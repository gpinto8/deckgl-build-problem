/*! For license information please see micro-frontend.js.LICENSE.txt */
(()=>{var t={363:()=>{(function(){"use strict";var t=window.Document.prototype.createElement,e=window.Document.prototype.createElementNS,n=window.Document.prototype.importNode,i=window.Document.prototype.prepend,r=window.Document.prototype.append,o=window.DocumentFragment.prototype.prepend,s=window.DocumentFragment.prototype.append,a=window.Node.prototype.cloneNode,l=window.Node.prototype.appendChild,c=window.Node.prototype.insertBefore,u=window.Node.prototype.removeChild,h=window.Node.prototype.replaceChild,d=Object.getOwnPropertyDescriptor(window.Node.prototype,"textContent"),f=window.Element.prototype.attachShadow,p=Object.getOwnPropertyDescriptor(window.Element.prototype,"innerHTML"),g=window.Element.prototype.getAttribute,m=window.Element.prototype.setAttribute,v=window.Element.prototype.removeAttribute,y=window.Element.prototype.toggleAttribute,_=window.Element.prototype.getAttributeNS,b=window.Element.prototype.setAttributeNS,w=window.Element.prototype.removeAttributeNS,x=window.Element.prototype.insertAdjacentElement,E=window.Element.prototype.insertAdjacentHTML,S=window.Element.prototype.prepend,P=window.Element.prototype.append,T=window.Element.prototype.before,C=window.Element.prototype.after,A=window.Element.prototype.replaceWith,M=window.Element.prototype.remove,L=window.HTMLElement,k=Object.getOwnPropertyDescriptor(window.HTMLElement.prototype,"innerHTML"),O=window.HTMLElement.prototype.insertAdjacentElement,I=window.HTMLElement.prototype.insertAdjacentHTML,R=new Set;function N(t){var e=R.has(t);return t=/^[a-z][.0-9_a-z]*-[-.0-9_a-z]*$/.test(t),!e&&t}"annotation-xml color-profile font-face font-face-src font-face-uri font-face-format font-face-name missing-glyph".split(" ").forEach((function(t){return R.add(t)}));var z=document.contains?document.contains.bind(document):document.documentElement.contains.bind(document.documentElement);function F(t){var e=t.isConnected;if(void 0!==e)return e;if(z(t))return!0;for(;t&&!(t.__CE_isImportDocument||t instanceof Document);)t=t.parentNode||(window.ShadowRoot&&t instanceof ShadowRoot?t.host:void 0);return!(!t||!(t.__CE_isImportDocument||t instanceof Document))}function D(t){var e=t.children;if(e)return Array.prototype.slice.call(e);for(e=[],t=t.firstChild;t;t=t.nextSibling)t.nodeType===Node.ELEMENT_NODE&&e.push(t);return e}function j(t,e){for(;e&&e!==t&&!e.nextSibling;)e=e.parentNode;return e&&e!==t?e.nextSibling:null}function B(t,e,n){for(var i=t;i;){if(i.nodeType===Node.ELEMENT_NODE){var r=i;e(r);var o=r.localName;if("link"===o&&"import"===r.getAttribute("rel")){if(i=r.import,void 0===n&&(n=new Set),i instanceof Node&&!n.has(i))for(n.add(i),i=i.firstChild;i;i=i.nextSibling)B(i,e,n);i=j(t,r);continue}if("template"===o){i=j(t,r);continue}if(r=r.__CE_shadowRoot)for(r=r.firstChild;r;r=r.nextSibling)B(r,e,n)}i=i.firstChild?i.firstChild:j(t,i)}}function U(){var t=!(null==at||!at.noDocumentConstructionObserver),e=!(null==at||!at.shadyDomFastWalk);this.m=[],this.g=[],this.j=!1,this.shadyDomFastWalk=e,this.I=!t}function V(t,e,n,i){var r=window.ShadyDOM;if(t.shadyDomFastWalk&&r&&r.inUse){if(e.nodeType===Node.ELEMENT_NODE&&n(e),e.querySelectorAll)for(t=r.nativeMethods.querySelectorAll.call(e,"*"),e=0;e<t.length;e++)n(t[e])}else B(e,n,i)}function W(t,e){t.j&&V(t,e,(function(e){return G(t,e)}))}function G(t,e){if(t.j&&!e.__CE_patched){e.__CE_patched=!0;for(var n=0;n<t.m.length;n++)t.m[n](e);for(n=0;n<t.g.length;n++)t.g[n](e)}}function H(t,e){var n=[];for(V(t,e,(function(t){return n.push(t)})),e=0;e<n.length;e++){var i=n[e];1===i.__CE_state?t.connectedCallback(i):Z(t,i)}}function q(t,e){var n=[];for(V(t,e,(function(t){return n.push(t)})),e=0;e<n.length;e++){var i=n[e];1===i.__CE_state&&t.disconnectedCallback(i)}}function X(t,e,n){var i=(n=void 0===n?{}:n).J,r=n.upgrade||function(e){return Z(t,e)},o=[];for(V(t,e,(function(e){if(t.j&&G(t,e),"link"===e.localName&&"import"===e.getAttribute("rel")){var n=e.import;n instanceof Node&&(n.__CE_isImportDocument=!0,n.__CE_registry=document.__CE_registry),n&&"complete"===n.readyState?n.__CE_documentLoadHandled=!0:e.addEventListener("load",(function(){var n=e.import;if(!n.__CE_documentLoadHandled){n.__CE_documentLoadHandled=!0;var o=new Set;i&&(i.forEach((function(t){return o.add(t)})),o.delete(n)),X(t,n,{J:o,upgrade:r})}}))}else o.push(e)}),i),e=0;e<o.length;e++)r(o[e])}function Z(t,e){try{var n=e.ownerDocument,i=n.__CE_registry,r=i&&(n.defaultView||n.__CE_isImportDocument)?rt(i,e.localName):void 0;if(r&&void 0===e.__CE_state){r.constructionStack.push(e);try{try{if(new r.constructorFunction!==e)throw Error("The custom element constructor did not produce the element being upgraded.")}finally{r.constructionStack.pop()}}catch(t){throw e.__CE_state=2,t}if(e.__CE_state=1,e.__CE_definition=r,r.attributeChangedCallback&&e.hasAttributes()){var o=r.observedAttributes;for(r=0;r<o.length;r++){var s=o[r],a=e.getAttribute(s);null!==a&&t.attributeChangedCallback(e,s,null,a,null)}}F(e)&&t.connectedCallback(e)}}catch(t){K(t)}}function Y(n,i,r,o){var s=i.__CE_registry;if(s&&(null===o||"http://www.w3.org/1999/xhtml"===o)&&(s=rt(s,r)))try{var a=new s.constructorFunction;if(void 0===a.__CE_state||void 0===a.__CE_definition)throw Error("Failed to construct '"+r+"': The returned value was not constructed with the HTMLElement constructor.");if("http://www.w3.org/1999/xhtml"!==a.namespaceURI)throw Error("Failed to construct '"+r+"': The constructed element's namespace must be the HTML namespace.");if(a.hasAttributes())throw Error("Failed to construct '"+r+"': The constructed element must not have any attributes.");if(null!==a.firstChild)throw Error("Failed to construct '"+r+"': The constructed element must not have any children.");if(null!==a.parentNode)throw Error("Failed to construct '"+r+"': The constructed element must not have a parent node.");if(a.ownerDocument!==i)throw Error("Failed to construct '"+r+"': The constructed element's owner document is incorrect.");if(a.localName!==r)throw Error("Failed to construct '"+r+"': The constructed element's local name is incorrect.");return a}catch(s){return K(s),i=null===o?t.call(i,r):e.call(i,o,r),Object.setPrototypeOf(i,HTMLUnknownElement.prototype),i.__CE_state=2,i.__CE_definition=void 0,G(n,i),i}return G(n,i=null===o?t.call(i,r):e.call(i,o,r)),i}function K(t){var e="",n="",i=0,r=0;t instanceof Error?(e=t.message,n=t.sourceURL||t.fileName||"",i=t.line||t.lineNumber||0,r=t.column||t.columnNumber||0):e="Uncaught "+String(t);var o=void 0;void 0===ErrorEvent.prototype.initErrorEvent?o=new ErrorEvent("error",{cancelable:!0,message:e,filename:n,lineno:i,colno:r,error:t}):((o=document.createEvent("ErrorEvent")).initErrorEvent("error",!1,!0,e,n,i),o.preventDefault=function(){Object.defineProperty(this,"defaultPrevented",{configurable:!0,get:function(){return!0}})}),void 0===o.error&&Object.defineProperty(o,"error",{configurable:!0,enumerable:!0,get:function(){return t}}),window.dispatchEvent(o),o.defaultPrevented||console.error(t)}function Q(){var t=this;this.g=void 0,this.F=new Promise((function(e){t.l=e}))}function $(t){var e=document;this.l=void 0,this.h=t,this.g=e,X(this.h,this.g),"loading"===this.g.readyState&&(this.l=new MutationObserver(this.G.bind(this)),this.l.observe(this.g,{childList:!0,subtree:!0}))}function J(t){t.l&&t.l.disconnect()}function tt(t){this.s=new Map,this.u=new Map,this.C=new Map,this.A=!1,this.B=new Map,this.o=function(t){return t()},this.i=!1,this.v=[],this.h=t,this.D=t.I?new $(t):void 0}function et(t,e){if(!N(e))throw new SyntaxError("The element name '"+e+"' is not valid.");if(rt(t,e))throw Error("A custom element with name '"+e+"' has already been defined.");if(t.A)throw Error("A custom element is already being defined.")}function nt(t,e,n){var i;t.A=!0;try{var r=n.prototype;if(!(r instanceof Object))throw new TypeError("The custom element constructor's prototype is not an object.");var o=function(t){var e=r[t];if(void 0!==e&&!(e instanceof Function))throw Error("The '"+t+"' callback must be a function.");return e},s=o("connectedCallback"),a=o("disconnectedCallback"),l=o("adoptedCallback"),c=(i=o("attributeChangedCallback"))&&n.observedAttributes||[]}catch(t){throw t}finally{t.A=!1}return n={localName:e,constructorFunction:n,connectedCallback:s,disconnectedCallback:a,adoptedCallback:l,attributeChangedCallback:i,observedAttributes:c,constructionStack:[]},t.u.set(e,n),t.C.set(n.constructorFunction,n),n}function it(t){if(!1!==t.i){t.i=!1;for(var e=[],n=t.v,i=new Map,r=0;r<n.length;r++)i.set(n[r],[]);for(X(t.h,document,{upgrade:function(n){if(void 0===n.__CE_state){var r=n.localName,o=i.get(r);o?o.push(n):t.u.has(r)&&e.push(n)}}}),r=0;r<e.length;r++)Z(t.h,e[r]);for(r=0;r<n.length;r++){for(var o=n[r],s=i.get(o),a=0;a<s.length;a++)Z(t.h,s[a]);(o=t.B.get(o))&&o.resolve(void 0)}n.length=0}}function rt(t,e){var n=t.u.get(e);if(n)return n;if(n=t.s.get(e)){t.s.delete(e);try{return nt(t,e,n())}catch(t){K(t)}}}function ot(t,e,n){function i(e){return function(n){for(var i=[],r=0;r<arguments.length;++r)i[r]=arguments[r];r=[];for(var o=[],s=0;s<i.length;s++){var a=i[s];if(a instanceof Element&&F(a)&&o.push(a),a instanceof DocumentFragment)for(a=a.firstChild;a;a=a.nextSibling)r.push(a);else r.push(a)}for(e.apply(this,i),i=0;i<o.length;i++)q(t,o[i]);if(F(this))for(i=0;i<r.length;i++)(o=r[i])instanceof Element&&H(t,o)}}void 0!==n.prepend&&(e.prepend=i(n.prepend)),void 0!==n.append&&(e.append=i(n.append))}U.prototype.connectedCallback=function(t){var e=t.__CE_definition;if(e.connectedCallback)try{e.connectedCallback.call(t)}catch(t){K(t)}},U.prototype.disconnectedCallback=function(t){var e=t.__CE_definition;if(e.disconnectedCallback)try{e.disconnectedCallback.call(t)}catch(t){K(t)}},U.prototype.attributeChangedCallback=function(t,e,n,i,r){var o=t.__CE_definition;if(o.attributeChangedCallback&&-1<o.observedAttributes.indexOf(e))try{o.attributeChangedCallback.call(t,e,n,i,r)}catch(t){K(t)}},Q.prototype.resolve=function(t){if(this.g)throw Error("Already resolved.");this.g=t,this.l(t)},$.prototype.G=function(t){var e=this.g.readyState;for("interactive"!==e&&"complete"!==e||J(this),e=0;e<t.length;e++)for(var n=t[e].addedNodes,i=0;i<n.length;i++)X(this.h,n[i])},tt.prototype.H=function(t,e){var n=this;if(!(e instanceof Function))throw new TypeError("Custom element constructor getters must be functions.");et(this,t),this.s.set(t,e),this.v.push(t),this.i||(this.i=!0,this.o((function(){return it(n)})))},tt.prototype.define=function(t,e){var n=this;if(!(e instanceof Function))throw new TypeError("Custom element constructors must be functions.");et(this,t),nt(this,t,e),this.v.push(t),this.i||(this.i=!0,this.o((function(){return it(n)})))},tt.prototype.upgrade=function(t){X(this.h,t)},tt.prototype.get=function(t){if(t=rt(this,t))return t.constructorFunction},tt.prototype.whenDefined=function(t){if(!N(t))return Promise.reject(new SyntaxError("'"+t+"' is not a valid custom element name."));var e=this.B.get(t);if(e)return e.F;e=new Q,this.B.set(t,e);var n=this.u.has(t)||this.s.has(t);return t=-1===this.v.indexOf(t),n&&t&&e.resolve(void 0),e.F},tt.prototype.polyfillWrapFlushCallback=function(t){this.D&&J(this.D);var e=this.o;this.o=function(n){return t((function(){return e(n)}))}},tt.prototype.define=tt.prototype.define,tt.prototype.upgrade=tt.prototype.upgrade,tt.prototype.get=tt.prototype.get,tt.prototype.whenDefined=tt.prototype.whenDefined,tt.prototype.polyfillDefineLazy=tt.prototype.H,tt.prototype.polyfillWrapFlushCallback=tt.prototype.polyfillWrapFlushCallback;var st={},at=window.customElements;function lt(){var R=new U;!function(e){function n(){var n=this.constructor,i=document.__CE_registry.C.get(n);if(!i)throw Error("Failed to construct a custom element: The constructor was not registered with `customElements`.");var r=i.constructionStack;if(0===r.length)return r=t.call(document,i.localName),Object.setPrototypeOf(r,n.prototype),r.__CE_state=1,r.__CE_definition=i,G(e,r),r;var o=r.length-1,s=r[o];if(s===st)throw Error("Failed to construct '"+i.localName+"': This element was already constructed.");return r[o]=st,Object.setPrototypeOf(s,n.prototype),G(e,s),s}n.prototype=L.prototype,Object.defineProperty(HTMLElement.prototype,"constructor",{writable:!0,configurable:!0,enumerable:!1,value:n}),window.HTMLElement=n}(R),function(t){Document.prototype.createElement=function(e){return Y(t,this,e,null)},Document.prototype.importNode=function(e,i){return e=n.call(this,e,!!i),this.__CE_registry?X(t,e):W(t,e),e},Document.prototype.createElementNS=function(e,n){return Y(t,this,n,e)},ot(t,Document.prototype,{prepend:i,append:r})}(R),ot(R,DocumentFragment.prototype,{prepend:o,append:s}),function(t){function e(e,n){Object.defineProperty(e,"textContent",{enumerable:n.enumerable,configurable:!0,get:n.get,set:function(e){if(this.nodeType===Node.TEXT_NODE)n.set.call(this,e);else{var i=void 0;if(this.firstChild){var r=this.childNodes,o=r.length;if(0<o&&F(this)){i=Array(o);for(var s=0;s<o;s++)i[s]=r[s]}}if(n.set.call(this,e),i)for(e=0;e<i.length;e++)q(t,i[e])}}})}Node.prototype.insertBefore=function(e,n){if(e instanceof DocumentFragment){var i=D(e);if(e=c.call(this,e,n),F(this))for(n=0;n<i.length;n++)H(t,i[n]);return e}return i=e instanceof Element&&F(e),n=c.call(this,e,n),i&&q(t,e),F(this)&&H(t,e),n},Node.prototype.appendChild=function(e){if(e instanceof DocumentFragment){var n=D(e);if(e=l.call(this,e),F(this))for(var i=0;i<n.length;i++)H(t,n[i]);return e}return n=e instanceof Element&&F(e),i=l.call(this,e),n&&q(t,e),F(this)&&H(t,e),i},Node.prototype.cloneNode=function(e){return e=a.call(this,!!e),this.ownerDocument.__CE_registry?X(t,e):W(t,e),e},Node.prototype.removeChild=function(e){var n=e instanceof Element&&F(e),i=u.call(this,e);return n&&q(t,e),i},Node.prototype.replaceChild=function(e,n){if(e instanceof DocumentFragment){var i=D(e);if(e=h.call(this,e,n),F(this))for(q(t,n),n=0;n<i.length;n++)H(t,i[n]);return e}i=e instanceof Element&&F(e);var r=h.call(this,e,n),o=F(this);return o&&q(t,n),i&&q(t,e),o&&H(t,e),r},d&&d.get?e(Node.prototype,d):function(t,e){t.j=!0,t.m.push(e)}(t,(function(t){e(t,{enumerable:!0,configurable:!0,get:function(){for(var t=[],e=this.firstChild;e;e=e.nextSibling)e.nodeType!==Node.COMMENT_NODE&&t.push(e.textContent);return t.join("")},set:function(t){for(;this.firstChild;)u.call(this,this.firstChild);null!=t&&""!==t&&l.call(this,document.createTextNode(t))}})}))}(R),function(t){function n(e,n){Object.defineProperty(e,"innerHTML",{enumerable:n.enumerable,configurable:!0,get:n.get,set:function(e){var i=this,r=void 0;if(F(this)&&(r=[],V(t,this,(function(t){t!==i&&r.push(t)}))),n.set.call(this,e),r)for(var o=0;o<r.length;o++){var s=r[o];1===s.__CE_state&&t.disconnectedCallback(s)}return this.ownerDocument.__CE_registry?X(t,this):W(t,this),e}})}function i(e,n){e.insertAdjacentElement=function(e,i){var r=F(i);return e=n.call(this,e,i),r&&q(t,i),F(e)&&H(t,i),e}}function r(e,n){function i(e,n){for(var i=[];e!==n;e=e.nextSibling)i.push(e);for(n=0;n<i.length;n++)X(t,i[n])}e.insertAdjacentHTML=function(t,e){if("beforebegin"===(t=t.toLowerCase())){var r=this.previousSibling;n.call(this,t,e),i(r||this.parentNode.firstChild,this)}else if("afterbegin"===t)r=this.firstChild,n.call(this,t,e),i(this.firstChild,r);else if("beforeend"===t)r=this.lastChild,n.call(this,t,e),i(r||this.firstChild,null);else{if("afterend"!==t)throw new SyntaxError("The value provided ("+String(t)+") is not one of 'beforebegin', 'afterbegin', 'beforeend', or 'afterend'.");r=this.nextSibling,n.call(this,t,e),i(this.nextSibling,r)}}}f&&(Element.prototype.attachShadow=function(e){if(e=f.call(this,e),t.j&&!e.__CE_patched){e.__CE_patched=!0;for(var n=0;n<t.m.length;n++)t.m[n](e)}return this.__CE_shadowRoot=e}),p&&p.get?n(Element.prototype,p):k&&k.get?n(HTMLElement.prototype,k):function(t,e){t.j=!0,t.g.push(e)}(t,(function(t){n(t,{enumerable:!0,configurable:!0,get:function(){return a.call(this,!0).innerHTML},set:function(t){var n="template"===this.localName,i=n?this.content:this,r=e.call(document,this.namespaceURI,this.localName);for(r.innerHTML=t;0<i.childNodes.length;)u.call(i,i.childNodes[0]);for(t=n?r.content:r;0<t.childNodes.length;)l.call(i,t.childNodes[0])}})})),Element.prototype.setAttribute=function(e,n){if(1!==this.__CE_state)return m.call(this,e,n);var i=g.call(this,e);m.call(this,e,n),n=g.call(this,e),t.attributeChangedCallback(this,e,i,n,null)},Element.prototype.setAttributeNS=function(e,n,i){if(1!==this.__CE_state)return b.call(this,e,n,i);var r=_.call(this,e,n);b.call(this,e,n,i),i=_.call(this,e,n),t.attributeChangedCallback(this,n,r,i,e)},Element.prototype.removeAttribute=function(e){if(1!==this.__CE_state)return v.call(this,e);var n=g.call(this,e);v.call(this,e),null!==n&&t.attributeChangedCallback(this,e,n,null,null)},y&&(Element.prototype.toggleAttribute=function(e,n){if(1!==this.__CE_state)return y.call(this,e,n);var i=g.call(this,e);return null!==i!==(n=y.call(this,e,n))&&t.attributeChangedCallback(this,e,i,n?"":null,null),n}),Element.prototype.removeAttributeNS=function(e,n){if(1!==this.__CE_state)return w.call(this,e,n);var i=_.call(this,e,n);w.call(this,e,n);var r=_.call(this,e,n);i!==r&&t.attributeChangedCallback(this,n,i,r,e)},O?i(HTMLElement.prototype,O):x&&i(Element.prototype,x),I?r(HTMLElement.prototype,I):E&&r(Element.prototype,E),ot(t,Element.prototype,{prepend:S,append:P}),function(t){function e(e){return function(n){for(var i=[],r=0;r<arguments.length;++r)i[r]=arguments[r];r=[];for(var o=[],s=0;s<i.length;s++){var a=i[s];if(a instanceof Element&&F(a)&&o.push(a),a instanceof DocumentFragment)for(a=a.firstChild;a;a=a.nextSibling)r.push(a);else r.push(a)}for(e.apply(this,i),i=0;i<o.length;i++)q(t,o[i]);if(F(this))for(i=0;i<r.length;i++)(o=r[i])instanceof Element&&H(t,o)}}var n=Element.prototype;void 0!==T&&(n.before=e(T)),void 0!==C&&(n.after=e(C)),void 0!==A&&(n.replaceWith=function(e){for(var n=[],i=0;i<arguments.length;++i)n[i]=arguments[i];i=[];for(var r=[],o=0;o<n.length;o++){var s=n[o];if(s instanceof Element&&F(s)&&r.push(s),s instanceof DocumentFragment)for(s=s.firstChild;s;s=s.nextSibling)i.push(s);else i.push(s)}for(o=F(this),A.apply(this,n),n=0;n<r.length;n++)q(t,r[n]);if(o)for(q(t,this),n=0;n<i.length;n++)(r=i[n])instanceof Element&&H(t,r)}),void 0!==M&&(n.remove=function(){var e=F(this);M.call(this),e&&q(t,this)})}(t)}(R),window.CustomElementRegistry=tt,R=new tt(R),document.__CE_registry=R,Object.defineProperty(window,"customElements",{configurable:!0,enumerable:!0,value:R})}at&&!at.forcePolyfill&&"function"==typeof at.define&&"function"==typeof at.get||lt(),window.__CE_installPolyfill=lt}).call(self)},919:function(t,e,n){(function(){"use strict";var t;function e(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function i(t){var n="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return n?n.call(t):{next:e(t)}}function r(t){if(!(t instanceof Array)){t=i(t);for(var e,n=[];!(e=t.next()).done;)n.push(e.value);t=n}return t}var o=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g];for(var e=0;e<t.length;++e){var i=t[e];if(i&&i.Math==Math)return i}throw Error("Cannot find global object")}(this);function s(){}function a(t){return t.__shady||(t.__shady=new s),t.__shady}function l(t){return t&&t.__shady}s.prototype.toJSON=function(){return{}};var c=window.ShadyDOM||{};c.da=!(!Element.prototype.attachShadow||!Node.prototype.getRootNode);var u,h=Object.getOwnPropertyDescriptor(Node.prototype,"firstChild");c.i=!!(h&&h.configurable&&h.get),c.N=c.force||!c.da,c.l=c.noPatch||!1,c.C=c.preferPerformance,c.O="on-demand"===c.l;var d=c.querySelectorImplementation;function f(){return Document.prototype.msElementsFromPoint?"msElementsFromPoint":"elementsFromPoint"}function p(t){return(t=l(t))&&void 0!==t.firstChild}function g(t){return t instanceof ShadowRoot}function m(t){return(t=(t=l(t))&&t.root)&&hn(t)}u=-1<["native","selectorEngine"].indexOf(d)?d:void 0,c.ga=u,c.V=navigator.userAgent.match("Trident");var v=Element.prototype,y=v.matches||v.matchesSelector||v.mozMatchesSelector||v.msMatchesSelector||v.oMatchesSelector||v.webkitMatchesSelector,_=document.createTextNode(""),b=0,w=[];function x(t){w.push(t),_.textContent=b++}new MutationObserver((function(){for(;w.length;)try{w.shift()()}catch(t){throw _.textContent=b++,t}})).observe(_,{characterData:!0});var E=document.contains?function(t,e){return t.__shady_native_contains(e)}:function(t,e){return t===e||t.documentElement&&t.documentElement.__shady_native_contains(e)};function S(t,e){for(;e;){if(e==t)return!0;e=e.__shady_parentNode}return!1}function P(t){for(var e=t.length-1;0<=e;e--){var n=t[e],r=n.getAttribute("id")||n.getAttribute("name");r&&"length"!==r&&isNaN(r)&&(t[r]=n)}return t.item=function(e){return t[e]},t.namedItem=function(e){if("length"!==e&&isNaN(e)&&t[e])return t[e];for(var n=i(t),r=n.next();!r.done;r=n.next())if(((r=r.value).getAttribute("id")||r.getAttribute("name"))==e)return r;return null},t}function T(t){var e=[];for(t=t.__shady_native_firstChild;t;t=t.__shady_native_nextSibling)e.push(t);return e}function C(t){var e=[];for(t=t.__shady_firstChild;t;t=t.__shady_nextSibling)e.push(t);return e}function A(t,e,n){if(n.configurable=!0,n.value)t[e]=n.value;else try{Object.defineProperty(t,e,n)}catch(t){}}function M(t,e,n,i){for(var r in n=void 0===n?"":n,e)i&&0<=i.indexOf(r)||A(t,n+r,e[r])}function L(t,e){for(var n in e)n in t&&A(t,n,e[n])}function k(t){var e={};return Object.getOwnPropertyNames(t).forEach((function(n){e[n]=Object.getOwnPropertyDescriptor(t,n)})),e}function O(t,e){for(var n,i=Object.getOwnPropertyNames(e),r=0;r<i.length;r++)t[n=i[r]]=e[n]}function I(t){return t instanceof Node?t:document.createTextNode(""+t)}function R(t){for(var e=[],n=0;n<arguments.length;++n)e[n]=arguments[n];if(1===e.length)return I(e[0]);n=document.createDocumentFragment();for(var r=(e=i(e)).next();!r.done;r=e.next())n.appendChild(I(r.value));return n}function N(t){var e;for(e=void 0===e?1:e;0<e;e--)t=t.reduce((function(t,e){return Array.isArray(e)?t.push.apply(t,r(e)):t.push(e),t}),[]);return t}var z,F=[];function D(t){z||(z=!0,x(j)),F.push(t)}function j(){z=!1;for(var t=!!F.length;F.length;)F.shift()();return t}function B(){this.g=!1,this.addedNodes=[],this.removedNodes=[],this.H=new Set}j.list=F,B.prototype.flush=function(){if(this.g){this.g=!1;var t=this.takeRecords();t.length&&this.H.forEach((function(e){e(t)}))}},B.prototype.takeRecords=function(){if(this.addedNodes.length||this.removedNodes.length){var t=[{addedNodes:this.addedNodes,removedNodes:this.removedNodes}];return this.addedNodes=[],this.removedNodes=[],t}return[]};var U=/[&\u00A0"]/g,V=/[&\u00A0<>]/g;function W(t){switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"Â ":return"&nbsp;"}}function G(t){for(var e={},n=0;n<t.length;n++)e[t[n]]=!0;return e}var H=G("area base br col command embed hr img input keygen link meta param source track wbr".split(" ")),q=G("style script xmp iframe noembed noframes plaintext noscript".split(" "));function X(t,e){"template"===t.localName&&(t=t.content);for(var n="",i=e?e(t):t.childNodes,r=0,o=i.length,s=void 0;r<o&&(s=i[r]);r++){t:{var a=s,l=t,c=e;switch(a.nodeType){case Node.ELEMENT_NODE:for(var u,h="<"+(l=a.localName),d=a.attributes,f=0;u=d[f];f++)h+=" "+u.name+'="'+u.value.replace(U,W)+'"';h+=">",a=H[l]?h:h+X(a,c)+"</"+l+">";break t;case Node.TEXT_NODE:a=a.data,a=l&&q[l.localName]?a:a.replace(V,W);break t;case Node.COMMENT_NODE:a="\x3c!--"+a.data+"--\x3e";break t;default:throw window.console.error(a),Error("not implemented")}}n+=a}return n}var Z=c.i,Y={querySelector:function(t){return this.__shady_native_querySelector(t)},querySelectorAll:function(t){return this.__shady_native_querySelectorAll(t)}},K={};function Q(t){K[t]=function(e){return e["__shady_native_"+t]}}function $(t,e){for(var n in M(t,e,"__shady_native_"),e)Q(n)}function J(t,e){e=void 0===e?[]:e;for(var n=0;n<e.length;n++){var i=e[n],r=Object.getOwnPropertyDescriptor(t,i);r&&(Object.defineProperty(t,"__shady_native_"+i,r),r.value?Y[i]||(Y[i]=r.value):Q(i))}}var tt=document.createTreeWalker(document,NodeFilter.SHOW_ALL,null,!1),et=document.createTreeWalker(document,NodeFilter.SHOW_ELEMENT,null,!1),nt=document.implementation.createHTMLDocument("inert");function it(t){for(var e;e=t.__shady_native_firstChild;)t.__shady_native_removeChild(e)}var rt=["firstElementChild","lastElementChild","children","childElementCount"],ot=["querySelector","querySelectorAll","append","prepend","replaceChildren"],st=k({get childNodes(){return this.__shady_childNodes},get firstChild(){return this.__shady_firstChild},get lastChild(){return this.__shady_lastChild},get childElementCount(){return this.__shady_childElementCount},get children(){return this.__shady_children},get firstElementChild(){return this.__shady_firstElementChild},get lastElementChild(){return this.__shady_lastElementChild},get shadowRoot(){return this.__shady_shadowRoot}}),at=k({get textContent(){return this.__shady_textContent},set textContent(t){this.__shady_textContent=t},get innerHTML(){return this.__shady_innerHTML},set innerHTML(t){this.__shady_innerHTML=t}}),lt=k({get parentElement(){return this.__shady_parentElement},get parentNode(){return this.__shady_parentNode},get nextSibling(){return this.__shady_nextSibling},get previousSibling(){return this.__shady_previousSibling},get nextElementSibling(){return this.__shady_nextElementSibling},get previousElementSibling(){return this.__shady_previousElementSibling},get className(){return this.__shady_className},set className(t){this.__shady_className=t}});function ct(t){for(var e in t){var n=t[e];n&&(n.enumerable=!1)}}ct(st),ct(at),ct(lt);var ut,ht=c.i||!0===c.l,dt=ht?function(){}:function(t){var e=a(t);e.X||(e.X=!0,L(t,lt))},ft=ht?function(){}:function(t){var e=a(t);e.W||(e.W=!0,L(t,st),window.customElements&&window.customElements.polyfillWrapFlushCallback&&!c.l||L(t,at))},pt="__eventWrappers"+Date.now(),gt=(ut=Object.getOwnPropertyDescriptor(Event.prototype,"composed"))?function(t){return ut.get.call(t)}:null,mt=function(){function t(){}var e=!1,n={get capture(){return e=!0,!1}};return window.addEventListener("test",t,n),window.removeEventListener("test",t,n),e}();function vt(t){if(null===t||"object"!=typeof t&&"function"!=typeof t)var e=!!t,n=!1;else{e=!!t.capture,n=!!t.once;var i=t.o}return{U:i,capture:e,once:n,T:mt?t:e}}var yt={blur:!0,focus:!0,focusin:!0,focusout:!0,click:!0,dblclick:!0,mousedown:!0,mouseenter:!0,mouseleave:!0,mousemove:!0,mouseout:!0,mouseover:!0,mouseup:!0,wheel:!0,beforeinput:!0,input:!0,keydown:!0,keyup:!0,compositionstart:!0,compositionupdate:!0,compositionend:!0,touchstart:!0,touchend:!0,touchmove:!0,touchcancel:!0,pointerover:!0,pointerenter:!0,pointerdown:!0,pointermove:!0,pointerup:!0,pointercancel:!0,pointerout:!0,pointerleave:!0,gotpointercapture:!0,lostpointercapture:!0,dragstart:!0,drag:!0,dragenter:!0,dragleave:!0,dragover:!0,drop:!0,dragend:!0,DOMActivate:!0,DOMFocusIn:!0,DOMFocusOut:!0,keypress:!0},_t={DOMAttrModified:!0,DOMAttributeNameChanged:!0,DOMCharacterDataModified:!0,DOMElementNameChanged:!0,DOMNodeInserted:!0,DOMNodeInsertedIntoDocument:!0,DOMNodeRemoved:!0,DOMNodeRemovedFromDocument:!0,DOMSubtreeModified:!0};function bt(t){return t instanceof Node?t.__shady_getRootNode():t}function wt(t,e){var n=[],i=t;for(t=bt(t);i;)n.push(i),i=i.__shady_assignedSlot?i.__shady_assignedSlot:i.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&i.host&&(e||i!==t)?i.host:i.__shady_parentNode;return n[n.length-1]===document&&n.push(window),n}function xt(t,e){if(!g)return t;t=wt(t,!0);for(var n,i,r=0,o=void 0,s=void 0;r<e.length;r++)if((i=bt(n=e[r]))!==o&&(s=t.indexOf(i),o=i),!g(i)||-1<s)return n}var Et={get composed(){return void 0===this.__composed&&(gt?this.__composed="focusin"===this.type||"focusout"===this.type||gt(this):!1!==this.isTrusted&&(this.__composed=yt[this.type])),this.__composed||!1},composedPath:function(){return this.__composedPath||(this.__composedPath=wt(this.__target,this.composed)),this.__composedPath},get target(){return xt(this.currentTarget||this.__previousCurrentTarget,this.composedPath())},get relatedTarget(){return this.__relatedTarget?(this.__relatedTargetComposedPath||(this.__relatedTargetComposedPath=wt(this.__relatedTarget,!0)),xt(this.currentTarget||this.__previousCurrentTarget,this.__relatedTargetComposedPath)):null},stopPropagation:function(){Event.prototype.stopPropagation.call(this),this.K=!0},stopImmediatePropagation:function(){Event.prototype.stopImmediatePropagation.call(this),this.K=this.__immediatePropagationStopped=!0}},St=c.i&&Object.getOwnPropertyDescriptor(Event.prototype,"eventPhase");function Pt(t){function e(e,n){return(e=new t(e,n)).__composed=n&&!!n.composed,e}return e.__proto__=t,e.prototype=t.prototype,e}St&&(Object.defineProperty(Et,"eventPhase",{get:function(){return this.currentTarget===this.target?Event.AT_TARGET:this.__shady_native_eventPhase},enumerable:!0,configurable:!0}),Object.defineProperty(Et,"__shady_native_eventPhase",St));var Tt={focus:!0,blur:!0};function Ct(t){return t.__target!==t.target||t.__relatedTarget!==t.relatedTarget}function At(t,e,n){if(n=e.__handlers&&e.__handlers[t.type]&&e.__handlers[t.type][n])for(var i,r=0;(i=n[r])&&(!Ct(t)||t.target!==t.relatedTarget)&&(i.call(e,t),!t.__immediatePropagationStopped);r++);}var Mt=new Event("e").hasOwnProperty("currentTarget");function Lt(t){var e=(t=Mt?Object.create(t):t).composedPath(),n=e.map((function(t){return xt(t,e)})),i=t.bubbles,r=Object.getOwnPropertyDescriptor(t,"currentTarget");Object.defineProperty(t,"currentTarget",{configurable:!0,enumerable:!0,get:function(){return l}});var o=Event.CAPTURING_PHASE,s=Object.getOwnPropertyDescriptor(t,"eventPhase");Object.defineProperty(t,"eventPhase",{configurable:!0,enumerable:!0,get:function(){return o}});try{for(var a=e.length-1;0<=a;a--){var l=e[a];if(o=l===n[a]?Event.AT_TARGET:Event.CAPTURING_PHASE,At(t,l,"capture"),t.K)return}for(a=0;a<e.length;a++){var c=(l=e[a])===n[a];if((c||i)&&(o=c?Event.AT_TARGET:Event.BUBBLING_PHASE,At(t,l,"bubble"),t.K))break}}finally{Mt||(r?Object.defineProperty(t,"currentTarget",r):delete t.currentTarget,s?Object.defineProperty(t,"eventPhase",s):delete t.eventPhase)}}function kt(t,e,n,i){for(var r=0;r<t.length;r++){var o=t[r],s=o.type,a=o.capture;if(e===o.node&&n===s&&i===a)return r}return-1}function Ot(t){return j(),!c.C&&this instanceof Node&&!E(document,this)?(t.__target||zt(t,this),Lt(t)):this.__shady_native_dispatchEvent(t)}function It(t,e,n){var i=this,r=vt(n),o=r.capture,s=r.once,a=r.U;if(r=r.T,e){var l=typeof e;if(("function"===l||"object"===l)&&("object"!==l||e.handleEvent&&"function"==typeof e.handleEvent)){if(_t[t])return this.__shady_native_addEventListener(t,e,r);var c=a||this;if(a=e[pt]){if(-1<kt(a,c,t,o))return}else e[pt]=[];a=function(r){if(s&&i.__shady_removeEventListener(t,e,n),r.__target||zt(r),c!==i){var a=Object.getOwnPropertyDescriptor(r,"currentTarget");Object.defineProperty(r,"currentTarget",{get:function(){return c},configurable:!0});var u=Object.getOwnPropertyDescriptor(r,"eventPhase");Object.defineProperty(r,"eventPhase",{configurable:!0,enumerable:!0,get:function(){return o?Event.CAPTURING_PHASE:Event.BUBBLING_PHASE}})}if(r.__previousCurrentTarget=r.currentTarget,(!g(c)&&"slot"!==c.localName||-1!=r.composedPath().indexOf(c))&&(r.composed||-1<r.composedPath().indexOf(c)))if(Ct(r)&&r.target===r.relatedTarget)r.eventPhase===Event.BUBBLING_PHASE&&r.stopImmediatePropagation();else if(r.eventPhase===Event.CAPTURING_PHASE||r.bubbles||r.target===c||c instanceof Window){var h="function"===l?e.call(c,r):e.handleEvent&&e.handleEvent(r);return c!==i&&(a?(Object.defineProperty(r,"currentTarget",a),a=null):delete r.currentTarget,u?(Object.defineProperty(r,"eventPhase",u),u=null):delete r.eventPhase),h}},e[pt].push({node:c,type:t,capture:o,fa:a}),this.__handlers=this.__handlers||{},this.__handlers[t]=this.__handlers[t]||{capture:[],bubble:[]},this.__handlers[t][o?"capture":"bubble"].push(a),Tt[t]||this.__shady_native_addEventListener(t,a,r)}}}function Rt(t,e,n){if(e){var i=vt(n);n=i.capture;var r=i.U;if(i=i.T,_t[t])return this.__shady_native_removeEventListener(t,e,i);var o=r||this;r=void 0;var s=null;try{s=e[pt]}catch(t){}s&&-1<(o=kt(s,o,t,n))&&(r=s.splice(o,1)[0].fa,s.length||(e[pt]=void 0)),this.__shady_native_removeEventListener(t,r||e,i),r&&this.__handlers&&this.__handlers[t]&&-1<(e=(t=this.__handlers[t][n?"capture":"bubble"]).indexOf(r))&&t.splice(e,1)}}var Nt=k(Et);function zt(t,e){if(e=void 0===e?t.target:e,t.__target=e,t.__relatedTarget=t.relatedTarget,c.i){if(!(e=Object.getPrototypeOf(t)).hasOwnProperty("__shady_patchedProto")){var n=Object.create(e);n.__shady_sourceProto=e,M(n,Nt),e.__shady_patchedProto=n}t.__proto__=e.__shady_patchedProto}else M(t,Nt)}var Ft=Pt(Event),Dt=Pt(CustomEvent),jt=Pt(MouseEvent),Bt=Object.getOwnPropertyNames(Element.prototype).filter((function(t){return"on"===t.substring(0,2)})),Ut=Object.getOwnPropertyNames(HTMLElement.prototype).filter((function(t){return"on"===t.substring(0,2)}));function Vt(t){return{set:function(e){var n=a(this),i=t.substring(2);n.m||(n.m={}),n.m[t]&&this.removeEventListener(i,n.m[t]),this.__shady_addEventListener(i,e),n.m[t]=e},get:function(){var e=l(this);return e&&e.m&&e.m[t]},configurable:!0}}function Wt(t,e){return{index:t,D:[],G:e}}function Gt(t,e,n,i){var r=0,o=0,s=0,a=0,l=Math.min(e-r,i-o);if(0==r&&0==o)t:{for(s=0;s<l;s++)if(t[s]!==n[s])break t;s=l}if(e==t.length&&i==n.length){a=t.length;for(var c=n.length,u=0;u<l-s&&Ht(t[--a],n[--c]);)u++;a=u}if(o+=s,i-=a,0==(e-=a)-(r+=s)&&0==i-o)return[];if(r==e){for(e=Wt(r,0);o<i;)e.D.push(n[o++]);return[e]}if(o==i)return[Wt(r,e-r)];for(i=i-(s=o)+1,a=e-(l=r)+1,e=Array(i),c=0;c<i;c++)e[c]=Array(a),e[c][0]=c;for(c=0;c<a;c++)e[0][c]=c;for(c=1;c<i;c++)for(u=1;u<a;u++)if(t[l+u-1]===n[s+c-1])e[c][u]=e[c-1][u-1];else{var h=e[c-1][u]+1,d=e[c][u-1]+1;e[c][u]=h<d?h:d}for(l=e.length-1,s=e[0].length-1,i=e[l][s],t=[];0<l||0<s;)0==l?(t.push(2),s--):0==s?(t.push(3),l--):(a=e[l-1][s-1],(h=(c=e[l-1][s])<(u=e[l][s-1])?c<a?c:a:u<a?u:a)==a?(a==i?t.push(0):(t.push(1),i=a),l--,s--):h==c?(t.push(3),l--,i=c):(t.push(2),s--,i=u));for(t.reverse(),e=void 0,l=[],s=0;s<t.length;s++)switch(t[s]){case 0:e&&(l.push(e),e=void 0),r++,o++;break;case 1:e||(e=Wt(r,0)),e.G++,r++,e.D.push(n[o]),o++;break;case 2:e||(e=Wt(r,0)),e.G++,r++;break;case 3:e||(e=Wt(r,0)),e.D.push(n[o]),o++}return e&&l.push(e),l}function Ht(t,e){return t===e}var qt=k({dispatchEvent:Ot,addEventListener:It,removeEventListener:Rt}),Xt=null;function Zt(){return Xt||(Xt=window.ShadyCSS&&window.ShadyCSS.ScopingShim),Xt||null}function Yt(t,e,n){var i=Zt();return!(!i||"class"!==e||(i.setElementClass(t,n),0))}function Kt(t,e){var n=Zt();n&&n.unscopeNode(t,e)}function Qt(t,e){var n=Zt();if(!n)return!0;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){for(n=!0,t=t.__shady_firstChild;t;t=t.__shady_nextSibling)n=n&&Qt(t,e);return n}return t.nodeType!==Node.ELEMENT_NODE||n.currentScopeForNode(t)===e}function $t(t){if(t.nodeType!==Node.ELEMENT_NODE)return"";var e=Zt();return e?e.currentScopeForNode(t):""}function Jt(t,e){if(t)for(t.nodeType===Node.ELEMENT_NODE&&e(t),t=t.__shady_firstChild;t;t=t.__shady_nextSibling)t.nodeType===Node.ELEMENT_NODE&&Jt(t,e)}var te=window.document,ee=c.C,ne=Object.getOwnPropertyDescriptor(Node.prototype,"isConnected"),ie=ne&&ne.get;function re(t){for(var e;e=t.__shady_firstChild;)t.__shady_removeChild(e)}function oe(t){var e=l(t);if(e&&void 0!==e.J)for(e=t.__shady_firstChild;e;e=e.__shady_nextSibling)oe(e);(t=l(t))&&(t.J=void 0)}function se(t){var e=t;if(t&&"slot"===t.localName){var n=l(t);(n=n&&n.u)&&(e=n.length?n[0]:se(t.__shady_nextSibling))}return e}function ae(t,e,n){if(t=(t=l(t))&&t.B){if(e)if(e.nodeType===Node.DOCUMENT_FRAGMENT_NODE)for(var i=0,r=e.childNodes.length;i<r;i++)t.addedNodes.push(e.childNodes[i]);else t.addedNodes.push(e);n&&t.removedNodes.push(n),function(t){t.g||(t.g=!0,x((function(){t.flush()})))}(t)}}var le=k({get parentNode(){var t=l(this);return void 0!==(t=t&&t.parentNode)?t:this.__shady_native_parentNode},get firstChild(){var t=l(this);return void 0!==(t=t&&t.firstChild)?t:this.__shady_native_firstChild},get lastChild(){var t=l(this);return void 0!==(t=t&&t.lastChild)?t:this.__shady_native_lastChild},get nextSibling(){var t=l(this);return void 0!==(t=t&&t.nextSibling)?t:this.__shady_native_nextSibling},get previousSibling(){var t=l(this);return void 0!==(t=t&&t.previousSibling)?t:this.__shady_native_previousSibling},get childNodes(){if(p(this)){var t=l(this);if(!t.childNodes){t.childNodes=[];for(var e=this.__shady_firstChild;e;e=e.__shady_nextSibling)t.childNodes.push(e)}var n=t.childNodes}else n=this.__shady_native_childNodes;return n.item=function(t){return n[t]},n},get parentElement(){var t=l(this);return(t=t&&t.parentNode)&&t.nodeType!==Node.ELEMENT_NODE&&(t=null),void 0!==t?t:this.__shady_native_parentElement},get isConnected(){if(ie&&ie.call(this))return!0;if(this.nodeType==Node.DOCUMENT_FRAGMENT_NODE)return!1;var t=this.ownerDocument;if(null===t||E(t,this))return!0;for(t=this;t&&!(t instanceof Document);)t=t.__shady_parentNode||(g(t)?t.host:void 0);return!!(t&&t instanceof Document)},get textContent(){if(p(this)){for(var t=[],e=this.__shady_firstChild;e;e=e.__shady_nextSibling)e.nodeType!==Node.COMMENT_NODE&&t.push(e.__shady_textContent);return t.join("")}return this.__shady_native_textContent},set textContent(t){switch(null==t&&(t=""),this.nodeType){case Node.ELEMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:if(!p(this)&&c.i){var e=this.__shady_firstChild;(e!=this.__shady_lastChild||e&&e.nodeType!=Node.TEXT_NODE)&&re(this),this.__shady_native_textContent=t}else re(this),(0<t.length||this.nodeType===Node.ELEMENT_NODE)&&this.__shady_insertBefore(document.createTextNode(t));break;default:this.nodeValue=t}},insertBefore:function(t,e){if(this.ownerDocument!==te&&t.ownerDocument!==te)return this.__shady_native_insertBefore(t,e),t;if(t===this)throw Error("Failed to execute 'appendChild' on 'Node': The new child element contains the parent.");if(e){var n=l(e);if(void 0!==(n=n&&n.parentNode)&&n!==this||void 0===n&&e.__shady_native_parentNode!==this)throw Error("Failed to execute 'insertBefore' on 'Node': The node before which the new node is to be inserted is not a child of this node.")}if(e===t)return t;ae(this,t);var i=[],o=(n=gn(this))?n.host.localName:$t(this),s=t.__shady_parentNode;if(s){var c=$t(t),u=!!n||!gn(t)||ee&&void 0!==this.__noInsertionPoint;s.__shady_removeChild(t,u)}s=!0;var h=(!ee||void 0===t.__noInsertionPoint&&void 0===this.__noInsertionPoint)&&!Qt(t,o),d=n&&!t.__noInsertionPoint&&(!ee||t.nodeType===Node.DOCUMENT_FRAGMENT_NODE);return(d||h)&&(h&&(c=c||$t(t)),Jt(t,(function(t){if(d&&"slot"===t.localName&&i.push(t),h){var e=c;Zt()&&(e&&Kt(t,e),(e=Zt())&&e.scopeNode(t,o))}}))),i.length&&(an(n),n.j.push.apply(n.j,r(i)),en(n)),p(this)&&(function(t,e,n){Ge(e,2);var i=a(e);if(void 0!==i.firstChild&&(i.childNodes=null),t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)for(t=t.__shady_native_firstChild;t;t=t.__shady_native_nextSibling)He(t,e,i,n);else He(t,e,i,n)}(t,this,e),(u=l(this)).root?(s=!1,m(this)&&en(u.root)):n&&"slot"===this.localName&&(s=!1,en(n))),s?(n=g(this)?this.host:this,e?(e=se(e),n.__shady_native_insertBefore(t,e)):n.__shady_native_appendChild(t)):t.ownerDocument!==this.ownerDocument&&this.ownerDocument.adoptNode(t),t},appendChild:function(t){if(this!=t||!g(t))return this.__shady_insertBefore(t)},removeChild:function(t,e){if(e=void 0!==e&&e,this.ownerDocument!==te)return this.__shady_native_removeChild(t);if(t.__shady_parentNode!==this)throw Error("The node to be removed is not a child of this node: "+t);ae(this,null,t);var n=gn(t),i=n&&function(t,e){if(t.g){ln(t);var n,i=t.h;for(n in i)for(var r=i[n],o=0;o<r.length;o++){var s=r[o];if(S(e,s)){r.splice(o,1);var a=t.g.indexOf(s);if(0<=a&&(t.g.splice(a,1),(a=l(s.__shady_parentNode))&&a.F&&a.F--),o--,a=(s=l(s)).u)for(var c=0;c<a.length;c++){var u=a[c],h=u.__shady_native_parentNode;h&&h.__shady_native_removeChild(u)}s.u=[],s.assignedNodes=[],a=!0}}return a}}(n,t),r=l(this);if(p(this)&&(function(t,e){var n=a(t);t===(e=a(e)).firstChild&&(e.firstChild=n.nextSibling),t===e.lastChild&&(e.lastChild=n.previousSibling),t=n.previousSibling;var i=n.nextSibling;t&&(a(t).nextSibling=i),i&&(a(i).previousSibling=t),n.parentNode=n.previousSibling=n.nextSibling=void 0,void 0!==e.childNodes&&(e.childNodes=null)}(t,this),m(this))){en(r.root);var o=!0}if(Zt()&&!e&&n&&t.nodeType!==Node.TEXT_NODE){var s=$t(t);Jt(t,(function(t){Kt(t,s)}))}return oe(t),n&&((e="slot"===this.localName)&&(o=!0),(i||e)&&en(n)),o||(o=g(this)?this.host:this,(!r.root&&"slot"!==t.localName||o===t.__shady_native_parentNode)&&o.__shady_native_removeChild(t)),t},replaceChild:function(t,e){return this.__shady_insertBefore(t,e),this.__shady_removeChild(e),t},cloneNode:function(t){if("template"==this.localName)return this.__shady_native_cloneNode(t);var e=this.__shady_native_cloneNode(!1);if(t&&e.nodeType!==Node.ATTRIBUTE_NODE){t=this.__shady_firstChild;for(var n;t;t=t.__shady_nextSibling)n=t.__shady_cloneNode(!0),e.__shady_appendChild(n)}return e},getRootNode:function(t){if(this&&this.nodeType){var e=a(this),n=e.J;return void 0===n&&(g(this)?(n=this,e.J=n):(n=(n=this.__shady_parentNode)?n.__shady_getRootNode(t):this,document.documentElement.__shady_native_contains(this)&&(e.J=n))),n}},contains:function(t){return S(this,t)}}),ce=k({get assignedSlot(){var t=this.__shady_parentNode;return(t=t&&t.__shady_shadowRoot)&&nn(t),(t=l(this))&&t.assignedSlot||null}}),ue=new Map;function he(t,e,n,i){for(i=void 0===i||i;e<t.length;e++)if("\\"===t[e]&&e<t.length-1&&"\n"!==t[e+1])e++;else{if(-1!==n.indexOf(t[e]))return e;if(i&&ue.has(t[e])){var r=ue.get(t[e]);e=he(t,e+1,[r.end],r.I)}}return t.length}function de(t,e,n){var i=[];return fe(t,e,n,i),i}function fe(t,e,n,i){for(t=t.__shady_firstChild;t;t=t.__shady_nextSibling){var r;if(r=t.nodeType===Node.ELEMENT_NODE){var o=e,s=n,a=i,l=o(r=t);l&&a.push(r),s&&s(l)?r=l:(fe(r,o,s,a),r=void 0)}if(r)break}}[["(",{end:")",I:!0}],["[",{end:"]",I:!0}],['"',{end:'"',I:!1}],["'",{end:"'",I:!1}]].forEach((function(t){var e=i(t);t=e.next().value,e=e.next().value,ue.set(t,e)}));var pe={get firstElementChild(){var t=l(this);if(t&&void 0!==t.firstChild){for(t=this.__shady_firstChild;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__shady_nextSibling;return t}return this.__shady_native_firstElementChild},get lastElementChild(){var t=l(this);if(t&&void 0!==t.lastChild){for(t=this.__shady_lastChild;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__shady_previousSibling;return t}return this.__shady_native_lastElementChild},get children(){return p(this)?P(Array.prototype.filter.call(C(this),(function(t){return t.nodeType===Node.ELEMENT_NODE}))):this.__shady_native_children},get childElementCount(){var t=this.__shady_children;return t?t.length:0}},ge=k((pe.append=function(t){for(var e=[],n=0;n<arguments.length;++n)e[n]=arguments[n];this.__shady_insertBefore(R.apply(null,r(e)),null)},pe.prepend=function(t){for(var e=[],n=0;n<arguments.length;++n)e[n]=arguments[n];this.__shady_insertBefore(R.apply(null,r(e)),this.__shady_firstChild)},pe.replaceChildren=function(t){for(var e=[],n=0;n<arguments.length;++n)e[n]=arguments[n];for(;null!==(n=this.__shady_firstChild);)this.__shady_removeChild(n);this.__shady_insertBefore(R.apply(null,r(e)),null)},pe));function me(t,e){function n(e,n){return(e===t||-1===n.indexOf(":scope"))&&y.call(e,n)}var r=function(t){function e(){if(0<i.length){for(;" "===i[i.length-1];)i.pop();n.push({S:i.filter((function(t,e){return 0==e%2})),ca:i.filter((function(t,e){return 1==e%2}))}),i.length=0}}for(var n=[],i=[],r=0;r<t.length;){var o=i[i.length-1],s=he(t,r,[","," ",">","+","~"]),a=s===r?t[r]:t.substring(r,s);","===a?e():-1!==[void 0," ",">","+","~"].indexOf(o)&&" "===a||(" "===o&&-1!==[">","+","~"].indexOf(a)?i[i.length-1]=a:i.push(a)),r=s+(s===r?1:0)}return e(),n}(e);if(1>r.length)return[];for(e=N(de(t,(function(){return!0})).map((function(t){return N(r.map((function(e){var i=e.S,r=i.length-1;return n(t,i[r])?{target:t,v:e,A:t,index:r}:[]})))})));e.some((function(t){return 0<t.index}));)e=N(e.map((function(t){if(0>=t.index)return t;var e=t.target,i=t.A,r=t.v;t=t.index-1;var o=r.ca[t],s=r.S[t];if(" "===o){for(o=[],i=i.__shady_parentElement;i;i=i.__shady_parentElement)n(i,s)&&o.push({target:e,v:r,A:i,index:t});return o}if(">"===o)return n(i=i.__shady_parentElement,s)?{target:e,v:r,A:i,index:t}:[];if("+"===o)return(i=i.__shady_previousElementSibling)&&n(i,s)?{target:e,v:r,A:i,index:t}:[];if("~"===o){for(o=[],i=i.__shady_previousElementSibling;i;i=i.__shady_previousElementSibling)n(i,s)&&o.push({target:e,v:r,A:i,index:t});return o}throw Error("Unrecognized combinator: '"+o+"'.")})));return function(t){for(var e=[],n=new Set,r=(t=i(t)).next();!r.done;r=t.next())r=r.value,n.has(r)||(e.push(r),n.add(r));return e}(e.map((function(t){return t.target})))}var ve=c.querySelectorImplementation,ye=k({querySelector:function(t){if("native"===ve){for(var e=Array.prototype.slice.call((this instanceof ShadowRoot?this.host:this).__shady_native_querySelectorAll(t)),n=this.__shady_getRootNode(),r=(e=i(e)).next();!r.done;r=e.next())if((r=r.value).__shady_getRootNode()==n)return r;return null}if("selectorEngine"===ve)return me(this,t)[0]||null;if(void 0===ve)return de(this,(function(e){return y.call(e,t)}),(function(t){return!!t}))[0]||null;throw Error("Unrecognized value of ShadyDOM.querySelectorImplementation: '"+ve+"'")},querySelectorAll:function(t,e){if(e||"native"===ve){e=Array.prototype.slice.call((this instanceof ShadowRoot?this.host:this).__shady_native_querySelectorAll(t));var n=this.__shady_getRootNode();return P(e.filter((function(t){return t.__shady_getRootNode()==n})))}if("selectorEngine"===ve)return P(me(this,t));if(void 0===ve)return P(de(this,(function(e){return y.call(e,t)})));throw Error("Unrecognized value of ShadyDOM.querySelectorImplementation: '"+ve+"'")}}),_e=c.C&&!c.l?O({},ge):ge;O(ge,ye);var be=k({after:function(t){for(var e=[],n=0;n<arguments.length;++n)e[n]=arguments[n];if(null!==(n=this.__shady_parentNode)){var i=this.__shady_nextSibling;n.__shady_insertBefore(R.apply(null,r(e)),i)}},before:function(t){for(var e=[],n=0;n<arguments.length;++n)e[n]=arguments[n];null!==(n=this.__shady_parentNode)&&n.__shady_insertBefore(R.apply(null,r(e)),this)},remove:function(){var t=this.__shady_parentNode;null!==t&&t.__shady_removeChild(this)},replaceWith:function(t){for(var e=[],n=0;n<arguments.length;++n)e[n]=arguments[n];if(null!==(n=this.__shady_parentNode)){var i=this.__shady_nextSibling;n.__shady_removeChild(this),n.__shady_insertBefore(R.apply(null,r(e)),i)}}}),we=window.document;function xe(t,e){if("slot"===e)m(t=t.__shady_parentNode)&&en(l(t).root);else if("slot"===t.localName&&"name"===e&&(e=gn(t))){if(e.g){ln(e);var n=t.Y,i=cn(t);if(i!==n){var r=(n=e.h[n]).indexOf(t);0<=r&&n.splice(r,1),(n=e.h[i]||(e.h[i]=[])).push(t),1<n.length&&(e.h[i]=un(n))}}en(e)}}var Ee=k({get previousElementSibling(){var t=l(this);if(t&&void 0!==t.previousSibling){for(t=this.__shady_previousSibling;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__shady_previousSibling;return t}return this.__shady_native_previousElementSibling},get nextElementSibling(){var t=l(this);if(t&&void 0!==t.nextSibling){for(t=this.__shady_nextSibling;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__shady_nextSibling;return t}return this.__shady_native_nextElementSibling},get slot(){return this.getAttribute("slot")},set slot(t){this.__shady_setAttribute("slot",t)},get className(){return this.getAttribute("class")||""},set className(t){this.__shady_setAttribute("class",t)},setAttribute:function(t,e){this.ownerDocument!==we?this.__shady_native_setAttribute(t,e):Yt(this,t,e)||(this.__shady_native_setAttribute(t,e),xe(this,t))},removeAttribute:function(t){this.ownerDocument!==we?this.__shady_native_removeAttribute(t):Yt(this,t,"")?""===this.getAttribute(t)&&this.__shady_native_removeAttribute(t):(this.__shady_native_removeAttribute(t),xe(this,t))},toggleAttribute:function(t,e){return this.ownerDocument!==we?this.__shady_native_toggleAttribute(t,e):Yt(this,t,"")?""!==this.getAttribute(t)||e?void 0:this.__shady_native_toggleAttribute(t,e):(e=this.__shady_native_toggleAttribute(t,e),xe(this,t),e)}});c.C||Bt.forEach((function(t){Ee[t]=Vt(t)}));var Se=k({attachShadow:function(t){if(!this)throw Error("Must provide a host.");if(!t)throw Error("Not enough arguments.");if(t.shadyUpgradeFragment&&!c.V){var e=t.shadyUpgradeFragment;if(e.__proto__=ShadowRoot.prototype,tn(e,this,t),qe(e,e),t=e.__noInsertionPoint?null:e.querySelectorAll("slot"),e.__noInsertionPoint=void 0,t&&t.length){var n=e;an(n),n.j.push.apply(n.j,r(t)),en(e)}e.host.__shady_native_appendChild(e)}else e=new Je(Ke,this,t);return this.__CE_shadowRoot=e},get shadowRoot(){var t=l(this);return t&&t.ea||null}});O(Ee,Se);var Pe=document.implementation.createHTMLDocument("inert"),Te=k({get innerHTML(){return p(this)?X("template"===this.localName?this.content:this,C):this.__shady_native_innerHTML},set innerHTML(t){if("template"===this.localName)this.__shady_native_innerHTML=t;else{re(this);var e=this.localName||"div";for(e=this.namespaceURI&&this.namespaceURI!==Pe.namespaceURI?Pe.createElementNS(this.namespaceURI,e):Pe.createElement(e),c.i?e.__shady_native_innerHTML=t:e.innerHTML=t;t=e.__shady_firstChild;)this.__shady_insertBefore(t)}}}),Ce=k({blur:function(){var t=l(this);(t=(t=t&&t.root)&&t.activeElement)?t.__shady_blur():this.__shady_native_blur()}});c.C||Ut.forEach((function(t){Ce[t]=Vt(t)}));var Ae=k({assignedNodes:function(t){if("slot"===this.localName){var e=this.__shady_getRootNode();return e&&g(e)&&nn(e),(e=l(this))&&(t&&t.flatten?e.u:e.assignedNodes)||[]}},addEventListener:function(t,e,n){if("slot"!==this.localName||"slotchange"===t)It.call(this,t,e,n);else{"object"!=typeof n&&(n={capture:!!n});var i=this.__shady_parentNode;if(!i)throw Error("ShadyDOM cannot attach event to slot unless it has a `parentNode`");n.o=this,i.__shady_addEventListener(t,e,n)}},removeEventListener:function(t,e,n){if("slot"!==this.localName||"slotchange"===t)Rt.call(this,t,e,n);else{"object"!=typeof n&&(n={capture:!!n});var i=this.__shady_parentNode;if(!i)throw Error("ShadyDOM cannot attach event to slot unless it has a `parentNode`");n.o=this,i.__shady_removeEventListener(t,e,n)}}}),Me=k({getElementById:function(t){return""===t?null:de(this,(function(e){return e.id==t}),(function(t){return!!t}))[0]||null}});function Le(t,e){for(var n;e&&!t.has(n=e.__shady_getRootNode());)e=n.host;return e}var ke="__shady_native_"+f(),Oe=k({get activeElement(){var t=c.i?document.__shady_native_activeElement:document.activeElement;if(!t||!t.nodeType)return null;var e=!!g(this);if(!(this===document||e&&this.host!==t&&this.host.__shady_native_contains(t)))return null;for(e=gn(t);e&&e!==this;)e=gn(t=e.host);return this===document?e?null:t:e===this?t:null},elementsFromPoint:function(t,e){if(t=document[ke](t,e),this===document&&c.useNativeDocumentEFP)return t;t=[].slice.call(t),e=function(t){var e=new Set;for(e.add(t);g(t)&&t.host;)t=t.host.__shady_getRootNode(),e.add(t);return e}(this);for(var n=new Set,i=0;i<t.length;i++)n.add(Le(e,t[i]));var r=[];return n.forEach((function(t){return r.push(t)})),r},elementFromPoint:function(t,e){return this===document&&c.useNativeDocumentEFP?this.__shady_native_elementFromPoint(t,e):this.__shady_elementsFromPoint(t,e)[0]||null}}),Ie=window.document,Re=k({importNode:function(t,e){if(t.ownerDocument!==Ie||"template"===t.localName)return this.__shady_native_importNode(t,e);var n=this.__shady_native_importNode(t,!1);if(e)for(t=t.__shady_firstChild;t;t=t.__shady_nextSibling)e=this.__shady_importNode(t,!0),n.__shady_appendChild(e);return n}}),Ne=k({dispatchEvent:Ot,addEventListener:It.bind(window),removeEventListener:Rt.bind(window)}),ze={};Object.getOwnPropertyDescriptor(HTMLElement.prototype,"parentElement")&&(ze.parentElement=le.parentElement),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"contains")&&(ze.contains=le.contains),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"children")&&(ze.children=ge.children),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"innerHTML")&&(ze.innerHTML=Te.innerHTML),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"className")&&(ze.className=Ee.className);var Fe={EventTarget:[qt],Node:[le,window.EventTarget?null:qt],Text:[ce],Comment:[ce],CDATASection:[ce],ProcessingInstruction:[ce],Element:[Ee,ge,be,ce,!c.i||"innerHTML"in Element.prototype?Te:null,window.HTMLSlotElement?null:Ae],HTMLElement:[Ce,ze],HTMLSlotElement:[Ae],DocumentFragment:[_e,Me],Document:[Re,_e,Me,Oe],Window:[Ne],CharacterData:[be],XMLHttpRequest:[window.EventTarget?null:qt]},De=c.i?null:["innerHTML","textContent"];function je(t,e,n,i){e.forEach((function(e){return t&&e&&M(t,e,n,i)}))}function Be(t){var e,n=t?null:De;for(e in Fe)je(window[e]&&window[e].prototype,Fe[e],t,n)}function Ue(t){return t.__shady_protoIsPatched=!0,je(t,Fe.EventTarget),je(t,Fe.Node),je(t,Fe.Element),je(t,Fe.HTMLElement),je(t,Fe.HTMLSlotElement),t}["Text","Comment","CDATASection","ProcessingInstruction"].forEach((function(t){var e=window[t],n=Object.create(e.prototype);n.__shady_protoIsPatched=!0,je(n,Fe.EventTarget),je(n,Fe.Node),Fe[t]&&je(n,Fe[t]),e.prototype.__shady_patchedProto=n}));var Ve=c.O,We=c.i;function Ge(t,e){if(Ve&&!t.__shady_protoIsPatched&&!g(t)){var n=Object.getPrototypeOf(t),i=n.hasOwnProperty("__shady_patchedProto")&&n.__shady_patchedProto;i||(Ue(i=Object.create(n)),n.__shady_patchedProto=i),Object.setPrototypeOf(t,i)}We||(1===e?dt(t):2===e&&ft(t))}function He(t,e,n,i){Ge(t,1),i=i||null;var r=a(t),o=i?a(i):null;r.previousSibling=i?o.previousSibling:e.__shady_lastChild,(o=l(r.previousSibling))&&(o.nextSibling=t),(o=l(r.nextSibling=i))&&(o.previousSibling=t),r.parentNode=e,i?i===n.firstChild&&(n.firstChild=t):(n.lastChild=t,n.firstChild||(n.firstChild=t)),n.childNodes=null}function qe(t,e){var n=a(t);if(e||void 0===n.firstChild){n.childNodes=null;var i=n.firstChild=t.__shady_native_firstChild;for(n.lastChild=t.__shady_native_lastChild,Ge(t,2),n=i,i=void 0;n;n=n.__shady_native_nextSibling){var r=a(n);r.parentNode=e||t,r.nextSibling=n.__shady_native_nextSibling,r.previousSibling=i||null,i=n,Ge(n,1)}}}var Xe=k({addEventListener:function(t,e,n){"object"!=typeof n&&(n={capture:!!n}),n.o=n.o||this,this.host.__shady_addEventListener(t,e,n)},removeEventListener:function(t,e,n){"object"!=typeof n&&(n={capture:!!n}),n.o=n.o||this,this.host.__shady_removeEventListener(t,e,n)}});function Ze(t,e){M(t,Xe,e),M(t,Oe,e),M(t,Te,e),M(t,ge,e),c.l&&!e?(M(t,le,e),M(t,Me,e)):c.i||(M(t,lt),M(t,st),M(t,at))}var Ye,Ke={},Qe=c.deferConnectionCallbacks&&"loading"===document.readyState;function $e(t){var e=[];do{e.unshift(t)}while(t=t.__shady_parentNode);return e}function Je(t,e,n){if(t!==Ke)throw new TypeError("Illegal constructor");this.g=null,tn(this,e,n)}function tn(t,e,n){if(t.host=e,t.mode=n&&n.mode,qe(t.host),(e=a(t.host)).root=t,e.ea="closed"!==t.mode?t:null,(e=a(t)).firstChild=e.lastChild=e.parentNode=e.nextSibling=e.previousSibling=null,c.preferPerformance)for(;e=t.host.__shady_native_firstChild;)t.host.__shady_native_removeChild(e);else en(t)}function en(t){t.s||(t.s=!0,D((function(){return nn(t)})))}function nn(t){var e;if(e=t.s){for(var n;t;)t.s&&(n=t),g(t=(e=t).host.__shady_getRootNode())&&(e=l(e.host))&&0<e.F||(t=void 0);e=n}(n=e)&&n._renderSelf()}function rn(t,e,n){var i=a(e),r=i.L;i.L=null,n||(n=(t=t.h[e.__shady_slot||"__catchall"])&&t[0]),n?(a(n).assignedNodes.push(e),i.assignedSlot=n):i.assignedSlot=void 0,r!==i.assignedSlot&&i.assignedSlot&&(a(i.assignedSlot).M=!0)}function on(t,e,n){for(var i=0,r=void 0;i<n.length&&(r=n[i]);i++)if("slot"==r.localName){var o=l(r).assignedNodes;o&&o.length&&on(t,e,o)}else e.push(n[i])}function sn(t,e){e.__shady_native_dispatchEvent(new Event("slotchange")),(e=l(e)).assignedSlot&&sn(t,e.assignedSlot)}function an(t){t.j=t.j||[],t.g=t.g||[],t.h=t.h||{}}function ln(t){if(t.j&&t.j.length){for(var e,n=t.j,i=0;i<n.length;i++){var r=n[i];qe(r);var o=r.__shady_parentNode;qe(o),(o=l(o)).F=(o.F||0)+1,o=cn(r),t.h[o]?((e=e||{})[o]=!0,t.h[o].push(r)):t.h[o]=[r],t.g.push(r)}if(e)for(var s in e)t.h[s]=un(t.h[s]);t.j=[]}}function cn(t){var e=t.name||t.getAttribute("name")||"__catchall";return t.Y=e}function un(t){return t.sort((function(t,e){t=$e(t);for(var n=$e(e),i=0;i<t.length;i++){e=t[i];var r=n[i];if(e!==r)return(t=C(e.__shady_parentNode)).indexOf(e)-t.indexOf(r)}}))}function hn(t){return ln(t),!(!t.g||!t.g.length)}if(Je.prototype._renderSelf=function(){var t=Qe;if(Qe=!0,this.s=!1,this.g){ln(this);for(var e,n=0;n<this.g.length;n++){var i=l(e=this.g[n]),r=i.assignedNodes;if(i.assignedNodes=[],i.u=[],i.R=r)for(i=0;i<r.length;i++){var o=l(r[i]);o.L=o.assignedSlot,o.assignedSlot===e&&(o.assignedSlot=null)}}for(n=this.host.__shady_firstChild;n;n=n.__shady_nextSibling)rn(this,n);for(n=0;n<this.g.length;n++){if(!(r=l(e=this.g[n])).assignedNodes.length)for(i=e.__shady_firstChild;i;i=i.__shady_nextSibling)rn(this,i,e);if((i=(i=l(e.__shady_parentNode))&&i.root)&&(hn(i)||i.s)&&i._renderSelf(),on(this,r.u,r.assignedNodes),i=r.R){for(o=0;o<i.length;o++)l(i[o]).L=null;r.R=null,i.length>r.assignedNodes.length&&(r.M=!0)}r.M&&(r.M=!1,sn(this,e))}for(e=this.g,n=[],r=0;r<e.length;r++)(o=l(i=e[r].__shady_parentNode))&&o.root||!(0>n.indexOf(i))||n.push(i);for(e=0;e<n.length;e++){for(r=(o=n[e])===this?this.host:o,i=[],o=o.__shady_firstChild;o;o=o.__shady_nextSibling)if("slot"==o.localName)for(var s=l(o).u,a=0;a<s.length;a++)i.push(s[a]);else i.push(o);o=T(r),s=Gt(i,i.length,o,o.length);for(var u=a=0,h=void 0;a<s.length&&(h=s[a]);a++){for(var d=0,f=void 0;d<h.D.length&&(f=h.D[d]);d++)f.__shady_native_parentNode===r&&r.__shady_native_removeChild(f),o.splice(h.index+u,1);u-=h.G}for(u=0,h=void 0;u<s.length&&(h=s[u]);u++)for(a=o[h.index],d=h.index;d<h.index+h.G;d++)f=i[d],r.__shady_native_insertBefore(f,a),o.splice(d,0,f)}}if(!c.preferPerformance&&!this.P)for(n=this.host.__shady_firstChild;n;n=n.__shady_nextSibling)e=l(n),n.__shady_native_parentNode!==this.host||"slot"!==n.localName&&e.assignedSlot||this.host.__shady_native_removeChild(n);this.P=!0,Qe=t,Ye&&Ye()},function(t){t.__proto__=DocumentFragment.prototype,Ze(t,"__shady_"),Ze(t),Object.defineProperties(t,{nodeType:{value:Node.DOCUMENT_FRAGMENT_NODE,configurable:!0},nodeName:{value:"#document-fragment",configurable:!0},nodeValue:{value:null,configurable:!0}}),["localName","namespaceURI","prefix"].forEach((function(e){Object.defineProperty(t,e,{value:void 0,configurable:!0})})),["ownerDocument","baseURI","isConnected"].forEach((function(e){Object.defineProperty(t,e,{get:function(){return this.host[e]},configurable:!0})}))}(Je.prototype),window.customElements&&window.customElements.define&&c.N&&!c.preferPerformance){var dn=new Map;Ye=function(){var t=[];dn.forEach((function(e,n){t.push([n,e])})),dn.clear();for(var e=0;e<t.length;e++){var n=t[e][0];t[e][1]?n.__shadydom_connectedCallback():n.__shadydom_disconnectedCallback()}},Qe&&document.addEventListener("readystatechange",(function(){Qe=!1,Ye()}),{once:!0});var fn=window.customElements.define,pn=function(t,e){var n=e.prototype.connectedCallback,i=e.prototype.disconnectedCallback;fn.call(window.customElements,t,function(t,e,n){var i=0,r="__isConnected"+i++;return(e||n)&&(t.prototype.connectedCallback=t.prototype.__shadydom_connectedCallback=function(){Qe?dn.set(this,!0):this[r]||(this[r]=!0,e&&e.call(this))},t.prototype.disconnectedCallback=t.prototype.__shadydom_disconnectedCallback=function(){Qe?this.isConnected||dn.set(this,!1):this[r]&&(this[r]=!1,n&&n.call(this))}),t}(e,n,i)),e.prototype.connectedCallback=n,e.prototype.disconnectedCallback=i};window.customElements.define=pn,Object.defineProperty(window.CustomElementRegistry.prototype,"define",{value:pn,configurable:!0})}function gn(t){if(g(t=t.__shady_getRootNode()))return t}function mn(t){this.node=t}function vn(t){Object.defineProperty(mn.prototype,t,{get:function(){return this.node["__shady_"+t]},set:function(e){this.node["__shady_"+t]=e},configurable:!0})}(t=mn.prototype).addEventListener=function(t,e,n){return this.node.__shady_addEventListener(t,e,n)},t.removeEventListener=function(t,e,n){return this.node.__shady_removeEventListener(t,e,n)},t.appendChild=function(t){return this.node.__shady_appendChild(t)},t.insertBefore=function(t,e){return this.node.__shady_insertBefore(t,e)},t.removeChild=function(t){return this.node.__shady_removeChild(t)},t.replaceChild=function(t,e){return this.node.__shady_replaceChild(t,e)},t.cloneNode=function(t){return this.node.__shady_cloneNode(t)},t.getRootNode=function(t){return this.node.__shady_getRootNode(t)},t.contains=function(t){return this.node.__shady_contains(t)},t.dispatchEvent=function(t){return this.node.__shady_dispatchEvent(t)},t.setAttribute=function(t,e){this.node.__shady_setAttribute(t,e)},t.getAttribute=function(t){return this.node.__shady_native_getAttribute(t)},t.removeAttribute=function(t){this.node.__shady_removeAttribute(t)},t.toggleAttribute=function(t,e){return this.node.__shady_toggleAttribute(t,e)},t.attachShadow=function(t){return this.node.__shady_attachShadow(t)},t.focus=function(){this.node.__shady_native_focus()},t.blur=function(){this.node.__shady_blur()},t.importNode=function(t,e){if(this.node.nodeType===Node.DOCUMENT_NODE)return this.node.__shady_importNode(t,e)},t.getElementById=function(t){if(this.node.nodeType===Node.DOCUMENT_NODE)return this.node.__shady_getElementById(t)},t.elementsFromPoint=function(t,e){return this.node.__shady_elementsFromPoint(t,e)},t.elementFromPoint=function(t,e){return this.node.__shady_elementFromPoint(t,e)},t.querySelector=function(t){return this.node.__shady_querySelector(t)},t.querySelectorAll=function(t,e){return this.node.__shady_querySelectorAll(t,e)},t.assignedNodes=function(t){if("slot"===this.node.localName)return this.node.__shady_assignedNodes(t)},t.append=function(t){for(var e=[],n=0;n<arguments.length;++n)e[n]=arguments[n];return this.node.__shady_append.apply(this.node,r(e))},t.prepend=function(t){for(var e=[],n=0;n<arguments.length;++n)e[n]=arguments[n];return this.node.__shady_prepend.apply(this.node,r(e))},t.after=function(t){for(var e=[],n=0;n<arguments.length;++n)e[n]=arguments[n];return this.node.__shady_after.apply(this.node,r(e))},t.before=function(t){for(var e=[],n=0;n<arguments.length;++n)e[n]=arguments[n];return this.node.__shady_before.apply(this.node,r(e))},t.remove=function(){return this.node.__shady_remove()},t.replaceWith=function(t){for(var e=[],n=0;n<arguments.length;++n)e[n]=arguments[n];return this.node.__shady_replaceWith.apply(this.node,r(e))},o.Object.defineProperties(mn.prototype,{activeElement:{configurable:!0,enumerable:!0,get:function(){if(g(this.node)||this.node.nodeType===Node.DOCUMENT_NODE)return this.node.__shady_activeElement}},_activeElement:{configurable:!0,enumerable:!0,get:function(){return this.activeElement}},host:{configurable:!0,enumerable:!0,get:function(){if(g(this.node))return this.node.host}},parentNode:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_parentNode}},firstChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_firstChild}},lastChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_lastChild}},nextSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_nextSibling}},previousSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_previousSibling}},childNodes:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_childNodes}},parentElement:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_parentElement}},firstElementChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_firstElementChild}},lastElementChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_lastElementChild}},nextElementSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_nextElementSibling}},previousElementSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_previousElementSibling}},children:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_children}},childElementCount:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_childElementCount}},shadowRoot:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_shadowRoot}},assignedSlot:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_assignedSlot}},isConnected:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_isConnected}},innerHTML:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_innerHTML},set:function(t){this.node.__shady_innerHTML=t}},textContent:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_textContent},set:function(t){this.node.__shady_textContent=t}},slot:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_slot},set:function(t){this.node.__shady_slot=t}},className:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_className},set:function(t){this.node.__shady_className=t}}}),Bt.forEach((function(t){return vn(t)})),Ut.forEach((function(t){return vn(t)}));var yn=new WeakMap;function _n(t){if(g(t)||t instanceof mn)return t;var e=yn.get(t);return e||(e=new mn(t),yn.set(t,e)),e}if(c.N){var bn=c.i?function(t){return t}:function(t){return ft(t),dt(t),t};window.ShadyDOM={inUse:c.N,patch:bn,isShadyRoot:g,enqueue:D,flush:j,flushInitial:function(t){!t.P&&t.s&&nn(t)},settings:c,filterMutations:function(t,e){var n=e.getRootNode();return t.map((function(t){var e=n===t.target.getRootNode();if(e&&t.addedNodes){if((e=[].slice.call(t.addedNodes).filter((function(t){return n===t.getRootNode()}))).length)return t=Object.create(t),Object.defineProperty(t,"addedNodes",{value:e,configurable:!0}),t}else if(e)return t})).filter((function(t){return t}))},observeChildren:function(t,e){var n=a(t);n.B||(n.B=new B),n.B.H.add(e);var i=n.B;return{Z:e,ba:i,aa:t,takeRecords:function(){return i.takeRecords()}}},unobserveChildren:function(t){var e=t&&t.ba;e&&(e.H.delete(t.Z),e.H.size||(a(t.aa).B=null))},deferConnectionCallbacks:c.deferConnectionCallbacks,preferPerformance:c.preferPerformance,handlesDynamicScoping:!0,wrap:c.l?_n:bn,wrapIfNeeded:!0===c.l?_n:function(t){return t},Wrapper:mn,composedPath:function(t){return t.__composedPath||(t.__composedPath=wt(t.target,!0)),t.__composedPath},noPatch:c.l,patchOnDemand:c.O,nativeMethods:Y,nativeTree:K,patchElementProto:Ue,querySelectorImplementation:c.querySelectorImplementation},function(){var t=["dispatchEvent","addEventListener","removeEventListener"];window.EventTarget?(J(window.EventTarget.prototype,t),void 0===window.__shady_native_addEventListener&&J(Window.prototype,t)):(J(Node.prototype,t),J(Window.prototype,t),J(XMLHttpRequest.prototype,t)),Z?J(Node.prototype,"parentNode firstChild lastChild previousSibling nextSibling childNodes parentElement textContent".split(" ")):$(Node.prototype,{parentNode:{get:function(){return tt.currentNode=this,tt.parentNode()}},firstChild:{get:function(){return tt.currentNode=this,tt.firstChild()}},lastChild:{get:function(){return tt.currentNode=this,tt.lastChild()}},previousSibling:{get:function(){return tt.currentNode=this,tt.previousSibling()}},nextSibling:{get:function(){return tt.currentNode=this,tt.nextSibling()}},childNodes:{get:function(){var t=[];tt.currentNode=this;for(var e=tt.firstChild();e;)t.push(e),e=tt.nextSibling();return t}},parentElement:{get:function(){return et.currentNode=this,et.parentNode()}},textContent:{get:function(){switch(this.nodeType){case Node.ELEMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:for(var t,e=document.createTreeWalker(this,NodeFilter.SHOW_TEXT,null,!1),n="";t=e.nextNode();)n+=t.nodeValue;return n;default:return this.nodeValue}},set:function(t){switch(null==t&&(t=""),this.nodeType){case Node.ELEMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:it(this),(0<t.length||this.nodeType===Node.ELEMENT_NODE)&&this.__shady_native_insertBefore(document.createTextNode(t),void 0);break;default:this.nodeValue=t}}}}),J(Node.prototype,"appendChild insertBefore removeChild replaceChild cloneNode contains".split(" ")),J(HTMLElement.prototype,["parentElement","contains"]),t={firstElementChild:{get:function(){return et.currentNode=this,et.firstChild()}},lastElementChild:{get:function(){return et.currentNode=this,et.lastChild()}},children:{get:function(){var t=[];et.currentNode=this;for(var e=et.firstChild();e;)t.push(e),e=et.nextSibling();return P(t)}},childElementCount:{get:function(){return this.children?this.children.length:0}}},Z?(J(Element.prototype,rt),J(Element.prototype,["previousElementSibling","nextElementSibling","innerHTML","className"]),J(HTMLElement.prototype,["children","innerHTML","className"])):($(Element.prototype,t),$(Element.prototype,{previousElementSibling:{get:function(){return et.currentNode=this,et.previousSibling()}},nextElementSibling:{get:function(){return et.currentNode=this,et.nextSibling()}},innerHTML:{get:function(){return X(this,T)},set:function(t){var e="template"===this.localName?this.content:this;it(e);var n=this.localName||"div";for((n=this.namespaceURI&&this.namespaceURI!==nt.namespaceURI?nt.createElementNS(this.namespaceURI,n):nt.createElement(n)).innerHTML=t,t="template"===this.localName?n.content:n;n=t.__shady_native_firstChild;)e.__shady_native_insertBefore(n,void 0)}},className:{get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)}}})),J(Element.prototype,"setAttribute getAttribute hasAttribute removeAttribute toggleAttribute focus blur".split(" ")),J(Element.prototype,ot),J(HTMLElement.prototype,["focus","blur"]),window.HTMLTemplateElement&&J(window.HTMLTemplateElement.prototype,["innerHTML"]),Z?J(DocumentFragment.prototype,rt):$(DocumentFragment.prototype,t),J(DocumentFragment.prototype,ot),Z?(J(Document.prototype,rt),J(Document.prototype,["activeElement"])):$(Document.prototype,t),J(Document.prototype,["importNode","getElementById","elementFromPoint",f()]),J(Document.prototype,ot)}(),Be("__shady_"),Object.defineProperty(document,"_activeElement",Oe.activeElement),M(Window.prototype,Ne,"__shady_"),c.l?c.O&&M(Element.prototype,Se):(Be(),function(){if(!gt&&Object.getOwnPropertyDescriptor(Event.prototype,"isTrusted")){var t=function(){var t=new MouseEvent("click",{bubbles:!0,cancelable:!0,composed:!0});this.__shady_dispatchEvent(t)};Element.prototype.click?Element.prototype.click=t:HTMLElement.prototype.click&&(HTMLElement.prototype.click=t)}}()),function(){for(var t in Tt)window.__shady_native_addEventListener(t,(function(t){t.__target||(zt(t),Lt(t))}),!0)}(),window.Event=Ft,window.CustomEvent=Dt,window.MouseEvent=jt,window.ShadowRoot=Je}}).call(this)},187:t=>{"use strict";function e(t,e,i){i=i||2;var o,s,a,l,h,d,p,g=e&&e.length,m=g?e[0]*i:t.length,v=n(t,0,m,i,!0),y=[];if(!v||v.next===v.prev)return y;if(g&&(v=function(t,e,i,r){var o,s,a,l=[];for(o=0,s=e.length;o<s;o++)(a=n(t,e[o]*r,o<s-1?e[o+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),l.push(f(a));for(l.sort(c),o=0;o<l.length;o++)i=u(l[o],i);return i}(t,e,v,i)),t.length>80*i){o=a=t[0],s=l=t[1];for(var _=i;_<m;_+=i)(h=t[_])<o&&(o=h),(d=t[_+1])<s&&(s=d),h>a&&(a=h),d>l&&(l=d);p=0!==(p=Math.max(a-o,l-s))?32767/p:0}return r(v,y,i,o,s,p,0),y}function n(t,e,n,i,r){var o,s;if(r===T(t,e,n,i)>0)for(o=e;o<n;o+=i)s=E(o,t[o],t[o+1],s);else for(o=n-i;o>=e;o-=i)s=E(o,t[o],t[o+1],s);return s&&v(s,s.next)&&(S(s),s=s.next),s}function i(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!v(i,i.next)&&0!==m(i.prev,i,i.next))i=i.next;else{if(S(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function r(t,e,n,c,u,h,f){if(t){!f&&h&&function(t,e,n,i){var r=t;do{0===r.z&&(r.z=d(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,s,a,l,c=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,i=n,a=0,e=0;e<c&&(a++,i=i.nextZ);e++);for(l=c;a>0||l>0&&i;)0!==a&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,c*=2}while(s>1)}(r)}(t,c,u,h);for(var p,g,m=t;t.prev!==t.next;)if(p=t.prev,g=t.next,h?s(t,c,u,h):o(t))e.push(p.i/n|0),e.push(t.i/n|0),e.push(g.i/n|0),S(t),t=g.next,m=g.next;else if((t=g)===m){f?1===f?r(t=a(i(t),e,n),e,n,c,u,h,2):2===f&&l(t,e,n,c,u,h):r(i(t),e,n,c,u,h,1);break}}}function o(t){var e=t.prev,n=t,i=t.next;if(m(e,n,i)>=0)return!1;for(var r=e.x,o=n.x,s=i.x,a=e.y,l=n.y,c=i.y,u=r<o?r<s?r:s:o<s?o:s,h=a<l?a<c?a:c:l<c?l:c,d=r>o?r>s?r:s:o>s?o:s,f=a>l?a>c?a:c:l>c?l:c,g=i.next;g!==e;){if(g.x>=u&&g.x<=d&&g.y>=h&&g.y<=f&&p(r,a,o,l,s,c,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function s(t,e,n,i){var r=t.prev,o=t,s=t.next;if(m(r,o,s)>=0)return!1;for(var a=r.x,l=o.x,c=s.x,u=r.y,h=o.y,f=s.y,g=a<l?a<c?a:c:l<c?l:c,v=u<h?u<f?u:f:h<f?h:f,y=a>l?a>c?a:c:l>c?l:c,_=u>h?u>f?u:f:h>f?h:f,b=d(g,v,e,n,i),w=d(y,_,e,n,i),x=t.prevZ,E=t.nextZ;x&&x.z>=b&&E&&E.z<=w;){if(x.x>=g&&x.x<=y&&x.y>=v&&x.y<=_&&x!==r&&x!==s&&p(a,u,l,h,c,f,x.x,x.y)&&m(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,E.x>=g&&E.x<=y&&E.y>=v&&E.y<=_&&E!==r&&E!==s&&p(a,u,l,h,c,f,E.x,E.y)&&m(E.prev,E,E.next)>=0)return!1;E=E.nextZ}for(;x&&x.z>=b;){if(x.x>=g&&x.x<=y&&x.y>=v&&x.y<=_&&x!==r&&x!==s&&p(a,u,l,h,c,f,x.x,x.y)&&m(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;E&&E.z<=w;){if(E.x>=g&&E.x<=y&&E.y>=v&&E.y<=_&&E!==r&&E!==s&&p(a,u,l,h,c,f,E.x,E.y)&&m(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function a(t,e,n){var r=t;do{var o=r.prev,s=r.next.next;!v(o,s)&&y(o,r,r.next,s)&&w(o,s)&&w(s,o)&&(e.push(o.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),S(r),S(r.next),r=t=s),r=r.next}while(r!==t);return i(r)}function l(t,e,n,o,s,a){var l=t;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&g(l,c)){var u=x(l,c);return l=i(l,l.next),u=i(u,u.next),r(l,e,n,o,s,a,0),void r(u,e,n,o,s,a,0)}c=c.next}l=l.next}while(l!==t)}function c(t,e){return t.x-e.x}function u(t,e){var n=function(t,e){var n,i=e,r=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>s&&(s=a,n=i.x<i.next.x?i:i.next,a===r))return n}i=i.next}while(i!==e);if(!n)return null;var l,c=n,u=n.x,d=n.y,f=1/0;i=n;do{r>=i.x&&i.x>=u&&r!==i.x&&p(o<d?r:s,o,u,d,o<d?s:r,o,i.x,i.y)&&(l=Math.abs(o-i.y)/(r-i.x),w(i,t)&&(l<f||l===f&&(i.x>n.x||i.x===n.x&&h(n,i)))&&(n=i,f=l)),i=i.next}while(i!==c);return n}(t,e);if(!n)return e;var r=x(n,t);return i(r,r.next),i(n,n.next)}function h(t,e){return m(t.prev,t,e.prev)<0&&m(e.next,t,t.next)<0}function d(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function f(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function p(t,e,n,i,r,o,s,a){return(r-s)*(e-a)>=(t-s)*(o-a)&&(t-s)*(i-a)>=(n-s)*(e-a)&&(n-s)*(o-a)>=(r-s)*(i-a)}function g(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&y(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(w(t,e)&&w(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(m(t.prev,t,e.prev)||m(t,e.prev,e))||v(t,e)&&m(t.prev,t,t.next)>0&&m(e.prev,e,e.next)>0)}function m(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function v(t,e){return t.x===e.x&&t.y===e.y}function y(t,e,n,i){var r=b(m(t,e,n)),o=b(m(t,e,i)),s=b(m(n,i,t)),a=b(m(n,i,e));return r!==o&&s!==a||!(0!==r||!_(t,n,e))||!(0!==o||!_(t,i,e))||!(0!==s||!_(n,t,i))||!(0!==a||!_(n,e,i))}function _(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function b(t){return t>0?1:t<0?-1:0}function w(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function x(t,e){var n=new P(t.i,t.x,t.y),i=new P(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function E(t,e,n,i){var r=new P(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function S(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function P(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T(t,e,n,i){for(var r=0,o=e,s=n-i;o<n;o+=i)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}t.exports=e,t.exports.default=e,e.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,s=Math.abs(T(t,0,o,n));if(r)for(var a=0,l=e.length;a<l;a++){var c=e[a]*n,u=a<l-1?e[a+1]*n:t.length;s-=Math.abs(T(t,c,u,n))}var h=0;for(a=0;a<i.length;a+=3){var d=i[a]*n,f=i[a+1]*n,p=i[a+2]*n;h+=Math.abs((t[d]-t[p])*(t[f+1]-t[d+1])-(t[d]-t[f])*(t[p+1]-t[d+1]))}return 0===s&&0===h?0:Math.abs((h-s)/s)},e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[r][o][s]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n}},797:(t,e,n)=>{var i;!function(r,o,s,a){"use strict";var l,c=["","webkit","Moz","MS","ms","o"],u=o.createElement("div"),h="function",d=Math.round,f=Math.abs,p=Date.now;function g(t,e,n){return setTimeout(x(t,n),e)}function m(t,e,n){return!!Array.isArray(t)&&(v(t,n[e],n),!0)}function v(t,e,n){var i;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==a)for(i=0;i<t.length;)e.call(n,t[i],i,t),i++;else for(i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i,t)}function y(t,e,n){var i="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=r.console&&(r.console.warn||r.console.log);return o&&o.call(r.console,i,n),t.apply(this,arguments)}}l="function"!=typeof Object.assign?function(t){if(t===a||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(i!==a&&null!==i)for(var r in i)i.hasOwnProperty(r)&&(e[r]=i[r])}return e}:Object.assign;var _=y((function(t,e,n){for(var i=Object.keys(e),r=0;r<i.length;)(!n||n&&t[i[r]]===a)&&(t[i[r]]=e[i[r]]),r++;return t}),"extend","Use `assign`."),b=y((function(t,e){return _(t,e,!0)}),"merge","Use `assign`.");function w(t,e,n){var i,r=e.prototype;(i=t.prototype=Object.create(r)).constructor=t,i._super=r,n&&l(i,n)}function x(t,e){return function(){return t.apply(e,arguments)}}function E(t,e){return typeof t==h?t.apply(e&&e[0]||a,e):t}function S(t,e){return t===a?e:t}function P(t,e,n){v(M(e),(function(e){t.addEventListener(e,n,!1)}))}function T(t,e,n){v(M(e),(function(e){t.removeEventListener(e,n,!1)}))}function C(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function A(t,e){return t.indexOf(e)>-1}function M(t){return t.trim().split(/\s+/g)}function L(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var i=0;i<t.length;){if(n&&t[i][n]==e||!n&&t[i]===e)return i;i++}return-1}function k(t){return Array.prototype.slice.call(t,0)}function O(t,e,n){for(var i=[],r=[],o=0;o<t.length;){var s=e?t[o][e]:t[o];L(r,s)<0&&i.push(t[o]),r[o]=s,o++}return n&&(i=e?i.sort((function(t,n){return t[e]>n[e]})):i.sort()),i}function I(t,e){for(var n,i,r=e[0].toUpperCase()+e.slice(1),o=0;o<c.length;){if((i=(n=c[o])?n+r:e)in t)return i;o++}return a}var R=1;function N(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||r}var z="ontouchstart"in r,F=I(r,"PointerEvent")!==a,D=z&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),j="touch",B="mouse",U=25,V=1,W=4,G=8,H=1,q=2,X=4,Z=8,Y=16,K=q|X,Q=Z|Y,$=K|Q,J=["x","y"],tt=["clientX","clientY"];function et(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){E(t.options.enable,[t])&&n.handler(e)},this.init()}function nt(t,e,n){var i=n.pointers.length,r=n.changedPointers.length,o=e&V&&i-r==0,s=e&(W|G)&&i-r==0;n.isFirst=!!o,n.isFinal=!!s,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,i=e.pointers,r=i.length;n.firstInput||(n.firstInput=it(e)),r>1&&!n.firstMultiple?n.firstMultiple=it(e):1===r&&(n.firstMultiple=!1);var o=n.firstInput,s=n.firstMultiple,l=s?s.center:o.center,c=e.center=rt(i);e.timeStamp=p(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=lt(l,c),e.distance=at(l,c),function(t,e){var n=e.center,i=t.offsetDelta||{},r=t.prevDelta||{},o=t.prevInput||{};e.eventType!==V&&o.eventType!==W||(r=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},i=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=r.x+(n.x-i.x),e.deltaY=r.y+(n.y-i.y)}(n,e),e.offsetDirection=st(e.deltaX,e.deltaY);var u,h,d=ot(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=d.x,e.overallVelocityY=d.y,e.overallVelocity=f(d.x)>f(d.y)?d.x:d.y,e.scale=s?(u=s.pointers,at((h=i)[0],h[1],tt)/at(u[0],u[1],tt)):1,e.rotation=s?function(t,e){return lt(e[1],e[0],tt)+lt(t[1],t[0],tt)}(s.pointers,i):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,i,r,o,s=t.lastInterval||e,l=e.timeStamp-s.timeStamp;if(e.eventType!=G&&(l>U||s.velocity===a)){var c=e.deltaX-s.deltaX,u=e.deltaY-s.deltaY,h=ot(l,c,u);i=h.x,r=h.y,n=f(h.x)>f(h.y)?h.x:h.y,o=st(c,u),t.lastInterval=e}else n=s.velocity,i=s.velocityX,r=s.velocityY,o=s.direction;e.velocity=n,e.velocityX=i,e.velocityY=r,e.direction=o}(n,e);var g=t.element;C(e.srcEvent.target,g)&&(g=e.srcEvent.target),e.target=g}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function it(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:d(t.pointers[n].clientX),clientY:d(t.pointers[n].clientY)},n++;return{timeStamp:p(),pointers:e,center:rt(e),deltaX:t.deltaX,deltaY:t.deltaY}}function rt(t){var e=t.length;if(1===e)return{x:d(t[0].clientX),y:d(t[0].clientY)};for(var n=0,i=0,r=0;r<e;)n+=t[r].clientX,i+=t[r].clientY,r++;return{x:d(n/e),y:d(i/e)}}function ot(t,e,n){return{x:e/t||0,y:n/t||0}}function st(t,e){return t===e?H:f(t)>=f(e)?t<0?q:X:e<0?Z:Y}function at(t,e,n){n||(n=J);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return Math.sqrt(i*i+r*r)}function lt(t,e,n){n||(n=J);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return 180*Math.atan2(r,i)/Math.PI}et.prototype={handler:function(){},init:function(){this.evEl&&P(this.element,this.evEl,this.domHandler),this.evTarget&&P(this.target,this.evTarget,this.domHandler),this.evWin&&P(N(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&T(this.element,this.evEl,this.domHandler),this.evTarget&&T(this.target,this.evTarget,this.domHandler),this.evWin&&T(N(this.element),this.evWin,this.domHandler)}};var ct={mousedown:V,mousemove:2,mouseup:W},ut="mousedown",ht="mousemove mouseup";function dt(){this.evEl=ut,this.evWin=ht,this.pressed=!1,et.apply(this,arguments)}w(dt,et,{handler:function(t){var e=ct[t.type];e&V&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=W),this.pressed&&(e&W&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:B,srcEvent:t}))}});var ft={pointerdown:V,pointermove:2,pointerup:W,pointercancel:G,pointerout:G},pt={2:j,3:"pen",4:B,5:"kinect"},gt="pointerdown",mt="pointermove pointerup pointercancel";function vt(){this.evEl=gt,this.evWin=mt,et.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}r.MSPointerEvent&&!r.PointerEvent&&(gt="MSPointerDown",mt="MSPointerMove MSPointerUp MSPointerCancel"),w(vt,et,{handler:function(t){var e=this.store,n=!1,i=t.type.toLowerCase().replace("ms",""),r=ft[i],o=pt[t.pointerType]||t.pointerType,s=o==j,a=L(e,t.pointerId,"pointerId");r&V&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):r&(W|G)&&(n=!0),a<0||(e[a]=t,this.callback(this.manager,r,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(a,1))}});var yt={touchstart:V,touchmove:2,touchend:W,touchcancel:G};function _t(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,et.apply(this,arguments)}function bt(t,e){var n=k(t.touches),i=k(t.changedTouches);return e&(W|G)&&(n=O(n.concat(i),"identifier",!0)),[n,i]}w(_t,et,{handler:function(t){var e=yt[t.type];if(e===V&&(this.started=!0),this.started){var n=bt.call(this,t,e);e&(W|G)&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:j,srcEvent:t})}}});var wt={touchstart:V,touchmove:2,touchend:W,touchcancel:G},xt="touchstart touchmove touchend touchcancel";function Et(){this.evTarget=xt,this.targetIds={},et.apply(this,arguments)}function St(t,e){var n=k(t.touches),i=this.targetIds;if(e&(2|V)&&1===n.length)return i[n[0].identifier]=!0,[n,n];var r,o,s=k(t.changedTouches),a=[],l=this.target;if(o=n.filter((function(t){return C(t.target,l)})),e===V)for(r=0;r<o.length;)i[o[r].identifier]=!0,r++;for(r=0;r<s.length;)i[s[r].identifier]&&a.push(s[r]),e&(W|G)&&delete i[s[r].identifier],r++;return a.length?[O(o.concat(a),"identifier",!0),a]:void 0}w(Et,et,{handler:function(t){var e=wt[t.type],n=St.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:j,srcEvent:t})}});var Pt=2500;function Tt(){et.apply(this,arguments);var t=x(this.handler,this);this.touch=new Et(this.manager,t),this.mouse=new dt(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function Ct(t,e){t&V?(this.primaryTouch=e.changedPointers[0].identifier,At.call(this,e)):t&(W|G)&&At.call(this,e)}function At(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var i=this.lastTouches;setTimeout((function(){var t=i.indexOf(n);t>-1&&i.splice(t,1)}),Pt)}}function Mt(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var r=this.lastTouches[i],o=Math.abs(e-r.x),s=Math.abs(n-r.y);if(o<=25&&s<=25)return!0}return!1}w(Tt,et,{handler:function(t,e,n){var i=n.pointerType==j,r=n.pointerType==B;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(i)Ct.call(this,e,n);else if(r&&Mt.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Lt=I(u.style,"touchAction"),kt=Lt!==a,Ot="compute",It="auto",Rt="manipulation",Nt="none",zt="pan-x",Ft="pan-y",Dt=function(){if(!kt)return!1;var t={},e=r.CSS&&r.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!e||r.CSS.supports("touch-action",n)})),t}();function jt(t,e){this.manager=t,this.set(e)}jt.prototype={set:function(t){t==Ot&&(t=this.compute()),kt&&this.manager.element.style&&Dt[t]&&(this.manager.element.style[Lt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return v(this.manager.recognizers,(function(e){E(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(A(t,Nt))return Nt;var e=A(t,zt),n=A(t,Ft);return e&&n?Nt:e||n?e?zt:Ft:A(t,Rt)?Rt:It}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var i=this.actions,r=A(i,Nt)&&!Dt[Nt],o=A(i,Ft)&&!Dt[Ft],s=A(i,zt)&&!Dt[zt];if(r){var a=1===t.pointers.length,l=t.distance<2,c=t.deltaTime<250;if(a&&l&&c)return}if(!s||!o)return r||o&&n&K||s&&n&Q?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Bt=1,Ut=32;function Vt(t){this.options=l({},this.defaults,t||{}),this.id=R++,this.manager=null,this.options.enable=S(this.options.enable,!0),this.state=Bt,this.simultaneous={},this.requireFail=[]}function Wt(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function Gt(t){return t==Y?"down":t==Z?"up":t==q?"left":t==X?"right":""}function Ht(t,e){var n=e.manager;return n?n.get(t):t}function qt(){Vt.apply(this,arguments)}function Xt(){qt.apply(this,arguments),this.pX=null,this.pY=null}function Zt(){qt.apply(this,arguments)}function Yt(){Vt.apply(this,arguments),this._timer=null,this._input=null}function Kt(){qt.apply(this,arguments)}function Qt(){qt.apply(this,arguments)}function $t(){Vt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Jt(t,e){return(e=e||{}).recognizers=S(e.recognizers,Jt.defaults.preset),new te(t,e)}function te(t,e){this.options=l({},Jt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new(this.options.inputClass||(F?vt:D?Et:z?Tt:dt))(this,nt),this.touchAction=new jt(this,this.options.touchAction),ee(this,!0),v(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function ee(t,e){var n,i=t.element;i.style&&(v(t.options.cssProps,(function(r,o){n=I(i.style,o),e?(t.oldCssProps[n]=i.style[n],i.style[n]=r):i.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}Vt.prototype={defaults:{},set:function(t){return l(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(m(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Ht(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return m(t,"dropRecognizeWith",this)||(t=Ht(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(m(t,"requireFailure",this))return this;var e=this.requireFail;return-1===L(e,t=Ht(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(m(t,"dropRequireFailure",this))return this;t=Ht(t,this);var e=L(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function i(n){e.manager.emit(n,t)}n<8&&i(e.options.event+Wt(n)),i(e.options.event),t.additionalEvent&&i(t.additionalEvent),n>=8&&i(e.options.event+Wt(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=Ut},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(Ut|Bt)))return!1;t++}return!0},recognize:function(t){var e=l({},t);if(!E(this.options.enable,[this,e]))return this.reset(),void(this.state=Ut);56&this.state&&(this.state=Bt),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},w(qt,Vt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,i=6&e,r=this.attrTest(t);return i&&(n&G||!r)?16|e:i||r?n&W?8|e:2&e?4|e:2:Ut}}),w(Xt,qt,{defaults:{event:"pan",threshold:10,pointers:1,direction:$},getTouchAction:function(){var t=this.options.direction,e=[];return t&K&&e.push(Ft),t&Q&&e.push(zt),e},directionTest:function(t){var e=this.options,n=!0,i=t.distance,r=t.direction,o=t.deltaX,s=t.deltaY;return r&e.direction||(e.direction&K?(r=0===o?H:o<0?q:X,n=o!=this.pX,i=Math.abs(t.deltaX)):(r=0===s?H:s<0?Z:Y,n=s!=this.pY,i=Math.abs(t.deltaY))),t.direction=r,n&&i>e.threshold&&r&e.direction},attrTest:function(t){return qt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Gt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),w(Zt,qt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Nt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),w(Yt,Vt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[It]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,r=t.deltaTime>e.time;if(this._input=t,!i||!n||t.eventType&(W|G)&&!r)this.reset();else if(t.eventType&V)this.reset(),this._timer=g((function(){this.state=8,this.tryEmit()}),e.time,this);else if(t.eventType&W)return 8;return Ut},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&t.eventType&W?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}}),w(Kt,qt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Nt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),w(Qt,qt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:K|Q,pointers:1},getTouchAction:function(){return Xt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&(K|Q)?e=t.overallVelocity:n&K?e=t.overallVelocityX:n&Q&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&f(e)>this.options.velocity&&t.eventType&W},emit:function(t){var e=Gt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),w($t,Vt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Rt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,r=t.deltaTime<e.time;if(this.reset(),t.eventType&V&&0===this.count)return this.failTimeout();if(i&&r&&n){if(t.eventType!=W)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||at(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,s&&o?this.count+=1:this.count=1,this._input=t,0==this.count%e.taps)return this.hasRequireFailures()?(this._timer=g((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return Ut},failTimeout:function(){return this._timer=g((function(){this.state=Ut}),this.options.interval,this),Ut},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Jt.VERSION="2.0.7",Jt.defaults={domEvents:!1,touchAction:Ot,enable:!0,inputTarget:null,inputClass:null,preset:[[Kt,{enable:!1}],[Zt,{enable:!1},["rotate"]],[Qt,{direction:K}],[Xt,{direction:K},["swipe"]],[$t],[$t,{event:"doubletap",taps:2},["tap"]],[Yt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},te.prototype={set:function(t){return l(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var i=this.recognizers,r=e.curRecognizer;(!r||r&&8&r.state)&&(r=e.curRecognizer=null);for(var o=0;o<i.length;)n=i[o],2===e.stopped||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(t),!r&&14&n.state&&(r=e.curRecognizer=n),o++}},get:function(t){if(t instanceof Vt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(m(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(m(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=L(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==a&&e!==a){var n=this.handlers;return v(M(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(t!==a){var n=this.handlers;return v(M(t),(function(t){e?n[t]&&n[t].splice(L(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var i=0;i<n.length;)n[i](e),i++}},destroy:function(){this.element&&ee(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},l(Jt,{INPUT_START:V,INPUT_MOVE:2,INPUT_END:W,INPUT_CANCEL:G,STATE_POSSIBLE:Bt,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Ut,DIRECTION_NONE:H,DIRECTION_LEFT:q,DIRECTION_RIGHT:X,DIRECTION_UP:Z,DIRECTION_DOWN:Y,DIRECTION_HORIZONTAL:K,DIRECTION_VERTICAL:Q,DIRECTION_ALL:$,Manager:te,Input:et,TouchAction:jt,TouchInput:Et,MouseInput:dt,PointerEventInput:vt,TouchMouseInput:Tt,SingleTouchInput:_t,Recognizer:Vt,AttrRecognizer:qt,Tap:$t,Pan:Xt,Swipe:Qt,Pinch:Zt,Rotate:Kt,Press:Yt,on:P,off:T,each:v,merge:b,extend:_,assign:l,inherit:w,bindFn:x,prefixed:I}),(void 0!==r?r:"undefined"!=typeof self?self:{}).Hammer=Jt,(i=function(){return Jt}.call(e,n,e,t))===a||(t.exports=i)}(window,document)},418:t=>{"use strict";var e=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(t){i[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(t){return!1}}()?Object.assign:function(t,r){for(var o,s,a=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),l=1;l<arguments.length;l++){for(var c in o=Object(arguments[l]))n.call(o,c)&&(a[c]=o[c]);if(e){s=e(o);for(var u=0;u<s.length;u++)i.call(o,s[u])&&(a[s[u]]=o[s[u]])}}return a}},448:(t,e,n)=>{"use strict";var i=n(294),r=n(418),o=n(840);function s(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!i)throw Error(s(227));var a=new Set,l={};function c(t,e){u(t,e),u(t+"Capture",e)}function u(t,e){for(l[t]=e,t=0;t<e.length;t++)a.add(e[t])}var h=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f=Object.prototype.hasOwnProperty,p={},g={};function m(t,e,n,i,r,o,s){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){v[t]=new m(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];v[e]=new m(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){v[t]=new m(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){v[t]=new m(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){v[t]=new m(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){v[t]=new m(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){v[t]=new m(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){v[t]=new m(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){v[t]=new m(t,5,!1,t.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function _(t){return t[1].toUpperCase()}function b(t,e,n,i){var r=v.hasOwnProperty(e)?v[e]:null;(null!==r?0===r.type:!i&&2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1]))||(function(t,e,n,i){if(null==e||function(t,e,n,i){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,r,i)&&(n=null),i||null===r?function(t){return!!f.call(g,t)||!f.call(p,t)&&(d.test(t)?g[t]=!0:(p[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=null===n?3!==r.type&&"":n:(e=r.attributeName,i=r.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(y,_);v[e]=new m(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(y,_);v[e]=new m(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(y,_);v[e]=new m(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){v[t]=new m(t,1,!1,t.toLowerCase(),null,!1,!1)})),v.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){v[t]=new m(t,1,!1,t.toLowerCase(),null,!0,!0)}));var w=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=60103,E=60106,S=60107,P=60108,T=60114,C=60109,A=60110,M=60112,L=60113,k=60120,O=60115,I=60116,R=60121,N=60128,z=60129,F=60130,D=60131;if("function"==typeof Symbol&&Symbol.for){var j=Symbol.for;x=j("react.element"),E=j("react.portal"),S=j("react.fragment"),P=j("react.strict_mode"),T=j("react.profiler"),C=j("react.provider"),A=j("react.context"),M=j("react.forward_ref"),L=j("react.suspense"),k=j("react.suspense_list"),O=j("react.memo"),I=j("react.lazy"),R=j("react.block"),j("react.scope"),N=j("react.opaque.id"),z=j("react.debug_trace_mode"),F=j("react.offscreen"),D=j("react.legacy_hidden")}var B,U="function"==typeof Symbol&&Symbol.iterator;function V(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=U&&t[U]||t["@@iterator"])?t:null}function W(t){if(void 0===B)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);B=e&&e[1]||""}return"\n"+B+t}var G=!1;function H(t,e){if(!t||G)return"";G=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(t){var i=t}Reflect.construct(t,[],e)}else{try{e.call()}catch(t){i=t}t.call(e.prototype)}else{try{throw Error()}catch(t){i=t}t()}}catch(t){if(t&&i&&"string"==typeof t.stack){for(var r=t.stack.split("\n"),o=i.stack.split("\n"),s=r.length-1,a=o.length-1;1<=s&&0<=a&&r[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(r[s]!==o[a]){if(1!==s||1!==a)do{if(s--,0>--a||r[s]!==o[a])return"\n"+r[s].replace(" at new "," at ")}while(1<=s&&0<=a);break}}}finally{G=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?W(t):""}function q(t){switch(t.tag){case 5:return W(t.type);case 16:return W("Lazy");case 13:return W("Suspense");case 19:return W("SuspenseList");case 0:case 2:case 15:return H(t.type,!1);case 11:return H(t.type.render,!1);case 22:return H(t.type._render,!1);case 1:return H(t.type,!0);default:return""}}function X(t){if(null==t)return null;if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t;switch(t){case S:return"Fragment";case E:return"Portal";case T:return"Profiler";case P:return"StrictMode";case L:return"Suspense";case k:return"SuspenseList"}if("object"==typeof t)switch(t.$$typeof){case A:return(t.displayName||"Context")+".Consumer";case C:return(t._context.displayName||"Context")+".Provider";case M:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case O:return X(t.type);case R:return X(t._render);case I:e=t._payload,t=t._init;try{return X(t(e))}catch(t){}}return null}function Z(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function Y(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function K(t){t._valueTracker||(t._valueTracker=function(t){var e=Y(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var r=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(t){i=""+t,o.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(t){i=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function Q(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=Y(t)?t.checked?"true":"false":t.value),(t=i)!==n&&(e.setValue(t),!0)}function $(t){if(void 0===(t=t||("undefined"!=typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function J(t,e){var n=e.checked;return r({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function tt(t,e){var n=null==e.defaultValue?"":e.defaultValue,i=null!=e.checked?e.checked:e.defaultChecked;n=Z(null!=e.value?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function et(t,e){null!=(e=e.checked)&&b(t,"checked",e,!1)}function nt(t,e){et(t,e);var n=Z(e.value),i=e.type;if(null!=n)"number"===i?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===i||"reset"===i)return void t.removeAttribute("value");e.hasOwnProperty("value")?rt(t,e.type,n):e.hasOwnProperty("defaultValue")&&rt(t,e.type,Z(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function it(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!("submit"!==i&&"reset"!==i||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function rt(t,e,n){"number"===e&&$(t.ownerDocument)===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}function ot(t,e){return t=r({children:void 0},e),(e=function(t){var e="";return i.Children.forEach(t,(function(t){null!=t&&(e+=t)})),e}(e.children))&&(t.children=e),t}function st(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+Z(n),e=null,r=0;r<t.length;r++){if(t[r].value===n)return t[r].selected=!0,void(i&&(t[r].defaultSelected=!0));null!==e||t[r].disabled||(e=t[r])}null!==e&&(e.selected=!0)}}function at(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(s(91));return r({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function lt(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(s(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(s(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:Z(n)}}function ct(t,e){var n=Z(e.value),i=Z(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=i&&(t.defaultValue=""+i)}function ut(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}var ht={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function dt(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ft(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?dt(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var pt,gt,mt=(gt=function(t,e){if(t.namespaceURI!==ht.svg||"innerHTML"in t)t.innerHTML=e;else{for((pt=pt||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=pt.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,i){MSApp.execUnsafeLocalFunction((function(){return gt(t,e)}))}:gt);function vt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var yt={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},_t=["Webkit","ms","Moz","O"];function bt(t,e,n){return null==e||"boolean"==typeof e||""===e?"":n||"number"!=typeof e||0===e||yt.hasOwnProperty(t)&&yt[t]?(""+e).trim():e+"px"}function wt(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=bt(n,e[n],i);"float"===n&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}Object.keys(yt).forEach((function(t){_t.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),yt[e]=yt[t]}))}));var xt=r({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Et(t,e){if(e){if(xt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(s(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(s(60));if("object"!=typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=e.style&&"object"!=typeof e.style)throw Error(s(62))}}function St(t,e){if(-1===t.indexOf("-"))return"string"==typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Pt(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var Tt=null,Ct=null,At=null;function Mt(t){if(t=nr(t)){if("function"!=typeof Tt)throw Error(s(280));var e=t.stateNode;e&&(e=rr(e),Tt(t.stateNode,t.type,e))}}function Lt(t){Ct?At?At.push(t):At=[t]:Ct=t}function kt(){if(Ct){var t=Ct,e=At;if(At=Ct=null,Mt(t),e)for(t=0;t<e.length;t++)Mt(e[t])}}function Ot(t,e){return t(e)}function It(t,e,n,i,r){return t(e,n,i,r)}function Rt(){}var Nt=Ot,zt=!1,Ft=!1;function Dt(){null===Ct&&null===At||(Rt(),kt())}function jt(t,e){var n=t.stateNode;if(null===n)return null;var i=rr(n);if(null===i)return null;n=i[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!i;break t;default:t=!1}if(t)return null;if(n&&"function"!=typeof n)throw Error(s(231,e,typeof n));return n}var Bt=!1;if(h)try{var Ut={};Object.defineProperty(Ut,"passive",{get:function(){Bt=!0}}),window.addEventListener("test",Ut,Ut),window.removeEventListener("test",Ut,Ut)}catch(gt){Bt=!1}function Vt(t,e,n,i,r,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(t){this.onError(t)}}var Wt=!1,Gt=null,Ht=!1,qt=null,Xt={onError:function(t){Wt=!0,Gt=t}};function Zt(t,e,n,i,r,o,s,a,l){Wt=!1,Gt=null,Vt.apply(Xt,arguments)}function Yt(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!=(1026&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function Kt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&null!==(t=t.alternate)&&(e=t.memoizedState),null!==e)return e.dehydrated}return null}function Qt(t){if(Yt(t)!==t)throw Error(s(188))}function $t(t){if(t=function(t){var e=t.alternate;if(!e){if(null===(e=Yt(t)))throw Error(s(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(null===r)break;var o=r.alternate;if(null===o){if(null!==(i=r.return)){n=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return Qt(r),t;if(o===i)return Qt(r),e;o=o.sibling}throw Error(s(188))}if(n.return!==i.return)n=r,i=o;else{for(var a=!1,l=r.child;l;){if(l===n){a=!0,n=r,i=o;break}if(l===i){a=!0,i=r,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,i=r;break}if(l===i){a=!0,i=o,n=r;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==i)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?t:e}(t),!t)return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function Jt(t,e){for(var n=t.alternate;null!==e;){if(e===t||e===n)return!0;e=e.return}return!1}var te,ee,ne,ie,re=!1,oe=[],se=null,ae=null,le=null,ce=new Map,ue=new Map,he=[],de="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function fe(t,e,n,i,r){return{blockedOn:t,domEventName:e,eventSystemFlags:16|n,nativeEvent:r,targetContainers:[i]}}function pe(t,e){switch(t){case"focusin":case"focusout":se=null;break;case"dragenter":case"dragleave":ae=null;break;case"mouseover":case"mouseout":le=null;break;case"pointerover":case"pointerout":ce.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ue.delete(e.pointerId)}}function ge(t,e,n,i,r,o){return null===t||t.nativeEvent!==o?(t=fe(e,n,i,r,o),null!==e&&null!==(e=nr(e))&&ee(e),t):(t.eventSystemFlags|=i,e=t.targetContainers,null!==r&&-1===e.indexOf(r)&&e.push(r),t)}function me(t){var e=er(t.target);if(null!==e){var n=Yt(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=Kt(n)))return t.blockedOn=e,void ie(t.lanePriority,(function(){o.unstable_runWithPriority(t.priority,(function(){ne(n)}))}))}else if(3===e&&n.stateNode.hydrate)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function ve(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var n=$e(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n)return null!==(e=nr(n))&&ee(e),t.blockedOn=n,!1;e.shift()}return!0}function ye(t,e,n){ve(t)&&n.delete(e)}function _e(){for(re=!1;0<oe.length;){var t=oe[0];if(null!==t.blockedOn){null!==(t=nr(t.blockedOn))&&te(t);break}for(var e=t.targetContainers;0<e.length;){var n=$e(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n){t.blockedOn=n;break}e.shift()}null===t.blockedOn&&oe.shift()}null!==se&&ve(se)&&(se=null),null!==ae&&ve(ae)&&(ae=null),null!==le&&ve(le)&&(le=null),ce.forEach(ye),ue.forEach(ye)}function be(t,e){t.blockedOn===e&&(t.blockedOn=null,re||(re=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,_e)))}function we(t){function e(e){return be(e,t)}if(0<oe.length){be(oe[0],t);for(var n=1;n<oe.length;n++){var i=oe[n];i.blockedOn===t&&(i.blockedOn=null)}}for(null!==se&&be(se,t),null!==ae&&be(ae,t),null!==le&&be(le,t),ce.forEach(e),ue.forEach(e),n=0;n<he.length;n++)(i=he[n]).blockedOn===t&&(i.blockedOn=null);for(;0<he.length&&null===(n=he[0]).blockedOn;)me(n),null===n.blockedOn&&he.shift()}function xe(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ee={animationend:xe("Animation","AnimationEnd"),animationiteration:xe("Animation","AnimationIteration"),animationstart:xe("Animation","AnimationStart"),transitionend:xe("Transition","TransitionEnd")},Se={},Pe={};function Te(t){if(Se[t])return Se[t];if(!Ee[t])return t;var e,n=Ee[t];for(e in n)if(n.hasOwnProperty(e)&&e in Pe)return Se[t]=n[e];return t}h&&(Pe=document.createElement("div").style,"AnimationEvent"in window||(delete Ee.animationend.animation,delete Ee.animationiteration.animation,delete Ee.animationstart.animation),"TransitionEvent"in window||delete Ee.transitionend.transition);var Ce=Te("animationend"),Ae=Te("animationiteration"),Me=Te("animationstart"),Le=Te("transitionend"),ke=new Map,Oe=new Map,Ie=["abort","abort",Ce,"animationEnd",Ae,"animationIteration",Me,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Le,"transitionEnd","waiting","waiting"];function Re(t,e){for(var n=0;n<t.length;n+=2){var i=t[n],r=t[n+1];r="on"+(r[0].toUpperCase()+r.slice(1)),Oe.set(i,e),ke.set(i,r),c(r,[i])}}(0,o.unstable_now)();var Ne=8;function ze(t){if(0!=(1&t))return Ne=15,1;if(0!=(2&t))return Ne=14,2;if(0!=(4&t))return Ne=13,4;var e=24&t;return 0!==e?(Ne=12,e):0!=(32&t)?(Ne=11,32):0!=(e=192&t)?(Ne=10,e):0!=(256&t)?(Ne=9,256):0!=(e=3584&t)?(Ne=8,e):0!=(4096&t)?(Ne=7,4096):0!=(e=4186112&t)?(Ne=6,e):0!=(e=62914560&t)?(Ne=5,e):67108864&t?(Ne=4,67108864):0!=(134217728&t)?(Ne=3,134217728):0!=(e=805306368&t)?(Ne=2,e):0!=(1073741824&t)?(Ne=1,1073741824):(Ne=8,t)}function Fe(t,e){var n=t.pendingLanes;if(0===n)return Ne=0;var i=0,r=0,o=t.expiredLanes,s=t.suspendedLanes,a=t.pingedLanes;if(0!==o)i=o,r=Ne=15;else if(0!=(o=134217727&n)){var l=o&~s;0!==l?(i=ze(l),r=Ne):0!=(a&=o)&&(i=ze(a),r=Ne)}else 0!=(o=n&~s)?(i=ze(o),r=Ne):0!==a&&(i=ze(a),r=Ne);if(0===i)return 0;if(i=n&((0>(i=31-We(i))?0:1<<i)<<1)-1,0!==e&&e!==i&&0==(e&s)){if(ze(e),r<=Ne)return e;Ne=r}if(0!==(e=t.entangledLanes))for(t=t.entanglements,e&=i;0<e;)r=1<<(n=31-We(e)),i|=t[n],e&=~r;return i}function De(t){return 0!=(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function je(t,e){switch(t){case 15:return 1;case 14:return 2;case 12:return 0===(t=Be(24&~e))?je(10,e):t;case 10:return 0===(t=Be(192&~e))?je(8,e):t;case 8:return 0===(t=Be(3584&~e))&&0===(t=Be(4186112&~e))&&(t=512),t;case 2:return 0===(e=Be(805306368&~e))&&(e=268435456),e}throw Error(s(358,t))}function Be(t){return t&-t}function Ue(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ve(t,e,n){t.pendingLanes|=e;var i=e-1;t.suspendedLanes&=i,t.pingedLanes&=i,(t=t.eventTimes)[e=31-We(e)]=n}var We=Math.clz32?Math.clz32:function(t){return 0===t?32:31-(Ge(t)/He|0)|0},Ge=Math.log,He=Math.LN2,qe=o.unstable_UserBlockingPriority,Xe=o.unstable_runWithPriority,Ze=!0;function Ye(t,e,n,i){zt||Rt();var r=Qe,o=zt;zt=!0;try{It(r,t,e,n,i)}finally{(zt=o)||Dt()}}function Ke(t,e,n,i){Xe(qe,Qe.bind(null,t,e,n,i))}function Qe(t,e,n,i){var r;if(Ze)if((r=0==(4&e))&&0<oe.length&&-1<de.indexOf(t))t=fe(null,t,e,n,i),oe.push(t);else{var o=$e(t,e,n,i);if(null===o)r&&pe(t,i);else{if(r){if(-1<de.indexOf(t))return t=fe(o,t,e,n,i),void oe.push(t);if(function(t,e,n,i,r){switch(e){case"focusin":return se=ge(se,t,e,n,i,r),!0;case"dragenter":return ae=ge(ae,t,e,n,i,r),!0;case"mouseover":return le=ge(le,t,e,n,i,r),!0;case"pointerover":var o=r.pointerId;return ce.set(o,ge(ce.get(o)||null,t,e,n,i,r)),!0;case"gotpointercapture":return o=r.pointerId,ue.set(o,ge(ue.get(o)||null,t,e,n,i,r)),!0}return!1}(o,t,e,n,i))return;pe(t,i)}Ri(t,e,i,null,n)}}}function $e(t,e,n,i){var r=Pt(i);if(null!==(r=er(r))){var o=Yt(r);if(null===o)r=null;else{var s=o.tag;if(13===s){if(null!==(r=Kt(o)))return r;r=null}else if(3===s){if(o.stateNode.hydrate)return 3===o.tag?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return Ri(t,e,i,r,n),null}var Je=null,tn=null,en=null;function nn(){if(en)return en;var t,e,n=tn,i=n.length,r="value"in Je?Je.value:Je.textContent,o=r.length;for(t=0;t<i&&n[t]===r[t];t++);var s=i-t;for(e=1;e<=s&&n[i-e]===r[o-e];e++);return en=r.slice(t,1<e?1-e:void 0)}function rn(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function on(){return!0}function sn(){return!1}function an(t){function e(e,n,i,r,o){for(var s in this._reactName=e,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=o,this.currentTarget=null,t)t.hasOwnProperty(s)&&(e=t[s],this[s]=e?e(r):r[s]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?on:sn,this.isPropagationStopped=sn,this}return r(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!=typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=on)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!=typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=on)},persist:function(){},isPersistent:on}),e}var ln,cn,un,hn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=an(hn),fn=r({},hn,{view:0,detail:0}),pn=an(fn),gn=r({},fn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==un&&(un&&"mousemove"===t.type?(ln=t.screenX-un.screenX,cn=t.screenY-un.screenY):cn=ln=0,un=t),ln)},movementY:function(t){return"movementY"in t?t.movementY:cn}}),mn=an(gn),vn=an(r({},gn,{dataTransfer:0})),yn=an(r({},fn,{relatedTarget:0})),_n=an(r({},hn,{animationName:0,elapsedTime:0,pseudoElement:0})),bn=r({},hn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),wn=an(bn),xn=an(r({},hn,{data:0})),En={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Pn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tn(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=Pn[t])&&!!e[t]}function Cn(){return Tn}var An=r({},fn,{key:function(t){if(t.key){var e=En[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=rn(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?Sn[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(t){return"keypress"===t.type?rn(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?rn(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),Mn=an(An),Ln=an(r({},gn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),kn=an(r({},fn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),On=an(r({},hn,{propertyName:0,elapsedTime:0,pseudoElement:0})),In=r({},gn,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=an(In),Nn=[9,13,27,32],zn=h&&"CompositionEvent"in window,Fn=null;h&&"documentMode"in document&&(Fn=document.documentMode);var Dn=h&&"TextEvent"in window&&!Fn,jn=h&&(!zn||Fn&&8<Fn&&11>=Fn),Bn=String.fromCharCode(32),Un=!1;function Vn(t,e){switch(t){case"keyup":return-1!==Nn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wn(t){return"object"==typeof(t=t.detail)&&"data"in t?t.data:null}var Gn=!1,Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Hn[t.type]:"textarea"===e}function Xn(t,e,n,i){Lt(i),0<(e=zi(e,"onChange")).length&&(n=new dn("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Zn=null,Yn=null;function Kn(t){Ai(t,0)}function Qn(t){if(Q(ir(t)))return t}function $n(t,e){if("change"===t)return e}var Jn=!1;if(h){var ti;if(h){var ei="oninput"in document;if(!ei){var ni=document.createElement("div");ni.setAttribute("oninput","return;"),ei="function"==typeof ni.oninput}ti=ei}else ti=!1;Jn=ti&&(!document.documentMode||9<document.documentMode)}function ii(){Zn&&(Zn.detachEvent("onpropertychange",ri),Yn=Zn=null)}function ri(t){if("value"===t.propertyName&&Qn(Yn)){var e=[];if(Xn(e,Yn,t,Pt(t)),t=Kn,zt)t(e);else{zt=!0;try{Ot(t,e)}finally{zt=!1,Dt()}}}}function oi(t,e,n){"focusin"===t?(ii(),Yn=n,(Zn=e).attachEvent("onpropertychange",ri)):"focusout"===t&&ii()}function si(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Qn(Yn)}function ai(t,e){if("click"===t)return Qn(e)}function li(t,e){if("input"===t||"change"===t)return Qn(e)}var ci="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},ui=Object.prototype.hasOwnProperty;function hi(t,e){if(ci(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++)if(!ui.call(e,n[i])||!ci(t[n[i]],e[n[i]]))return!1;return!0}function di(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function fi(t,e){var n,i=di(t);for(t=0;i;){if(3===i.nodeType){if(n=t+i.textContent.length,t<=e&&n>=e)return{node:i,offset:e-t};t=n}t:{for(;i;){if(i.nextSibling){i=i.nextSibling;break t}i=i.parentNode}i=void 0}i=di(i)}}function pi(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?pi(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function gi(){for(var t=window,e=$();e instanceof t.HTMLIFrameElement;){try{var n="string"==typeof e.contentWindow.location.href}catch(t){n=!1}if(!n)break;e=$((t=e.contentWindow).document)}return e}function mi(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}var vi=h&&"documentMode"in document&&11>=document.documentMode,yi=null,_i=null,bi=null,wi=!1;function xi(t,e,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;wi||null==yi||yi!==$(i)||(i="selectionStart"in(i=yi)&&mi(i)?{start:i.selectionStart,end:i.selectionEnd}:{anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},bi&&hi(bi,i)||(bi=i,0<(i=zi(_i,"onSelect")).length&&(e=new dn("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=yi)))}Re("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Re("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Re(Ie,2);for(var Ei="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Si=0;Si<Ei.length;Si++)Oe.set(Ei[Si],0);u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ti=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pi));function Ci(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,function(t,e,n,i,r,o,a,l,c){if(Zt.apply(this,arguments),Wt){if(!Wt)throw Error(s(198));var u=Gt;Wt=!1,Gt=null,Ht||(Ht=!0,qt=u)}}(i,e,void 0,t),t.currentTarget=null}function Ai(t,e){e=0!=(4&e);for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;t:{var o=void 0;if(e)for(var s=i.length-1;0<=s;s--){var a=i[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&r.isPropagationStopped())break t;Ci(r,a,c),o=l}else for(s=0;s<i.length;s++){if(l=(a=i[s]).instance,c=a.currentTarget,a=a.listener,l!==o&&r.isPropagationStopped())break t;Ci(r,a,c),o=l}}}if(Ht)throw t=qt,Ht=!1,qt=null,t}function Mi(t,e){var n=or(e),i=t+"__bubble";n.has(i)||(Ii(e,t,2,!1),n.add(i))}var Li="_reactListening"+Math.random().toString(36).slice(2);function ki(t){t[Li]||(t[Li]=!0,a.forEach((function(e){Ti.has(e)||Oi(e,!1,t,null),Oi(e,!0,t,null)})))}function Oi(t,e,n,i){var r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=n;if("selectionchange"===t&&9!==n.nodeType&&(o=n.ownerDocument),null!==i&&!e&&Ti.has(t)){if("scroll"!==t)return;r|=2,o=i}var s=or(o),a=t+"__"+(e?"capture":"bubble");s.has(a)||(e&&(r|=4),Ii(o,t,r,e),s.add(a))}function Ii(t,e,n,i){var r=Oe.get(e);switch(void 0===r?2:r){case 0:r=Ye;break;case 1:r=Ke;break;default:r=Qe}n=r.bind(null,e,n,t),r=void 0,!Bt||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(r=!0),i?void 0!==r?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):void 0!==r?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Ri(t,e,n,i,r){var o=i;if(0==(1&e)&&0==(2&e)&&null!==i)t:for(;;){if(null===i)return;var s=i.tag;if(3===s||4===s){var a=i.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===s)for(s=i.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;s=s.return}for(;null!==a;){if(null===(s=er(a)))return;if(5===(l=s.tag)||6===l){i=o=s;continue t}a=a.parentNode}}i=i.return}!function(t,e,n){if(Ft)return t();Ft=!0;try{return Nt(t,e,n)}finally{Ft=!1,Dt()}}((function(){var i=o,r=Pt(n),s=[];t:{var a=ke.get(t);if(void 0!==a){var l=dn,c=t;switch(t){case"keypress":if(0===rn(n))break t;case"keydown":case"keyup":l=Mn;break;case"focusin":c="focus",l=yn;break;case"focusout":c="blur",l=yn;break;case"beforeblur":case"afterblur":l=yn;break;case"click":if(2===n.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=kn;break;case Ce:case Ae:case Me:l=_n;break;case Le:l=On;break;case"scroll":l=pn;break;case"wheel":l=Rn;break;case"copy":case"cut":case"paste":l=wn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Ln}var u=0!=(4&e),h=!u&&"scroll"===t,d=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=i;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==d&&null!=(g=jt(p,d))&&u.push(Ni(p,g,f))),h)break;p=p.return}0<u.length&&(a=new l(a,c,null,n,r),s.push({event:a,listeners:u}))}}if(0==(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(a="mouseover"===t||"pointerover"===t)||0!=(16&e)||!(c=n.relatedTarget||n.fromElement)||!er(c)&&!c[Ji])&&(l||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?er(c):null)&&(c!==(h=Yt(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=mn,g="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==t&&"pointerover"!==t||(u=Ln,g="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?a:ir(l),f=null==c?a:ir(c),(a=new u(g,p+"leave",l,n,r)).target=h,a.relatedTarget=f,g=null,er(r)===i&&((u=new u(d,p+"enter",c,n,r)).target=f,u.relatedTarget=h,g=u),h=g,l&&c)t:{for(d=c,p=0,f=u=l;f;f=Fi(f))p++;for(f=0,g=d;g;g=Fi(g))f++;for(;0<p-f;)u=Fi(u),p--;for(;0<f-p;)d=Fi(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break t;u=Fi(u),d=Fi(d)}u=null}else u=null;null!==l&&Di(s,a,l,u,!1),null!==c&&null!==h&&Di(s,h,c,u,!0)}if("select"===(l=(a=i?ir(i):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=$n;else if(qn(a))if(Jn)m=li;else{m=si;var v=oi}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=ai);switch(m&&(m=m(t,i))?Xn(s,m,n,r):(v&&v(t,a,i),"focusout"===t&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&rt(a,"number",a.value)),v=i?ir(i):window,t){case"focusin":(qn(v)||"true"===v.contentEditable)&&(yi=v,_i=i,bi=null);break;case"focusout":bi=_i=yi=null;break;case"mousedown":wi=!0;break;case"contextmenu":case"mouseup":case"dragend":wi=!1,xi(s,n,r);break;case"selectionchange":if(vi)break;case"keydown":case"keyup":xi(s,n,r)}var y;if(zn)t:{switch(t){case"compositionstart":var _="onCompositionStart";break t;case"compositionend":_="onCompositionEnd";break t;case"compositionupdate":_="onCompositionUpdate";break t}_=void 0}else Gn?Vn(t,n)&&(_="onCompositionEnd"):"keydown"===t&&229===n.keyCode&&(_="onCompositionStart");_&&(jn&&"ko"!==n.locale&&(Gn||"onCompositionStart"!==_?"onCompositionEnd"===_&&Gn&&(y=nn()):(tn="value"in(Je=r)?Je.value:Je.textContent,Gn=!0)),0<(v=zi(i,_)).length&&(_=new xn(_,t,null,n,r),s.push({event:_,listeners:v}),(y||null!==(y=Wn(n)))&&(_.data=y))),(y=Dn?function(t,e){switch(t){case"compositionend":return Wn(e);case"keypress":return 32!==e.which?null:(Un=!0,Bn);case"textInput":return(t=e.data)===Bn&&Un?null:t;default:return null}}(t,n):function(t,e){if(Gn)return"compositionend"===t||!zn&&Vn(t,e)?(t=nn(),en=tn=Je=null,Gn=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return jn&&"ko"!==e.locale?null:e.data}}(t,n))&&0<(i=zi(i,"onBeforeInput")).length&&(r=new xn("onBeforeInput","beforeinput",null,n,r),s.push({event:r,listeners:i}),r.data=y)}Ai(s,e)}))}function Ni(t,e,n){return{instance:t,listener:e,currentTarget:n}}function zi(t,e){for(var n=e+"Capture",i=[];null!==t;){var r=t,o=r.stateNode;5===r.tag&&null!==o&&(r=o,null!=(o=jt(t,n))&&i.unshift(Ni(t,o,r)),null!=(o=jt(t,e))&&i.push(Ni(t,o,r))),t=t.return}return i}function Fi(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function Di(t,e,n,i,r){for(var o=e._reactName,s=[];null!==n&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===i)break;5===a.tag&&null!==c&&(a=c,r?null!=(l=jt(n,o))&&s.unshift(Ni(n,l,a)):r||null!=(l=jt(n,o))&&s.push(Ni(n,l,a))),n=n.return}0!==s.length&&t.push({event:e,listeners:s})}function ji(){}var Bi=null,Ui=null;function Vi(t,e){switch(t){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function Wi(t,e){return"textarea"===t||"option"===t||"noscript"===t||"string"==typeof e.children||"number"==typeof e.children||"object"==typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var Gi="function"==typeof setTimeout?setTimeout:void 0,Hi="function"==typeof clearTimeout?clearTimeout:void 0;function qi(t){(1===t.nodeType||9===t.nodeType&&null!=(t=t.body))&&(t.textContent="")}function Xi(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break}return t}function Zi(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var Yi=0,Ki=Math.random().toString(36).slice(2),Qi="__reactFiber$"+Ki,$i="__reactProps$"+Ki,Ji="__reactContainer$"+Ki,tr="__reactEvents$"+Ki;function er(t){var e=t[Qi];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ji]||n[Qi]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=Zi(t);null!==t;){if(n=t[Qi])return n;t=Zi(t)}return e}n=(t=n).parentNode}return null}function nr(t){return!(t=t[Qi]||t[Ji])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function ir(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(s(33))}function rr(t){return t[$i]||null}function or(t){var e=t[tr];return void 0===e&&(e=t[tr]=new Set),e}var sr=[],ar=-1;function lr(t){return{current:t}}function cr(t){0>ar||(t.current=sr[ar],sr[ar]=null,ar--)}function ur(t,e){ar++,sr[ar]=t.current,t.current=e}var hr={},dr=lr(hr),fr=lr(!1),pr=hr;function gr(t,e){var n=t.type.contextTypes;if(!n)return hr;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r,o={};for(r in n)o[r]=e[r];return i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function mr(t){return null!=t.childContextTypes}function vr(){cr(fr),cr(dr)}function yr(t,e,n){if(dr.current!==hr)throw Error(s(168));ur(dr,e),ur(fr,n)}function _r(t,e,n){var i=t.stateNode;if(t=e.childContextTypes,"function"!=typeof i.getChildContext)return n;for(var o in i=i.getChildContext())if(!(o in t))throw Error(s(108,X(e)||"Unknown",o));return r({},n,i)}function br(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||hr,pr=dr.current,ur(dr,t),ur(fr,fr.current),!0}function wr(t,e,n){var i=t.stateNode;if(!i)throw Error(s(169));n?(t=_r(t,e,pr),i.__reactInternalMemoizedMergedChildContext=t,cr(fr),cr(dr),ur(dr,t)):cr(fr),ur(fr,n)}var xr=null,Er=null,Sr=o.unstable_runWithPriority,Pr=o.unstable_scheduleCallback,Tr=o.unstable_cancelCallback,Cr=o.unstable_shouldYield,Ar=o.unstable_requestPaint,Mr=o.unstable_now,Lr=o.unstable_getCurrentPriorityLevel,kr=o.unstable_ImmediatePriority,Or=o.unstable_UserBlockingPriority,Ir=o.unstable_NormalPriority,Rr=o.unstable_LowPriority,Nr=o.unstable_IdlePriority,zr={},Fr=void 0!==Ar?Ar:function(){},Dr=null,jr=null,Br=!1,Ur=Mr(),Vr=1e4>Ur?Mr:function(){return Mr()-Ur};function Wr(){switch(Lr()){case kr:return 99;case Or:return 98;case Ir:return 97;case Rr:return 96;case Nr:return 95;default:throw Error(s(332))}}function Gr(t){switch(t){case 99:return kr;case 98:return Or;case 97:return Ir;case 96:return Rr;case 95:return Nr;default:throw Error(s(332))}}function Hr(t,e){return t=Gr(t),Sr(t,e)}function qr(t,e,n){return t=Gr(t),Pr(t,e,n)}function Xr(){if(null!==jr){var t=jr;jr=null,Tr(t)}Zr()}function Zr(){if(!Br&&null!==Dr){Br=!0;var t=0;try{var e=Dr;Hr(99,(function(){for(;t<e.length;t++){var n=e[t];do{n=n(!0)}while(null!==n)}})),Dr=null}catch(e){throw null!==Dr&&(Dr=Dr.slice(t+1)),Pr(kr,Xr),e}finally{Br=!1}}}var Yr=w.ReactCurrentBatchConfig;function Kr(t,e){if(t&&t.defaultProps){for(var n in e=r({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}return e}var Qr=lr(null),$r=null,Jr=null,to=null;function eo(){to=Jr=$r=null}function no(t){var e=Qr.current;cr(Qr),t.type._context._currentValue=e}function io(t,e){for(;null!==t;){var n=t.alternate;if((t.childLanes&e)===e){if(null===n||(n.childLanes&e)===e)break;n.childLanes|=e}else t.childLanes|=e,null!==n&&(n.childLanes|=e);t=t.return}}function ro(t,e){$r=t,to=Jr=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!=(t.lanes&e)&&(zs=!0),t.firstContext=null)}function oo(t,e){if(to!==t&&!1!==e&&0!==e)if("number"==typeof e&&1073741823!==e||(to=t,e=1073741823),e={context:t,observedBits:e,next:null},null===Jr){if(null===$r)throw Error(s(308));Jr=e,$r.dependencies={lanes:0,firstContext:e,responders:null}}else Jr=Jr.next=e;return t._currentValue}var so=!1;function ao(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function lo(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function co(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function uo(t,e){if(null!==(t=t.updateQueue)){var n=(t=t.shared).pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}}function ho(t,e){var n=t.updateQueue,i=t.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?r=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?r=o=e:o=o.next=e}else r=o=e;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:i.shared,effects:i.effects},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function fo(t,e,n,i){var o=t.updateQueue;so=!1;var s=o.firstBaseUpdate,a=o.lastBaseUpdate,l=o.shared.pending;if(null!==l){o.shared.pending=null;var c=l,u=c.next;c.next=null,null===a?s=u:a.next=u,a=c;var h=t.alternate;if(null!==h){var d=(h=h.updateQueue).lastBaseUpdate;d!==a&&(null===d?h.firstBaseUpdate=u:d.next=u,h.lastBaseUpdate=c)}}if(null!==s){for(d=o.baseState,a=0,h=u=c=null;;){l=s.lane;var f=s.eventTime;if((i&l)===l){null!==h&&(h=h.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});t:{var p=t,g=s;switch(l=e,f=n,g.tag){case 1:if("function"==typeof(p=g.payload)){d=p.call(f,d,l);break t}d=p;break t;case 3:p.flags=-4097&p.flags|64;case 0:if(null==(l="function"==typeof(p=g.payload)?p.call(f,d,l):p))break t;d=r({},d,l);break t;case 2:so=!0}}null!==s.callback&&(t.flags|=32,null===(l=o.effects)?o.effects=[s]:l.push(s))}else f={eventTime:f,lane:l,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===h?(u=h=f,c=d):h=h.next=f,a|=l;if(null===(s=s.next)){if(null===(l=o.shared.pending))break;s=l.next,l.next=null,o.lastBaseUpdate=l,o.shared.pending=null}}null===h&&(c=d),o.baseState=c,o.firstBaseUpdate=u,o.lastBaseUpdate=h,ja|=a,t.lanes=a,t.memoizedState=d}}function po(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!=typeof r)throw Error(s(191,r));r.call(i)}}}var go=(new i.Component).refs;function mo(t,e,n,i){n=null==(n=n(i,e=t.memoizedState))?e:r({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var vo={isMounted:function(t){return!!(t=t._reactInternals)&&Yt(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=ul(),r=hl(t),o=co(i,r);o.payload=e,null!=n&&(o.callback=n),uo(t,o),dl(t,r,i)},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=ul(),r=hl(t),o=co(i,r);o.tag=1,o.payload=e,null!=n&&(o.callback=n),uo(t,o),dl(t,r,i)},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ul(),i=hl(t),r=co(n,i);r.tag=2,null!=e&&(r.callback=e),uo(t,r),dl(t,i,n)}};function yo(t,e,n,i,r,o,s){return"function"==typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(i,o,s):!(e.prototype&&e.prototype.isPureReactComponent&&hi(n,i)&&hi(r,o))}function _o(t,e,n){var i=!1,r=hr,o=e.contextType;return"object"==typeof o&&null!==o?o=oo(o):(r=mr(e)?pr:dr.current,o=(i=null!=(i=e.contextTypes))?gr(t,r):hr),e=new e(n,o),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=vo,t.stateNode=e,e._reactInternals=t,i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=o),e}function bo(t,e,n,i){t=e.state,"function"==typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,i),"function"==typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&vo.enqueueReplaceState(e,e.state,null)}function wo(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs=go,ao(t);var o=e.contextType;"object"==typeof o&&null!==o?r.context=oo(o):(o=mr(e)?pr:dr.current,r.context=gr(t,o)),fo(t,n,r,i),r.state=t.memoizedState,"function"==typeof(o=e.getDerivedStateFromProps)&&(mo(t,e,o,n),r.state=t.memoizedState),"function"==typeof e.getDerivedStateFromProps||"function"==typeof r.getSnapshotBeforeUpdate||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||(e=r.state,"function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),e!==r.state&&vo.enqueueReplaceState(r,r.state,null),fo(t,n,r,i),r.state=t.memoizedState),"function"==typeof r.componentDidMount&&(t.flags|=4)}var xo=Array.isArray;function Eo(t,e,n){if(null!==(t=n.ref)&&"function"!=typeof t&&"object"!=typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var i=n.stateNode}if(!i)throw Error(s(147,t));var r=""+t;return null!==e&&null!==e.ref&&"function"==typeof e.ref&&e.ref._stringRef===r?e.ref:(e=function(t){var e=i.refs;e===go&&(e=i.refs={}),null===t?delete e[r]:e[r]=t},e._stringRef=r,e)}if("string"!=typeof t)throw Error(s(284));if(!n._owner)throw Error(s(290,t))}return t}function So(t,e){if("textarea"!==t.type)throw Error(s(31,"[object Object]"===Object.prototype.toString.call(e)?"object with keys {"+Object.keys(e).join(", ")+"}":e))}function Po(t){function e(e,n){if(t){var i=e.lastEffect;null!==i?(i.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,i){if(!t)return null;for(;null!==i;)e(n,i),i=i.sibling;return null}function i(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(t,e){return(t=Gl(t,e)).index=0,t.sibling=null,t}function o(e,n,i){return e.index=i,t?null!==(i=e.alternate)?(i=i.index)<n?(e.flags=2,n):i:(e.flags=2,n):n}function a(e){return t&&null===e.alternate&&(e.flags=2),e}function l(t,e,n,i){return null===e||6!==e.tag?((e=Zl(n,t.mode,i)).return=t,e):((e=r(e,n)).return=t,e)}function c(t,e,n,i){return null!==e&&e.elementType===n.type?((i=r(e,n.props)).ref=Eo(t,e,n),i.return=t,i):((i=Hl(n.type,n.key,n.props,null,t.mode,i)).ref=Eo(t,e,n),i.return=t,i)}function u(t,e,n,i){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Yl(n,t.mode,i)).return=t,e):((e=r(e,n.children||[])).return=t,e)}function h(t,e,n,i,o){return null===e||7!==e.tag?((e=ql(n,t.mode,i,o)).return=t,e):((e=r(e,n)).return=t,e)}function d(t,e,n){if("string"==typeof e||"number"==typeof e)return(e=Zl(""+e,t.mode,n)).return=t,e;if("object"==typeof e&&null!==e){switch(e.$$typeof){case x:return(n=Hl(e.type,e.key,e.props,null,t.mode,n)).ref=Eo(t,null,e),n.return=t,n;case E:return(e=Yl(e,t.mode,n)).return=t,e}if(xo(e)||V(e))return(e=ql(e,t.mode,n,null)).return=t,e;So(t,e)}return null}function f(t,e,n,i){var r=null!==e?e.key:null;if("string"==typeof n||"number"==typeof n)return null!==r?null:l(t,e,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===r?n.type===S?h(t,e,n.props.children,i,r):c(t,e,n,i):null;case E:return n.key===r?u(t,e,n,i):null}if(xo(n)||V(n))return null!==r?null:h(t,e,n,i,null);So(t,n)}return null}function p(t,e,n,i,r){if("string"==typeof i||"number"==typeof i)return l(e,t=t.get(n)||null,""+i,r);if("object"==typeof i&&null!==i){switch(i.$$typeof){case x:return t=t.get(null===i.key?n:i.key)||null,i.type===S?h(e,t,i.props.children,r,i.key):c(e,t,i,r);case E:return u(e,t=t.get(null===i.key?n:i.key)||null,i,r)}if(xo(i)||V(i))return h(e,t=t.get(n)||null,i,r,null);So(e,i)}return null}function g(r,s,a,l){for(var c=null,u=null,h=s,g=s=0,m=null;null!==h&&g<a.length;g++){h.index>g?(m=h,h=null):m=h.sibling;var v=f(r,h,a[g],l);if(null===v){null===h&&(h=m);break}t&&h&&null===v.alternate&&e(r,h),s=o(v,s,g),null===u?c=v:u.sibling=v,u=v,h=m}if(g===a.length)return n(r,h),c;if(null===h){for(;g<a.length;g++)null!==(h=d(r,a[g],l))&&(s=o(h,s,g),null===u?c=h:u.sibling=h,u=h);return c}for(h=i(r,h);g<a.length;g++)null!==(m=p(h,r,g,a[g],l))&&(t&&null!==m.alternate&&h.delete(null===m.key?g:m.key),s=o(m,s,g),null===u?c=m:u.sibling=m,u=m);return t&&h.forEach((function(t){return e(r,t)})),c}function m(r,a,l,c){var u=V(l);if("function"!=typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var h=u=null,g=a,m=a=0,v=null,y=l.next();null!==g&&!y.done;m++,y=l.next()){g.index>m?(v=g,g=null):v=g.sibling;var _=f(r,g,y.value,c);if(null===_){null===g&&(g=v);break}t&&g&&null===_.alternate&&e(r,g),a=o(_,a,m),null===h?u=_:h.sibling=_,h=_,g=v}if(y.done)return n(r,g),u;if(null===g){for(;!y.done;m++,y=l.next())null!==(y=d(r,y.value,c))&&(a=o(y,a,m),null===h?u=y:h.sibling=y,h=y);return u}for(g=i(r,g);!y.done;m++,y=l.next())null!==(y=p(g,r,m,y.value,c))&&(t&&null!==y.alternate&&g.delete(null===y.key?m:y.key),a=o(y,a,m),null===h?u=y:h.sibling=y,h=y);return t&&g.forEach((function(t){return e(r,t)})),u}return function(t,i,o,l){var c="object"==typeof o&&null!==o&&o.type===S&&null===o.key;c&&(o=o.props.children);var u="object"==typeof o&&null!==o;if(u)switch(o.$$typeof){case x:t:{for(u=o.key,c=i;null!==c;){if(c.key===u){if(7===c.tag){if(o.type===S){n(t,c.sibling),(i=r(c,o.props.children)).return=t,t=i;break t}}else if(c.elementType===o.type){n(t,c.sibling),(i=r(c,o.props)).ref=Eo(t,c,o),i.return=t,t=i;break t}n(t,c);break}e(t,c),c=c.sibling}o.type===S?((i=ql(o.props.children,t.mode,l,o.key)).return=t,t=i):((l=Hl(o.type,o.key,o.props,null,t.mode,l)).ref=Eo(t,i,o),l.return=t,t=l)}return a(t);case E:t:{for(c=o.key;null!==i;){if(i.key===c){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){n(t,i.sibling),(i=r(i,o.children||[])).return=t,t=i;break t}n(t,i);break}e(t,i),i=i.sibling}(i=Yl(o,t.mode,l)).return=t,t=i}return a(t)}if("string"==typeof o||"number"==typeof o)return o=""+o,null!==i&&6===i.tag?(n(t,i.sibling),(i=r(i,o)).return=t,t=i):(n(t,i),(i=Zl(o,t.mode,l)).return=t,t=i),a(t);if(xo(o))return g(t,i,o,l);if(V(o))return m(t,i,o,l);if(u&&So(t,o),void 0===o&&!c)switch(t.tag){case 1:case 22:case 0:case 11:case 15:throw Error(s(152,X(t.type)||"Component"))}return n(t,i)}}var To=Po(!0),Co=Po(!1),Ao={},Mo=lr(Ao),Lo=lr(Ao),ko=lr(Ao);function Oo(t){if(t===Ao)throw Error(s(174));return t}function Io(t,e){switch(ur(ko,e),ur(Lo,t),ur(Mo,Ao),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ft(null,"");break;default:e=ft(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}cr(Mo),ur(Mo,e)}function Ro(){cr(Mo),cr(Lo),cr(ko)}function No(t){Oo(ko.current);var e=Oo(Mo.current),n=ft(e,t.type);e!==n&&(ur(Lo,t),ur(Mo,n))}function zo(t){Lo.current===t&&(cr(Mo),cr(Lo))}var Fo=lr(0);function Do(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!=(64&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var jo=null,Bo=null,Uo=!1;function Vo(t,e){var n=Vl(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=e,n.return=t,n.flags=8,null!==t.lastEffect?(t.lastEffect.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n}function Wo(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,!0);default:return!1}}function Go(t){if(Uo){var e=Bo;if(e){var n=e;if(!Wo(t,e)){if(!(e=Xi(n.nextSibling))||!Wo(t,e))return t.flags=-1025&t.flags|2,Uo=!1,void(jo=t);Vo(jo,n)}jo=t,Bo=Xi(e.firstChild)}else t.flags=-1025&t.flags|2,Uo=!1,jo=t}}function Ho(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;jo=t}function qo(t){if(t!==jo)return!1;if(!Uo)return Ho(t),Uo=!0,!1;var e=t.type;if(5!==t.tag||"head"!==e&&"body"!==e&&!Wi(e,t.memoizedProps))for(e=Bo;e;)Vo(t,e),e=Xi(e.nextSibling);if(Ho(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(s(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){Bo=Xi(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}Bo=null}}else Bo=jo?Xi(t.stateNode.nextSibling):null;return!0}function Xo(){Bo=jo=null,Uo=!1}var Zo=[];function Yo(){for(var t=0;t<Zo.length;t++)Zo[t]._workInProgressVersionPrimary=null;Zo.length=0}var Ko=w.ReactCurrentDispatcher,Qo=w.ReactCurrentBatchConfig,$o=0,Jo=null,ts=null,es=null,ns=!1,is=!1;function rs(){throw Error(s(321))}function os(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ci(t[n],e[n]))return!1;return!0}function ss(t,e,n,i,r,o){if($o=o,Jo=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ko.current=null===t||null===t.memoizedState?Os:Is,t=n(i,r),is){o=0;do{if(is=!1,!(25>o))throw Error(s(301));o+=1,es=ts=null,e.updateQueue=null,Ko.current=Rs,t=n(i,r)}while(is)}if(Ko.current=ks,e=null!==ts&&null!==ts.next,$o=0,es=ts=Jo=null,ns=!1,e)throw Error(s(300));return t}function as(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===es?Jo.memoizedState=es=t:es=es.next=t,es}function ls(){if(null===ts){var t=Jo.alternate;t=null!==t?t.memoizedState:null}else t=ts.next;var e=null===es?Jo.memoizedState:es.next;if(null!==e)es=e,ts=t;else{if(null===t)throw Error(s(310));t={memoizedState:(ts=t).memoizedState,baseState:ts.baseState,baseQueue:ts.baseQueue,queue:ts.queue,next:null},null===es?Jo.memoizedState=es=t:es=es.next=t}return es}function cs(t,e){return"function"==typeof e?e(t):e}function us(t){var e=ls(),n=e.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=t;var i=ts,r=i.baseQueue,o=n.pending;if(null!==o){if(null!==r){var a=r.next;r.next=o.next,o.next=a}i.baseQueue=r=o,n.pending=null}if(null!==r){r=r.next,i=i.baseState;var l=a=o=null,c=r;do{var u=c.lane;if(($o&u)===u)null!==l&&(l=l.next={lane:0,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null}),i=c.eagerReducer===t?c.eagerState:t(i,c.action);else{var h={lane:u,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null};null===l?(a=l=h,o=i):l=l.next=h,Jo.lanes|=u,ja|=u}c=c.next}while(null!==c&&c!==r);null===l?o=i:l.next=a,ci(i,e.memoizedState)||(zs=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,n.lastRenderedState=i}return[e.memoizedState,n.dispatch]}function hs(t){var e=ls(),n=e.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,o=e.memoizedState;if(null!==r){n.pending=null;var a=r=r.next;do{o=t(o,a.action),a=a.next}while(a!==r);ci(o,e.memoizedState)||(zs=!0),e.memoizedState=o,null===e.baseQueue&&(e.baseState=o),n.lastRenderedState=o}return[o,i]}function ds(t,e,n){var i=e._getVersion;i=i(e._source);var r=e._workInProgressVersionPrimary;if(null!==r?t=r===i:(t=t.mutableReadLanes,(t=($o&t)===t)&&(e._workInProgressVersionPrimary=i,Zo.push(e))),t)return n(e._source);throw Zo.push(e),Error(s(350))}function fs(t,e,n,i){var r=ka;if(null===r)throw Error(s(349));var o=e._getVersion,a=o(e._source),l=Ko.current,c=l.useState((function(){return ds(r,e,n)})),u=c[1],h=c[0];c=es;var d=t.memoizedState,f=d.refs,p=f.getSnapshot,g=d.source;d=d.subscribe;var m=Jo;return t.memoizedState={refs:f,source:e,subscribe:i},l.useEffect((function(){f.getSnapshot=n,f.setSnapshot=u;var t=o(e._source);if(!ci(a,t)){t=n(e._source),ci(h,t)||(u(t),t=hl(m),r.mutableReadLanes|=t&r.pendingLanes),t=r.mutableReadLanes,r.entangledLanes|=t;for(var i=r.entanglements,s=t;0<s;){var l=31-We(s),c=1<<l;i[l]|=t,s&=~c}}}),[n,e,i]),l.useEffect((function(){return i(e._source,(function(){var t=f.getSnapshot,n=f.setSnapshot;try{n(t(e._source));var i=hl(m);r.mutableReadLanes|=i&r.pendingLanes}catch(t){n((function(){throw t}))}}))}),[e,i]),ci(p,n)&&ci(g,e)&&ci(d,i)||((t={pending:null,dispatch:null,lastRenderedReducer:cs,lastRenderedState:h}).dispatch=u=Ls.bind(null,Jo,t),c.queue=t,c.baseQueue=null,h=ds(r,e,n),c.memoizedState=c.baseState=h),h}function ps(t,e,n){return fs(ls(),t,e,n)}function gs(t){var e=as();return"function"==typeof t&&(t=t()),e.memoizedState=e.baseState=t,t=(t=e.queue={pending:null,dispatch:null,lastRenderedReducer:cs,lastRenderedState:t}).dispatch=Ls.bind(null,Jo,t),[e.memoizedState,t]}function ms(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},null===(e=Jo.updateQueue)?(e={lastEffect:null},Jo.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t),t}function vs(t){return t={current:t},as().memoizedState=t}function ys(){return ls().memoizedState}function _s(t,e,n,i){var r=as();Jo.flags|=t,r.memoizedState=ms(1|e,n,void 0,void 0===i?null:i)}function bs(t,e,n,i){var r=ls();i=void 0===i?null:i;var o=void 0;if(null!==ts){var s=ts.memoizedState;if(o=s.destroy,null!==i&&os(i,s.deps))return void ms(e,n,o,i)}Jo.flags|=t,r.memoizedState=ms(1|e,n,o,i)}function ws(t,e){return _s(516,4,t,e)}function xs(t,e){return bs(516,4,t,e)}function Es(t,e){return bs(4,2,t,e)}function Ss(t,e){return"function"==typeof e?(t=t(),e(t),function(){e(null)}):null!=e?(t=t(),e.current=t,function(){e.current=null}):void 0}function Ps(t,e,n){return n=null!=n?n.concat([t]):null,bs(4,2,Ss.bind(null,e,t),n)}function Ts(){}function Cs(t,e){var n=ls();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&os(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function As(t,e){var n=ls();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&os(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function Ms(t,e){var n=Wr();Hr(98>n?98:n,(function(){t(!0)})),Hr(97<n?97:n,(function(){var n=Qo.transition;Qo.transition=1;try{t(!1),e()}finally{Qo.transition=n}}))}function Ls(t,e,n){var i=ul(),r=hl(t),o={lane:r,action:n,eagerReducer:null,eagerState:null,next:null},s=e.pending;if(null===s?o.next=o:(o.next=s.next,s.next=o),e.pending=o,s=t.alternate,t===Jo||null!==s&&s===Jo)is=ns=!0;else{if(0===t.lanes&&(null===s||0===s.lanes)&&null!==(s=e.lastRenderedReducer))try{var a=e.lastRenderedState,l=s(a,n);if(o.eagerReducer=s,o.eagerState=l,ci(l,a))return}catch(t){}dl(t,r,i)}}var ks={readContext:oo,useCallback:rs,useContext:rs,useEffect:rs,useImperativeHandle:rs,useLayoutEffect:rs,useMemo:rs,useReducer:rs,useRef:rs,useState:rs,useDebugValue:rs,useDeferredValue:rs,useTransition:rs,useMutableSource:rs,useOpaqueIdentifier:rs,unstable_isNewReconciler:!1},Os={readContext:oo,useCallback:function(t,e){return as().memoizedState=[t,void 0===e?null:e],t},useContext:oo,useEffect:ws,useImperativeHandle:function(t,e,n){return n=null!=n?n.concat([t]):null,_s(4,2,Ss.bind(null,e,t),n)},useLayoutEffect:function(t,e){return _s(4,2,t,e)},useMemo:function(t,e){var n=as();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=as();return e=void 0!==n?n(e):e,i.memoizedState=i.baseState=e,t=(t=i.queue={pending:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:e}).dispatch=Ls.bind(null,Jo,t),[i.memoizedState,t]},useRef:vs,useState:gs,useDebugValue:Ts,useDeferredValue:function(t){var e=gs(t),n=e[0],i=e[1];return ws((function(){var e=Qo.transition;Qo.transition=1;try{i(t)}finally{Qo.transition=e}}),[t]),n},useTransition:function(){var t=gs(!1),e=t[0];return vs(t=Ms.bind(null,t[1])),[t,e]},useMutableSource:function(t,e,n){var i=as();return i.memoizedState={refs:{getSnapshot:e,setSnapshot:null},source:t,subscribe:n},fs(i,t,e,n)},useOpaqueIdentifier:function(){if(Uo){var t=!1,e=function(t){return{$$typeof:N,toString:t,valueOf:t}}((function(){throw t||(t=!0,n("r:"+(Yi++).toString(36))),Error(s(355))})),n=gs(e)[1];return 0==(2&Jo.mode)&&(Jo.flags|=516,ms(5,(function(){n("r:"+(Yi++).toString(36))}),void 0,null)),e}return gs(e="r:"+(Yi++).toString(36)),e},unstable_isNewReconciler:!1},Is={readContext:oo,useCallback:Cs,useContext:oo,useEffect:xs,useImperativeHandle:Ps,useLayoutEffect:Es,useMemo:As,useReducer:us,useRef:ys,useState:function(){return us(cs)},useDebugValue:Ts,useDeferredValue:function(t){var e=us(cs),n=e[0],i=e[1];return xs((function(){var e=Qo.transition;Qo.transition=1;try{i(t)}finally{Qo.transition=e}}),[t]),n},useTransition:function(){var t=us(cs)[0];return[ys().current,t]},useMutableSource:ps,useOpaqueIdentifier:function(){return us(cs)[0]},unstable_isNewReconciler:!1},Rs={readContext:oo,useCallback:Cs,useContext:oo,useEffect:xs,useImperativeHandle:Ps,useLayoutEffect:Es,useMemo:As,useReducer:hs,useRef:ys,useState:function(){return hs(cs)},useDebugValue:Ts,useDeferredValue:function(t){var e=hs(cs),n=e[0],i=e[1];return xs((function(){var e=Qo.transition;Qo.transition=1;try{i(t)}finally{Qo.transition=e}}),[t]),n},useTransition:function(){var t=hs(cs)[0];return[ys().current,t]},useMutableSource:ps,useOpaqueIdentifier:function(){return hs(cs)[0]},unstable_isNewReconciler:!1},Ns=w.ReactCurrentOwner,zs=!1;function Fs(t,e,n,i){e.child=null===t?Co(e,null,n,i):To(e,t.child,n,i)}function Ds(t,e,n,i,r){n=n.render;var o=e.ref;return ro(e,r),i=ss(t,e,n,i,o,r),null===t||zs?(e.flags|=1,Fs(t,e,i,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-517,t.lanes&=~r,ia(t,e,r))}function js(t,e,n,i,r,o){if(null===t){var s=n.type;return"function"!=typeof s||Wl(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Hl(n.type,null,i,e,e.mode,o)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=s,Bs(t,e,s,i,r,o))}return s=t.child,0==(r&o)&&(r=s.memoizedProps,(n=null!==(n=n.compare)?n:hi)(r,i)&&t.ref===e.ref)?ia(t,e,o):(e.flags|=1,(t=Gl(s,i)).ref=e.ref,t.return=e,e.child=t)}function Bs(t,e,n,i,r,o){if(null!==t&&hi(t.memoizedProps,i)&&t.ref===e.ref){if(zs=!1,0==(o&r))return e.lanes=t.lanes,ia(t,e,o);0!=(16384&t.flags)&&(zs=!0)}return Ws(t,e,n,i,o)}function Us(t,e,n){var i=e.pendingProps,r=i.children,o=null!==t?t.memoizedState:null;if("hidden"===i.mode||"unstable-defer-without-hiding"===i.mode)if(0==(4&e.mode))e.memoizedState={baseLanes:0},bl(0,n);else{if(0==(1073741824&n))return t=null!==o?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t},bl(0,t),null;e.memoizedState={baseLanes:0},bl(0,null!==o?o.baseLanes:n)}else null!==o?(i=o.baseLanes|n,e.memoizedState=null):i=n,bl(0,i);return Fs(t,e,r,n),e.child}function Vs(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.flags|=128)}function Ws(t,e,n,i,r){var o=mr(n)?pr:dr.current;return o=gr(e,o),ro(e,r),n=ss(t,e,n,i,o,r),null===t||zs?(e.flags|=1,Fs(t,e,n,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-517,t.lanes&=~r,ia(t,e,r))}function Gs(t,e,n,i,r){if(mr(n)){var o=!0;br(e)}else o=!1;if(ro(e,r),null===e.stateNode)null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),_o(e,n,i),wo(e,n,i,r),i=!0;else if(null===t){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,c=n.contextType;c="object"==typeof c&&null!==c?oo(c):gr(e,c=mr(n)?pr:dr.current);var u=n.getDerivedStateFromProps,h="function"==typeof u||"function"==typeof s.getSnapshotBeforeUpdate;h||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==i||l!==c)&&bo(e,s,i,c),so=!1;var d=e.memoizedState;s.state=d,fo(e,i,s,r),l=e.memoizedState,a!==i||d!==l||fr.current||so?("function"==typeof u&&(mo(e,n,u,i),l=e.memoizedState),(a=so||yo(e,n,a,i,d,l,c))?(h||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(e.flags|=4)):("function"==typeof s.componentDidMount&&(e.flags|=4),e.memoizedProps=i,e.memoizedState=l),s.props=i,s.state=l,s.context=c,i=a):("function"==typeof s.componentDidMount&&(e.flags|=4),i=!1)}else{s=e.stateNode,lo(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Kr(e.type,a),s.props=c,h=e.pendingProps,d=s.context,l="object"==typeof(l=n.contextType)&&null!==l?oo(l):gr(e,l=mr(n)?pr:dr.current);var f=n.getDerivedStateFromProps;(u="function"==typeof f||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==h||d!==l)&&bo(e,s,i,l),so=!1,d=e.memoizedState,s.state=d,fo(e,i,s,r);var p=e.memoizedState;a!==h||d!==p||fr.current||so?("function"==typeof f&&(mo(e,n,f,i),p=e.memoizedState),(c=so||yo(e,n,c,i,d,p,l))?(u||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(i,p,l),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(i,p,l)),"function"==typeof s.componentDidUpdate&&(e.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(e.flags|=256)):("function"!=typeof s.componentDidUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=256),e.memoizedProps=i,e.memoizedState=p),s.props=i,s.state=p,s.context=l,i=c):("function"!=typeof s.componentDidUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=256),i=!1)}return Hs(t,e,n,i,o,r)}function Hs(t,e,n,i,r,o){Vs(t,e);var s=0!=(64&e.flags);if(!i&&!s)return r&&wr(e,n,!1),ia(t,e,o);i=e.stateNode,Ns.current=e;var a=s&&"function"!=typeof n.getDerivedStateFromError?null:i.render();return e.flags|=1,null!==t&&s?(e.child=To(e,t.child,null,o),e.child=To(e,null,a,o)):Fs(t,e,a,o),e.memoizedState=i.state,r&&wr(e,n,!0),e.child}function qs(t){var e=t.stateNode;e.pendingContext?yr(0,e.pendingContext,e.pendingContext!==e.context):e.context&&yr(0,e.context,!1),Io(t,e.containerInfo)}var Xs,Zs,Ys,Ks,Qs={dehydrated:null,retryLane:0};function $s(t,e,n){var i,r=e.pendingProps,o=Fo.current,s=!1;return(i=0!=(64&e.flags))||(i=(null===t||null!==t.memoizedState)&&0!=(2&o)),i?(s=!0,e.flags&=-65):null!==t&&null===t.memoizedState||void 0===r.fallback||!0===r.unstable_avoidThisFallback||(o|=1),ur(Fo,1&o),null===t?(void 0!==r.fallback&&Go(e),t=r.children,o=r.fallback,s?(t=Js(e,t,o,n),e.child.memoizedState={baseLanes:n},e.memoizedState=Qs,t):"number"==typeof r.unstable_expectedLoadTime?(t=Js(e,t,o,n),e.child.memoizedState={baseLanes:n},e.memoizedState=Qs,e.lanes=33554432,t):((n=Xl({mode:"visible",children:t},e.mode,n,null)).return=e,e.child=n)):(t.memoizedState,s?(r=function(t,e,n,i,r){var o=e.mode,s=t.child;t=s.sibling;var a={mode:"hidden",children:n};return 0==(2&o)&&e.child!==s?((n=e.child).childLanes=0,n.pendingProps=a,null!==(s=n.lastEffect)?(e.firstEffect=n.firstEffect,e.lastEffect=s,s.nextEffect=null):e.firstEffect=e.lastEffect=null):n=Gl(s,a),null!==t?i=Gl(t,i):(i=ql(i,o,r,null)).flags|=2,i.return=e,n.return=e,n.sibling=i,e.child=n,i}(t,e,r.children,r.fallback,n),s=e.child,o=t.child.memoizedState,s.memoizedState=null===o?{baseLanes:n}:{baseLanes:o.baseLanes|n},s.childLanes=t.childLanes&~n,e.memoizedState=Qs,r):(n=function(t,e,n,i){var r=t.child;return t=r.sibling,n=Gl(r,{mode:"visible",children:n}),0==(2&e.mode)&&(n.lanes=i),n.return=e,n.sibling=null,null!==t&&(t.nextEffect=null,t.flags=8,e.firstEffect=e.lastEffect=t),e.child=n}(t,e,r.children,n),e.memoizedState=null,n))}function Js(t,e,n,i){var r=t.mode,o=t.child;return e={mode:"hidden",children:e},0==(2&r)&&null!==o?(o.childLanes=0,o.pendingProps=e):o=Xl(e,r,0,null),n=ql(n,r,i,null),o.return=t,n.return=t,o.sibling=n,t.child=o,n}function ta(t,e){t.lanes|=e;var n=t.alternate;null!==n&&(n.lanes|=e),io(t.return,e)}function ea(t,e,n,i,r,o){var s=t.memoizedState;null===s?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r,lastEffect:o}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r,s.lastEffect=o)}function na(t,e,n){var i=e.pendingProps,r=i.revealOrder,o=i.tail;if(Fs(t,e,i.children,n),0!=(2&(i=Fo.current)))i=1&i|2,e.flags|=64;else{if(null!==t&&0!=(64&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&ta(t,n);else if(19===t.tag)ta(t,n);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(ur(Fo,i),0==(2&e.mode))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;null!==n;)null!==(t=n.alternate)&&null===Do(t)&&(r=n),n=n.sibling;null===(n=r)?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),ea(e,!1,r,n,o,e.lastEffect);break;case"backwards":for(n=null,r=e.child,e.child=null;null!==r;){if(null!==(t=r.alternate)&&null===Do(t)){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}ea(e,!0,n,null,o,e.lastEffect);break;case"together":ea(e,!1,null,null,void 0,e.lastEffect);break;default:e.memoizedState=null}return e.child}function ia(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),ja|=e.lanes,0!=(n&e.childLanes)){if(null!==t&&e.child!==t.child)throw Error(s(153));if(null!==e.child){for(n=Gl(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Gl(t,t.pendingProps)).return=e;n.sibling=null}return e.child}return null}function ra(t,e){if(!Uo)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?e||null===t.tail?t.tail=null:t.tail.sibling=null:i.sibling=null}}function oa(t,e,n){var i=e.pendingProps;switch(e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return mr(e.type)&&vr(),null;case 3:return Ro(),cr(fr),cr(dr),Yo(),(i=e.stateNode).pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==t&&null!==t.child||(qo(e)?e.flags|=4:i.hydrate||(e.flags|=256)),Zs(e),null;case 5:zo(e);var o=Oo(ko.current);if(n=e.type,null!==t&&null!=e.stateNode)Ys(t,e,n,i,o),t.ref!==e.ref&&(e.flags|=128);else{if(!i){if(null===e.stateNode)throw Error(s(166));return null}if(t=Oo(Mo.current),qo(e)){i=e.stateNode,n=e.type;var a=e.memoizedProps;switch(i[Qi]=e,i[$i]=a,n){case"dialog":Mi("cancel",i),Mi("close",i);break;case"iframe":case"object":case"embed":Mi("load",i);break;case"video":case"audio":for(t=0;t<Pi.length;t++)Mi(Pi[t],i);break;case"source":Mi("error",i);break;case"img":case"image":case"link":Mi("error",i),Mi("load",i);break;case"details":Mi("toggle",i);break;case"input":tt(i,a),Mi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!a.multiple},Mi("invalid",i);break;case"textarea":lt(i,a),Mi("invalid",i)}for(var c in Et(n,a),t=null,a)a.hasOwnProperty(c)&&(o=a[c],"children"===c?"string"==typeof o?i.textContent!==o&&(t=["children",o]):"number"==typeof o&&i.textContent!==""+o&&(t=["children",""+o]):l.hasOwnProperty(c)&&null!=o&&"onScroll"===c&&Mi("scroll",i));switch(n){case"input":K(i),it(i,a,!0);break;case"textarea":K(i),ut(i);break;case"select":case"option":break;default:"function"==typeof a.onClick&&(i.onclick=ji)}i=t,e.updateQueue=i,null!==i&&(e.flags|=4)}else{switch(c=9===o.nodeType?o:o.ownerDocument,t===ht.html&&(t=dt(n)),t===ht.html?"script"===n?((t=c.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"==typeof i.is?t=c.createElement(n,{is:i.is}):(t=c.createElement(n),"select"===n&&(c=t,i.multiple?c.multiple=!0:i.size&&(c.size=i.size))):t=c.createElementNS(t,n),t[Qi]=e,t[$i]=i,Xs(t,e,!1,!1),e.stateNode=t,c=St(n,i),n){case"dialog":Mi("cancel",t),Mi("close",t),o=i;break;case"iframe":case"object":case"embed":Mi("load",t),o=i;break;case"video":case"audio":for(o=0;o<Pi.length;o++)Mi(Pi[o],t);o=i;break;case"source":Mi("error",t),o=i;break;case"img":case"image":case"link":Mi("error",t),Mi("load",t),o=i;break;case"details":Mi("toggle",t),o=i;break;case"input":tt(t,i),o=J(t,i),Mi("invalid",t);break;case"option":o=ot(t,i);break;case"select":t._wrapperState={wasMultiple:!!i.multiple},o=r({},i,{value:void 0}),Mi("invalid",t);break;case"textarea":lt(t,i),o=at(t,i),Mi("invalid",t);break;default:o=i}Et(n,o);var u=o;for(a in u)if(u.hasOwnProperty(a)){var h=u[a];"style"===a?wt(t,h):"dangerouslySetInnerHTML"===a?null!=(h=h?h.__html:void 0)&&mt(t,h):"children"===a?"string"==typeof h?("textarea"!==n||""!==h)&&vt(t,h):"number"==typeof h&&vt(t,""+h):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(l.hasOwnProperty(a)?null!=h&&"onScroll"===a&&Mi("scroll",t):null!=h&&b(t,a,h,c))}switch(n){case"input":K(t),it(t,i,!1);break;case"textarea":K(t),ut(t);break;case"option":null!=i.value&&t.setAttribute("value",""+Z(i.value));break;case"select":t.multiple=!!i.multiple,null!=(a=i.value)?st(t,!!i.multiple,a,!1):null!=i.defaultValue&&st(t,!!i.multiple,i.defaultValue,!0);break;default:"function"==typeof o.onClick&&(t.onclick=ji)}Vi(n,i)&&(e.flags|=4)}null!==e.ref&&(e.flags|=128)}return null;case 6:if(t&&null!=e.stateNode)Ks(t,e,t.memoizedProps,i);else{if("string"!=typeof i&&null===e.stateNode)throw Error(s(166));n=Oo(ko.current),Oo(Mo.current),qo(e)?(i=e.stateNode,n=e.memoizedProps,i[Qi]=e,i.nodeValue!==n&&(e.flags|=4)):((i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[Qi]=e,e.stateNode=i)}return null;case 13:return cr(Fo),i=e.memoizedState,0!=(64&e.flags)?(e.lanes=n,e):(i=null!==i,n=!1,null===t?void 0!==e.memoizedProps.fallback&&qo(e):n=null!==t.memoizedState,i&&!n&&0!=(2&e.mode)&&(null===t&&!0!==e.memoizedProps.unstable_avoidThisFallback||0!=(1&Fo.current)?0===za&&(za=3):(0!==za&&3!==za||(za=4),null===ka||0==(134217727&ja)&&0==(134217727&Ba)||ml(ka,Ia))),(i||n)&&(e.flags|=4),null);case 4:return Ro(),Zs(e),null===t&&ki(e.stateNode.containerInfo),null;case 10:return no(e),null;case 19:if(cr(Fo),null===(i=e.memoizedState))return null;if(a=0!=(64&e.flags),null===(c=i.rendering))if(a)ra(i,!1);else{if(0!==za||null!==t&&0!=(64&t.flags))for(t=e.child;null!==t;){if(null!==(c=Do(t))){for(e.flags|=64,ra(i,!1),null!==(a=c.updateQueue)&&(e.updateQueue=a,e.flags|=4),null===i.lastEffect&&(e.firstEffect=null),e.lastEffect=i.lastEffect,i=n,n=e.child;null!==n;)t=i,(a=n).flags&=2,a.nextEffect=null,a.firstEffect=null,a.lastEffect=null,null===(c=a.alternate)?(a.childLanes=0,a.lanes=t,a.child=null,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=c.childLanes,a.lanes=c.lanes,a.child=c.child,a.memoizedProps=c.memoizedProps,a.memoizedState=c.memoizedState,a.updateQueue=c.updateQueue,a.type=c.type,t=c.dependencies,a.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ur(Fo,1&Fo.current|2),e.child}t=t.sibling}null!==i.tail&&Vr()>Ga&&(e.flags|=64,a=!0,ra(i,!1),e.lanes=33554432)}else{if(!a)if(null!==(t=Do(c))){if(e.flags|=64,a=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.flags|=4),ra(i,!0),null===i.tail&&"hidden"===i.tailMode&&!c.alternate&&!Uo)return null!==(e=e.lastEffect=i.lastEffect)&&(e.nextEffect=null),null}else 2*Vr()-i.renderingStartTime>Ga&&1073741824!==n&&(e.flags|=64,a=!0,ra(i,!1),e.lanes=33554432);i.isBackwards?(c.sibling=e.child,e.child=c):(null!==(n=i.last)?n.sibling=c:e.child=c,i.last=c)}return null!==i.tail?(n=i.tail,i.rendering=n,i.tail=n.sibling,i.lastEffect=e.lastEffect,i.renderingStartTime=Vr(),n.sibling=null,e=Fo.current,ur(Fo,a?1&e|2:1&e),n):null;case 23:case 24:return wl(),null!==t&&null!==t.memoizedState!=(null!==e.memoizedState)&&"unstable-defer-without-hiding"!==i.mode&&(e.flags|=4),null}throw Error(s(156,e.tag))}function sa(t){switch(t.tag){case 1:mr(t.type)&&vr();var e=t.flags;return 4096&e?(t.flags=-4097&e|64,t):null;case 3:if(Ro(),cr(fr),cr(dr),Yo(),0!=(64&(e=t.flags)))throw Error(s(285));return t.flags=-4097&e|64,t;case 5:return zo(t),null;case 13:return cr(Fo),4096&(e=t.flags)?(t.flags=-4097&e|64,t):null;case 19:return cr(Fo),null;case 4:return Ro(),null;case 10:return no(t),null;case 23:case 24:return wl(),null;default:return null}}function aa(t,e){try{var n="",i=e;do{n+=q(i),i=i.return}while(i);var r=n}catch(t){r="\nError generating stack: "+t.message+"\n"+t.stack}return{value:t,source:e,stack:r}}function la(t,e){try{console.error(e.value)}catch(t){setTimeout((function(){throw t}))}}Xs=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Zs=function(){},Ys=function(t,e,n,i){var o=t.memoizedProps;if(o!==i){t=e.stateNode,Oo(Mo.current);var s,a=null;switch(n){case"input":o=J(t,o),i=J(t,i),a=[];break;case"option":o=ot(t,o),i=ot(t,i),a=[];break;case"select":o=r({},o,{value:void 0}),i=r({},i,{value:void 0}),a=[];break;case"textarea":o=at(t,o),i=at(t,i),a=[];break;default:"function"!=typeof o.onClick&&"function"==typeof i.onClick&&(t.onclick=ji)}for(h in Et(n,i),n=null,o)if(!i.hasOwnProperty(h)&&o.hasOwnProperty(h)&&null!=o[h])if("style"===h){var c=o[h];for(s in c)c.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==h&&"children"!==h&&"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&"autoFocus"!==h&&(l.hasOwnProperty(h)?a||(a=[]):(a=a||[]).push(h,null));for(h in i){var u=i[h];if(c=null!=o?o[h]:void 0,i.hasOwnProperty(h)&&u!==c&&(null!=u||null!=c))if("style"===h)if(c){for(s in c)!c.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in u)u.hasOwnProperty(s)&&c[s]!==u[s]&&(n||(n={}),n[s]=u[s])}else n||(a||(a=[]),a.push(h,n)),n=u;else"dangerouslySetInnerHTML"===h?(u=u?u.__html:void 0,c=c?c.__html:void 0,null!=u&&c!==u&&(a=a||[]).push(h,u)):"children"===h?"string"!=typeof u&&"number"!=typeof u||(a=a||[]).push(h,""+u):"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&(l.hasOwnProperty(h)?(null!=u&&"onScroll"===h&&Mi("scroll",t),a||c===u||(a=[])):"object"==typeof u&&null!==u&&u.$$typeof===N?u.toString():(a=a||[]).push(h,u))}n&&(a=a||[]).push("style",n);var h=a;(e.updateQueue=h)&&(e.flags|=4)}},Ks=function(t,e,n,i){n!==i&&(e.flags|=4)};var ca="function"==typeof WeakMap?WeakMap:Map;function ua(t,e,n){(n=co(-1,n)).tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){Za||(Za=!0,Ya=i),la(0,e)},n}function ha(t,e,n){(n=co(-1,n)).tag=3;var i=t.type.getDerivedStateFromError;if("function"==typeof i){var r=e.value;n.payload=function(){return la(0,e),i(r)}}var o=t.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(n.callback=function(){"function"!=typeof i&&(null===Ka?Ka=new Set([this]):Ka.add(this),la(0,e));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),n}var da="function"==typeof WeakSet?WeakSet:Set;function fa(t){var e=t.ref;if(null!==e)if("function"==typeof e)try{e(null)}catch(e){Dl(t,e)}else e.current=null}function pa(t,e){switch(e.tag){case 0:case 11:case 15:case 22:case 5:case 6:case 4:case 17:return;case 1:if(256&e.flags&&null!==t){var n=t.memoizedProps,i=t.memoizedState;e=(t=e.stateNode).getSnapshotBeforeUpdate(e.elementType===e.type?n:Kr(e.type,n),i),t.__reactInternalSnapshotBeforeUpdate=e}return;case 3:return void(256&e.flags&&qi(e.stateNode.containerInfo))}throw Error(s(163))}function ga(t,e,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(e=null!==(e=n.updateQueue)?e.lastEffect:null)){t=e=e.next;do{if(3==(3&t.tag)){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}if(null!==(e=null!==(e=n.updateQueue)?e.lastEffect:null)){t=e=e.next;do{var r=t;i=r.next,0!=(4&(r=r.tag))&&0!=(1&r)&&(Nl(n,t),Rl(n,t)),t=i}while(t!==e)}return;case 1:return t=n.stateNode,4&n.flags&&(null===e?t.componentDidMount():(i=n.elementType===n.type?e.memoizedProps:Kr(n.type,e.memoizedProps),t.componentDidUpdate(i,e.memoizedState,t.__reactInternalSnapshotBeforeUpdate))),void(null!==(e=n.updateQueue)&&po(n,e,t));case 3:if(null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 5:case 1:t=n.child.stateNode}po(n,e,t)}return;case 5:return t=n.stateNode,void(null===e&&4&n.flags&&Vi(n.type,n.memoizedProps)&&t.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:case 23:case 24:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&we(n)))))}throw Error(s(163))}function ma(t,e){for(var n=t;;){if(5===n.tag){var i=n.stateNode;if(e)"function"==typeof(i=i.style).setProperty?i.setProperty("display","none","important"):i.display="none";else{i=n.stateNode;var r=n.memoizedProps.style;r=null!=r&&r.hasOwnProperty("display")?r.display:null,i.style.display=bt("display",r)}}else if(6===n.tag)n.stateNode.nodeValue=e?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===t)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function va(t,e){if(Er&&"function"==typeof Er.onCommitFiberUnmount)try{Er.onCommitFiberUnmount(xr,e)}catch(t){}switch(e.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(t=e.updateQueue)&&null!==(t=t.lastEffect)){var n=t=t.next;do{var i=n,r=i.destroy;if(i=i.tag,void 0!==r)if(0!=(4&i))Nl(e,n);else{i=e;try{r()}catch(t){Dl(i,t)}}n=n.next}while(n!==t)}break;case 1:if(fa(e),"function"==typeof(t=e.stateNode).componentWillUnmount)try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(t){Dl(e,t)}break;case 5:fa(e);break;case 4:Ea(t,e)}}function ya(t){t.alternate=null,t.child=null,t.dependencies=null,t.firstEffect=null,t.lastEffect=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.return=null,t.updateQueue=null}function _a(t){return 5===t.tag||3===t.tag||4===t.tag}function ba(t){t:{for(var e=t.return;null!==e;){if(_a(e))break t;e=e.return}throw Error(s(160))}var n=e;switch(e=n.stateNode,n.tag){case 5:var i=!1;break;case 3:case 4:e=e.containerInfo,i=!0;break;default:throw Error(s(161))}16&n.flags&&(vt(e,""),n.flags&=-17);t:e:for(n=t;;){for(;null===n.sibling;){if(null===n.return||_a(n.return)){n=null;break t}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue e;if(null===n.child||4===n.tag)continue e;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break t}}i?wa(t,n,e):xa(t,n,e)}function wa(t,e,n){var i=t.tag,r=5===i||6===i;if(r)t=r?t.stateNode:t.stateNode.instance,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!=(n=n._reactRootContainer)||null!==e.onclick||(e.onclick=ji));else if(4!==i&&null!==(t=t.child))for(wa(t,e,n),t=t.sibling;null!==t;)wa(t,e,n),t=t.sibling}function xa(t,e,n){var i=t.tag,r=5===i||6===i;if(r)t=r?t.stateNode:t.stateNode.instance,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==i&&null!==(t=t.child))for(xa(t,e,n),t=t.sibling;null!==t;)xa(t,e,n),t=t.sibling}function Ea(t,e){for(var n,i,r=e,o=!1;;){if(!o){o=r.return;t:for(;;){if(null===o)throw Error(s(160));switch(n=o.stateNode,o.tag){case 5:i=!1;break t;case 3:case 4:n=n.containerInfo,i=!0;break t}o=o.return}o=!0}if(5===r.tag||6===r.tag){t:for(var a=t,l=r,c=l;;)if(va(a,c),null!==c.child&&4!==c.tag)c.child.return=c,c=c.child;else{if(c===l)break t;for(;null===c.sibling;){if(null===c.return||c.return===l)break t;c=c.return}c.sibling.return=c.return,c=c.sibling}i?(a=n,l=r.stateNode,8===a.nodeType?a.parentNode.removeChild(l):a.removeChild(l)):n.removeChild(r.stateNode)}else if(4===r.tag){if(null!==r.child){n=r.stateNode.containerInfo,i=!0,r.child.return=r,r=r.child;continue}}else if(va(t,r),null!==r.child){r.child.return=r,r=r.child;continue}if(r===e)break;for(;null===r.sibling;){if(null===r.return||r.return===e)return;4===(r=r.return).tag&&(o=!1)}r.sibling.return=r.return,r=r.sibling}}function Sa(t,e){switch(e.tag){case 0:case 11:case 14:case 15:case 22:var n=e.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var i=n=n.next;do{3==(3&i.tag)&&(t=i.destroy,i.destroy=void 0,void 0!==t&&t()),i=i.next}while(i!==n)}return;case 1:case 12:case 17:return;case 5:if(null!=(n=e.stateNode)){i=e.memoizedProps;var r=null!==t?t.memoizedProps:i;t=e.type;var o=e.updateQueue;if(e.updateQueue=null,null!==o){for(n[$i]=i,"input"===t&&"radio"===i.type&&null!=i.name&&et(n,i),St(t,r),e=St(t,i),r=0;r<o.length;r+=2){var a=o[r],l=o[r+1];"style"===a?wt(n,l):"dangerouslySetInnerHTML"===a?mt(n,l):"children"===a?vt(n,l):b(n,a,l,e)}switch(t){case"input":nt(n,i);break;case"textarea":ct(n,i);break;case"select":t=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!i.multiple,null!=(o=i.value)?st(n,!!i.multiple,o,!1):t!==!!i.multiple&&(null!=i.defaultValue?st(n,!!i.multiple,i.defaultValue,!0):st(n,!!i.multiple,i.multiple?[]:"",!1))}}}return;case 6:if(null===e.stateNode)throw Error(s(162));return void(e.stateNode.nodeValue=e.memoizedProps);case 3:return void((n=e.stateNode).hydrate&&(n.hydrate=!1,we(n.containerInfo)));case 13:return null!==e.memoizedState&&(Wa=Vr(),ma(e.child,!0)),void Pa(e);case 19:return void Pa(e);case 23:case 24:return void ma(e,null!==e.memoizedState)}throw Error(s(163))}function Pa(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new da),e.forEach((function(e){var i=Bl.bind(null,t,e);n.has(e)||(n.add(e),e.then(i,i))}))}}function Ta(t,e){return null!==t&&(null===(t=t.memoizedState)||null!==t.dehydrated)&&null!==(e=e.memoizedState)&&null===e.dehydrated}var Ca=Math.ceil,Aa=w.ReactCurrentDispatcher,Ma=w.ReactCurrentOwner,La=0,ka=null,Oa=null,Ia=0,Ra=0,Na=lr(0),za=0,Fa=null,Da=0,ja=0,Ba=0,Ua=0,Va=null,Wa=0,Ga=1/0;function Ha(){Ga=Vr()+500}var qa,Xa=null,Za=!1,Ya=null,Ka=null,Qa=!1,$a=null,Ja=90,tl=[],el=[],nl=null,il=0,rl=null,ol=-1,sl=0,al=0,ll=null,cl=!1;function ul(){return 0!=(48&La)?Vr():-1!==ol?ol:ol=Vr()}function hl(t){if(0==(2&(t=t.mode)))return 1;if(0==(4&t))return 99===Wr()?1:2;if(0===sl&&(sl=Da),0!==Yr.transition){0!==al&&(al=null!==Va?Va.pendingLanes:0),t=sl;var e=4186112&~al;return 0==(e&=-e)&&0==(e=(t=4186112&~t)&-t)&&(e=8192),e}return t=Wr(),t=je(0!=(4&La)&&98===t?12:t=function(t){switch(t){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(t),sl)}function dl(t,e,n){if(50<il)throw il=0,rl=null,Error(s(185));if(null===(t=fl(t,e)))return null;Ve(t,e,n),t===ka&&(Ba|=e,4===za&&ml(t,Ia));var i=Wr();1===e?0!=(8&La)&&0==(48&La)?vl(t):(pl(t,n),0===La&&(Ha(),Xr())):(0==(4&La)||98!==i&&99!==i||(null===nl?nl=new Set([t]):nl.add(t)),pl(t,n)),Va=t}function fl(t,e){t.lanes|=e;var n=t.alternate;for(null!==n&&(n.lanes|=e),n=t,t=t.return;null!==t;)t.childLanes|=e,null!==(n=t.alternate)&&(n.childLanes|=e),n=t,t=t.return;return 3===n.tag?n.stateNode:null}function pl(t,e){for(var n=t.callbackNode,i=t.suspendedLanes,r=t.pingedLanes,o=t.expirationTimes,a=t.pendingLanes;0<a;){var l=31-We(a),c=1<<l,u=o[l];if(-1===u){if(0==(c&i)||0!=(c&r)){u=e,ze(c);var h=Ne;o[l]=10<=h?u+250:6<=h?u+5e3:-1}}else u<=e&&(t.expiredLanes|=c);a&=~c}if(i=Fe(t,t===ka?Ia:0),e=Ne,0===i)null!==n&&(n!==zr&&Tr(n),t.callbackNode=null,t.callbackPriority=0);else{if(null!==n){if(t.callbackPriority===e)return;n!==zr&&Tr(n)}15===e?(n=vl.bind(null,t),null===Dr?(Dr=[n],jr=Pr(kr,Zr)):Dr.push(n),n=zr):14===e?n=qr(99,vl.bind(null,t)):(n=function(t){switch(t){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(s(358,t))}}(e),n=qr(n,gl.bind(null,t))),t.callbackPriority=e,t.callbackNode=n}}function gl(t){if(ol=-1,al=sl=0,0!=(48&La))throw Error(s(327));var e=t.callbackNode;if(Il()&&t.callbackNode!==e)return null;var n=Fe(t,t===ka?Ia:0);if(0===n)return null;var i=n,r=La;La|=16;var o=Sl();for(ka===t&&Ia===i||(Ha(),xl(t,i));;)try{Cl();break}catch(e){El(t,e)}if(eo(),Aa.current=o,La=r,null!==Oa?i=0:(ka=null,Ia=0,i=za),0!=(Da&Ba))xl(t,0);else if(0!==i){if(2===i&&(La|=64,t.hydrate&&(t.hydrate=!1,qi(t.containerInfo)),0!==(n=De(t))&&(i=Pl(t,n))),1===i)throw e=Fa,xl(t,0),ml(t,n),pl(t,Vr()),e;switch(t.finishedWork=t.current.alternate,t.finishedLanes=n,i){case 0:case 1:throw Error(s(345));case 2:case 5:Ll(t);break;case 3:if(ml(t,n),(62914560&n)===n&&10<(i=Wa+500-Vr())){if(0!==Fe(t,0))break;if(((r=t.suspendedLanes)&n)!==n){ul(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=Gi(Ll.bind(null,t),i);break}Ll(t);break;case 4:if(ml(t,n),(4186112&n)===n)break;for(i=t.eventTimes,r=-1;0<n;){var a=31-We(n);o=1<<a,(a=i[a])>r&&(r=a),n&=~o}if(n=r,10<(n=(120>(n=Vr()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Ca(n/1960))-n)){t.timeoutHandle=Gi(Ll.bind(null,t),n);break}Ll(t);break;default:throw Error(s(329))}}return pl(t,Vr()),t.callbackNode===e?gl.bind(null,t):null}function ml(t,e){for(e&=~Ua,e&=~Ba,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-We(e),i=1<<n;t[n]=-1,e&=~i}}function vl(t){if(0!=(48&La))throw Error(s(327));if(Il(),t===ka&&0!=(t.expiredLanes&Ia)){var e=Ia,n=Pl(t,e);0!=(Da&Ba)&&(n=Pl(t,e=Fe(t,e)))}else n=Pl(t,e=Fe(t,0));if(0!==t.tag&&2===n&&(La|=64,t.hydrate&&(t.hydrate=!1,qi(t.containerInfo)),0!==(e=De(t))&&(n=Pl(t,e))),1===n)throw n=Fa,xl(t,0),ml(t,e),pl(t,Vr()),n;return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ll(t),pl(t,Vr()),null}function yl(t,e){var n=La;La|=1;try{return t(e)}finally{0===(La=n)&&(Ha(),Xr())}}function _l(t,e){var n=La;La&=-2,La|=8;try{return t(e)}finally{0===(La=n)&&(Ha(),Xr())}}function bl(t,e){ur(Na,Ra),Ra|=e,Da|=e}function wl(){Ra=Na.current,cr(Na)}function xl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,Hi(n)),null!==Oa)for(n=Oa.return;null!==n;){var i=n;switch(i.tag){case 1:null!=(i=i.type.childContextTypes)&&vr();break;case 3:Ro(),cr(fr),cr(dr),Yo();break;case 5:zo(i);break;case 4:Ro();break;case 13:case 19:cr(Fo);break;case 10:no(i);break;case 23:case 24:wl()}n=n.return}ka=t,Oa=Gl(t.current,null),Ia=Ra=Da=e,za=0,Fa=null,Ua=Ba=ja=0}function El(t,e){for(;;){var n=Oa;try{if(eo(),Ko.current=ks,ns){for(var i=Jo.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}ns=!1}if($o=0,es=ts=Jo=null,is=!1,Ma.current=null,null===n||null===n.return){za=1,Fa=e,Oa=null;break}t:{var o=t,s=n.return,a=n,l=e;if(e=Ia,a.flags|=2048,a.firstEffect=a.lastEffect=null,null!==l&&"object"==typeof l&&"function"==typeof l.then){var c=l;if(0==(2&a.mode)){var u=a.alternate;u?(a.updateQueue=u.updateQueue,a.memoizedState=u.memoizedState,a.lanes=u.lanes):(a.updateQueue=null,a.memoizedState=null)}var h=0!=(1&Fo.current),d=s;do{var f;if(f=13===d.tag){var p=d.memoizedState;if(null!==p)f=null!==p.dehydrated;else{var g=d.memoizedProps;f=void 0!==g.fallback&&(!0!==g.unstable_avoidThisFallback||!h)}}if(f){var m=d.updateQueue;if(null===m){var v=new Set;v.add(c),d.updateQueue=v}else m.add(c);if(0==(2&d.mode)){if(d.flags|=64,a.flags|=16384,a.flags&=-2981,1===a.tag)if(null===a.alternate)a.tag=17;else{var y=co(-1,1);y.tag=2,uo(a,y)}a.lanes|=1;break t}l=void 0,a=e;var _=o.pingCache;if(null===_?(_=o.pingCache=new ca,l=new Set,_.set(c,l)):void 0===(l=_.get(c))&&(l=new Set,_.set(c,l)),!l.has(a)){l.add(a);var b=jl.bind(null,o,c,a);c.then(b,b)}d.flags|=4096,d.lanes=e;break t}d=d.return}while(null!==d);l=Error((X(a.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==za&&(za=2),l=aa(l,a),d=s;do{switch(d.tag){case 3:o=l,d.flags|=4096,e&=-e,d.lanes|=e,ho(d,ua(0,o,e));break t;case 1:o=l;var w=d.type,x=d.stateNode;if(0==(64&d.flags)&&("function"==typeof w.getDerivedStateFromError||null!==x&&"function"==typeof x.componentDidCatch&&(null===Ka||!Ka.has(x)))){d.flags|=4096,e&=-e,d.lanes|=e,ho(d,ha(d,o,e));break t}}d=d.return}while(null!==d)}Ml(n)}catch(t){e=t,Oa===n&&null!==n&&(Oa=n=n.return);continue}break}}function Sl(){var t=Aa.current;return Aa.current=ks,null===t?ks:t}function Pl(t,e){var n=La;La|=16;var i=Sl();for(ka===t&&Ia===e||xl(t,e);;)try{Tl();break}catch(e){El(t,e)}if(eo(),La=n,Aa.current=i,null!==Oa)throw Error(s(261));return ka=null,Ia=0,za}function Tl(){for(;null!==Oa;)Al(Oa)}function Cl(){for(;null!==Oa&&!Cr();)Al(Oa)}function Al(t){var e=qa(t.alternate,t,Ra);t.memoizedProps=t.pendingProps,null===e?Ml(t):Oa=e,Ma.current=null}function Ml(t){var e=t;do{var n=e.alternate;if(t=e.return,0==(2048&e.flags)){if(null!==(n=oa(n,e,Ra)))return void(Oa=n);if(24!==(n=e).tag&&23!==n.tag||null===n.memoizedState||0!=(1073741824&Ra)||0==(4&n.mode)){for(var i=0,r=n.child;null!==r;)i|=r.lanes|r.childLanes,r=r.sibling;n.childLanes=i}null!==t&&0==(2048&t.flags)&&(null===t.firstEffect&&(t.firstEffect=e.firstEffect),null!==e.lastEffect&&(null!==t.lastEffect&&(t.lastEffect.nextEffect=e.firstEffect),t.lastEffect=e.lastEffect),1<e.flags&&(null!==t.lastEffect?t.lastEffect.nextEffect=e:t.firstEffect=e,t.lastEffect=e))}else{if(null!==(n=sa(e)))return n.flags&=2047,void(Oa=n);null!==t&&(t.firstEffect=t.lastEffect=null,t.flags|=2048)}if(null!==(e=e.sibling))return void(Oa=e);Oa=e=t}while(null!==e);0===za&&(za=5)}function Ll(t){var e=Wr();return Hr(99,kl.bind(null,t,e)),null}function kl(t,e){do{Il()}while(null!==$a);if(0!=(48&La))throw Error(s(327));var n=t.finishedWork;if(null===n)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(s(177));t.callbackNode=null;var i=n.lanes|n.childLanes,r=i,o=t.pendingLanes&~r;t.pendingLanes=r,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=r,t.mutableReadLanes&=r,t.entangledLanes&=r,r=t.entanglements;for(var a=t.eventTimes,l=t.expirationTimes;0<o;){var c=31-We(o),u=1<<c;r[c]=0,a[c]=-1,l[c]=-1,o&=~u}if(null!==nl&&0==(24&i)&&nl.has(t)&&nl.delete(t),t===ka&&(Oa=ka=null,Ia=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,i=n.firstEffect):i=n:i=n.firstEffect,null!==i){if(r=La,La|=32,Ma.current=null,Bi=Ze,mi(a=gi())){if("selectionStart"in a)l={start:a.selectionStart,end:a.selectionEnd};else t:if(l=(l=a.ownerDocument)&&l.defaultView||window,(u=l.getSelection&&l.getSelection())&&0!==u.rangeCount){l=u.anchorNode,o=u.anchorOffset,c=u.focusNode,u=u.focusOffset;try{l.nodeType,c.nodeType}catch(t){l=null;break t}var h=0,d=-1,f=-1,p=0,g=0,m=a,v=null;e:for(;;){for(var y;m!==l||0!==o&&3!==m.nodeType||(d=h+o),m!==c||0!==u&&3!==m.nodeType||(f=h+u),3===m.nodeType&&(h+=m.nodeValue.length),null!==(y=m.firstChild);)v=m,m=y;for(;;){if(m===a)break e;if(v===l&&++p===o&&(d=h),v===c&&++g===u&&(f=h),null!==(y=m.nextSibling))break;v=(m=v).parentNode}m=y}l=-1===d||-1===f?null:{start:d,end:f}}else l=null;l=l||{start:0,end:0}}else l=null;Ui={focusedElem:a,selectionRange:l},Ze=!1,ll=null,cl=!1,Xa=i;do{try{Ol()}catch(t){if(null===Xa)throw Error(s(330));Dl(Xa,t),Xa=Xa.nextEffect}}while(null!==Xa);ll=null,Xa=i;do{try{for(a=t;null!==Xa;){var _=Xa.flags;if(16&_&&vt(Xa.stateNode,""),128&_){var b=Xa.alternate;if(null!==b){var w=b.ref;null!==w&&("function"==typeof w?w(null):w.current=null)}}switch(1038&_){case 2:ba(Xa),Xa.flags&=-3;break;case 6:ba(Xa),Xa.flags&=-3,Sa(Xa.alternate,Xa);break;case 1024:Xa.flags&=-1025;break;case 1028:Xa.flags&=-1025,Sa(Xa.alternate,Xa);break;case 4:Sa(Xa.alternate,Xa);break;case 8:Ea(a,l=Xa);var x=l.alternate;ya(l),null!==x&&ya(x)}Xa=Xa.nextEffect}}catch(t){if(null===Xa)throw Error(s(330));Dl(Xa,t),Xa=Xa.nextEffect}}while(null!==Xa);if(w=Ui,b=gi(),_=w.focusedElem,a=w.selectionRange,b!==_&&_&&_.ownerDocument&&pi(_.ownerDocument.documentElement,_)){null!==a&&mi(_)&&(b=a.start,void 0===(w=a.end)&&(w=b),"selectionStart"in _?(_.selectionStart=b,_.selectionEnd=Math.min(w,_.value.length)):(w=(b=_.ownerDocument||document)&&b.defaultView||window).getSelection&&(w=w.getSelection(),l=_.textContent.length,x=Math.min(a.start,l),a=void 0===a.end?x:Math.min(a.end,l),!w.extend&&x>a&&(l=a,a=x,x=l),l=fi(_,x),o=fi(_,a),l&&o&&(1!==w.rangeCount||w.anchorNode!==l.node||w.anchorOffset!==l.offset||w.focusNode!==o.node||w.focusOffset!==o.offset)&&((b=b.createRange()).setStart(l.node,l.offset),w.removeAllRanges(),x>a?(w.addRange(b),w.extend(o.node,o.offset)):(b.setEnd(o.node,o.offset),w.addRange(b))))),b=[];for(w=_;w=w.parentNode;)1===w.nodeType&&b.push({element:w,left:w.scrollLeft,top:w.scrollTop});for("function"==typeof _.focus&&_.focus(),_=0;_<b.length;_++)(w=b[_]).element.scrollLeft=w.left,w.element.scrollTop=w.top}Ze=!!Bi,Ui=Bi=null,t.current=n,Xa=i;do{try{for(_=t;null!==Xa;){var E=Xa.flags;if(36&E&&ga(_,Xa.alternate,Xa),128&E){b=void 0;var S=Xa.ref;if(null!==S){var P=Xa.stateNode;Xa.tag,b=P,"function"==typeof S?S(b):S.current=b}}Xa=Xa.nextEffect}}catch(t){if(null===Xa)throw Error(s(330));Dl(Xa,t),Xa=Xa.nextEffect}}while(null!==Xa);Xa=null,Fr(),La=r}else t.current=n;if(Qa)Qa=!1,$a=t,Ja=e;else for(Xa=i;null!==Xa;)e=Xa.nextEffect,Xa.nextEffect=null,8&Xa.flags&&((E=Xa).sibling=null,E.stateNode=null),Xa=e;if(0===(i=t.pendingLanes)&&(Ka=null),1===i?t===rl?il++:(il=0,rl=t):il=0,n=n.stateNode,Er&&"function"==typeof Er.onCommitFiberRoot)try{Er.onCommitFiberRoot(xr,n,void 0,64==(64&n.current.flags))}catch(t){}if(pl(t,Vr()),Za)throw Za=!1,t=Ya,Ya=null,t;return 0!=(8&La)||Xr(),null}function Ol(){for(;null!==Xa;){var t=Xa.alternate;cl||null===ll||(0!=(8&Xa.flags)?Jt(Xa,ll)&&(cl=!0):13===Xa.tag&&Ta(t,Xa)&&Jt(Xa,ll)&&(cl=!0));var e=Xa.flags;0!=(256&e)&&pa(t,Xa),0==(512&e)||Qa||(Qa=!0,qr(97,(function(){return Il(),null}))),Xa=Xa.nextEffect}}function Il(){if(90!==Ja){var t=97<Ja?97:Ja;return Ja=90,Hr(t,zl)}return!1}function Rl(t,e){tl.push(e,t),Qa||(Qa=!0,qr(97,(function(){return Il(),null})))}function Nl(t,e){el.push(e,t),Qa||(Qa=!0,qr(97,(function(){return Il(),null})))}function zl(){if(null===$a)return!1;var t=$a;if($a=null,0!=(48&La))throw Error(s(331));var e=La;La|=32;var n=el;el=[];for(var i=0;i<n.length;i+=2){var r=n[i],o=n[i+1],a=r.destroy;if(r.destroy=void 0,"function"==typeof a)try{a()}catch(t){if(null===o)throw Error(s(330));Dl(o,t)}}for(n=tl,tl=[],i=0;i<n.length;i+=2){r=n[i],o=n[i+1];try{var l=r.create;r.destroy=l()}catch(t){if(null===o)throw Error(s(330));Dl(o,t)}}for(l=t.current.firstEffect;null!==l;)t=l.nextEffect,l.nextEffect=null,8&l.flags&&(l.sibling=null,l.stateNode=null),l=t;return La=e,Xr(),!0}function Fl(t,e,n){uo(t,e=ua(0,e=aa(n,e),1)),e=ul(),null!==(t=fl(t,1))&&(Ve(t,1,e),pl(t,e))}function Dl(t,e){if(3===t.tag)Fl(t,t,e);else for(var n=t.return;null!==n;){if(3===n.tag){Fl(n,t,e);break}if(1===n.tag){var i=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof i.componentDidCatch&&(null===Ka||!Ka.has(i))){var r=ha(n,t=aa(e,t),1);if(uo(n,r),r=ul(),null!==(n=fl(n,1)))Ve(n,1,r),pl(n,r);else if("function"==typeof i.componentDidCatch&&(null===Ka||!Ka.has(i)))try{i.componentDidCatch(e,t)}catch(t){}break}}n=n.return}}function jl(t,e,n){var i=t.pingCache;null!==i&&i.delete(e),e=ul(),t.pingedLanes|=t.suspendedLanes&n,ka===t&&(Ia&n)===n&&(4===za||3===za&&(62914560&Ia)===Ia&&500>Vr()-Wa?xl(t,0):Ua|=n),pl(t,e)}function Bl(t,e){var n=t.stateNode;null!==n&&n.delete(e),0==(e=0)&&(0==(2&(e=t.mode))?e=1:0==(4&e)?e=99===Wr()?1:2:(0===sl&&(sl=Da),0===(e=Be(62914560&~sl))&&(e=4194304))),n=ul(),null!==(t=fl(t,e))&&(Ve(t,e,n),pl(t,n))}function Ul(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Vl(t,e,n,i){return new Ul(t,e,n,i)}function Wl(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Gl(t,e){var n=t.alternate;return null===n?((n=Vl(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Hl(t,e,n,i,r,o){var a=2;if(i=t,"function"==typeof t)Wl(t)&&(a=1);else if("string"==typeof t)a=5;else t:switch(t){case S:return ql(n.children,r,o,e);case z:a=8,r|=16;break;case P:a=8,r|=1;break;case T:return(t=Vl(12,n,e,8|r)).elementType=T,t.type=T,t.lanes=o,t;case L:return(t=Vl(13,n,e,r)).type=L,t.elementType=L,t.lanes=o,t;case k:return(t=Vl(19,n,e,r)).elementType=k,t.lanes=o,t;case F:return Xl(n,r,o,e);case D:return(t=Vl(24,n,e,r)).elementType=D,t.lanes=o,t;default:if("object"==typeof t&&null!==t)switch(t.$$typeof){case C:a=10;break t;case A:a=9;break t;case M:a=11;break t;case O:a=14;break t;case I:a=16,i=null;break t;case R:a=22;break t}throw Error(s(130,null==t?t:typeof t,""))}return(e=Vl(a,n,e,r)).elementType=t,e.type=i,e.lanes=o,e}function ql(t,e,n,i){return(t=Vl(7,t,i,e)).lanes=n,t}function Xl(t,e,n,i){return(t=Vl(23,t,i,e)).elementType=F,t.lanes=n,t}function Zl(t,e,n){return(t=Vl(6,t,null,e)).lanes=n,t}function Yl(t,e,n){return(e=Vl(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Kl(t,e,n){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Ue(0),this.expirationTimes=Ue(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ue(0),this.mutableSourceEagerHydrationData=null}function Ql(t,e,n,i){var r=e.current,o=ul(),a=hl(r);t:if(n){e:{if(Yt(n=n._reactInternals)!==n||1!==n.tag)throw Error(s(170));var l=n;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(mr(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(null!==l);throw Error(s(171))}if(1===n.tag){var c=n.type;if(mr(c)){n=_r(n,c,l);break t}}n=l}else n=hr;return null===e.context?e.context=n:e.pendingContext=n,(e=co(o,a)).payload={element:t},null!==(i=void 0===i?null:i)&&(e.callback=i),uo(r,e),dl(r,a,o),a}function $l(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function Jl(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function tc(t,e){Jl(t,e),(t=t.alternate)&&Jl(t,e)}function ec(t,e,n){var i=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new Kl(t,e,null!=n&&!0===n.hydrate),e=Vl(3,null,null,2===e?7:1===e?3:0),n.current=e,e.stateNode=n,ao(e),t[Ji]=n.current,ki(8===t.nodeType?t.parentNode:t),i)for(t=0;t<i.length;t++){var r=(e=i[t])._getVersion;r=r(e._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[e,r]:n.mutableSourceEagerHydrationData.push(e,r)}this._internalRoot=n}function nc(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function ic(t,e,n,i,r){var o=n._reactRootContainer;if(o){var s=o._internalRoot;if("function"==typeof r){var a=r;r=function(){var t=$l(s);a.call(t)}}Ql(e,s,t,r)}else{if(o=n._reactRootContainer=function(t,e){if(e||(e=!(!(e=t?9===t.nodeType?t.documentElement:t.firstChild:null)||1!==e.nodeType||!e.hasAttribute("data-reactroot"))),!e)for(var n;n=t.lastChild;)t.removeChild(n);return new ec(t,0,e?{hydrate:!0}:void 0)}(n,i),s=o._internalRoot,"function"==typeof r){var l=r;r=function(){var t=$l(s);l.call(t)}}_l((function(){Ql(e,s,t,r)}))}return $l(s)}function rc(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!nc(e))throw Error(s(200));return function(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:E,key:null==i?null:""+i,children:t,containerInfo:e,implementation:n}}(t,e,null,n)}qa=function(t,e,n){var i=e.lanes;if(null!==t)if(t.memoizedProps!==e.pendingProps||fr.current)zs=!0;else{if(0==(n&i)){switch(zs=!1,e.tag){case 3:qs(e),Xo();break;case 5:No(e);break;case 1:mr(e.type)&&br(e);break;case 4:Io(e,e.stateNode.containerInfo);break;case 10:i=e.memoizedProps.value;var r=e.type._context;ur(Qr,r._currentValue),r._currentValue=i;break;case 13:if(null!==e.memoizedState)return 0!=(n&e.child.childLanes)?$s(t,e,n):(ur(Fo,1&Fo.current),null!==(e=ia(t,e,n))?e.sibling:null);ur(Fo,1&Fo.current);break;case 19:if(i=0!=(n&e.childLanes),0!=(64&t.flags)){if(i)return na(t,e,n);e.flags|=64}if(null!==(r=e.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),ur(Fo,Fo.current),i)break;return null;case 23:case 24:return e.lanes=0,Us(t,e,n)}return ia(t,e,n)}zs=0!=(16384&t.flags)}else zs=!1;switch(e.lanes=0,e.tag){case 2:if(i=e.type,null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,r=gr(e,dr.current),ro(e,n),r=ss(null,e,i,t,r,n),e.flags|=1,"object"==typeof r&&null!==r&&"function"==typeof r.render&&void 0===r.$$typeof){if(e.tag=1,e.memoizedState=null,e.updateQueue=null,mr(i)){var o=!0;br(e)}else o=!1;e.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,ao(e);var a=i.getDerivedStateFromProps;"function"==typeof a&&mo(e,i,a,t),r.updater=vo,e.stateNode=r,r._reactInternals=e,wo(e,i,t,n),e=Hs(null,e,i,!0,o,n)}else e.tag=0,Fs(null,e,r,n),e=e.child;return e;case 16:r=e.elementType;t:{switch(null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,r=(o=r._init)(r._payload),e.type=r,o=e.tag=function(t){if("function"==typeof t)return Wl(t)?1:0;if(null!=t){if((t=t.$$typeof)===M)return 11;if(t===O)return 14}return 2}(r),t=Kr(r,t),o){case 0:e=Ws(null,e,r,t,n);break t;case 1:e=Gs(null,e,r,t,n);break t;case 11:e=Ds(null,e,r,t,n);break t;case 14:e=js(null,e,r,Kr(r.type,t),i,n);break t}throw Error(s(306,r,""))}return e;case 0:return i=e.type,r=e.pendingProps,Ws(t,e,i,r=e.elementType===i?r:Kr(i,r),n);case 1:return i=e.type,r=e.pendingProps,Gs(t,e,i,r=e.elementType===i?r:Kr(i,r),n);case 3:if(qs(e),i=e.updateQueue,null===t||null===i)throw Error(s(282));if(i=e.pendingProps,r=null!==(r=e.memoizedState)?r.element:null,lo(t,e),fo(e,i,null,n),(i=e.memoizedState.element)===r)Xo(),e=ia(t,e,n);else{if((o=(r=e.stateNode).hydrate)&&(Bo=Xi(e.stateNode.containerInfo.firstChild),jo=e,o=Uo=!0),o){if(null!=(t=r.mutableSourceEagerHydrationData))for(r=0;r<t.length;r+=2)(o=t[r])._workInProgressVersionPrimary=t[r+1],Zo.push(o);for(n=Co(e,null,i,n),e.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else Fs(t,e,i,n),Xo();e=e.child}return e;case 5:return No(e),null===t&&Go(e),i=e.type,r=e.pendingProps,o=null!==t?t.memoizedProps:null,a=r.children,Wi(i,r)?a=null:null!==o&&Wi(i,o)&&(e.flags|=16),Vs(t,e),Fs(t,e,a,n),e.child;case 6:return null===t&&Go(e),null;case 13:return $s(t,e,n);case 4:return Io(e,e.stateNode.containerInfo),i=e.pendingProps,null===t?e.child=To(e,null,i,n):Fs(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,Ds(t,e,i,r=e.elementType===i?r:Kr(i,r),n);case 7:return Fs(t,e,e.pendingProps,n),e.child;case 8:case 12:return Fs(t,e,e.pendingProps.children,n),e.child;case 10:t:{i=e.type._context,r=e.pendingProps,a=e.memoizedProps,o=r.value;var l=e.type._context;if(ur(Qr,l._currentValue),l._currentValue=o,null!==a)if(l=a.value,0==(o=ci(l,o)?0:0|("function"==typeof i._calculateChangedBits?i._calculateChangedBits(l,o):1073741823))){if(a.children===r.children&&!fr.current){e=ia(t,e,n);break t}}else for(null!==(l=e.child)&&(l.return=e);null!==l;){var c=l.dependencies;if(null!==c){a=l.child;for(var u=c.firstContext;null!==u;){if(u.context===i&&0!=(u.observedBits&o)){1===l.tag&&((u=co(-1,n&-n)).tag=2,uo(l,u)),l.lanes|=n,null!==(u=l.alternate)&&(u.lanes|=n),io(l.return,n),c.lanes|=n;break}u=u.next}}else a=10===l.tag&&l.type===e.type?null:l.child;if(null!==a)a.return=l;else for(a=l;null!==a;){if(a===e){a=null;break}if(null!==(l=a.sibling)){l.return=a.return,a=l;break}a=a.return}l=a}Fs(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=(o=e.pendingProps).children,ro(e,n),i=i(r=oo(r,o.unstable_observedBits)),e.flags|=1,Fs(t,e,i,n),e.child;case 14:return o=Kr(r=e.type,e.pendingProps),js(t,e,r,o=Kr(r.type,o),i,n);case 15:return Bs(t,e,e.type,e.pendingProps,i,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Kr(i,r),null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),e.tag=1,mr(i)?(t=!0,br(e)):t=!1,ro(e,n),_o(e,i,r),wo(e,i,r,n),Hs(null,e,i,!0,t,n);case 19:return na(t,e,n);case 23:case 24:return Us(t,e,n)}throw Error(s(156,e.tag))},ec.prototype.render=function(t){Ql(t,this._internalRoot,null,null)},ec.prototype.unmount=function(){var t=this._internalRoot,e=t.containerInfo;Ql(null,t,null,(function(){e[Ji]=null}))},te=function(t){13===t.tag&&(dl(t,4,ul()),tc(t,4))},ee=function(t){13===t.tag&&(dl(t,67108864,ul()),tc(t,67108864))},ne=function(t){if(13===t.tag){var e=ul(),n=hl(t);dl(t,n,e),tc(t,n)}},ie=function(t,e){return e()},Tt=function(t,e,n){switch(e){case"input":if(nt(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=rr(i);if(!r)throw Error(s(90));Q(i),nt(i,r)}}}break;case"textarea":ct(t,n);break;case"select":null!=(e=n.value)&&st(t,!!n.multiple,e,!1)}},Ot=yl,It=function(t,e,n,i,r){var o=La;La|=4;try{return Hr(98,t.bind(null,e,n,i,r))}finally{0===(La=o)&&(Ha(),Xr())}},Rt=function(){0==(49&La)&&(function(){if(null!==nl){var t=nl;nl=null,t.forEach((function(t){t.expiredLanes|=24&t.pendingLanes,pl(t,Vr())}))}Xr()}(),Il())},Nt=function(t,e){var n=La;La|=2;try{return t(e)}finally{0===(La=n)&&(Ha(),Xr())}};var oc={Events:[nr,ir,rr,Lt,kt,Il,{current:!1}]},sc={findFiberByHostInstance:er,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},ac={bundleType:sc.bundleType,version:sc.version,rendererPackageName:sc.rendererPackageName,rendererConfig:sc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=$t(t))?null:t.stateNode},findFiberByHostInstance:sc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var lc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!lc.isDisabled&&lc.supportsFiber)try{xr=lc.inject(ac),Er=lc}catch(gt){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oc,e.createPortal=rc,e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"==typeof t.render)throw Error(s(188));throw Error(s(268,Object.keys(t)))}return null===(t=$t(e))?null:t.stateNode},e.flushSync=function(t,e){var n=La;if(0!=(48&n))return t(e);La|=1;try{if(t)return Hr(99,t.bind(null,e))}finally{La=n,Xr()}},e.hydrate=function(t,e,n){if(!nc(e))throw Error(s(200));return ic(null,t,e,!0,n)},e.render=function(t,e,n){if(!nc(e))throw Error(s(200));return ic(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!nc(t))throw Error(s(40));return!!t._reactRootContainer&&(_l((function(){ic(null,null,t,!1,(function(){t._reactRootContainer=null,t[Ji]=null}))})),!0)},e.unstable_batchedUpdates=yl,e.unstable_createPortal=function(t,e){return rc(t,e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},e.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!nc(n))throw Error(s(200));if(null==t||void 0===t._reactInternals)throw Error(s(38));return ic(t,e,n,!1,i)},e.version="17.0.2"},935:(t,e,n)=>{"use strict";!function t(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(t){console.error(t)}}(),t.exports=n(448)},70:t=>{var e=["onAbort","onAnimationCancel","onAnimationEnd","onAnimationIteration","onAuxClick","onBlur","onChange","onClick","onClose","onContextMenu","onDoubleClick","onError","onFocus","onGotPointerCapture","onInput","onKeyDown","onKeyPress","onKeyUp","onLoad","onLoadEnd","onLoadStart","onLostPointerCapture","onMouseDown","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onReset","onResize","onScroll","onSelect","onSelectionChange","onSelectStart","onSubmit","onTouchCancel","onTouchMove","onTouchStart","onTouchEnd","onTransitionCancel","onTransitionEnd","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onFocusOut"],n={onDoubleClick:"dblclick"},i={onInput:"onChange",onFocusOut:"onBlur",onSelectionChange:"onSelect"};function r(t,e){for(var n in t)if(t.hasOwnProperty(n)&&-1!==n.indexOf(e))return t[n]}function o(t){if(t)return t.memoizedProps?t.memoizedProps:t._currentElement&&t._currentElement.props?t._currentElement.props:void 0}function s(t,e,n){t.persist=function(){t.isPersistent=function(){return!0}},n[e]&&n[e](t)}t.exports=function(t){var a=[];return e.forEach((function(e){var l=function(t){return n[t]?n[t]:t.replace(/^on/,"").toLowerCase()}(e);function c(n){for(var a=n.path||n.composedPath&&n.composedPath()||function(t){for(var e=[];t;){if(e.push(t),"HTML"===t.tagName)return e.push(document),e.push(window),e;t=t.parentElement}}(n.target),l=0;l<a.length;l++){var c,u=a[l],h=r(u,"_reactInternal");if(c=r(u,"__reactEventHandlers")||o(h),h&&c&&s(n,e,c),h&&c&&i[e]&&s(n,i[e],c),n.cancelBubble)break;if(u===t)break}}t.addEventListener(l,c,!1),a.push((function(){t.removeEventListener(l,c,!1)}))})),function(){a.forEach((function(t){t()}))}}},587:t=>{t.exports={styleElements:[]}},449:t=>{"use strict";t.exports=function(t){if(!t.attributes)return{};var e={},n=void 0,i=[].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(t.attributes)),r=i.map((function(t){return function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},t.name,t.value)})),o=!0,s=!1,a=void 0;try{for(var l,c=r[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){n=l.value;var u=Object.keys(n)[0],h=u.replace(/-([a-z])/g,(function(t){return t[1].toUpperCase()}));e[h]=n[u]}}catch(t){s=!0,a=t}finally{try{!o&&c.return&&c.return()}finally{if(s)throw a}}return e}},241:(t,e,n)=>{"use strict";t.exports=function(){try{return n(587).styleElements}catch(t){return[]}}},772:(t,e,n)=>{"use strict";var i=function(){function t(t,e){for(var n,i=0;i<e.length;i++)(n=e[i]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function r(){return Reflect.construct(HTMLElement,[],this.__proto__.constructor)}Object.setPrototypeOf(r.prototype,HTMLElement.prototype),Object.setPrototypeOf(r,HTMLElement);var o=n(294),s=n(935),a=n(70),l=n(241),c=n(449);n(919),n(363),t.exports={create:function(t,e){function n(t,e){var n=d[t];n&&h&&h[n]&&h[n].apply(h,e||[])}var u=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],h=void 0,d={attachedCallback:"webComponentAttached",connectedCallback:"webComponentConnected",disconnectedCallback:"webComponentDisconnected",attributeChangedCallback:"webComponentAttributeChanged",adoptedCallback:"webComponentAdopted"},f=function(e){function r(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(r,e),i(r,[{key:"connectedCallback",value:function(){var e=this,i=e;if(u){var r=e.attachShadow({mode:"open"});i=document.createElement("div"),l().forEach((function(t){r.appendChild(t.cloneNode(r))})),r.appendChild(i),a(r)}s.render(o.cloneElement(t,c(e)),i,(function(){h=this,function(t){h&&h.webComponentConstructed&&h.webComponentConstructed.apply(h,[t])}(e),n("connectedCallback")}))}},{key:"disconnectedCallback",value:function(){n("disconnectedCallback")}},{key:"attributeChangedCallback",value:function(t,e,i,r){n("attributeChangedCallback",[t,e,i,r])}},{key:"adoptedCallback",value:function(t,e){n("adoptedCallback",[t,e])}}]),r}(r);customElements.define(e,f)}}},408:(t,e,n)=>{"use strict";var i=n(418),r=60103,o=60106;e.Fragment=60107,e.StrictMode=60108,e.Profiler=60114;var s=60109,a=60110,l=60112;e.Suspense=60113;var c=60115,u=60116;if("function"==typeof Symbol&&Symbol.for){var h=Symbol.for;r=h("react.element"),o=h("react.portal"),e.Fragment=h("react.fragment"),e.StrictMode=h("react.strict_mode"),e.Profiler=h("react.profiler"),s=h("react.provider"),a=h("react.context"),l=h("react.forward_ref"),e.Suspense=h("react.suspense"),c=h("react.memo"),u=h("react.lazy")}var d="function"==typeof Symbol&&Symbol.iterator;function f(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g={};function m(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||p}function v(){}function y(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||p}m.prototype.isReactComponent={},m.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error(f(85));this.updater.enqueueSetState(this,t,e,"setState")},m.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},v.prototype=m.prototype;var _=y.prototype=new v;_.constructor=y,i(_,m.prototype),_.isPureReactComponent=!0;var b={current:null},w=Object.prototype.hasOwnProperty,x={key:!0,ref:!0,__self:!0,__source:!0};function E(t,e,n){var i,o={},s=null,a=null;if(null!=e)for(i in void 0!==e.ref&&(a=e.ref),void 0!==e.key&&(s=""+e.key),e)w.call(e,i)&&!x.hasOwnProperty(i)&&(o[i]=e[i]);var l=arguments.length-2;if(1===l)o.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}if(t&&t.defaultProps)for(i in l=t.defaultProps)void 0===o[i]&&(o[i]=l[i]);return{$$typeof:r,type:t,key:s,ref:a,props:o,_owner:b.current}}function S(t){return"object"==typeof t&&null!==t&&t.$$typeof===r}var P=/\/+/g;function T(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function C(t,e,n,i,s){var a=typeof t;"undefined"!==a&&"boolean"!==a||(t=null);var l=!1;if(null===t)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case r:case o:l=!0}}if(l)return s=s(l=t),t=""===i?"."+T(l,0):i,Array.isArray(s)?(n="",null!=t&&(n=t.replace(P,"$&/")+"/"),C(s,e,n,"",(function(t){return t}))):null!=s&&(S(s)&&(s=function(t,e){return{$$typeof:r,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(s,n+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(P,"$&/")+"/")+t)),e.push(s)),1;if(l=0,i=""===i?".":i+":",Array.isArray(t))for(var c=0;c<t.length;c++){var u=i+T(a=t[c],c);l+=C(a,e,n,u,s)}else if(u=function(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=d&&t[d]||t["@@iterator"])?t:null}(t),"function"==typeof u)for(t=u.call(t),c=0;!(a=t.next()).done;)l+=C(a=a.value,e,n,u=i+T(a,c++),s);else if("object"===a)throw e=""+t,Error(f(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e));return l}function A(t,e,n){if(null==t)return t;var i=[],r=0;return C(t,i,"","",(function(t){return e.call(n,t,r++)})),i}function M(t){if(-1===t._status){var e=t._result;e=e(),t._status=0,t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}if(1===t._status)return t._result;throw t._result}var L={current:null};function k(){var t=L.current;if(null===t)throw Error(f(321));return t}var O={ReactCurrentDispatcher:L,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:b,IsSomeRendererActing:{current:!1},assign:i};e.Children={map:A,forEach:function(t,e,n){A(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return A(t,(function(){e++})),e},toArray:function(t){return A(t,(function(t){return t}))||[]},only:function(t){if(!S(t))throw Error(f(143));return t}},e.Component=m,e.PureComponent=y,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,e.cloneElement=function(t,e,n){if(null==t)throw Error(f(267,t));var o=i({},t.props),s=t.key,a=t.ref,l=t._owner;if(null!=e){if(void 0!==e.ref&&(a=e.ref,l=b.current),void 0!==e.key&&(s=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)w.call(e,u)&&!x.hasOwnProperty(u)&&(o[u]=void 0===e[u]&&void 0!==c?c[u]:e[u])}var u=arguments.length-2;if(1===u)o.children=n;else if(1<u){c=Array(u);for(var h=0;h<u;h++)c[h]=arguments[h+2];o.children=c}return{$$typeof:r,type:t.type,key:s,ref:a,props:o,_owner:l}},e.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:a,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:s,_context:t},t.Consumer=t},e.createElement=E,e.createFactory=function(t){var e=E.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:l,render:t}},e.isValidElement=S,e.lazy=function(t){return{$$typeof:u,_payload:{_status:-1,_result:t},_init:M}},e.memo=function(t,e){return{$$typeof:c,type:t,compare:void 0===e?null:e}},e.useCallback=function(t,e){return k().useCallback(t,e)},e.useContext=function(t,e){return k().useContext(t,e)},e.useDebugValue=function(){},e.useEffect=function(t,e){return k().useEffect(t,e)},e.useImperativeHandle=function(t,e,n){return k().useImperativeHandle(t,e,n)},e.useLayoutEffect=function(t,e){return k().useLayoutEffect(t,e)},e.useMemo=function(t,e){return k().useMemo(t,e)},e.useReducer=function(t,e,n){return k().useReducer(t,e,n)},e.useRef=function(t){return k().useRef(t)},e.useState=function(t){return k().useState(t)},e.version="17.0.2"},294:(t,e,n)=>{"use strict";t.exports=n(408)},53:(t,e)=>{"use strict";var n,i,r,o;if("object"==typeof performance&&"function"==typeof performance.now){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var c=null,u=null,h=function(){if(null!==c)try{var t=e.unstable_now();c(!0,t),c=null}catch(t){throw setTimeout(h,0),t}};n=function(t){null!==c?setTimeout(n,0,t):(c=t,setTimeout(h,0))},i=function(t,e){u=setTimeout(t,e)},r=function(){clearTimeout(u)},e.unstable_shouldYield=function(){return!1},o=e.unstable_forceFrameRate=function(){}}else{var d=window.setTimeout,f=window.clearTimeout;if("undefined"!=typeof console){var p=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!=typeof p&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var g=!1,m=null,v=-1,y=5,_=0;e.unstable_shouldYield=function(){return e.unstable_now()>=_},o=function(){},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<t?Math.floor(1e3/t):5};var b=new MessageChannel,w=b.port2;b.port1.onmessage=function(){if(null!==m){var t=e.unstable_now();_=t+y;try{m(!0,t)?w.postMessage(null):(g=!1,m=null)}catch(t){throw w.postMessage(null),t}}else g=!1},n=function(t){m=t,g||(g=!0,w.postMessage(null))},i=function(t,n){v=d((function(){t(e.unstable_now())}),n)},r=function(){f(v),v=-1}}function x(t,e){var n=t.length;t.push(e);t:for(;;){var i=n-1>>>1,r=t[i];if(!(void 0!==r&&0<P(r,e)))break t;t[i]=e,t[n]=r,n=i}}function E(t){return void 0===(t=t[0])?null:t}function S(t){var e=t[0];if(void 0!==e){var n=t.pop();if(n!==e){t[0]=n;t:for(var i=0,r=t.length;i<r;){var o=2*(i+1)-1,s=t[o],a=o+1,l=t[a];if(void 0!==s&&0>P(s,n))void 0!==l&&0>P(l,s)?(t[i]=l,t[a]=n,i=a):(t[i]=s,t[o]=n,i=o);else{if(!(void 0!==l&&0>P(l,n)))break t;t[i]=l,t[a]=n,i=a}}}return e}return null}function P(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}var T=[],C=[],A=1,M=null,L=3,k=!1,O=!1,I=!1;function R(t){for(var e=E(C);null!==e;){if(null===e.callback)S(C);else{if(!(e.startTime<=t))break;S(C),e.sortIndex=e.expirationTime,x(T,e)}e=E(C)}}function N(t){if(I=!1,R(t),!O)if(null!==E(T))O=!0,n(z);else{var e=E(C);null!==e&&i(N,e.startTime-t)}}function z(t,n){O=!1,I&&(I=!1,r()),k=!0;var o=L;try{for(R(n),M=E(T);null!==M&&(!(M.expirationTime>n)||t&&!e.unstable_shouldYield());){var s=M.callback;if("function"==typeof s){M.callback=null,L=M.priorityLevel;var a=s(M.expirationTime<=n);n=e.unstable_now(),"function"==typeof a?M.callback=a:M===E(T)&&S(T),R(n)}else S(T);M=E(T)}if(null!==M)var l=!0;else{var c=E(C);null!==c&&i(N,c.startTime-n),l=!1}return l}finally{M=null,L=o,k=!1}}var F=o;e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){O||k||(O=!0,n(z))},e.unstable_getCurrentPriorityLevel=function(){return L},e.unstable_getFirstCallbackNode=function(){return E(T)},e.unstable_next=function(t){switch(L){case 1:case 2:case 3:var e=3;break;default:e=L}var n=L;L=e;try{return t()}finally{L=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=F,e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=L;L=t;try{return e()}finally{L=n}},e.unstable_scheduleCallback=function(t,o,s){var a=e.unstable_now();switch(s="object"==typeof s&&null!==s&&"number"==typeof(s=s.delay)&&0<s?a+s:a,t){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return t={id:A++,callback:o,priorityLevel:t,startTime:s,expirationTime:l=s+l,sortIndex:-1},s>a?(t.sortIndex=s,x(C,t),null===E(T)&&t===E(C)&&(I?r():I=!0,i(N,s-a))):(t.sortIndex=l,x(T,t),O||k||(O=!0,n(z))),t},e.unstable_wrapCallback=function(t){var e=L;return function(){var n=L;L=e;try{return t.apply(this,arguments)}finally{L=n}}}},840:(t,e,n)=>{"use strict";t.exports=n(53)}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={exports:{}};return t[i].call(o.exports,o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=n(294);function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function i(t,n,i){return(n=function(t){var n=function(t,n){if("object"!==e(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,"string");if("object"!==e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===e(n)?n:String(n)}(n))in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t}let r=1,o=1;class s{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(t){const{delay:e=0,duration:n=Number.POSITIVE_INFINITY,rate:i=1,repeat:o=1}=t,s=r++,a={time:0,delay:e,duration:n,rate:i,repeat:o};return this._setChannelTime(a,this.time),this.channels.set(s,a),s}removeChannel(t){this.channels.delete(t);for(const[e,n]of this.animations)n.channel===t&&this.detachAnimation(e)}isFinished(t){const e=this.channels.get(t);return void 0!==e&&this.time>=e.delay+e.duration*e.repeat}getTime(t){if(void 0===t)return this.time;const e=this.channels.get(t);return void 0===e?-1:e.time}setTime(t){this.time=Math.max(0,t);const e=this.channels.values();for(const t of e)this._setChannelTime(t,this.time);const n=this.animations.values();for(const t of n){const{animation:e,channel:n}=t;e.setTime(this.getTime(n))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(t,e){const n=o++;return this.animations.set(n,{animation:t,channel:e}),t.setTime(this.getTime(e)),n}detachAnimation(t){this.animations.delete(t)}update(t){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}_setChannelTime(t,e){const n=e-t.delay;n>=t.duration*t.repeat?t.time=t.duration*t.rate:(t.time=Math.max(0,n)%t.duration,t.time*=t.rate)}}const a=Symbol.for("component"),l=Symbol.for("propTypes"),c=Symbol.for("deprecatedProps"),u=Symbol.for("asyncPropDefaults"),h=Symbol.for("asyncPropOriginal"),d=Symbol.for("asyncPropResolved");function f(t){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function p(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||f()}const g="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source";p();class m{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";i(this,"storage",void 0),i(this,"id",void 0),i(this,"config",void 0),this.storage=function(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(t){return null}}(n),this.id=t,this.config=e,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){if(Object.assign(this.config,t),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}}_loadConfiguration(){let t={};if(this.storage){const e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}function v(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const o=t.width*n,s=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(s/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(s,"px;"),"background:url(".concat(r,");"),"background-size:".concat(o,"px ").concat(s,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let y;function _(t){return"string"==typeof t?y[t.toUpperCase()]||y.WHITE:t}function b(t,e){if(!t)throw new Error(e||"Assertion failed")}!function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(y||(y={}));const w={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==n.g&&n.g,document:"undefined"!=typeof document&&document,process:"object"==typeof process&&process},x=w.window||w.self||w.global,E=w.process||{};function S(){let t;var e,n;if(p&&"performance"in x)t=null==x||null===(e=x.performance)||void 0===e||null===(n=e.now)||void 0===n?void 0:n.call(e);else if("hrtime"in E){var i;const e=null==E||null===(i=E.hrtime)||void 0===i?void 0:i.call(E);t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}const P={debug:p&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},T={enabled:!0,level:0};function C(){}const A={},M={once:!0};class L{constructor(){let{id:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""};i(this,"id",void 0),i(this,"VERSION",g),i(this,"_startTs",S()),i(this,"_deltaTs",S()),i(this,"_storage",void 0),i(this,"userData",{}),i(this,"LOG_THROTTLE_TIMEOUT",0),this.id=t,this.userData={},this._storage=new m("__probe-".concat(this.id,"__"),T),this.timeStamp("".concat(this.id," started")),function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n);for(const n of i)"function"==typeof t[n]&&(e.find((t=>n===t))||(t[n]=t[n].bind(t)))}(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((S()-this._startTs).toPrecision(10))}getDelta(){return Number((S()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.setConfiguration({enabled:t}),this}setLevel(t){return this._storage.setConfiguration({level:t}),this}get(t){return this._storage.config[t]}set(t,e){this._storage.setConfiguration({[t]:e})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(t,e){b(t,e)}warn(t){return this._getLogFunction(0,t,P.warn,arguments,M)}error(t){return this._getLogFunction(0,t,P.error,arguments)}deprecated(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}removed(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}probe(t,e){return this._getLogFunction(t,e,P.log,arguments,{time:!0,once:!0})}log(t,e){return this._getLogFunction(t,e,P.debug,arguments)}info(t,e){return this._getLogFunction(t,e,console.info,arguments)}once(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return this._getLogFunction(t,e,P.debug||P.info,arguments,M)}table(t,e,n){return e?this._getLogFunction(t,e,console.table||C,n&&[n],{tag:I(e)}):C}image(t){let{logLevel:e,priority:n,image:i,message:r="",scale:o=1}=t;return this._shouldLog(e||n)?p?function(t){let{image:e,message:n="",scale:i=1}=t;if("string"==typeof e){const t=new Image;return t.onload=()=>{const e=v(t,n,i);console.log(...e)},t.src=e,C}const r=e.nodeName||"";if("img"===r.toLowerCase())return console.log(...v(e,n,i)),C;if("canvas"===r.toLowerCase()){const t=new Image;return t.onload=()=>console.log(...v(t,n,i)),t.src=e.toDataURL(),C}return C}({image:i,message:r,scale:o}):function(t){let{image:e,message:n="",scale:i=1}=t;return console.warn("removed"),C}({image:i,message:r,scale:o}):C}time(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}timeEnd(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,e){return this._getLogFunction(t,e,console.timeStamp||C)}group(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const i=O({logLevel:t,message:e,opts:n}),{collapsed:r}=n;return i.method=(r?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(t,e,Object.assign({},n,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||C)}withGroup(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=k(t)}_getLogFunction(t,e,n,i,r){if(this._shouldLog(t)){r=O({logLevel:t,message:e,args:i,opts:r}),b(n=n||r.method),r.total=this.getTotal(),r.delta=this.getDelta(),this._deltaTs=S();const o=r.tag||r.message;if(r.once){if(A[o])return C;A[o]=S()}return e=function(t,e,n){if("string"==typeof e){const s=n.time?function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}(function(t){let e;return e=t<10?"".concat(t.toFixed(2),"ms"):t<100?"".concat(t.toFixed(1),"ms"):t<1e3?"".concat(t.toFixed(0),"ms"):"".concat((t/1e3).toFixed(2),"s"),e}(n.total)):"";i=e=n.time?"".concat(t,": ").concat(s,"  ").concat(e):"".concat(t,": ").concat(e),r=n.color,o=n.background,p||"string"!=typeof i||(r&&(r=_(r),i="[".concat(r,"m").concat(i,"[39m")),o&&(r=_(o),i="[".concat(o+10,"m").concat(i,"[49m"))),e=i}var i,r,o;return e}(this.id,r.message,r),n.bind(console,e,...r.args)}return C}}function k(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return b(Number.isFinite(e)&&e>=0),e}function O(t){const{logLevel:e,message:n}=t;t.logLevel=k(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":void 0!==n&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e)}"function"==typeof t.message&&(t.message=t.message());const r=typeof t.message;return b("string"===r||"object"===r),Object.assign(t,{args:i},t.opts)}function I(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}i(L,"VERSION",g);const R=new L({id:"deck"});let N={};function z(t){N=t}function F(t,e,n,i){R.level>0&&N[t]&&N[t].call(null,e,n,i)}function D(t,e=(()=>!0)){return Array.isArray(t)?j(t,e,[]):e(t)?[t]:[]}function j(t,e,n){let i=-1;for(;++i<t.length;){const r=t[i];Array.isArray(r)?j(r,e,n):e(r)&&n.push(r)}return n}function B({target:t,source:e,start:n=0,count:i=1}){const r=e.length,o=i*r;let s=0;for(let i=n;s<r;s++)t[i++]=e[s];for(;s<o;)s<o-s?(t.copyWithin(n+s,n,n+s),s*=2):(t.copyWithin(n+s,n,n+o-s),s=o);return t}function U(){let t;if("undefined"!=typeof window&&window.performance)t=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const e=process.hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}class V{constructor(t,e){i(this,"name",void 0),i(this,"type",void 0),i(this,"sampleSize",1),i(this,"time",void 0),i(this,"count",void 0),i(this,"samples",void 0),i(this,"lastTiming",void 0),i(this,"lastSampleTime",void 0),i(this,"lastSampleCount",void 0),i(this,"_count",0),i(this,"_time",0),i(this,"_samples",0),i(this,"_startTime",0),i(this,"_timerPending",!1),this.name=t,this.type=e,this.reset()}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=U(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(U()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class W{constructor(t){i(this,"id",void 0),i(this,"stats",{}),this.id=t.id,this.stats={},this._initializeStats(t.stats),Object.seal(this)}get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:t,type:e})}get size(){return Object.keys(this.stats).length}reset(){for(const t in this.stats)this.stats[t].reset();return this}forEach(t){for(const e in this.stats)t(this.stats[e])}getTable(){const t={};return this.forEach((e=>{t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}})),t}_initializeStats(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((t=>this._getOrCreate(t)))}_getOrCreate(t){if(!t||!t.name)return null;const{name:e,type:n}=t;return this.stats[e]||(this.stats[e]=t instanceof V?t:new V(e,n)),this.stats[e]}}const G=t=>"function"==typeof t,H=t=>null!==t&&"object"==typeof t,q=t=>H(t)&&t.constructor==={}.constructor,X=t=>t&&"function"==typeof t[Symbol.iterator],Z=t=>t&&"function"==typeof t[Symbol.asyncIterator],Y=t=>"undefined"!=typeof Response&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,K=t=>"undefined"!=typeof Blob&&t instanceof Blob,Q=t=>t&&"object"==typeof t&&t.isBuffer,$=t=>(t=>"undefined"!=typeof ReadableStream&&t instanceof ReadableStream||H(t)&&G(t.tee)&&G(t.cancel)&&G(t.getReader))(t)||(t=>H(t)&&G(t.read)&&G(t.pipe)&&(t=>"boolean"==typeof t)(t.readable))(t);function J(t,e){if(!t)throw new Error(e||"loader assertion failed.")}function tt(t){var e;return!!t&&(Array.isArray(t)&&(t=t[0]),Array.isArray(null===(e=t)||void 0===e?void 0:e.extensions))}function et(t){var e,n;let i;return J(t,"null loader"),J(tt(t),"invalid loader"),Array.isArray(t)&&(i=t[1],t=t[0],t={...t,options:{...t.options,...i}}),(null!==(e=t)&&void 0!==e&&e.parseTextSync||null!==(n=t)&&void 0!==n&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}let nt="";const it={},rt=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,ot=/^([-\w.]+\/[-\w.+]+)/;function st(t){const e=rt.exec(t);return e?e[1]:""}const at=/\?.*/;function lt(t){return t.replace(at,"")}function ct(t){return Y(t)?t.url:K(t)?t.name||"":"string"==typeof t?t:""}function ut(t){if(Y(t)){const e=t,n=e.headers.get("content-type")||"",i=lt(e.url);return function(t){const e=ot.exec(t);return e?e[1]:t}(n)||st(i)}return K(t)?t.type||"":"string"==typeof t?st(t):""}async function ht(t){if(Y(t))return t;const e={},n=function(t){return Y(t)?t.headers["content-length"]||-1:K(t)?t.size:"string"==typeof t?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}(t);n>=0&&(e["content-length"]=String(n));const i=ct(t),r=ut(t);r&&(e["content-type"]=r);const o=await async function(t){if("string"==typeof t)return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const e=t.slice(0,5);return await new Promise((t=>{const n=new FileReader;n.onload=e=>{var n;return t(null==e||null===(n=e.target)||void 0===n?void 0:n.result)},n.readAsDataURL(e)}))}if(t instanceof ArrayBuffer){const e=function(t){let e="";const n=new Uint8Array(t);for(let t=0;t<n.byteLength;t++)e+=String.fromCharCode(n[t]);return btoa(e)}(t.slice(0,5));return"data:base64,".concat(e)}return null}(t);o&&(e["x-first-bytes"]=o),"string"==typeof t&&(t=(new TextEncoder).encode(t));const s=new Response(t,{headers:e});return Object.defineProperty(s,"url",{value:i}),s}async function dt(t,e){if("string"==typeof t){t=function(t){for(const e in it)if(t.startsWith(e)){const n=it[e];t=t.replace(e,n)}return t.startsWith("http://")||t.startsWith("https://")||(t="".concat(nt).concat(t)),t}(t);let n=e;return null!=e&&e.fetch&&"function"!=typeof(null==e?void 0:e.fetch)&&(n=e.fetch),await fetch(t,n)}return await ht(t)}function ft(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||function(t){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent;return!!(e&&e.indexOf("Electron")>=0)}()}const pt="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source";ft();class gt{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=function(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(t){return null}}(n),this.id=t,this.config=e,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){if(Object.assign(this.config,t),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}}_loadConfiguration(){let t={};if(this.storage){const e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}function mt(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const o=t.width*n,s=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(s/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(s,"px;"),"background:url(".concat(r,");"),"background-size:".concat(o,"px ").concat(s,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let vt;!function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(vt||(vt={}));function yt(t){return"string"!=typeof t?t:(t=t.toUpperCase(),vt[t]||vt.WHITE)}function _t(t,e){if(!t)throw new Error(e||"Assertion failed")}globalThis.self||globalThis.window||globalThis.global;const bt=globalThis.window||globalThis.self||globalThis.global,wt=(globalThis.document,globalThis.process||{});function xt(){let t;var e,n;if(ft()&&bt.performance)t=null==bt||null===(e=bt.performance)||void 0===e||null===(n=e.now)||void 0===n?void 0:n.call(e);else if("hrtime"in wt){var i;const e=null==wt||null===(i=wt.hrtime)||void 0===i?void 0:i.call(wt);t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}globalThis.console,globalThis.navigator;const Et={debug:ft()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},St={enabled:!0,level:0};function Pt(){}const Tt={},Ct={once:!0};class At{constructor(){let{id:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""};this.id=void 0,this.VERSION=pt,this._startTs=xt(),this._deltaTs=xt(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=t,this.userData={},this._storage=new gt("__probe-".concat(this.id,"__"),St),this.timeStamp("".concat(this.id," started")),function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n),r=t;for(const n of i){const i=r[n];"function"==typeof i&&(e.find((t=>n===t))||(r[n]=i.bind(t)))}}(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((xt()-this._startTs).toPrecision(10))}getDelta(){return Number((xt()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.setConfiguration({enabled:t}),this}setLevel(t){return this._storage.setConfiguration({level:t}),this}get(t){return this._storage.config[t]}set(t,e){this._storage.setConfiguration({[t]:e})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(t,e){_t(t,e)}warn(t){return this._getLogFunction(0,t,Et.warn,arguments,Ct)}error(t){return this._getLogFunction(0,t,Et.error,arguments)}deprecated(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}removed(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}probe(t,e){return this._getLogFunction(t,e,Et.log,arguments,{time:!0,once:!0})}log(t,e){return this._getLogFunction(t,e,Et.debug,arguments)}info(t,e){return this._getLogFunction(t,e,console.info,arguments)}once(t,e){return this._getLogFunction(t,e,Et.debug||Et.info,arguments,Ct)}table(t,e,n){return e?this._getLogFunction(t,e,console.table||Pt,n&&[n],{tag:kt(e)}):Pt}image(t){let{logLevel:e,priority:n,image:i,message:r="",scale:o=1}=t;return this._shouldLog(e||n)?ft()?function(t){let{image:e,message:n="",scale:i=1}=t;if("string"==typeof e){const t=new Image;return t.onload=()=>{const e=mt(t,n,i);console.log(...e)},t.src=e,Pt}const r=e.nodeName||"";if("img"===r.toLowerCase())return console.log(...mt(e,n,i)),Pt;if("canvas"===r.toLowerCase()){const t=new Image;return t.onload=()=>console.log(...mt(t,n,i)),t.src=e.toDataURL(),Pt}return Pt}({image:i,message:r,scale:o}):function(t){let{image:e,message:n="",scale:i=1}=t;return console.warn("removed"),Pt}({image:i,message:r,scale:o}):Pt}time(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}timeEnd(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,e){return this._getLogFunction(t,e,console.timeStamp||Pt)}group(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const i=Lt({logLevel:t,message:e,opts:n}),{collapsed:r}=n;return i.method=(r?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(t,e,Object.assign({},n,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||Pt)}withGroup(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=Mt(t)}_getLogFunction(t,e,n,i,r){if(this._shouldLog(t)){r=Lt({logLevel:t,message:e,args:i,opts:r}),_t(n=n||r.method),r.total=this.getTotal(),r.delta=this.getDelta(),this._deltaTs=xt();const o=r.tag||r.message;if(r.once&&o){if(Tt[o])return Pt;Tt[o]=xt()}return e=function(t,e,n){if("string"==typeof e){const i=n.time?function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}(function(t){let e;return e=t<10?"".concat(t.toFixed(2),"ms"):t<100?"".concat(t.toFixed(1),"ms"):t<1e3?"".concat(t.toFixed(0),"ms"):"".concat((t/1e3).toFixed(2),"s"),e}(n.total)):"";e=function(t,e,n){if(!ft&&"string"==typeof t){if(e){const n=yt(e);t="[".concat(n,"m").concat(t,"[39m")}if(n){const e=yt(n);t="[".concat(e+10,"m").concat(t,"[49m")}}return t}(e=n.time?"".concat(t,": ").concat(i,"  ").concat(e):"".concat(t,": ").concat(e),n.color,n.background)}return e}(this.id,r.message,r),n.bind(console,e,...r.args)}return Pt}}function Mt(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return _t(Number.isFinite(e)&&e>=0),e}function Lt(t){const{logLevel:e,message:n}=t;t.logLevel=Mt(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":void 0!==n&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e)}"function"==typeof t.message&&(t.message=t.message());const r=typeof t.message;return _t("string"===r||"object"===r),Object.assign(t,{args:i},t.opts)}function kt(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}At.VERSION=pt;const Ot=new At({id:"loaders.gl"});class It{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,void 0!==n.g&&n.g,"undefined"!=typeof document&&document;const Rt=Boolean("object"!=typeof process||"[object process]"!==String(process)||process.browser),Nt="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),zt=(Nt&&parseFloat(Nt[1]),{fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){i(this,"console",void 0),this.console=console}log(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.log.bind(this.console,...e)}info(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.info.bind(this.console,...e)}warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.warn.bind(this.console,...e)}error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.error.bind(this.console,...e)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:Rt,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]}),Ft={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function Dt(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const jt=()=>{const t=Dt();return t.globalOptions=t.globalOptions||{...zt},t.globalOptions};function Bt(t,e,n,i){return n=n||[],function(t,e){Ut(t,null,zt,Ft,e);for(const n of e){const i=t&&t[n.id]||{},r=n.options&&n.options[n.id]||{},o=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};Ut(i,n.id,r,o,e)}}(t,n=Array.isArray(n)?n:[n]),function(t,e,n){const i={...t.options||{}};return function(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}(i,n),null===i.log&&(i.log=new It),Wt(i,jt()),Wt(i,e),i}(e,t,i)}function Ut(t,e,n,i,r){const o=e||"Top level",s=e?"".concat(e,"."):"";for(const a in t){const l=!e&&H(t[a]);if(!(a in n)&&("baseUri"!==a||e)&&("workerUrl"!==a||!e))if(a in i)Ot.warn("".concat(o," loader option '").concat(s).concat(a,"' no longer supported, use '").concat(i[a],"'"))();else if(!l){const t=Vt(a,r);Ot.warn("".concat(o," loader option '").concat(s).concat(a,"' not recognized. ").concat(t))()}}}function Vt(t,e){const n=t.toLowerCase();let i="";for(const r of e)for(const e in r.options){if(t===e)return"Did you mean '".concat(r.id,".").concat(e,"'?");const o=e.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(i=i||"Did you mean '".concat(r.id,".").concat(e,"'?"))}return i}function Wt(t,e){for(const n in e)if(n in e){const i=e[n];q(i)&&q(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function Gt(t,e){const n=jt(),i=t||n;return"function"==typeof i.fetch?i.fetch:H(i.fetch)?t=>dt(t,i):null!=e&&e.fetch?null==e?void 0:e.fetch:dt}function Ht(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,void 0!==n.g&&n.g,"undefined"!=typeof document&&document;const qt="object"!=typeof process||"[object process]"!==String(process)||process.browser,Xt="undefined"!=typeof window&&void 0!==window.orientation,Zt="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);Zt&&parseFloat(Zt[1]);class Yt{terminate(){}}const Kt=new Map;function Qt(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function $t(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;const i=n||new Set;if(t)if(Jt(t))i.add(t);else if(Jt(t.buffer))i.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"==typeof t)for(const n in t)$t(t[n],e,i);return void 0===n?Array.from(i):[]}function Jt(t){return!!t&&(t instanceof ArrayBuffer||"undefined"!=typeof MessagePort&&t instanceof MessagePort||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas)}const te=()=>{};class ee{static isSupported(){return"undefined"!=typeof Worker&&qt||void 0!==Yt&&!qt}constructor(t){i(this,"name",void 0),i(this,"source",void 0),i(this,"url",void 0),i(this,"terminated",!1),i(this,"worker",void 0),i(this,"onMessage",void 0),i(this,"onError",void 0),i(this,"_loadableURL","");const{name:e,source:n,url:r}=t;Ht(n||r),this.name=e,this.source=n,this.url=r,this.onMessage=te,this.onError=t=>console.log(t),this.worker=qt?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=te,this.onError=te,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(t,e){e=e||$t(t),this.worker.postMessage(t,e)}_getErrorFromErrorEvent(t){let e="Failed to load ";return e+="worker ".concat(this.name," from ").concat(this.url,". "),t.message&&(e+="".concat(t.message," in ")),t.lineno&&(e+=":".concat(t.lineno,":").concat(t.colno)),new Error(e)}_createBrowserWorker(){this._loadableURL=function(t){Ht(t.source&&!t.url||!t.source&&t.url);let e=Kt.get(t.source||t.url);return e||(t.url&&(e=(n=t.url).startsWith("http")?Qt("try {\n  importScripts('".concat(n,"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}")):n,Kt.set(t.url,e)),t.source&&(e=Qt(t.source),Kt.set(t.source,e))),Ht(e),e;var n}({source:this.source,url:this.url});const t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},t.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},t.onmessageerror=t=>console.error(t),t}_createNodeWorker(){let t;if(this.url){const e=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);t=new Yt(e,{eval:!1})}else{if(!this.source)throw new Error("no worker");t=new Yt(this.source,{eval:!0})}return t.on("message",(t=>{this.onMessage(t)})),t.on("error",(t=>{this.onError(t)})),t.on("exit",(t=>{})),t}}class ne{constructor(t,e){i(this,"name",void 0),i(this,"workerThread",void 0),i(this,"isRunning",!0),i(this,"result",void 0),i(this,"_resolve",(()=>{})),i(this,"_reject",(()=>{})),this.name=t,this.workerThread=e,this.result=new Promise(((t,e)=>{this._resolve=t,this._reject=e}))}postMessage(t,e){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:e})}done(t){Ht(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){Ht(this.isRunning),this.isRunning=!1,this._reject(t)}}class ie{static isSupported(){return ee.isSupported()}constructor(t){i(this,"name","unnamed"),i(this,"source",void 0),i(this,"url",void 0),i(this,"maxConcurrency",1),i(this,"maxMobileConcurrency",1),i(this,"onDebug",(()=>{})),i(this,"reuseWorkers",!0),i(this,"props",{}),i(this,"jobQueue",[]),i(this,"idleQueue",[]),i(this,"count",0),i(this,"isDestroyed",!1),this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach((t=>t.destroy())),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)}async startJob(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t,e,n)=>t.done(n),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(t,e)=>t.error(e);const i=new Promise((i=>(this.jobQueue.push({name:t,onMessage:e,onError:n,onStart:i}),this)));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const t=this._getAvailableWorker();if(!t)return;const e=this.jobQueue.shift();if(e){this.onDebug({message:"Starting job",name:e.name,workerThread:t,backlog:this.jobQueue.length});const n=new ne(e.name,t);t.onMessage=t=>e.onMessage(n,t.type,t.payload),t.onError=t=>e.onError(n,t),e.onStart(n);try{await n.result}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const t="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new ee({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return Xt?this.maxMobileConcurrency:this.maxConcurrency}}const re={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class oe{static isSupported(){return ee.isSupported()}static getWorkerFarm(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return oe._workerFarm=oe._workerFarm||new oe({}),oe._workerFarm.setProps(t),oe._workerFarm}constructor(t){i(this,"props",void 0),i(this,"workerPools",new Map),this.props={...re},this.setProps(t),this.workerPools=new Map}destroy(){for(const t of this.workerPools.values())t.destroy();this.workerPools=new Map}setProps(t){this.props={...this.props,...t};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(t){const{name:e,source:n,url:i}=t;let r=this.workerPools.get(e);return r||(r=new ie({name:e,source:n,url:i}),r.setProps(this._getWorkerPoolProps()),this.workerPools.set(e,r)),r}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}i(oe,"_workerFarm",void 0);const se="latest";async function ae(t,e,n,i,r){const o=t.id,s=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e[t.id]||{},i="".concat(t.id,"-worker.js");let r=n.workerUrl;if(r||"compression"!==t.id||(r=e.workerUrl),"test"===e._workerType&&(r="modules/".concat(t.module,"/dist/").concat(i)),!r){let e=t.version;"latest"===e&&(e=se);const n=e?"@".concat(e):"";r="https://unpkg.com/@loaders.gl/".concat(t.module).concat(n,"/dist/").concat(i)}return Ht(r),r}(t,n),a=oe.getWorkerFarm(n).getWorkerPool({name:o,url:s});n=JSON.parse(JSON.stringify(n)),i=JSON.parse(JSON.stringify(i||{}));const l=await a.startJob("process-on-worker",le.bind(null,r));l.postMessage("process",{input:e,options:n,context:i});const c=await l.result;return await c.result}async function le(t,e,n,i){switch(n){case"done":e.done(i);break;case"error":e.error(new Error(i.error));break;case"process":const{id:r,input:o,options:s}=i;try{const n=await t(o,s);e.postMessage("done",{id:r,result:n})}catch(t){const n=t instanceof Error?t.message:"unknown error";e.postMessage("error",{id:r,error:n})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}const ce=262144,ue=262144,he=1048576;function de(t){if((e=t)&&"object"==typeof e&&e.isBuffer)return t;var e;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return 0===t.byteOffset&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if("string"==typeof t){const e=t;return(new TextEncoder).encode(e).buffer}if(t&&"object"==typeof t&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function fe(t,e){return Rt?async function*(t,e){const n=t.getReader();let i;try{for(;;){const t=i||n.read();null!=e&&e._streamReadAhead&&(i=n.read());const{done:r,value:o}=await t;if(r)return;yield de(o)}}catch(t){n.releaseLock()}}(t,e):async function*(t,e){for await(const e of t)yield de(e)}(t)}const pe="Cannot convert supplied data type";async function ge(t,e,n){const i=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if("string"==typeof t||i)return function(t,e,n){if(e.text&&"string"==typeof t)return t;if(Q(t)&&(t=t.buffer),t instanceof ArrayBuffer){const n=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let n=t.buffer;const i=t.byteLength||t.length;return 0===t.byteOffset&&i===n.byteLength||(n=n.slice(t.byteOffset,t.byteOffset+i)),n}throw new Error(pe)}(t,e);if(K(t)&&(t=await ht(t)),Y(t)){const n=t;return await async function(t){if(!t.ok){const e=await async function(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let i=t.statusText;n.includes("application/json")&&(i+=" ".concat(await t.text())),e+=i,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch(t){}return e}(t);throw new Error(e)}}(n),e.binary?await n.arrayBuffer():await n.text()}if($(t)&&(t=function(t,e){if("string"==typeof t)return function*(t,e){const n=(null==e?void 0:e.chunkSize)||ce;let i=0;const r=new TextEncoder;for(;i<t.length;){const e=Math.min(t.length-i,n),o=t.slice(i,i+e);i+=e,yield r.encode(o)}}(t,e);if(t instanceof ArrayBuffer)return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){const{chunkSize:n=ue}=e;let i=0;for(;i<t.byteLength;){const e=Math.min(t.byteLength-i,n),r=new ArrayBuffer(e),o=new Uint8Array(t,i,e);new Uint8Array(r).set(o),i+=e,yield r}}()}(t,e);if(K(t))return async function*(t,e){const n=(null==e?void 0:e.chunkSize)||he;let i=0;for(;i<t.size;){const e=i+n,r=await t.slice(i,e).arrayBuffer();i=e,yield r}}(t,e);if($(t))return fe(t,e);if(Y(t))return fe(t.body,e);throw new Error("makeIterator")}(t,n)),X(t)||Z(t))return async function(t){const e=[];for await(const n of t)e.push(n);return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=e.map((t=>t instanceof ArrayBuffer?new Uint8Array(t):t)),r=i.reduce(((t,e)=>t+e.byteLength),0),o=new Uint8Array(r);let s=0;for(const t of i)o.set(t,s),s+=t.byteLength;return o.buffer}(...e)}(t);throw new Error(pe)}function me(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}const ve=new At({id:"loaders.gl"}),ye=()=>{const t=Dt();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry},_e=/\.([^.]+)$/;function be(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!we(t))return null;if(e&&!Array.isArray(e))return et(e);let r=[];e&&(r=r.concat(e)),null!=n&&n.ignoreRegisteredLoaders||r.push(...ye()),function(t){for(const e of t)et(e)}(r);const o=function(t,e,n,i){const r=ct(t),o=ut(t),s=lt(r)||(null==i?void 0:i.url);let a=null,l="";var c;return null!=n&&n.mimeType&&(a=Ee(e,null==n?void 0:n.mimeType),l="match forced by supplied MIME type ".concat(null==n?void 0:n.mimeType)),a=a||function(t,e){const n=e&&_e.exec(e),i=n&&n[1];return i?function(t,e){e=e.toLowerCase();for(const n of t)for(const t of n.extensions)if(t.toLowerCase()===e)return n;return null}(t,i):null}(e,s),l=l||(a?"matched url ".concat(s):""),a=a||Ee(e,o),l=l||(a?"matched MIME type ".concat(o):""),a=a||function(t,e){if(!e)return null;for(const n of t)if("string"==typeof e){if(Se(e,n))return n}else if(ArrayBuffer.isView(e)){if(Pe(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&Pe(e,0,n))return n;return null}(e,t),l=l||(a?"matched initial data ".concat(Te(t)):""),a=a||Ee(e,null==n?void 0:n.fallbackMimeType),l=l||(a?"matched fallback MIME type ".concat(o):""),l&&ve.log(1,"selectLoader selected ".concat(null===(c=a)||void 0===c?void 0:c.name,": ").concat(l,".")),a}(t,r,n,i);if(!(o||null!=n&&n.nothrow))throw new Error(xe(t));return o}function we(t){return!(t instanceof Response&&204===t.status)}function xe(t){const e=ct(t),n=ut(t);let i="No valid loader found (";i+=e?"".concat(me(e),", "):"no url provided, ",i+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const r=t?Te(t):"";return i+=r?' first bytes: "'.concat(r,'"'):"first bytes: not available",i+=")",i}function Ee(t,e){for(const n of t){if(n.mimeTypes&&n.mimeTypes.includes(e))return n;if(e==="application/x.".concat(n.id))return n}return null}function Se(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some((e=>t.startsWith(e)))}function Pe(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some((i=>function(t,e,n,i){if(i instanceof ArrayBuffer)return function(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const i=new Uint8Array(t),r=new Uint8Array(e);for(let t=0;t<i.length;++t)if(i[t]!==r[t])return!1;return!0}(i,t,i.byteLength);switch(typeof i){case"function":return i(t,n);case"string":return i===Ce(t,e,i.length);default:return!1}}(t,e,n,i)))}function Te(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return"string"==typeof t?t.slice(0,e):ArrayBuffer.isView(t)?Ce(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?Ce(t,0,e):""}function Ce(t,e,n){if(t.byteLength<e+n)return"";const i=new DataView(t);let r="";for(let t=0;t<n;t++)r+=String.fromCharCode(i.getUint8(e+t));return r}async function Ae(t,e,n,i){Ht(!i||"object"==typeof i),!e||Array.isArray(e)||tt(e)||(i=void 0,n=e,e=void 0),n=n||{};const r=ct(t=await t),o=function(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const t=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...t]:t}return n&&n.length?n:null}(e,i),s=await async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!we(t))return null;let r=be(t,e,{...n,nothrow:!0},i);if(r)return r;if(K(t)&&(r=be(t=await t.slice(0,10).arrayBuffer(),e,n,i)),!(r||null!=n&&n.nothrow))throw new Error(xe(t));return r}(t,o,n);return s?(i=function(t,e,n){if(n)return n;const i={fetch:Gt(e,t),...t};if(i.url){const t=lt(i.url);i.baseUrl=t,i.queryString=function(t){const e=t.match(at);return e&&e[0]}(i.url),i.filename=me(t),i.baseUrl=function(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}(t)}return Array.isArray(i.loaders)||(i.loaders=null),i}({url:r,parse:Ae,loaders:o},n=Bt(n,s,o,r),i||null),await async function(t,e,n,i){if(function(t){Ht(t,"no worker provided");t.version}(t),Y(e)){const t=e,{ok:n,redirected:r,status:o,statusText:s,type:a,url:l}=t,c=Object.fromEntries(t.headers.entries());i.response={headers:c,ok:n,redirected:r,status:o,statusText:s,type:a,url:l}}if(e=await ge(e,t,n),t.parseTextSync&&"string"==typeof e)return n.dataType="text",t.parseTextSync(e,n,i,t);if(function(t,e){return!!oe.isSupported()&&!!(qt||null!=e&&e._nodeWorkers)&&t.worker&&(null==e?void 0:e.worker)}(t,n))return await ae(t,e,n,i,Ae);if(t.parseText&&"string"==typeof e)return await t.parseText(e,n,i,t);if(t.parse)return await t.parse(e,n,i,t);throw Ht(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}(s,t,n,i)):null}async function Me(t,e,n,i){Array.isArray(e)||tt(e)||(n=e,e=void 0);const r=Gt(n);let o=t;return"string"==typeof t&&(o=await r(t)),K(t)&&(o=await r(t)),await Ae(o,e,n)}class Le{constructor(t,e,n){i(this,"id",void 0),i(this,"context",void 0),i(this,"isLoaded",void 0),i(this,"persistent",void 0),i(this,"_loadCount",0),i(this,"_subscribers",new Set),i(this,"_data",void 0),i(this,"_loader",void 0),i(this,"_error",void 0),i(this,"_content",void 0),this.id=t,this.context=n,this.setData(e)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then((()=>this.getData()))}setData(t,e){if(t===this._data&&!e)return;this._data=t;const n=++this._loadCount;let i=t;"string"==typeof t&&(i=Me(t)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then((t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=t)})).catch((t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=t||!0)}))):(this.isLoaded=!0,this._error=void 0,this._content=t);for(const t of this._subscribers)t.onChange(this.getData())}}class ke{constructor({gl:t,protocol:e}){i(this,"protocol",void 0),i(this,"_context",void 0),i(this,"_resources",void 0),i(this,"_consumers",void 0),i(this,"_pruneRequest",void 0),this.protocol=e||"resource://",this._context={gl:t,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(t){return!!t.startsWith(this.protocol)||t in this._resources}add({resourceId:t,data:e,forceUpdate:n=!1,persistent:i=!0}){let r=this._resources[t];r?r.setData(e,n):(r=new Le(t,e,this._context),this._resources[t]=r),r.persistent=i}remove(t){const e=this._resources[t];e&&(e.delete(),delete this._resources[t])}unsubscribe({consumerId:t}){const e=this._consumers[t];if(e){for(const t in e){const n=e[t],i=this._resources[n.resourceId];i&&i.unsubscribe(n)}delete this._consumers[t],this.prune()}}subscribe({resourceId:t,onChange:e,consumerId:n,requestId:i="default"}){const{_resources:r,protocol:o}=this;t.startsWith(o)&&(r[t=t.replace(o,"")]||this.add({resourceId:t,data:null,persistent:!1}));const s=r[t];if(this._track(n,i,s,e),s)return s.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout((()=>this._prune()),0))}finalize(){for(const t in this._resources)this._resources[t].delete()}_track(t,e,n,i){const r=this._consumers,o=r[t]=r[t]||{},s=o[e]||{},a=s.resourceId&&this._resources[s.resourceId];a&&(a.unsubscribe(s),this.prune()),n&&(o[e]=s,s.onChange=i,s.resourceId=n.id,n.subscribe(s))}_prune(){this._pruneRequest=null;for(const t of Object.keys(this._resources)){const e=this._resources[t];e.persistent||e.inUse()||(e.delete(),delete this._resources[t])}}}const Oe=new class{constructor(t={}){i(this,"_pool",[]),i(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(t)}setOptions(t){Object.assign(this.opts,t)}allocate(t,e,{size:n=1,type:i,padding:r=0,copy:o=!1,initialize:s=!1,maxCount:a}){const l=i||t&&t.constructor||Float32Array,c=e*n+r;if(ArrayBuffer.isView(t)){if(c<=t.length)return t;if(c*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new l(t.buffer,0,c)}let u=1/0;a&&(u=a*n+r);const h=this._allocate(l,c,s,u);return t&&o?h.set(t):s||h.fill(0,0,4),this._release(t),h}release(t){this._release(t)}_allocate(t,e,n,i){let r=Math.max(Math.ceil(e*this.opts.overAlloc),1);r>i&&(r=i);const o=this._pool,s=t.BYTES_PER_ELEMENT*r,a=o.findIndex((t=>t.byteLength>=s));if(a>=0){const e=new t(o.splice(a,1)[0],0,r);return n&&e.fill(0),e}return new t(r)}_release(t){if(!ArrayBuffer.isView(t))return;const e=this._pool,{buffer:n}=t,{byteLength:i}=n,r=e.findIndex((t=>t.byteLength>=i));r<0?e.push(n):(r>0||e.length<this.opts.poolSize)&&e.splice(r,0,n),e.length>this.opts.poolSize&&e.shift()}},Ie=(Math.PI,Math.PI,{EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0});function Re(t,{precision:e=Ie.precision}={}){return t=function(t){return Math.round(t/Ie.EPSILON)*Ie.EPSILON}(t),"".concat(parseFloat(t.toPrecision(e)))}function Ne(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function ze(t,e,n){return function(t,e,n){if(Ne(t)){const i=t;n=n||function(t){return t.clone?t.clone():new Array(t.length)}(i);for(let r=0;r<n.length&&r<i.length;++r)n[r]=e(t[r],r,n);return n}return e(t)}(t,(t=>Math.max(e,Math.min(n,t))))}function Fe(t,e,n){return Ne(t)?t.map(((t,i)=>Fe(t,e[i],n))):n*e+(1-n)*t}function De(t,e,n){const i=Ie.EPSILON;n&&(Ie.EPSILON=n);try{if(t===e)return!0;if(Ne(t)&&Ne(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!De(t[n],e[n]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):"number"==typeof t&&"number"==typeof e&&Math.abs(t-e)<=Ie.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{Ie.EPSILON=i}}class je extends(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array)){clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}toArray(t=[],e=0){for(let n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:Ne(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Ie)}formatString(t){let e="";for(let n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+Re(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!De(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,n){if(void 0===n)return this.lerp(this,t,e);for(let i=0;i<this.ELEMENTS;++i){const r=t[i];this[i]=r+n*(e[i]-r)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}add(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]+=e[t];return this.check()}subtract(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]-=e[t];return this.check()}scale(t){if("number"==typeof t)for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;else for(let e=0;e<this.ELEMENTS&&e<t.length;++e)this[e]*=t[e];return this.check()}multiplyByScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}check(){if(Ie.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}get elements(){return this}}function Be(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function Ue(t,e,n=""){if(Ie.debug&&!function(t,e){if(t.length!==e)return!1;for(let e=0;e<t.length;++e)if(!Number.isFinite(t[e]))return!1;return!0}(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}function Ve(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}class We extends je{get x(){return this[0]}set x(t){this[0]=Be(t)}get y(){return this[1]}set y(t){this[1]=Be(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let n=0;n<this.ELEMENTS;++n){const i=this[n]-t[n];e+=i*i}return Be(e)}dot(t){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return Be(e)}normalize(){const t=this.magnitude();if(0!==t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e[t];return this.check()}divide(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e[t];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return Ve(t>=0&&t<this.ELEMENTS,"index is out of range"),Be(this[t])}setComponent(t,e){return Ve(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}var Ge=1e-6,He="undefined"!=typeof Float32Array?Float32Array:Array;function qe(){var t=new He(3);return He!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Xe(t,e,n){var i=new He(3);return i[0]=t,i[1]=e,i[2]=n,i}function Ze(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ye(t,e,n){var i=e[0],r=e[1],o=e[2],s=n[0],a=n[1],l=n[2];return t[0]=r*l-o*a,t[1]=o*s-i*l,t[2]=i*a-r*s,t}function Ke(t,e,n){var i=e[0],r=e[1],o=e[2],s=n[3]*i+n[7]*r+n[11]*o+n[15];return s=s||1,t[0]=(n[0]*i+n[4]*r+n[8]*o+n[12])/s,t[1]=(n[1]*i+n[5]*r+n[9]*o+n[13])/s,t[2]=(n[2]*i+n[6]*r+n[10]*o+n[14])/s,t}function Qe(t,e,n){var i=e[0],r=e[1],o=e[2];return t[0]=i*n[0]+r*n[3]+o*n[6],t[1]=i*n[1]+r*n[4]+o*n[7],t[2]=i*n[2]+r*n[5]+o*n[8],t}function $e(t,e,n){var i=n[0],r=n[1],o=n[2],s=n[3],a=e[0],l=e[1],c=e[2],u=r*c-o*l,h=o*a-i*c,d=i*l-r*a,f=r*d-o*h,p=o*u-i*d,g=i*h-r*u,m=2*s;return u*=m,h*=m,d*=m,f*=2,p*=2,g*=2,t[0]=a+u+f,t[1]=l+h+p,t[2]=c+d+g,t}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Je=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},tn=function(t){var e=t[0],n=t[1],i=t[2];return Math.hypot(e,n,i)},en=function(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i};function nn(t,e,n){const i=e[0],r=e[1],o=e[2],s=n[3]*i+n[7]*r+n[11]*o||1;return t[0]=(n[0]*i+n[4]*r+n[8]*o)/s,t[1]=(n[1]*i+n[5]*r+n[9]*o)/s,t[2]=(n[2]*i+n[6]*r+n[10]*o)/s,t}function rn(t,e,n){const i=e[0],r=e[1],o=e[2];return t[0]=n[0]*i+n[3]*r+n[6]*o,t[1]=n[1]*i+n[4]*r+n[7]*o,t[2]=n[2]*i+n[5]*r+n[8]*o,t[3]=e[3],t}qe();const on=[0,0,0];let sn;class an extends We{static get ZERO(){return sn||(sn=new an(0,0,0),Object.freeze(sn)),sn}constructor(t=0,e=0,n=0){super(-0,-0,-0),1===arguments.length&&Ne(t)?this.copy(t):(Ie.debug&&(Be(t),Be(e),Be(n)),this[0]=t,this[1]=e,this[2]=n)}set(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return Ie.debug&&(Be(t.x),Be(t.y),Be(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=Be(t)}angle(t){return n=t,i=(e=this)[0],r=e[1],o=e[2],s=n[0],a=n[1],l=n[2],u=(c=Math.sqrt(i*i+r*r+o*o)*Math.sqrt(s*s+a*a+l*l))&&Ze(e,n)/c,Math.acos(Math.min(Math.max(u,-1),1));var e,n,i,r,o,s,a,l,c,u}cross(t){return Ye(this,this,t),this.check()}rotateX({radians:t,origin:e=on}){var n,i,r,o,s;return n=this,i=e,r=t,s=[],(o=[])[0]=this[0]-i[0],o[1]=this[1]-i[1],o[2]=this[2]-i[2],s[0]=o[0],s[1]=o[1]*Math.cos(r)-o[2]*Math.sin(r),s[2]=o[1]*Math.sin(r)+o[2]*Math.cos(r),n[0]=s[0]+i[0],n[1]=s[1]+i[1],n[2]=s[2]+i[2],this.check()}rotateY({radians:t,origin:e=on}){var n,i,r,o,s;return n=this,i=e,r=t,s=[],(o=[])[0]=this[0]-i[0],o[1]=this[1]-i[1],o[2]=this[2]-i[2],s[0]=o[2]*Math.sin(r)+o[0]*Math.cos(r),s[1]=o[1],s[2]=o[2]*Math.cos(r)-o[0]*Math.sin(r),n[0]=s[0]+i[0],n[1]=s[1]+i[1],n[2]=s[2]+i[2],this.check()}rotateZ({radians:t,origin:e=on}){var n,i,r,o,s;return n=this,i=e,r=t,s=[],(o=[])[0]=this[0]-i[0],o[1]=this[1]-i[1],o[2]=this[2]-i[2],s[0]=o[0]*Math.cos(r)-o[1]*Math.sin(r),s[1]=o[0]*Math.sin(r)+o[1]*Math.cos(r),s[2]=o[2],n[0]=s[0]+i[0],n[1]=s[1]+i[1],n[2]=s[2]+i[2],this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return Ke(this,this,t),this.check()}transformAsVector(t){return nn(this,this,t),this.check()}transformByMatrix3(t){return Qe(this,this,t),this.check()}transformByMatrix2(t){return function(t,e,n){const i=e[0],r=e[1];t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2]}(this,this,t),this.check()}transformByQuaternion(t){return $e(this,this,t),this.check()}}const ln=new an;function cn(t,e,n,i){ln.set(t,e,n);const r=ln.len();return{distance:i/r,normal:new an(-t/r,-e/r,-n/r)}}let un;function hn(t,e){const{size:n=1,startIndex:i=0}=e,r=void 0!==e.endIndex?e.endIndex:t.length,o=(r-i)/n;un=Oe.allocate(un,o,{type:Float32Array,size:2*n});let s=i,a=0;for(;s<r;){for(let e=0;e<n;e++){const i=t[s++];un[a+e]=i,un[a+e+n]=(l=i)-Math.fround(l)}a+=2*n}var l;return un.subarray(0,o*n*2)}function dn(t){let e=null,n=!1;for(const i of t)i&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],i[0][0]),e[0][1]=Math.min(e[0][1],i[0][1]),e[1][0]=Math.max(e[1][0],i[1][0]),e[1][1]=Math.max(e[1][1],i[1][1])):e=i);return e}class fn extends je{toString(){let t="[";if(Ie.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let n=0;n<this.RANK;++n)t+=" ".concat(this[n*this.RANK+e])}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=" ".concat(this[e])}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,n){return this[e*this.RANK+t]=Be(n),this}getColumn(t,e=new Array(this.RANK).fill(-0)){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)e[t]=this[n+t];return e}setColumn(t,e){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)this[n+t]=e[t];return this}}function pn(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],m=e[14],v=e[15],y=n*a-i*s,_=n*l-r*s,b=n*c-o*s,w=i*l-r*a,x=i*c-o*a,E=r*c-o*l,S=u*g-h*p,P=u*m-d*p,T=u*v-f*p,C=h*m-d*g,A=h*v-f*g,M=d*v-f*m,L=y*M-_*A+b*C+w*T-x*P+E*S;return L?(L=1/L,t[0]=(a*M-l*A+c*C)*L,t[1]=(r*A-i*M-o*C)*L,t[2]=(g*E-m*x+v*w)*L,t[3]=(d*x-h*E-f*w)*L,t[4]=(l*T-s*M-c*P)*L,t[5]=(n*M-r*T+o*P)*L,t[6]=(m*b-p*E-v*_)*L,t[7]=(u*E-d*b+f*_)*L,t[8]=(s*A-a*T+c*S)*L,t[9]=(i*T-n*A-o*S)*L,t[10]=(p*x-g*b+v*y)*L,t[11]=(h*b-u*x-f*y)*L,t[12]=(a*P-s*C-l*S)*L,t[13]=(n*C-i*P+r*S)*L,t[14]=(g*_-p*w-m*y)*L,t[15]=(u*w-h*_+d*y)*L,t):null}function gn(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],f=e[10],p=e[11],g=e[12],m=e[13],v=e[14],y=e[15],_=n[0],b=n[1],w=n[2],x=n[3];return t[0]=_*i+b*a+w*h+x*g,t[1]=_*r+b*l+w*d+x*m,t[2]=_*o+b*c+w*f+x*v,t[3]=_*s+b*u+w*p+x*y,_=n[4],b=n[5],w=n[6],x=n[7],t[4]=_*i+b*a+w*h+x*g,t[5]=_*r+b*l+w*d+x*m,t[6]=_*o+b*c+w*f+x*v,t[7]=_*s+b*u+w*p+x*y,_=n[8],b=n[9],w=n[10],x=n[11],t[8]=_*i+b*a+w*h+x*g,t[9]=_*r+b*l+w*d+x*m,t[10]=_*o+b*c+w*f+x*v,t[11]=_*s+b*u+w*p+x*y,_=n[12],b=n[13],w=n[14],x=n[15],t[12]=_*i+b*a+w*h+x*g,t[13]=_*r+b*l+w*d+x*m,t[14]=_*o+b*c+w*f+x*v,t[15]=_*s+b*u+w*p+x*y,t}function mn(t,e,n){var i,r,o,s,a,l,c,u,h,d,f,p,g=n[0],m=n[1],v=n[2];return e===t?(t[12]=e[0]*g+e[4]*m+e[8]*v+e[12],t[13]=e[1]*g+e[5]*m+e[9]*v+e[13],t[14]=e[2]*g+e[6]*m+e[10]*v+e[14],t[15]=e[3]*g+e[7]*m+e[11]*v+e[15]):(i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],f=e[10],p=e[11],t[0]=i,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=l,t[6]=c,t[7]=u,t[8]=h,t[9]=d,t[10]=f,t[11]=p,t[12]=i*g+a*m+h*v+e[12],t[13]=r*g+l*m+d*v+e[13],t[14]=o*g+c*m+f*v+e[14],t[15]=s*g+u*m+p*v+e[15]),t}function vn(t,e,n){var i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function yn(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[4],s=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+c*i,t[5]=s*r+u*i,t[6]=a*r+h*i,t[7]=l*r+d*i,t[8]=c*r-o*i,t[9]=u*r-s*i,t[10]=h*r-a*i,t[11]=d*r-l*i,t}function _n(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],s=e[1],a=e[2],l=e[3],c=e[4],u=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+c*i,t[1]=s*r+u*i,t[2]=a*r+h*i,t[3]=l*r+d*i,t[4]=c*r-o*i,t[5]=u*r-s*i,t[6]=h*r-a*i,t[7]=d*r-l*i,t}var bn;function wn(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function xn(t,e,n,i){var r=e[0],o=e[1];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t}function En(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Sn(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*s,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*s,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*s,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*s,t}!function(){var t;t=new He(2),He!=Float32Array&&(t[0]=0,t[1]=0)}(),function(){var t;t=new He(4),He!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}(),function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"}(bn||(bn={}));const Pn=45*Math.PI/180,Tn=1,Cn=.1,An=500,Mn=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Ln extends fn{static get IDENTITY(){return On||(On=new Ln,Object.freeze(On)),On}static get ZERO(){return kn||(kn=new Ln([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(kn)),kn}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return bn}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,n,i,r,o,s,a,l,c,u,h,d,f,p,g){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this[4]=r,this[5]=o,this[6]=s,this[7]=a,this[8]=l,this[9]=c,this[10]=u,this[11]=h,this[12]=d,this[13]=f,this[14]=p,this[15]=g,this.check()}setRowMajor(t,e,n,i,r,o,s,a,l,c,u,h,d,f,p,g){return this[0]=t,this[1]=r,this[2]=l,this[3]=d,this[4]=e,this[5]=o,this[6]=c,this[7]=f,this[8]=n,this[9]=s,this[10]=u,this[11]=p,this[12]=i,this[13]=a,this[14]=h,this[15]=g,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(Mn)}fromObject(t){return this.check()}fromQuaternion(t){var e,n,i,r,o,s,a,l,c,u,h,d,f,p,g,m,v,y;return e=this,u=(i=(n=t)[0])*(a=i+i),h=(r=n[1])*a,d=r*(l=r+r),f=(o=n[2])*a,p=o*l,g=o*(c=o+o),m=(s=n[3])*a,v=s*l,y=s*c,e[0]=1-d-g,e[1]=h+y,e[2]=f-v,e[3]=0,e[4]=h-y,e[5]=1-u-g,e[6]=p+m,e[7]=0,e[8]=f+v,e[9]=p-m,e[10]=1-u-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this.check()}frustum(t){const{left:e,right:n,bottom:i,top:r,near:o=Cn,far:s=An}=t;return s===1/0?function(t,e,n,i,r,o){const s=2*o/(n-e),a=2*o/(r-i),l=(n+e)/(n-e),c=(r+i)/(r-i),u=-2*o;t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=l,t[9]=c,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=u,t[15]=0}(this,e,n,i,r,o):function(t,e,n,i,r,o,s){var a=1/(n-e),l=1/(r-i),c=1/(o-s);t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(r+i)*l,t[10]=(s+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*c,t[15]=0}(this,e,n,i,r,o,s),this.check()}lookAt(t){const{eye:e,center:n=[0,0,0],up:i=[0,1,0]}=t;return function(t,e,n,i){var r,o,s,a,l,c,u,h,d,f,p=e[0],g=e[1],m=e[2],v=i[0],y=i[1],_=i[2],b=n[0],w=n[1],x=n[2];Math.abs(p-b)<Ge&&Math.abs(g-w)<Ge&&Math.abs(m-x)<Ge?function(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(t):(u=p-b,h=g-w,d=m-x,r=y*(d*=f=1/Math.hypot(u,h,d))-_*(h*=f),o=_*(u*=f)-v*d,s=v*h-y*u,(f=Math.hypot(r,o,s))?(r*=f=1/f,o*=f,s*=f):(r=0,o=0,s=0),a=h*s-d*o,l=d*r-u*s,c=u*o-h*r,(f=Math.hypot(a,l,c))?(a*=f=1/f,l*=f,c*=f):(a=0,l=0,c=0),t[0]=r,t[1]=a,t[2]=u,t[3]=0,t[4]=o,t[5]=l,t[6]=h,t[7]=0,t[8]=s,t[9]=c,t[10]=d,t[11]=0,t[12]=-(r*p+o*g+s*m),t[13]=-(a*p+l*g+c*m),t[14]=-(u*p+h*g+d*m),t[15]=1)}(this,e,n,i),this.check()}ortho(t){const{left:e,right:n,bottom:i,top:r,near:o=Cn,far:s=An}=t;return function(t,e,n,i,r,o,s){var a=1/(e-n),l=1/(i-r),c=1/(o-s);t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*a,t[13]=(r+i)*l,t[14]=(s+o)*c,t[15]=1}(this,e,n,i,r,o,s),this.check()}orthographic(t){const{fovy:e=Pn,aspect:n=Tn,focalDistance:i=1,near:r=Cn,far:o=An}=t;In(e);const s=e/2,a=i*Math.tan(s),l=a*n;return this.ortho({left:-l,right:l,bottom:-a,top:a,near:r,far:o})}perspective(t){const{fovy:e=45*Math.PI/180,aspect:n=1,near:i=.1,far:r=500}=t;return In(e),function(t,e,n,i,r){var o,s=1/Math.tan(e/2);t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(o=1/(i-r),t[10]=(r+i)*o,t[14]=2*r*i*o):(t[10]=-1,t[14]=-2*i)}(this,e,n,i,r),this.check()}determinant(){return e=(t=this)[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11],f=t[12],p=t[13],g=t[14],(e*s-n*o)*(h*(m=t[15])-d*g)-(e*a-i*o)*(u*m-d*p)+(e*l-r*o)*(u*g-h*p)+(n*a-i*s)*(c*m-d*f)-(n*l-r*s)*(c*g-h*f)+(i*l-r*a)*(c*p-u*f);var t,e,n,i,r,o,s,a,l,c,u,h,d,f,p,g,m}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),i=1/n[0],r=1/n[1],o=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*o,t[3]=0,t[4]=this[4]*i,t[5]=this[5]*r,t[6]=this[6]*o,t[7]=0,t[8]=this[8]*i,t[9]=this[9]*r,t[10]=this[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),i=1/n[0],r=1/n[1],o=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*o,t[3]=this[4]*i,t[4]=this[5]*r,t[5]=this[6]*o,t[6]=this[8]*i,t[7]=this[9]*r,t[8]=this[10]*o,t}transpose(){return function(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[11]=e[14],t[12]=r,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15]}(this,this),this.check()}invert(){return pn(this,this),this.check()}multiplyLeft(t){return gn(this,t,this),this.check()}multiplyRight(t){return gn(this,this,t),this.check()}rotateX(t){return yn(this,this,t),this.check()}rotateY(t){var e,n,i,r,o,s,a,l,c,u,h,d,f;return e=this,n=this,i=t,r=Math.sin(i),o=Math.cos(i),s=n[0],a=n[1],l=n[2],c=n[3],u=n[8],h=n[9],d=n[10],f=n[11],n!==e&&(e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=s*o-u*r,e[1]=a*o-h*r,e[2]=l*o-d*r,e[3]=c*o-f*r,e[8]=s*r+u*o,e[9]=a*r+h*o,e[10]=l*r+d*o,e[11]=c*r+f*o,this.check()}rotateZ(t){return _n(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,e){return function(t,e,n,i){var r,o,s,a,l,c,u,h,d,f,p,g,m,v,y,_,b,w,x,E,S,P,T,C,A=i[0],M=i[1],L=i[2],k=Math.hypot(A,M,L);k<Ge||(A*=k=1/k,M*=k,L*=k,r=Math.sin(n),s=1-(o=Math.cos(n)),a=e[0],l=e[1],c=e[2],u=e[3],h=e[4],d=e[5],f=e[6],p=e[7],g=e[8],m=e[9],v=e[10],y=e[11],_=A*A*s+o,b=M*A*s+L*r,w=L*A*s-M*r,x=A*M*s-L*r,E=M*M*s+o,S=L*M*s+A*r,P=A*L*s+M*r,T=M*L*s-A*r,C=L*L*s+o,t[0]=a*_+h*b+g*w,t[1]=l*_+d*b+m*w,t[2]=c*_+f*b+v*w,t[3]=u*_+p*b+y*w,t[4]=a*x+h*E+g*S,t[5]=l*x+d*E+m*S,t[6]=c*x+f*E+v*S,t[7]=u*x+p*E+y*S,t[8]=a*P+h*T+g*C,t[9]=l*P+d*T+m*C,t[10]=c*P+f*T+v*C,t[11]=u*P+p*T+y*C,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]))}(this,this,t,e),this.check()}scale(t){return vn(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return mn(this,this,t),this.check()}transform(t,e){return 4===t.length?(Ue(e=Sn(e||[-0,-0,-0,-0],t,this),4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:n}=t;let i;switch(n){case 2:i=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t}(e||[-0,-0],t,this);break;case 3:i=Ke(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Ue(i,t.length),i}transformAsVector(t,e){let n;switch(t.length){case 2:n=function(t,e,n){const i=e[0],r=e[1],o=n[3]*i+n[7]*r||1;return t[0]=(n[0]*i+n[4]*r)/o,t[1]=(n[1]*i+n[5]*r)/o,t}(e||[-0,-0],t,this);break;case 3:n=nn(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Ue(n,t.length),n}transformPoint(t,e){return this.transformAsPoint(t,e)}transformVector(t,e){return this.transformAsPoint(t,e)}transformDirection(t,e){return this.transformAsVector(t,e)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,n){return this.identity().translate([t,e,n])}}let kn,On;function In(t){if(t>2*Math.PI)throw Error("expected radians")}function Rn(t,e){const n=Sn([],e,t);return En(n,n,1/n[3]),n}function Nn(t,e){const n=t%e;return n<0?e+n:n}function zn(t,e,n){return t<e?e:t>n?n:t}const Fn=Math.log2||function(t){return Math.log(t)*Math.LOG2E};function Dn(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const jn=Math.PI,Bn=jn/4,Un=jn/180,Vn=180/jn,Wn=512,Gn=4003e4,Hn=85.051129,qn=1.5;function Xn(t){const[e,n]=t;Dn(Number.isFinite(e)),Dn(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const i=n*Un;return[Wn*(e*Un+jn)/(2*jn),Wn*(jn+Math.log(Math.tan(Bn+.5*i)))/(2*jn)]}function Zn(t){const[e,n]=t,i=e/Wn*(2*jn)-jn,r=2*(Math.atan(Math.exp(n/Wn*(2*jn)-jn))-Bn);return[i*Vn,r*Vn]}function Yn(t){const e=Math.cos(t*Un);return Wn/Gn/e}function Kn(t){const{latitude:e,longitude:n,highPrecision:i=!1}=t;Dn(Number.isFinite(e)&&Number.isFinite(n));const r=Wn,o=Math.cos(e*Un),s=r/360,a=s/o,l=r/Gn/o,c={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[s,a,l],degreesPerUnit:[1/s,1/a,1/l]};if(i){const t=Un*Math.tan(e*Un)/o,n=s*t/2,i=r/Gn*t,u=i/a*l;c.unitsPerDegree2=[0,n,i],c.unitsPerMeter2=[u,0,u]}return c}function Qn(t,e){const[n,i,r]=t,[o,s,a]=e,{unitsPerMeter:l,unitsPerMeter2:c}=Kn({longitude:n,latitude:i,highPrecision:!0}),u=Xn(t);u[0]+=o*(l[0]+c[0]*s),u[1]+=s*(l[1]+c[1]*s);const h=Zn(u),d=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[h[0],h[1],d]:h}function $n(t){return 2*Math.atan(.5/t)*Vn}function Jn(t){return.5/Math.tan(.5*t*Un)}function ti(t,e){const[n,i,r=0]=t;return Dn(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(r)),Rn(e,[n,i,r,1])}function ei(t,e,n=0){const[i,r,o]=t;if(Dn(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(o))return Rn(e,[i,r,o,1]);const s=Rn(e,[i,r,0,1]),a=Rn(e,[i,r,1,1]),l=s[2],c=a[2];return xn([],s,a,l===c?0:((n||0)-l)/(c-l))}const ni=Math.PI/180;function ii(t,e,n){const{pixelUnprojectionMatrix:i}=t,r=Rn(i,[e,0,1,1]),o=Rn(i,[e,t.height,1,1]),s=Zn(xn([],r,o,(n*t.distanceScales.unitsPerMeter[2]-r[2])/(o[2]-r[2])));return s.push(n),s}const ri={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(ri,"IDENTITY",{get:()=>(R.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const oi={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},si={common:0,meters:1,pixels:2},ai={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},li=Math.PI/180,ci=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],ui=[0,0,0],hi={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class di{constructor(t={}){i(this,"id",void 0),i(this,"x",void 0),i(this,"y",void 0),i(this,"width",void 0),i(this,"height",void 0),i(this,"padding",void 0),i(this,"isGeospatial",void 0),i(this,"zoom",void 0),i(this,"focalDistance",void 0),i(this,"position",void 0),i(this,"modelMatrix",void 0),i(this,"distanceScales",void 0),i(this,"scale",void 0),i(this,"center",void 0),i(this,"cameraPosition",void 0),i(this,"projectionMatrix",void 0),i(this,"viewMatrix",void 0),i(this,"viewMatrixUncentered",void 0),i(this,"viewMatrixInverse",void 0),i(this,"viewProjectionMatrix",void 0),i(this,"pixelProjectionMatrix",void 0),i(this,"pixelUnprojectionMatrix",void 0),i(this,"resolution",void 0),i(this,"_frustumPlanes",{}),this.id=t.id||this.constructor.displayName||"viewport",this.x=t.x||0,this.y=t.y||0,this.width=t.width||1,this.height=t.height||1,this.zoom=t.zoom||0,this.padding=t.padding,this.distanceScales=t.distanceScales||hi,this.focalDistance=t.focalDistance||1,this.position=t.position||ui,this.modelMatrix=t.modelMatrix||null;const{longitude:e,latitude:n}=t;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(e),this._initProps(t),this._initMatrices(t),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?oi.WEB_MERCATOR:oi.WEB_MERCATOR_AUTO_OFFSET:oi.IDENTITY}equals(t){return t instanceof di&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&De(t.projectionMatrix,this.projectionMatrix)&&De(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:e=!0}={}){const n=ti(this.projectPosition(t),this.pixelProjectionMatrix),[i,r]=n,o=e?r:this.height-r;return 2===t.length?[i,o]:[i,o,n[2]]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[i,r,o]=t,s=e?r:this.height-r,a=n&&n*this.distanceScales.unitsPerMeter[2],l=ei([i,s,o],this.pixelUnprojectionMatrix,a),[c,u,h]=this.unprojectPosition(l);return Number.isFinite(o)?[c,u,h]:Number.isFinite(n)?[c,u,n]:[c,u]}projectPosition(t){const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){if(this.isGeospatial){const e=Xn(t);return e[1]=ze(e[1],-318,830),e}return t}unprojectFlat(t){return this.isGeospatial?Zn(t):t}getBounds(t={}){const e={targetZ:t.z||0},n=this.unproject([0,0],e),i=this.unproject([this.width,0],e),r=this.unproject([0,this.height],e),o=this.unproject([this.width,this.height],e);return[Math.min(n[0],i[0],r[0],o[0]),Math.min(n[1],i[1],r[1],o[1]),Math.max(n[0],i[0],r[0],o[0]),Math.max(n[1],i[1],r[1],o[1])]}getDistanceScales(t){return t?Kn({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:e,width:n=1,height:i=1}){return t<this.x+this.width&&this.x<t+n&&e<this.y+this.height&&this.y<e+i}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,{left:cn((t=this.viewProjectionMatrix)[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:cn(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:cn(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:cn(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:cn(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:cn(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}),this._frustumPlanes;var t}panByPosition(t,e){return null}_initProps(t){const e=t.longitude,n=t.latitude;this.isGeospatial&&(Number.isFinite(t.zoom)||(this.zoom=function(t){const{latitude:e}=t;Dn(Number.isFinite(e));const n=Math.cos(e*Un);return Fn(Gn*n)-9}({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=t.distanceScales||Kn({latitude:n,longitude:e}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:r,modelMatrix:o}=t;let s=ui;if(r&&(s=o?new Ln(o).transformAsVector(r,[]):r),this.isGeospatial){const t=this.projectPosition([e,n,0]);this.center=new an(s).scale(this.distanceScales.unitsPerMeter).add(t)}else this.center=this.projectPosition(s)}_initMatrices(t){const{viewMatrix:e=ci,projectionMatrix:n=null,orthographic:i=!1,fovyRadians:r,fovy:o=75,near:s=.1,far:a=1e3,padding:l=null,focalDistance:c=1}=t;this.viewMatrixUncentered=e,this.viewMatrix=(new Ln).multiplyRight(e).translate(new an(this.center).negate()),this.projectionMatrix=n||function({width:t,height:e,orthographic:n,fovyRadians:i,focalDistance:r,padding:o,near:s,far:a}){const l=t/e,c=n?(new Ln).orthographic({fovy:i,aspect:l,focalDistance:r,near:s,far:a}):(new Ln).perspective({fovy:i,aspect:l,near:s,far:a});if(o){const{left:n=0,right:i=0,top:r=0,bottom:s=0}=o,a=ze((n+t-i)/2,0,t)-t/2,l=ze((r+e-s)/2,0,e)-e/2;c[8]-=2*a/t,c[9]+=2*l/e}return c}({width:this.width,height:this.height,orthographic:i,fovyRadians:r||o*li,focalDistance:c,padding:l,near:s,far:a});const u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var h;gn(u,u,this.projectionMatrix),gn(u,u,this.viewMatrix),this.viewProjectionMatrix=u,this.viewMatrixInverse=pn([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=[(h=this.viewMatrixInverse)[12],h[13],h[14]];const d=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];vn(d,d,[this.width/2,-this.height/2,1]),mn(d,d,[1,-1,0]),gn(f,d,this.viewProjectionMatrix),this.pixelProjectionMatrix=f,this.pixelUnprojectionMatrix=pn([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||R.warn("Pixel project matrix not invertible")()}}i(di,"displayName","Viewport");const fi="vs",pi="fs";function gi(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const mi={number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},array:{validate:(t,e)=>Array.isArray(t)||ArrayBuffer.isView(t)}};function vi(t){let e=yi(t);return"object"===e?t?"type"in t?Object.assign({},t,mi[t.type]):"value"in t?(e=yi(t.value),Object.assign({type:e},t,mi[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},mi[e])}function yi(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}class _i{constructor(t){let{name:e,vs:n,fs:i,dependencies:r=[],uniforms:o,getUniforms:s,deprecations:a=[],defines:l={},inject:c={},vertexShader:u,fragmentShader:h}=t;gi("string"==typeof e),this.name=e,this.vs=n||u,this.fs=i||h,this.getModuleUniforms=s,this.dependencies=r,this.deprecations=this._parseDeprecationDefinitions(a),this.defines=l,this.injections=function(t){const e={vs:{},fs:{}};for(const n in t){let i=t[n];"string"==typeof i&&(i={order:0,injection:i}),e[n.slice(0,2)][n]=i}return e}(c),o&&(this.uniforms=function(t){const e={};for(const n in t){const i=vi(t[n]);e[n]=i}return e}(o))}getModuleSource(t){let e;switch(t){case"vs":e=this.vs||"";break;case"fs":e=this.fs||"";break;default:gi(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),"\n").concat(e,"// END MODULE_").concat(this.name,"\n\n")}getUniforms(t,e){return this.getModuleUniforms?this.getModuleUniforms(t,e):this.uniforms?this._defaultGetUniforms(t):{}}getDefines(){return this.defines}checkDeprecations(t,e){this.deprecations.forEach((n=>{n.regex.test(t)&&(n.deprecated?e.deprecated(n.old,n.new)():e.removed(n.old,n.new)())}))}_parseDeprecationDefinitions(t){return t.forEach((t=>{"function"===t.type?t.regex=new RegExp("\\b".concat(t.old,"\\(")):t.regex=new RegExp("".concat(t.type," ").concat(t.old,";"))})),t}_defaultGetUniforms(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e={},n=this.uniforms;for(const i in n){const r=n[i];i in t&&!r.private?(r.validate&&gi(r.validate(t[i],r),"".concat(this.name,": invalid ").concat(i)),e[i]=t[i]):e[i]=r.value}return e}}function bi(t){return function(t){const e={},n={};return wi({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort(((t,e)=>n[e]-n[t])).map((t=>e[t]))}(xi(t))}function wi(t){let{modules:e,level:n,moduleMap:i,moduleDepth:r}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const t of e)i[t.name]=t,(void 0===r[t.name]||r[t.name]<n)&&(r[t.name]=n);for(const t of e)t.dependencies&&wi({modules:t.dependencies,level:n+1,moduleMap:i,moduleDepth:r})}function xi(t,e){return t.map((t=>(t instanceof _i||(gi("string"!=typeof t,"Shader module use by name is deprecated. Import shader module '".concat(t,"' and use it directly.")),gi(t.name,"shader module has no name"),(t=new _i(t)).dependencies=xi(t.dependencies)),t)))}const Ei=7936,Si=7937,Pi=7938,Ti=35724,Ci={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Ai={};Object.keys(Ci).forEach((t=>{Ai[t]=t}));const Mi={};function Li(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=Ci[e];if(gi(i,e),!function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e="undefined"!=typeof window&&window.navigator||{},n=t.userAgent||e.userAgent||"",i=-1!==n.indexOf("MSIE "),r=-1!==n.indexOf("Trident/");return i||r}(n))return!0;if(e in Mi)return Mi[e];const r=i[0],o=n.behavior||"enable",s="#extension GL_".concat(r," : ").concat(o,"\nvoid main(void) {}"),a=t.createShader(35633);t.shaderSource(a,s),t.compileShader(a);const l=t.getShaderParameter(a,35713);return t.deleteShader(a),Mi[e]=l,l}function ki(t,e){return(e=Array.isArray(e)?e:[e]).every((e=>function(t,e){const n=Ci[e];gi(n,e);const i=function(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}(t)&&n[1]||n[0],r="string"==typeof i?Boolean(t.getExtension(i)):i;return gi(!1===r||!0===r),r}(t,e)))}const Oi={[fi]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",[pi]:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},Ii="__LUMA_INJECT_DECLARATIONS__",Ri=/void\s+main\s*\([^)]*\)\s*\{\n?/,Ni=/}\n?[^{}]*$/,zi=[];function Fi(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=e===fi;for(const e in n){const i=n[e];i.sort(((t,e)=>t.order-e.order)),zi.length=i.length;for(let t=0,e=i.length;t<e;++t)zi[t]=i[t].injection;const o="".concat(zi.join("\n"),"\n");switch(e){case"vs:#decl":r&&(t=t.replace(Ii,o));break;case"vs:#main-start":r&&(t=t.replace(Ri,(t=>t+o)));break;case"vs:#main-end":r&&(t=t.replace(Ni,(t=>o+t)));break;case"fs:#decl":r||(t=t.replace(Ii,o));break;case"fs:#main-start":r||(t=t.replace(Ri,(t=>t+o)));break;case"fs:#main-end":r||(t=t.replace(Ni,(t=>o+t)));break;default:t=t.replace(e,(t=>t+o))}}return t=t.replace(Ii,""),i&&(t=t.replace(/\}\s*$/,(t=>t+Oi[e]))),t}function Di(t){const e={};return gi(Array.isArray(t)&&t.length>1),t.forEach((t=>{for(const n in t)e[n]=e[n]?"".concat(e[n],"\n").concat(t[n]):t[n]})),e}function ji(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const Bi=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Ui=[...Bi,[ji("attribute"),"in $1"],[ji("varying"),"out $1"]],Vi=[...Bi,[ji("varying"),"in $1"]],Wi=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],Gi=[...Wi,[ji("in"),"attribute $1"],[ji("out"),"varying $1"]],Hi=[...Wi,[ji("in"),"varying $1"]],qi="gl_FragColor",Xi=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,Zi=/void\s+main\s*\([^)]*\)\s*\{\n?/;function Yi(t,e){for(const[n,i]of e)t=t.replace(n,i);return t}const Ki="\n\n".concat(Ii,"\n\n"),Qi={[fi]:"vertex",[pi]:"fragment"};function $i(t,e){let{id:n,source:i,type:r,modules:o,defines:s={},hookFunctions:a=[],inject:l={},transpileToGLSL100:c=!1,prologue:u=!0,log:h}=e;gi("string"==typeof i,"shader source must be a string");const d=r===fi,f=i.split("\n");let p=100,g="",m=i;0===f[0].indexOf("#version ")?(p=300,g=f[0],m=f.slice(1).join("\n")):g="#version ".concat(p);const v={};o.forEach((t=>{Object.assign(v,t.getDefines())})),Object.assign(v,s);let y=u?"".concat(g,"\n").concat(function(t){let{id:e,source:n,type:i}=t;return e&&"string"==typeof e&&-1===n.indexOf("SHADER_NAME")?"\n#define SHADER_NAME ".concat(e,"_").concat(Qi[i],"\n\n"):""}({id:n,source:i,type:r}),"\n").concat(function(t){let{type:e}=t;return"\n#define SHADER_TYPE_".concat(Qi[e].toUpperCase(),"\n")}({type:r}),"\n").concat(function(t){const e=function(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||Ei),i=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||Si);return{gpuVendor:function(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}(n,i),vendor:n,renderer:i,version:t.getParameter(Pi),shadingLanguageVersion:t.getParameter(Ti)}}(t);switch(e.gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(t),"\n").concat(function(t,e,n){let i="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return ki(t,Ai.GLSL_FRAG_DEPTH)&&(i+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),ki(t,Ai.GLSL_DERIVATIVES)&&Li(t,Ai.GLSL_DERIVATIVES)&&(i+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),ki(t,Ai.GLSL_FRAG_DATA)&&Li(t,Ai.GLSL_FRAG_DATA,{behavior:"require"})&&(i+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),ki(t,Ai.GLSL_TEXTURE_LOD)&&(i+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),i}(t),"\n").concat(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=0,n="";for(const i in t){0===e&&(n+="\n// APPLICATION DEFINES\n"),e++;const r=t[i];(r||Number.isFinite(r))&&(n+="#define ".concat(i.toUpperCase()," ").concat(t[i],"\n"))}return 0===e&&(n+="\n"),n}(v),"\n").concat(d?"":"precision highp float;\n\n","\n"):"".concat(g,"\n");const _=function(t){const e={vs:{},fs:{}};return t.forEach((t=>{let n;"string"!=typeof t?(n=t,t=n.hook):n={},t=t.trim();const[i,r]=t.split(":"),o=t.replace(/\(.+/,"");e[i][o]=Object.assign(n,{signature:r})})),e}(a),b={},w={},x={};for(const t in l){const e="string"==typeof l[t]?{injection:l[t],order:0}:l[t],n=t.match(/^(v|f)s:(#)?([\w-]+)$/);if(n){const i=n[2],r=n[3];i?"decl"===r?w[t]=[e]:x[t]=[e]:b[t]=[e]}else x[t]=[e]}for(const t of o){h&&t.checkDeprecations(m,h),y+=t.getModuleSource(r,p);const e=t.injections[r];for(const t in e){const n=t.match(/^(v|f)s:#([\w-]+)$/);if(n){const i="decl"===n[2]?w:x;i[t]=i[t]||[],i[t].push(e[t])}else b[t]=b[t]||[],b[t].push(e[t])}}return y+=Ki,y=Fi(y,r,w),y+=function(t,e){let n="";for(const i in t){const r=t[i];if(n+="void ".concat(r.signature," {\n"),r.header&&(n+="  ".concat(r.header)),e[i]){const t=e[i];t.sort(((t,e)=>t.order-e.order));for(const e of t)n+="  ".concat(e.injection,"\n")}r.footer&&(n+="  ".concat(r.footer)),n+="}\n"}return n}(_[r],b),y+=m,y=Fi(y,r,x),y=function(t,e,n){switch(e){case 300:return n?Yi(t,Ui):function(t){const e=(t=Yi(t,Vi)).match(Xi);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(qi,"\\b"),"g"),n)}else{const e="fragmentColor";t=t.replace(Zi,(t=>"out vec4 ".concat(e,";\n").concat(t))).replace(new RegExp("\\b".concat(qi,"\\b"),"g"),e)}return t}(t);case 100:return n?Yi(t,Gi):function(t){const e=(t=Yi(t,Hi)).match(Xi);if(e){const n=e[1];t=t.replace(Xi,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),qi)}return t}(t);default:throw new Error("unknown GLSL version ".concat(e))}}(y,c?100:p,d),y}function Ji(t){return function(e){const n={};for(const i of t){const t=i.getUniforms(e,n);Object.assign(n,t)}return n}}const tr=new L({id:"luma.gl"});function er(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const nr="Requires WebGL2";function ir(t){return"undefined"!=typeof WebGLRenderingContext&&t instanceof WebGLRenderingContext||"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&Number.isFinite(t._version))}function rr(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}function or(t){return er(ir(t),"Invalid WebGLRenderingContext"),t}function sr(t){return er(rr(t),nr),t}const ar={};const lr=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let e=0;e<this.attribs.length;e++){const i=new t.VertexAttrib(n);this.attribs[e]=i}this.maxAttrib=0};(lr.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const cr=function(t){const e=this;this.gl=t,function(t){const e=t.getError;t.getError=function(){let n;do{n=e.apply(t),0!==n&&(ar[n]=!0)}while(0!==n);for(n in ar)if(ar[n])return delete ar[n],parseInt(n,10);return 0}}(t);const n=this.original={getParameter:t.getParameter,enableVertexAttribArray:t.enableVertexAttribArray,disableVertexAttribArray:t.disableVertexAttribArray,bindBuffer:t.bindBuffer,getVertexAttrib:t.getVertexAttrib,vertexAttribPointer:t.vertexAttribPointer};t.getParameter=function(t){return t===e.VERTEX_ARRAY_BINDING_OES?e.currentVertexArrayObject===e.defaultVertexArrayObject?null:e.currentVertexArrayObject:n.getParameter.apply(this,arguments)},t.enableVertexAttribArray=function(t){const i=e.currentVertexArrayObject;return i.maxAttrib=Math.max(i.maxAttrib,t),i.attribs[t].enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},t.disableVertexAttribArray=function(t){const i=e.currentVertexArrayObject;return i.maxAttrib=Math.max(i.maxAttrib,t),i.attribs[t].enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},t.bindBuffer=function(t,i){switch(t){case 34962:e.currentArrayBuffer=i;break;case 34963:e.currentVertexArrayObject.elementArrayBuffer=i}return n.bindBuffer.apply(this,arguments)},t.getVertexAttrib=function(t,i){const r=e.currentVertexArrayObject.attribs[t];switch(i){case 34975:return r.buffer;case 34338:return r.enabled;case 34339:return r.size;case 34340:return r.stride;case 34341:return r.type;case 34922:return r.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},t.vertexAttribPointer=function(t,i,r,o,s,a){const l=e.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,t);const c=l.attribs[t];return c.buffer=e.currentArrayBuffer,c.size=i,c.type=r,c.normalized=o,c.stride=s,c.offset=a,c.recache(),n.vertexAttribPointer.apply(this,arguments)},t.instrumentExtension&&t.instrumentExtension(this,"OES_vertex_array_object"),t.canvas&&t.canvas.addEventListener("webglcontextrestored",(()=>{globalThis.console&&globalThis.console.log&&globalThis.console.log("OESVertexArrayObject emulation library context restored"),e.reset_()}),!0),this.reset_()};cr.prototype.VERTEX_ARRAY_BINDING_OES=34229,cr.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let t=0;t<this.vertexArrayObjects.length;++t)this.vertexArrayObjects.isAlive=!1;const t=this.gl;this.maxVertexAttribs=t.getParameter(34921),this.defaultVertexArrayObject=new lr(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},cr.prototype.createVertexArrayOES=function(){const t=new lr(this);return this.vertexArrayObjects.push(t),t},cr.prototype.deleteVertexArrayOES=function(t){t.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(t),1),this.currentVertexArrayObject===t&&this.bindVertexArrayOES(null)},cr.prototype.isVertexArrayOES=function(t){return!!(t&&t instanceof lr&&t.hasBeenBound&&t.ext===this)},cr.prototype.bindVertexArrayOES=function(t){const e=this.gl;if(t&&!t.isAlive)return n="bindVertexArrayOES: attempt to bind deleted arrayObject",ar[1282]=!0,void(void 0!==n&&(i=n,globalThis.console&&globalThis.console.error&&globalThis.console.error(i)));var n,i;const r=this.original,o=this.currentVertexArrayObject;this.currentVertexArrayObject=t||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(o===s)return;o&&s.elementArrayBuffer===o.elementArrayBuffer||r.bindBuffer.call(e,34963,s.elementArrayBuffer);let a=this.currentArrayBuffer;const l=Math.max(o?o.maxAttrib:0,s.maxAttrib);for(let t=0;t<=l;t++){const n=s.attribs[t],i=o?o.attribs[t]:null;if(o&&n.enabled===i.enabled||(n.enabled?r.enableVertexAttribArray.call(e,t):r.disableVertexAttribArray.call(e,t)),n.enabled){let s=!1;o&&n.buffer===i.buffer||(a!==n.buffer&&(r.bindBuffer.call(e,34962,n.buffer),a=n.buffer),s=!0),(s||n.cached!==i.cached)&&r.vertexAttribPointer.call(e,t,n.size,n.type,n.normalized,n.stride,n.offset)}}this.currentArrayBuffer!==a&&r.bindBuffer.call(e,34962,this.currentArrayBuffer)};const ur="OES_element_index",hr="WEBGL_draw_buffers",dr="WEBGL_debug_renderer_info",fr=t=>rr(t)?void 0:0,pr={3074:t=>rr(t)?void 0:36064,35723:t=>rr(t)?void 0:4352,35977:fr,32937:fr,36795:(t,e)=>{const n=rr(t)?t.getExtension("EXT_disjoint_timer_query_webgl2"):t.getExtension("EXT_disjoint_timer_query");return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},37445:(t,e)=>{const n=t.getExtension(dr);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},37446:(t,e)=>{const n=t.getExtension(dr);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},34047:(t,e)=>{const n=t.luma.extensions.EXT_texture_filter_anisotropic;return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:fr,35071:fr,37447:fr,36063:(t,e)=>{if(!rr(t)){const n=t.getExtension(hr);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:fr,35374:fr,35377:fr,34852:t=>{if(!rr(t)){const e=t.getExtension(hr);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(ur)?2147483647:65535,33001:t=>t.getExtension(ur)?16777216:65535,33e3:t=>16777216,37157:fr,35373:fr,35657:fr,36183:fr,37137:fr,34045:fr,35978:fr,35979:fr,35968:fr,35376:fr,35375:fr,35659:fr,37154:fr,35371:fr,35658:fr,35076:fr,35077:fr,35380:fr},gr="ANGLE_instanced_arrays",mr={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{er(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[gr]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){er(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{er(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{er(!1)},deleteQuery:()=>{er(!1)},beginQuery:()=>{er(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},vr={readBuffer:(t,e,n)=>{rr(t)&&e(n)},getVertexAttrib:(t,e,n,i)=>{const{webgl2:r,ext:o}=function(t,e){return{webgl2:rr(t),ext:t.getExtension(e)}}(t,gr);let s;switch(i){case 35069:s=!!r&&void 0;break;case 35070:s=r||o?void 0:0}return void 0!==s?s:e(n,i)},getProgramParameter:(t,e,n,i)=>{if(!rr(t))switch(i){case 35967:return 35981;case 35971:case 35382:return 0}return e(n,i)},getInternalformatParameter:(t,e,n,i,r)=>rr(t)||32937!==r?t.getInternalformatParameter(n,i,r):new Int32Array([0]),getTexParameter(t,e,n,i){if(34046===i){const{extensions:e}=t.luma,n=e.EXT_texture_filter_anisotropic;i=n&&n.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(n,i)},getParameter:function(t,e,n){const i=pr[n],r="function"==typeof i?i(t,e,n):i;return void 0!==r?r:e(n)},hint:(t,e,n,i)=>e(n,i)};function yr(t,e){let{extension:n,target:i,target2:r}=e;const o=mr[n];er(o);const{meta:s={}}=o,{suffix:a=""}=s,l=t.getExtension(n);for(const e of Object.keys(o)){const n="".concat(e).concat(a);let s=null;"meta"===e||"function"==typeof t[e]||(l&&"function"==typeof l[n]?s=function(){return l[n](...arguments)}:"function"==typeof o[e]&&(s=o[e].bind(i))),s&&(i[e]=s,r[e]=s)}}globalThis.polyfillContext=function(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(function(t){if("function"==typeof t.createVertexArray)return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const t=e.call(this)||[];return t.indexOf("OES_vertex_array_object")<0&&t.push("OES_vertex_array_object"),t};const n=t.getExtension;t.getExtension=function(e){return n.call(this,e)||("OES_vertex_array_object"!==e?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new cr(this)),this.__OESVertexArrayObject))}}(t),function(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}(t),function(t,e){for(const n of Object.getOwnPropertyNames(e))"overrides"!==n&&yr(t,{extension:n,target:t.luma,target2:t})}(t,mr),function(t,e){let{target:n,target2:i}=e;Object.keys(vr).forEach((e=>{if("function"==typeof vr[e]){const r=t[e]?t[e].bind(t):()=>{},o=vr[e].bind(null,t,r);n[e]=o,i[e]=o}}))}(t,{target:e,target2:t}),e.polyfilled=!0),t};const _r={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},br=(t,e,n)=>e?t.enable(n):t.disable(n),wr=(t,e,n)=>t.hint(n,e),xr=(t,e,n)=>t.pixelStorei(n,e);function Er(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const Sr={3042:br,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:br,2885:(t,e)=>t.cullFace(e),2929:br,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:br,35723:wr,36006:(t,e)=>{const n=rr(t)?36009:36160;return t.bindFramebuffer(n,e)},2886:(t,e)=>t.frontFace(e),33170:wr,2849:(t,e)=>t.lineWidth(e),32823:br,32824:"polygonOffset",10752:"polygonOffset",35977:br,32938:"sampleCoverage",32939:"sampleCoverage",3089:br,3088:(t,e)=>t.scissor(...e),2960:br,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:xr,3317:xr,37440:xr,37441:xr,37443:xr,3330:xr,3332:xr,3331:xr,36010:(t,e)=>t.bindFramebuffer(36008,e),3314:xr,32878:xr,3316:xr,3315:xr,32877:xr,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Er(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Er(e)&&2===e.length?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Er(e)?e:[e,e];const[n,i]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,i)},stencilFunc:(t,e)=>{e=Er(e)&&3===e.length?[...e,...e]:e;const[n,i,r,o,s,a]=e;t.stencilFuncSeparate(1028,n,i,r),t.stencilFuncSeparate(1029,o,s,a)},stencilOp:(t,e)=>{e=Er(e)&&3===e.length?[...e,...e]:e;const[n,i,r,o,s,a]=e;t.stencilOpSeparate(1028,n,i,r),t.stencilOpSeparate(1029,o,s,a)},viewport:(t,e)=>t.viewport(...e)};function Pr(t,e,n){return void 0!==e[t]?e[t]:n[t]}const Tr={blendEquation:(t,e,n)=>t.blendEquationSeparate(Pr(32777,e,n),Pr(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Pr(32969,e,n),Pr(32968,e,n),Pr(32971,e,n),Pr(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Pr(32824,e,n),Pr(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Pr(32938,e,n),Pr(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Pr(2962,e,n),Pr(2967,e,n),Pr(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Pr(34816,e,n),Pr(36003,e,n),Pr(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Pr(2964,e,n),Pr(2965,e,n),Pr(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Pr(34817,e,n),Pr(34818,e,n),Pr(34819,e,n))},Cr={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,i,r)=>t({32773:new Float32Array([e,n,i,r])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,i,r)=>t({32969:e,32968:n,32971:i,32970:r}),clearColor:(t,e,n,i,r)=>t({3106:new Float32Array([e,n,i,r])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,i,r)=>t({3107:[e,n,i,r]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,i,r)=>t({3088:new Int32Array([e,n,i,r])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[1028===e?2968:36005]:n}),stencilFunc:(t,e,n,i)=>t({2962:e,2967:n,2963:i,34816:e,36003:n,36004:i}),stencilFuncSeparate:(t,e,n,i,r)=>t({[1028===e?2962:34816]:n,[1028===e?2967:36003]:i,[1028===e?2963:36004]:r}),stencilOp:(t,e,n,i)=>t({2964:e,2965:n,2966:i,34817:e,34818:n,34819:i}),stencilOpSeparate:(t,e,n,i,r)=>t({[1028===e?2964:34817]:n,[1028===e?2965:34818]:i,[1028===e?2966:34819]:r}),viewport:(t,e,n,i,r)=>t({2978:[e,n,i,r]})},Ar=(t,e)=>t.isEnabled(e),Mr={3042:Ar,2884:Ar,2929:Ar,3024:Ar,32823:Ar,32926:Ar,32928:Ar,3089:Ar,2960:Ar,35977:Ar};function Lr(t){for(const e in t)return!1;return!0}function kr(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),i=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&i&&t.length===e.length){for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}return!1}function Or(t,e){const n=t[e].bind(t);t[e]=function(){const e=arguments.length<=0?void 0:arguments[0];return e in t.state.cache&&t.state.enable?t.state.cache[e]:n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function Ir(t,e,n){const i=t[e].bind(t);t[e]=function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];const{valueChanged:s,oldValue:a}=n(t.state._updateCache,...r);return s&&i(...r),a},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}class Rr{constructor(t){let{copyState:e=!1,log:n=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.program=null,this.stateStack=[],this.enable=!0,this.cache=e?function(t,e){if("number"==typeof(e=e||_r)){const n=e,i=Mr[n];return i?i(t,n):t.getParameter(n)}const n=Array.isArray(e)?e:Object.keys(e),i={};for(const e of n){const n=Mr[e];i[e]=n?n(t,Number(e)):t.getParameter(Number(e))}return i}(t):Object.assign({},_r),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){er(this.stateStack.length>0);const t=this.stateStack[this.stateStack.length-1];Fr(this.gl,t),this.stateStack.pop()}_updateCache(t){let e,n=!1;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const r in t){er(void 0!==r);const o=t[r],s=this.cache[r];kr(o,s)||(n=!0,e=s,i&&!(r in i)&&(i[r]=s),this.cache[r]=o)}return{valueChanged:n,oldValue:e}}}function Nr(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{enable:n=!0,copyState:i}=e;if(er(void 0!==i),!t.state){const{polyfillContext:e}=globalThis;e&&e(t),t.state=new Rr(t,{copyState:i}),function(t){const e=t.useProgram.bind(t);t.useProgram=function(n){t.state.program!==n&&(e(n),t.state.program=n)}}(t);for(const e in Cr)Ir(t,e,Cr[e]);Or(t,"getParameter"),Or(t,"isEnabled")}return t.state.enable=n,t}function zr(t){er(t.state),t.state.pop()}function Fr(t,e){if(er(ir(t),"setParameters requires a WebGL context"),Lr(e))return;const n={};for(const i in e){const r=Number(i),o=Sr[i];o&&("string"==typeof o?n[o]=!0:o(t,e[i],r))}const i=t.state&&t.state.cache;if(i)for(const r in n)(0,Tr[r])(t,e,i)}function Dr(t,e,n){if(Lr(e))return n(t);const{nocatch:i=!0}=e;let r;if(function(t){t.state||Nr(t,{copyState:!1}),t.state.push()}(t),Fr(t,e),i)r=n(t),zr(t);else try{r=n(t)}finally{zr(t)}return r}function jr(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,i="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return i?t.drawingBufferWidth/i:1}return 1}function Br(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(t,e,n,i,r){const o=Ur(t[0],e,n);let s=Vr(t[1],e,i,r),a=Ur(t[0]+1,e,n);const l=a===n-1?a:a-1;let c;return a=Vr(t[1]+1,e,i,r),r?(a=0===a?a:a+1,c=s,s=a):c=a===i-1?a:a-1,{x:o,y:s,width:Math.max(l-o+1,1),height:Math.max(c-s+1,1)}}(e,jr(t),t.drawingBufferWidth,t.drawingBufferHeight,n)}function Ur(t,e,n){return Math.min(Math.round(t*e),n-1)}function Vr(t,e,n,i){return i?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const Wr=p(),Gr=Wr&&"undefined"!=typeof document,Hr={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function qr(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};er(Wr,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),t=Object.assign({},Hr,t);const{width:e,height:n}=t;function i(e){if(t.throwOnError)throw new Error(e);return console.error(e),null}let r;t.onError=i;const{canvas:o}=t,s=function(t){let e,{canvas:n,width:i=800,height:r=600,onError:o}=t;return"string"==typeof n?(Gr&&"complete"===document.readyState||o("createGLContext called on canvas '".concat(n,"' before page was loaded")),e=document.getElementById(n)):n?e=n:(e=document.createElement("canvas"),e.id="lumagl-canvas",e.style.width=Number.isFinite(i)?"".concat(i,"px"):"100%",e.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(e,document.body.firstChild)),e}({canvas:o,width:e,height:n,onError:i});return r=function(t,e){const{onError:n}=e;let i=null;const r=t=>i=t.statusMessage||i;t.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:o=!0,webgl2:s=!0}=e;let a=null;return s&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),o&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",r,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n("Failed to create ".concat(s&&!o?"WebGL2":"WebGL"," context: ").concat(i||"Unknown error"))}(s,t),r?(r=Xr(r,t),function(t){const e=rr(t)?"WebGL2":"WebGL1",n=function(t){const e=t.getParameter(7936),n=t.getParameter(7937),i=t.getExtension("WEBGL_debug_renderer_info");return{vendor:i&&t.getParameter(i.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:i&&t.getParameter(i.UNMASKED_RENDERER_WEBGL||7937)||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t),i=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",r=t.debug?" debug":"";tr.info(1,"".concat(e).concat(r," context ").concat(i))()}(r),r):null}function Xr(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||function(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext?2:1}(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},Hr,e);const{manageState:n,debug:i}=e;return n&&Nr(t,{copyState:!1,log:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return tr.log(1,...e)()}}),Wr&&i&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),tr.level=Math.max(tr.level,1)):tr.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}const Zr="8.5.20",Yr=new class{constructor(){this.stats=new Map}get(t){return this.stats.has(t)||this.stats.set(t,new W({id:t})),this.stats.get(t)}};if(globalThis.luma&&globalThis.luma.VERSION!==Zr)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(Zr));function Kr(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function Qr(t,e){if("string"!=typeof e)return e;const n=Number(e);if(!isNaN(n))return n;const i=t[e=e.replace(/^.*\./,"")];return Kr(void 0!==i,"Accessing undefined constant GL.".concat(e)),i}function $r(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}globalThis.luma||(p()&&tr.log(1,"luma.gl ".concat(Zr," - ").concat("set luma.log.level=1 (or higher) to trace rendering"))(),globalThis.luma=globalThis.luma||{VERSION:Zr,version:Zr,log:tr,stats:Yr,globals:{modules:{},nodeIO:{}}}),globalThis.luma;const Jr={};function to(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";Jr[t]=Jr[t]||1;const e=Jr[t]++;return"".concat(t,"-").concat(e)}function eo(t){return Kr("number"==typeof t,"Input must be a number"),t&&0==(t&t-1)}function no(t){let e=!0;for(const n in t){e=!1;break}return e}function io(t,e,n,i){const r="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),o=Object.getPrototypeOf(t);i.forEach((t=>{o.methodName||(o[t]=()=>{throw tr.removed("Calling removed method ".concat(e,".").concat(t,": "),r)(),new Error(t)})}))}const ro="Resource subclass must define virtual methods";class oo{get[Symbol.toStringTag](){return"Resource"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};or(t);const{id:n,userData:i={}}=e;this.gl=t,this.gl2=t,this.id=n||to(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=e.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,e&&t&&e.filter(Boolean).forEach((t=>t.delete())),this}bind(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.handle;return"function"!=typeof e?(this._bindHandle(e),this):(this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t)}unbind(){this.bind(null)}getParameter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Kr(t=Qr(this.gl,t));const n=(this.constructor.PARAMETERS||{})[t];if(n){const t=rr(this.gl);if("webgl2"in n&&!t||"extension"in n&&!this.gl.getExtension(n.extension)){const e=n.webgl1,i="webgl2"in n?n.webgl2:n.webgl1;return t?i:e}}return this._getParameter(t,e)}getParameters(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{parameters:e,keys:n}=t,i=this.constructor.PARAMETERS||{},r=rr(this.gl),o={},s=e||Object.keys(i);for(const e of s){const s=i[e];if(s&&(!("webgl2"in s)||r)&&(!("extension"in s)||this.gl.getExtension(s.extension))){const i=n?$r(this.gl,e):e;o[i]=this.getParameter(e,t),n&&"GLenum"===s.type&&(o[i]=$r(this.gl,o[i]))}}return o}setParameter(t,e){Kr(t=Qr(this.gl,t));const n=(this.constructor.PARAMETERS||{})[t];if(n){const t=rr(this.gl);if("webgl2"in n&&!t||"extension"in n&&!this.gl.getExtension(n.extension))throw new Error("Parameter not available on this platform");"GLenum"===n.type&&(e=Qr(e))}return this._setParameter(t,e),this}setParameters(t){for(const e in t)this.setParameter(e,t[e]);return this}stubRemovedMethods(t,e,n){return io(this,t,e,n)}initialize(t){}_createHandle(){throw new Error(ro)}_deleteHandle(){throw new Error(ro)}_bindHandle(t){throw new Error(ro)}_getOptsFromHandle(){throw new Error(ro)}_getParameter(t,e){throw new Error(ro)}_setParameter(t,e){throw new Error(ro)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const t=this[Symbol.toStringTag],e=Yr.get("Resource Counts");e.get("Resources Created").incrementCount(),e.get("".concat(t,"s Created")).incrementCount(),e.get("".concat(t,"s Active")).incrementCount()}_removeStats(){const t=this[Symbol.toStringTag];Yr.get("Resource Counts").get("".concat(t,"s Active")).decrementCount()}_trackAllocatedMemory(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(t,e),this._trackAllocatedMemoryForContext(t,e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=t}_trackAllocatedMemoryForContext(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const i=Yr.get("Memory Usage".concat(n));i.get("GPU Memory").addCount(t),i.get("".concat(e," Memory")).addCount(t)}_trackDeallocatedMemory(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(t),this._trackDeallocatedMemoryForContext(t,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=Yr.get("Memory Usage".concat(e));n.get("GPU Memory").subtractCount(this.byteLength),n.get("".concat(t," Memory")).subtractCount(this.byteLength)}}const so="Failed to deduce GL constant from typed array";function ao(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(so)}}function lo(t){let{clamped:e=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function co(t){let{data:e,width:n,height:i}=t;const r=Math.round(n/2),o=Math.round(i/2),s=new Uint8Array(r*o*4);for(let t=0;t<o;t++)for(let i=0;i<r;i++)for(let o=0;o<4;o++)s[4*(t*r+i)+o]=e[4*(2*t*n+2*i)+o];return{data:s,width:r,height:o}}function uo(t,e,n){const{removedProps:i={},deprecatedProps:r={},replacedProps:o={}}=n;for(const n in i)if(n in e){const e=i[n]?"".concat(t,".").concat(i[n]):"N/A";tr.removed("".concat(t,".").concat(n),e)()}for(const n in r)if(n in e){const e=r[n];tr.deprecated("".concat(t,".").concat(n),"".concat(t,".").concat(e))()}let s=null;for(const n in o)if(n in e){const i=o[n];tr.deprecated("".concat(t,".").concat(n),"".concat(t,".").concat(i))(),s=s||Object.assign({},e),s[i]=e[n],delete s[n]}return s||e}const ho={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},fo={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class po{static getBytesPerElement(t){return lo(t.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(t){return Kr(t.size),lo(t.type||5126).BYTES_PER_ELEMENT*t.size}static resolve(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new po(...[ho,...e])}constructor(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach((t=>this._assign(t))),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return po.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return po.getBytesPerVertex(this)}_assign(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=uo("Accessor",t,fo),void 0!==t.type&&(this.type=t.type,5124!==t.type&&5125!==t.type||(this.integer=!0)),void 0!==t.size&&(this.size=t.size),void 0!==t.offset&&(this.offset=t.offset),void 0!==t.stride&&(this.stride=t.stride),void 0!==t.normalized&&(this.normalized=t.normalized),void 0!==t.integer&&(this.integer=t.integer),void 0!==t.divisor&&(this.divisor=t.divisor),void 0!==t.buffer&&(this.buffer=t.buffer),void 0!==t.index&&("boolean"==typeof t.index?this.index=t.index?1:0:this.index=t.index),void 0!==t.instanced&&(this.divisor=t.instanced?1:0),void 0!==t.isInstanced&&(this.divisor=t.isInstanced?1:0),this}}const go={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},mo={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:go},vo={removedProps:go};class yo extends oo{get[Symbol.toStringTag](){return"Buffer"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=e.target||(this.gl.webgl2?36662:34962),this.initialize(e),Object.seal(this)}getElementCount(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/po.getBytesPerElement(t))}getVertexCount(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/po.getBytesPerVertex(t))}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ArrayBuffer.isView(t)&&(t={data:t}),Number.isFinite(t)&&(t={byteLength:t}),t=uo("Buffer",t,mo),this.usage=t.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},t,t.accessor)),t.data?this._setData(t.data,t.offset,t.byteLength):this._setByteLength(t.byteLength||0),this}setProps(t){return"accessor"in(t=uo("Buffer",t,vo))&&this.setAccessor(t.accessor),this}setAccessor(t){return delete(t=Object.assign({},t)).buffer,this.accessor=new po(t),this}reallocate(t){return t>this.byteLength?(this._setByteLength(t),!0):(this.bytesUsed=t,!1)}setData(t){return this.initialize(t)}subData(t){ArrayBuffer.isView(t)&&(t={data:t});const{data:e,offset:n=0,srcOffset:i=0}=t,r=t.byteLength||t.length;Kr(e);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==i||void 0!==r?(sr(this.gl),this.gl.bufferSubData(this.target,n,e,i,r)):this.gl.bufferSubData(o,n,e),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(e),this}copyData(t){let{sourceBuffer:e,readOffset:n=0,writeOffset:i=0,size:r}=t;const{gl:o}=this;return sr(o),o.bindBuffer(36662,e.handle),o.bindBuffer(36663,this.handle),o.copyBufferSubData(36662,36663,n,i,r),o.bindBuffer(36662,null),o.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:t=null,srcByteOffset:e=0,dstOffset:n=0,length:i=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};sr(this.gl);const r=lo(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(e),s=n;let a,l;t?(l=t.length,a=l-s):(a=Math.min(o,i||o),l=s+a);const c=Math.min(o,a);return i=i||c,Kr(i<=c),t=t||new r(l),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,t,n,i),this.gl.bindBuffer(36662,null),t}bind(){let{target:t=this.target,index:e=this.accessor&&this.accessor.index,offset:n=0,size:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===t||35982===t?void 0!==i?this.gl.bindBufferRange(t,e,this.handle,n,i):(Kr(0===n),this.gl.bindBufferBase(t,e,this.handle)):this.gl.bindBuffer(t,this.handle),this}unbind(){let{target:t=this.target,index:e=this.accessor&&this.accessor.index}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===t||35982===t?this.gl.bindBufferBase(t,e,null):this.gl.bindBuffer(t,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.byteLength+e;Kr(ArrayBuffer.isView(t)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,this.usage),this.gl.bufferSubData(i,e,t),this.gl.bindBuffer(i,null),this.debugData=t.slice(0,10),this.bytesUsed=n,this._trackAllocatedMemory(n);const r=ao(t);return Kr(r),this.setAccessor(new po(this.accessor,{type:r})),this}_setByteLength(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.usage;Kr(t>=0),this._trackDeallocatedMemory();let n=t;0===t&&(n=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,e),this.gl.bindBuffer(i,null),this.usage=e,this.debugData=null,this.bytesUsed=t,this._trackAllocatedMemory(t),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(t){const e=t/lo(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-e}_inferType(t){this.accessor.type||this.setAccessor(new po(this.accessor,{type:ao(t)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(t){this.gl.bindBuffer(this.target,this.handle);const e=this.gl.getBufferParameter(this.target,t);return this.gl.bindBuffer(this.target,null),e}get type(){return tr.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return tr.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(t){return tr.deprecated("setByteLength","reallocate")(),this.reallocate(t)}updateAccessor(t){return tr.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new po(this.accessor,t),this}}const _o={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},bo={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},wo={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1},xo=[9729,9728],Eo=globalThis.WebGLBuffer||function(){};class So extends oo{get[Symbol.toStringTag](){return"Texture"}static isSupported(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{format:n,linearFiltering:i}=e;let r=!0;return n&&(r=r&&function(t,e){const n=_o[e];if(!n)return!1;if(void 0===n.gl1&&void 0===n.gl2)return!0;const i=rr(t)&&n.gl2||n.gl1;return"string"==typeof i?t.getExtension(i):i}(t,n),r=r&&(!i||function(t,e){const n=_o[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}(t,n))),r}constructor(t,e){const{id:n=to("texture"),handle:i,target:r}=e;super(t,{id:n,handle:i}),this.target=r,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.data;if(e instanceof Promise)return e.then((e=>this.initialize(Object.assign({},t,{pixels:e,data:e})))),this;const n="undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement;if(n&&e.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,e.addEventListener("loadeddata",(()=>this.initialize(t))),this;const{pixels:i=null,format:r=6408,border:o=0,recreate:s=!1,parameters:a={},pixelStore:l={},textureUnit:c}=t;e||(e=i);let{width:u,height:h,dataFormat:d,type:f,compressed:p=!1,mipmaps:g=!0}=t;const{depth:m=0}=t;return({width:u,height:h,compressed:p,dataFormat:d,type:f}=this._deduceParameters({format:r,type:f,dataFormat:d,compressed:p,data:e,width:u,height:h})),this.width=u,this.height=h,this.depth=m,this.format=r,this.type=f,this.dataFormat=d,this.border=o,this.textureUnit=c,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),g&&this._isNPOT()&&(tr.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),g=!1,this._updateForNPOT(a)),this.mipmaps=g,this.setImageData({data:e,width:u,height:h,depth:m,format:r,type:f,dataFormat:d,border:o,mipmaps:g,parameters:l,compressed:p}),g&&this.generateMipmap(),this.setParameters(a),s&&(this.data=e),n&&(this._video={video:e,parameters:a,lastTime:e.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?e.currentTime:-1}),this}update(){if(this._video){const{video:t,parameters:e,lastTime:n}=this._video;if(n===t.currentTime||t.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:t,parameters:e}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=t.currentTime}}resize(t){let{height:e,width:n,mipmaps:i=!1}=t;return n!==this.width||e!==this.height?this.initialize({width:n,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isNPOT()?(tr.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Dr(this.gl,t,(()=>{this.gl.generateMipmap(this.target)})),this.gl.bindTexture(this.target,null),this)}setImageData(t){this._trackDeallocatedMemory("Texture");const{target:e=this.target,pixels:n=null,level:i=0,format:r=this.format,border:o=this.border,offset:s=0,parameters:a={}}=t;let{data:l=null,type:c=this.type,width:u=this.width,height:h=this.height,dataFormat:d=this.dataFormat,compressed:f=!1}=t;l||(l=n),({type:c,dataFormat:d,compressed:f,width:u,height:h}=this._deduceParameters({format:r,type:c,dataFormat:d,compressed:f,data:l,width:u,height:h}));const{gl:p}=this;p.bindTexture(this.target,this.handle);let g,m=null;({data:l,dataType:m}=this._getDataType({data:l,compressed:f}));let v=0;if(Dr(this.gl,a,(()=>{switch(m){case"null":p.texImage2D(e,i,r,u,h,o,d,c,l);break;case"typed-array":p.texImage2D(e,i,r,u,h,o,d,c,l,s);break;case"buffer":g=sr(p),g.bindBuffer(35052,l.handle||l),g.texImage2D(e,i,r,u,h,o,d,c,s),g.bindBuffer(35052,null);break;case"browser-object":rr(p)?p.texImage2D(e,i,r,u,h,o,d,c,l):p.texImage2D(e,i,r,d,c,l);break;case"compressed":for(const[t,n]of l.entries())p.compressedTexImage2D(e,t,n.format,n.width,n.height,o,n.data),v+=n.levelSize;break;default:Kr(!1,"Unknown image data type")}})),"compressed"===m)this._trackAllocatedMemory(v,"Texture");else if(l&&l.byteLength)this._trackAllocatedMemory(l.byteLength,"Texture");else{const t=bo[this.dataFormat]||4,e=wo[this.type]||1;this._trackAllocatedMemory(this.width*this.height*t*e,"Texture")}return this.loaded=!0,this}setSubImageData(t){let{target:e=this.target,pixels:n=null,data:i=null,x:r=0,y:o=0,width:s=this.width,height:a=this.height,level:l=0,format:c=this.format,type:u=this.type,dataFormat:h=this.dataFormat,compressed:d=!1,offset:f=0,border:p=this.border,parameters:g={}}=t;if(({type:u,dataFormat:h,compressed:d,width:s,height:a}=this._deduceParameters({format:c,type:u,dataFormat:h,compressed:d,data:i,width:s,height:a})),Kr(0===this.depth,"texSubImage not supported for 3D textures"),i||(i=n),i&&i.data){const t=i;i=t.data,s=t.shape[0],a=t.shape[1]}i instanceof yo&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),Dr(this.gl,g,(()=>{if(d)this.gl.compressedTexSubImage2D(e,l,r,o,s,a,c,i);else if(null===i)this.gl.texSubImage2D(e,l,r,o,s,a,h,u,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(e,l,r,o,s,a,h,u,i,f);else if(i instanceof Eo){const t=sr(this.gl);t.bindBuffer(35052,i),t.texSubImage2D(e,l,r,o,s,a,h,u,f),t.bindBuffer(35052,null)}else rr(this.gl)?sr(this.gl).texSubImage2D(e,l,r,o,s,a,h,u,i):this.gl.texSubImage2D(e,l,r,o,h,u,i)})),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return tr.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,this.handle),t}unbind(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,null),t}_getDataType(t){let{data:e,compressed:n=!1}=t;return n?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof yo?{data:e.handle,dataType:"buffer"}:e instanceof Eo?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}_deduceParameters(t){const{format:e,data:n}=t;let{width:i,height:r,dataFormat:o,type:s,compressed:a}=t;const l=_o[e];return o=o||l&&l.dataFormat,s=s||l&&l.types[0],a=a||l&&l.compressed,({width:i,height:r}=this._deduceImageSize(n,i,r)),{dataFormat:o,type:s,compressed:a,width:i,height:r,format:e,data:n}}_deduceImageSize(t,e,n){let i;return i="undefined"!=typeof ImageData&&t instanceof ImageData?{width:t.width,height:t.height}:"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement?{width:t.naturalWidth,height:t.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?{width:t.width,height:t.height}:"undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:t?{width:e,height:n}:{width:e>=0?e:1,height:n>=0?n:1},Kr(i,"Could not deduced texture size"),Kr(void 0===e||i.width===e,"Deduced texture width does not match supplied width"),Kr(void 0===n||i.height===n,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(t){switch(t){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const e=this.gl.getTexParameter(this.target,t);return this.gl.bindTexture(this.target,null),e}}_setParameter(t,e){switch(this.gl.bindTexture(this.target,this.handle),e=this._getNPOTParam(t,e),t){case 33082:case 33083:this.gl.texParameterf(this.handle,t,e);break;case 4096:case 4097:Kr(!1);break;default:this.gl.texParameteri(this.target,t,e)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!(rr(this.gl)||!this.width||!this.height||eo(this.width)&&eo(this.height))}_updateForNPOT(t){void 0===t[this.gl.TEXTURE_MIN_FILTER]&&(t[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===t[this.gl.TEXTURE_WRAP_S]&&(t[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===t[this.gl.TEXTURE_WRAP_T]&&(t[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(t,e){if(this._isNPOT())switch(t){case 10241:-1===xo.indexOf(e)&&(e=9729);break;case 10242:case 10243:33071!==e&&(e=33071)}return e}}class Po extends So{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(t,e){return So.isSupported(t,e)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;or(t),(e instanceof Promise||"string"==typeof e)&&(e={data:e}),"string"==typeof e.data&&(e=Object.assign({},e,{data:(n=e.data,Kr("string"==typeof n),n=""+n,new Promise(((t,e)=>{try{const i=new Image;i.onload=()=>t(i),i.onerror=()=>e(new Error("Could not load image ".concat(n,"."))),i.crossOrigin="anonymous",i.src=n}catch(t){e(t)}})))})),super(t,Object.assign({},e,{target:3553})),this.initialize(e),Object.seal(this)}}const To="EXT_color_buffer_float",Co={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:To,bpp:2},33327:{gl2:To,bpp:4},34842:{gl2:To,bpp:8},33326:{gl2:To,bpp:4},33328:{gl2:To,bpp:8},34836:{gl2:To,bpp:16},35898:{gl2:To,bpp:4}};class Ao extends oo{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(t){let{format:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{format:null};return!e||function(t,e,n){const i=n[e];if(!i)return!1;const r=rr(t)&&i.gl2||i.gl1;return"string"==typeof r?t.getExtension(r):r}(t,e,Co)}static getSamplesForFormat(t,e){let{format:n}=e;return t.getInternalformatParameter(36161,n,32937)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.initialize(e),Object.seal(this)}initialize(t){let{format:e,width:n=1,height:i=1,samples:r=0}=t;return Kr(e,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==r&&rr(this.gl)?this.gl.renderbufferStorageMultisample(36161,r,e,n,i):this.gl.renderbufferStorage(36161,e,n,i),this.format=e,this.width=n,this.height=i,this.samples=r,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*Co[this.format].bpp),this}resize(t){let{width:e,height:n}=t;return e!==this.width||n!==this.height?this.initialize({width:e,height:n,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(t){this.gl.bindRenderbuffer(36161,t)}_syncHandle(t){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(t){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,t)}}const Mo=6144,Lo="clear: bad arguments";function ko(t){let{framebuffer:e=null,color:n=null,depth:i=null,stencil:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o={};e&&(o.framebuffer=e);let s=0;n&&(s|=16384,!0!==n&&(o.clearColor=n)),i&&(s|=256,!0!==i&&(o.clearDepth=i)),r&&(s|=1024,!0!==i&&(o.clearStencil=i)),Kr(0!==s,Lo),Dr(t,o,(()=>{t.clear(s)}))}const Oo=[34069,34070,34071,34072,34073,34074];class Io extends So{get[Symbol.toStringTag](){return"TextureCube"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};or(t),super(t,Object.assign({},e,{target:34067})),this.initialize(e),Object.seal(this)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mipmaps:e=!0,parameters:n={}}=t;return this.opts=t,this.setCubeMapImageData(t).then((()=>{this.loaded=!0,e&&this.generateMipmap(t),this.setParameters(n)})),this}subImage(t){let{face:e,data:n,x:i=0,y:r=0,mipmapLevel:o=0}=t;return this._subImage({target:e,data:n,x:i,y:r,mipmapLevel:o})}async setCubeMapImageData(t){let{width:e,height:n,pixels:i,data:r,border:o=0,format:s=6408,type:a=5121}=t;const{gl:l}=this,c=i||r,u=await Promise.all(Oo.map((t=>{const e=c[t];return Promise.all(Array.isArray(e)?e:[e])})));this.bind(),Oo.forEach(((t,i)=>{u[i].length>1&&!1!==this.opts.mipmaps&&tr.warn("".concat(this.id," has mipmap and multiple LODs."))(),u[i].forEach(((i,r)=>{e&&n?l.texImage2D(t,r,s,e,n,o,s,a,i):l.texImage2D(t,r,s,s,a,i)}))})),this.unbind()}setImageDataForFace(t){const{face:e,width:n,height:i,pixels:r,data:o,border:s=0,format:a=6408,type:l=5121}=t,{gl:c}=this,u=r||o;return this.bind(),u instanceof Promise?u.then((n=>this.setImageDataForFace(Object.assign({},t,{face:e,data:n,pixels:n})))):this.width||this.height?c.texImage2D(e,0,a,n,i,s,a,l,u):c.texImage2D(e,0,a,a,l,u),this}}Io.FACES=Oo;class Ro extends So{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(t){return rr(t)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};sr(t),e=Object.assign({depth:1},e,{target:32879,unpackFlipY:!1}),super(t,e),this.initialize(e),Object.seal(this)}setImageData(t){let{level:e=0,dataFormat:n=6408,width:i,height:r,depth:o=1,border:s=0,format:a,type:l=5121,offset:c=0,data:u,parameters:h={}}=t;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Dr(this.gl,h,(()=>{ArrayBuffer.isView(u)&&this.gl.texImage3D(this.target,e,n,i,r,o,s,a,l,u),u instanceof yo&&(this.gl.bindBuffer(35052,u.handle),this.gl.texImage3D(this.target,e,n,i,r,o,s,a,l,c))})),u&&u.byteLength)this._trackAllocatedMemory(u.byteLength,"Texture");else{const t=bo[this.dataFormat]||4,e=wo[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*t*e,"Texture")}return this.loaded=!0,this}}function No(t,e){const{gl:n,width:i,height:r,id:o}=t;return new qo(n,Object.assign({},e,{id:"framebuffer-for-".concat(o),width:i,height:r,attachments:{36064:t}}))}function zo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{sourceX:n=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:o=36064,target:s=null,sourceWidth:a,sourceHeight:l,sourceType:c}=e;const{framebuffer:u,deleteFramebuffer:h}=Do(t);Kr(u);const{gl:d,handle:f,attachments:p}=u;a=a||u.width,l=l||u.height,36064===o&&null===f&&(o=1028),Kr(p[o]),c=c||p[o].type,s=function(t,e,n,i,r){if(t)return t;const o=lo(e=e||5121,{clamped:!1}),s=function(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Kr(!1),0}}(n);return new o(i*r*s)}(s,c,r,a,l),c=c||ao(s);const g=d.bindFramebuffer(36160,f);return d.readPixels(n,i,a,l,r,c,s),d.bindFramebuffer(36160,g||null),h&&u.delete(),s}function Fo(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=zo(t,{sourceAttachment:e}),{width:r,height:o}=t;for(;o>n;)({data:i,width:r,height:o}=co({data:i,width:r,height:o}));!function(t){let{data:e,width:n,height:i,bytesPerPixel:r=4,temp:o}=t;const s=n*r;o=o||new Uint8Array(s);for(let t=0;t<i/2;++t){const n=t*s,r=(i-t-1)*s;o.set(e.subarray(n,n+s)),e.copyWithin(n,r,r+s),e.set(o,r)}}({data:i,width:r,height:o});const s=document.createElement("canvas");s.width=r,s.height=o;const a=s.getContext("2d"),l=a.createImageData(r,o);return l.data.set(i),a.putImageData(l,0,0),s.toDataURL()}function Do(t){return t instanceof qo?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:No(t),deleteFramebuffer:!0}}const jo="TIMER_QUERY",Bo="ELEMENT_INDEX_UINT32",Uo={WEBGL2:[!1,!0],VERTEX_ARRAY_OBJECT:["OES_vertex_array_object",!0],[jo]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],INSTANCED_RENDERING:["ANGLE_instanced_arrays",!0],MULTIPLE_RENDER_TARGETS:["WEBGL_draw_buffers",!0],[Bo]:["OES_element_index_uint",!0],BLEND_EQUATION_MINMAX:["EXT_blend_minmax",!0],FLOAT_BLEND:["EXT_float_blend"],COLOR_ENCODING_SRGB:["EXT_sRGB",!0],TEXTURE_DEPTH:["WEBGL_depth_texture",!0],TEXTURE_FLOAT:["OES_texture_float",!0],TEXTURE_HALF_FLOAT:["OES_texture_half_float",!0],TEXTURE_FILTER_LINEAR_FLOAT:["OES_texture_float_linear"],TEXTURE_FILTER_LINEAR_HALF_FLOAT:["OES_texture_half_float_linear"],TEXTURE_FILTER_ANISOTROPIC:["EXT_texture_filter_anisotropic"],COLOR_ATTACHMENT_RGBA32F:[function(t){const e=new Po(t,{format:6408,type:5126,dataFormat:6408}),n=new qo(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),i=n.getStatus();return e.delete(),n.delete(),36053===i},"EXT_color_buffer_float"],COLOR_ATTACHMENT_FLOAT:[!1,"EXT_color_buffer_float"],COLOR_ATTACHMENT_HALF_FLOAT:["EXT_color_buffer_half_float"],GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Vo=2;function Wo(t,e){return(e=Array.isArray(e)?e:[e]).every((e=>Go(t,e)))}function Go(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},void 0===t.luma.caps[e]&&(t.luma.caps[e]=function(t,e){const n=Uo[e];let i;Kr(n,e);const r=rr(t)&&n[1]||n[0];if("function"==typeof r)i=r(t);else if(Array.isArray(r)){i=!0;for(const e of r)i=i&&Boolean(t.getExtension(e))}else"string"==typeof r?i=Boolean(t.getExtension(r)):"boolean"==typeof r?i=r:Kr(!1);return i}(t,e)),t.luma.caps[e]||tr.log(Vo,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}const Ho="Multiple render targets not supported";class qo extends oo{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{colorBufferFloat:n,colorBufferHalfFloat:i}=e;let r=!0;return n&&(r=Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("WEBGL_color_buffer_float")||t.getExtension("OES_texture_float"))),i&&(r=r&&Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("EXT_color_buffer_half_float"))),r}static getDefaultFramebuffer(t){return t.luma=t.luma||{},t.luma.defaultFramebuffer=t.luma.defaultFramebuffer||new qo(t,{id:"default-framebuffer",handle:null,attachments:{}}),t.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const t=sr(this.gl);return t.getParameter(t.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const t=sr(this.gl);return t.getParameter(t.MAX_DRAW_BUFFERS)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(e),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(t){let{width:e=1,height:n=1,attachments:i=null,color:r=!0,depth:o=!0,stencil:s=!1,check:a=!0,readBuffer:l,drawBuffers:c}=t;if(Kr(e>=0&&n>=0,"Width and height need to be integers"),this.width=e,this.height=n,i)for(const t in i){const r=i[t];(Array.isArray(r)?r[0]:r).resize({width:e,height:n})}else i=this._createDefaultAttachments(r,o,s,e,n);this.update({clearAttachments:!0,attachments:i,readBuffer:l,drawBuffers:c}),i&&a&&this.checkStatus()}delete(){for(const t of this.ownResources)t.delete();return super.delete(),this}update(t){let{attachments:e={},readBuffer:n,drawBuffers:i,clearAttachments:r=!1,resizeAttachments:o=!0}=t;this.attach(e,{clearAttachments:r,resizeAttachments:o});const{gl:s}=this,a=s.bindFramebuffer(36160,this.handle);return n&&this._setReadBuffer(n),i&&this._setDrawBuffers(i),s.bindFramebuffer(36160,a||null),this}resize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{width:e,height:n}=t;if(null===this.handle)return Kr(void 0===e&&void 0===n),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===e&&(e=this.gl.drawingBufferWidth),void 0===n&&(n=this.gl.drawingBufferHeight),e!==this.width&&n!==this.height&&tr.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(e,"x").concat(n))();for(const t in this.attachments)this.attachments[t].resize({width:e,height:n});return this.width=e,this.height=n,this}attach(t){let{clearAttachments:e=!1,resizeAttachments:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i={};e&&Object.keys(this.attachments).forEach((t=>{i[t]=null})),Object.assign(i,t);const r=this.gl.bindFramebuffer(36160,this.handle);for(const t in i){Kr(void 0!==t,"Misspelled framebuffer binding point?");const e=Number(t),r=i[e];let o=r;if(o)if(o instanceof Ao)this._attachRenderbuffer({attachment:e,renderbuffer:o});else if(Array.isArray(r)){const[t,n=0,i=0]=r;o=t,this._attachTexture({attachment:e,texture:t,layer:n,level:i})}else this._attachTexture({attachment:e,texture:o,layer:0,level:0});else this._unattach(e);n&&o&&o.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,r||null),Object.assign(this.attachments,t),Object.keys(this.attachments).filter((t=>!this.attachments[t])).forEach((t=>{delete this.attachments[t]}))}checkStatus(){const{gl:t}=this,e=this.getStatus();if(36053!==e)throw new Error(function(t){return(qo.STATUS||{})[t]||"Framebuffer error ".concat(t)}(e));return this}getStatus(){const{gl:t}=this,e=t.bindFramebuffer(36160,this.handle),n=t.checkFramebufferStatus(36160);return t.bindFramebuffer(36160,e||null),n}clear(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:e,depth:n,stencil:i,drawBuffers:r=[]}=t,o=this.gl.bindFramebuffer(36160,this.handle);return(e||n||i)&&ko(this.gl,{color:e,depth:n,stencil:i}),r.forEach(((t,e)=>{!function(t){let{framebuffer:e=null,buffer:n=Mo,drawBuffer:i=0,value:r=[0,0,0,0]}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};sr(t),Dr(t,{framebuffer:e},(()=>{switch(n){case Mo:switch(r.constructor){case Int32Array:t.clearBufferiv(n,i,r);break;case Uint32Array:t.clearBufferuiv(n,i,r);break;case Float32Array:default:t.clearBufferfv(n,i,r)}break;case 6145:t.clearBufferfv(6145,0,[r]);break;case 6146:t.clearBufferiv(6146,0,[r]);break;case 34041:const[e,o]=r;t.clearBufferfi(34041,0,e,o);break;default:Kr(!1,Lo)}}))}(this.gl,{drawBuffer:e,value:t})})),this.gl.bindFramebuffer(36160,o||null),this}readPixels(){return tr.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return tr.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return tr.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return tr.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return tr.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return tr.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(t){let{attachments:e=[],x:n=0,y:i=0,width:r,height:o}=t;const s=sr(this.gl),a=s.bindFramebuffer(36008,this.handle);return 0===n&&0===i&&void 0===r&&void 0===o?s.invalidateFramebuffer(36008,e):s.invalidateFramebuffer(36008,e,n,i,r,o),s.bindFramebuffer(36008,a),this}getAttachmentParameter(t,e,n){let i=this._getAttachmentParameterFallback(e);return null===i&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,t,e),this.gl.bindFramebuffer(36160,null)),n&&i>1e3&&(i=$r(this.gl,i)),i}getAttachmentParameters(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36064,e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const r of n)i[e?$r(this.gl,r):r]=this.getAttachmentParameter(t,r,e);return i}getParameters(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const e=Object.keys(this.attachments),n={};for(const i of e){const e=Number(i);n[t?$r(this.gl,e):e]=this.getAttachmentParameters(e,t)}return n}show(){return"undefined"!=typeof window&&window.open(Fo(this),"luma-debug-texture"),this}log(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t>tr.level||"undefined"==typeof window)return this;e=e||"Framebuffer ".concat(this.id);const n=Fo(this,{targetMaxHeight:100});return tr.image({logLevel:t,message:e,image:n},e)(),this}bind(){let{target:t=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(t,this.handle),this}unbind(){let{target:t=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(t,null),this}_createDefaultAttachments(t,e,n,i,r){let o=null;return t&&(o=o||{},o[36064]=new Po(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:r,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),e&&n?(o=o||{},o[33306]=new Ao(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(o[33306])):e?(o=o||{},o[36096]=new Ao(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:r}),this.ownResources.push(o[36096])):n&&Kr(!1),o}_unattach(t){const e=this.attachments[t];e&&(e instanceof Ao?this.gl.framebufferRenderbuffer(36160,t,36161,null):this.gl.framebufferTexture2D(36160,t,3553,null,0),delete this.attachments[t])}_attachRenderbuffer(t){let{attachment:e=36064,renderbuffer:n}=t;const{gl:i}=this;i.framebufferRenderbuffer(36160,e,36161,n.handle),this.attachments[e]=n}_attachTexture(t){let{attachment:e=36064,texture:n,layer:i,level:r}=t;const{gl:o}=this;switch(o.bindTexture(n.target,n.handle),n.target){case 35866:case 32879:sr(o).framebufferTextureLayer(36160,e,n.target,r,i);break;case 34067:const t=function(t){return t<34069?t+34069:t}(i);o.framebufferTexture2D(36160,e,t,n.handle,r);break;case 3553:o.framebufferTexture2D(36160,e,3553,n.handle,r);break;default:Kr(!1,"Illegal texture type")}o.bindTexture(n.target,null),this.attachments[e]=n}_setReadBuffer(t){const e=rr(n=this.gl)?n:null;var n;e?e.readBuffer(t):Kr(36064===t||1029===t,Ho),this.readBuffer=t}_setDrawBuffers(t){const{gl:e}=this,n=sr(e);if(n)n.drawBuffers(t);else{const n=e.getExtension("WEBGL_draw_buffers");n?n.drawBuffersWEBGL(t):Kr(1===t.length&&(36064===t[0]||1029===t[0]),Ho)}this.drawBuffers=t}_getAttachmentParameterFallback(t){const e=function(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in Uo)void 0===t.luma.caps[e]&&(t.luma.caps[e]=Go(t,e));return t.luma.caps}(this.gl);switch(t){case 36052:return e.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return e.WEBGL2?null:8;case 33297:return e.WEBGL2?null:5125;case 33296:return e.WEBGL2||e.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(t){return this.gl.bindFramebuffer(36160,t)}}qo.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const Xo={5126:as.bind(null,"uniform1fv",Jo,1,ls),35664:as.bind(null,"uniform2fv",Jo,2,ls),35665:as.bind(null,"uniform3fv",Jo,3,ls),35666:as.bind(null,"uniform4fv",Jo,4,ls),5124:as.bind(null,"uniform1iv",ts,1,ls),35667:as.bind(null,"uniform2iv",ts,2,ls),35668:as.bind(null,"uniform3iv",ts,3,ls),35669:as.bind(null,"uniform4iv",ts,4,ls),35670:as.bind(null,"uniform1iv",ts,1,ls),35671:as.bind(null,"uniform2iv",ts,2,ls),35672:as.bind(null,"uniform3iv",ts,3,ls),35673:as.bind(null,"uniform4iv",ts,4,ls),35674:as.bind(null,"uniformMatrix2fv",Jo,4,cs),35675:as.bind(null,"uniformMatrix3fv",Jo,9,cs),35676:as.bind(null,"uniformMatrix4fv",Jo,16,cs),35678:ss,35680:ss,5125:as.bind(null,"uniform1uiv",es,1,ls),36294:as.bind(null,"uniform2uiv",es,2,ls),36295:as.bind(null,"uniform3uiv",es,3,ls),36296:as.bind(null,"uniform4uiv",es,4,ls),35685:as.bind(null,"uniformMatrix2x3fv",Jo,6,cs),35686:as.bind(null,"uniformMatrix2x4fv",Jo,8,cs),35687:as.bind(null,"uniformMatrix3x2fv",Jo,6,cs),35688:as.bind(null,"uniformMatrix3x4fv",Jo,12,cs),35689:as.bind(null,"uniformMatrix4x2fv",Jo,8,cs),35690:as.bind(null,"uniformMatrix4x3fv",Jo,12,cs),35678:ss,35680:ss,35679:ss,35682:ss,36289:ss,36292:ss,36293:ss,36298:ss,36299:ss,36300:ss,36303:ss,36306:ss,36307:ss,36308:ss,36311:ss},Zo={},Yo={},Ko={},Qo=[0];function $o(t,e,n,i){1===e&&"boolean"==typeof t&&(t=t?1:0),Number.isFinite(t)&&(Qo[0]=t,t=Qo);const r=t.length;if(r%e&&tr.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let o=i[r];o||(o=new n(r),i[r]=o);for(let e=0;e<r;e++)o[e]=t[e];return o}function Jo(t,e){return $o(t,e,Float32Array,Zo)}function ts(t,e){return $o(t,e,Int32Array,Yo)}function es(t,e){return $o(t,e,Uint32Array,Ko)}function ns(t,e,n){const i=Xo[n.type];if(!i)throw new Error("Unknown GLSL uniform type ".concat(n.type));return i().bind(null,t,e)}function is(t){if("]"!==t[t.length-1])return{name:t,length:1,isArray:!1};const e=t.match(/([^[]*)(\[[0-9]+\])?/);if(!e||e.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:e[1],length:e[2]||1,isArray:Boolean(e[2])}}function rs(t){return Array.isArray(t)||ArrayBuffer.isView(t)?function(t){if(0===t.length)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}(t):!!isFinite(t)||!0===t||!1===t||t instanceof So||t instanceof Ao||t instanceof qo&&Boolean(t.texture)}function os(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const i=t[e];for(let t=0,e=n.length;t<e;++t)i[t]=n[t]}else t[e]=n.slice();else t[e]=n}function ss(){let t=null;return(e,n,i)=>{const r=t!==i;return r&&(e.uniform1i(n,i),t=i),r}}function as(t,e,n,i){let r=null,o=null;return(s,a,l)=>{const c=e(l,n),u=c.length;let h=!1;if(null===r)r=new Float32Array(u),o=u,h=!0;else{Kr(o===u,"Uniform length cannot change.");for(let t=0;t<u;++t)if(c[t]!==r[t]){h=!0;break}}return h&&(i(s,t,a,c),r.set(c)),h}}function ls(t,e,n,i){t[e](n,i)}function cs(t,e,n,i){t[e](n,!1,i)}function us(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";const n=t.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return n?n[1]:e}function hs(t,e){let n="";for(let i=0;i<e.length;i++){const r=e[i];if((t[i+3]||t[i+2]||t[i+1])&&(n+="".concat(r,"\n"),t[i+1])){const e=t[i+1],r=e.split(":",3),o=r[0],s=parseInt(r[1],10)||0,a=e.substring(r.join(":").length+1).trim();n+=ds("^^^ ".concat(o,": ").concat(a,"\n\n"),s)}}return n}function ds(t,e){let n="";for(let t=0;t<e;++t)n+=" ";return"".concat(n).concat(t)}class fs extends oo{get[Symbol.toStringTag](){return"Shader"}static getTypeName(t){switch(t){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return Kr(!1),"unknown"}}constructor(t,e){or(t),Kr("string"==typeof e.source,"Shader: GLSL source code must be a JavaScript string"),super(t,{id:us(e.source,null)||e.id||to("unnamed ".concat(fs.getTypeName(e.shaderType)))}),this.shaderType=e.shaderType,this.source=e.source,this.initialize(e)}initialize(t){let{source:e}=t;const n=us(e,null);n&&(this.id=to(n)),this._compile(e)}getParameter(t){return this.gl.getShaderParameter(this.handle,t)}toString(){return"".concat(fs.getTypeName(this.shaderType),":").concat(this.id)}getName(){return us(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const t=this.gl.getExtension("WEBGL_debug_shaders");return t?t.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.source;if(t.startsWith("#version ")||(t="#version 100\n".concat(t)),this.source=t,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const t=this.gl.getShaderInfoLog(this.handle),{shaderName:e,errors:n,warnings:i}=function(t,e,n,i){const r=t.split(/\r?\n/),o={},s={},a=i||us(e)||"(unnamed)",l="".concat(function(t){switch(t){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(n)," shader ").concat(a);for(let e=0;e<r.length;e++){const n=r[e];if(n.length<=1)continue;const i=n.split(":"),a=i[0],c=parseInt(i[2],10);if(isNaN(c))throw new Error("GLSL compilation error in ".concat(l,": ").concat(t));"WARNING"!==a?o[c]=n:s[c]=n}const c=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:": ";const i=t.split(/\r?\n/),r=String(i.length+e-1).length;return i.map(((t,i)=>{const o=String(i+e),s=o.length;return ds(o,r-s)+n+t}))}(e);return{shaderName:l,errors:hs(o,c),warnings:hs(s,c)}}(t,this.source,this.shaderType,this.id);throw tr.error("GLSL compilation errors in ".concat(e,"\n").concat(n))(),tr.warn("GLSL compilation warnings in ".concat(e,"\n").concat(i))(),new Error("GLSL compilation errors in ".concat(e))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class ps extends fs{get[Symbol.toStringTag](){return"VertexShader"}constructor(t,e){"string"==typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class gs extends fs{get[Symbol.toStringTag](){return"FragmentShader"}constructor(t,e){"string"==typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const ms=5120,vs=5121,ys=5122,_s=5123,bs=5126,ws=5124,xs=5125,Es={[bs]:[bs,1,"float"],35664:[bs,2,"vec2"],35665:[bs,3,"vec3"],35666:[bs,4,"vec4"],[ws]:[ws,1,"int"],35667:[ws,2,"ivec2"],35668:[ws,3,"ivec3"],35669:[ws,4,"ivec4"],[xs]:[xs,1,"uint"],36294:[xs,2,"uvec2"],36295:[xs,3,"uvec3"],36296:[xs,4,"uvec4"],35670:[bs,1,"bool"],35671:[bs,2,"bvec2"],35672:[bs,3,"bvec3"],35673:[bs,4,"bvec4"],35674:[bs,8,"mat2"],35685:[bs,8,"mat2x3"],35686:[bs,8,"mat2x4"],35675:[bs,12,"mat3"],35687:[bs,12,"mat3x2"],35688:[bs,12,"mat3x4"],35676:[bs,16,"mat4"],35689:[bs,16,"mat4x2"],35690:[bs,16,"mat4x3"]};function Ss(t){const e=Es[t];if(!e)return null;const[n,i]=e;return{type:n,components:i}}function Ps(t,e){switch(t){case ms:case vs:case ys:case _s:t=bs}for(const n in Es){const[i,r,o]=Es[n];if(i===t&&r===e)return{glType:n,name:o}}return null}class Ts{constructor(t){this.id=t.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(t),this._readVaryingsFromProgram(t)}getAttributeInfo(t){const e=Number(t);return Number.isFinite(e)?this.attributeInfosByLocation[e]:this.attributeInfosByName[t]||null}getAttributeLocation(t){const e=this.getAttributeInfo(t);return e?e.location:-1}getAttributeAccessor(t){const e=this.getAttributeInfo(t);return e?e.accessor:null}getVaryingInfo(t){const e=Number(t);return Number.isFinite(e)?this.varyingInfos[e]:this.varyingInfosByName[t]||null}getVaryingIndex(t){const e=this.getVaryingInfo();return e?e.location:-1}getVaryingAccessor(t){const e=this.getVaryingInfo();return e?e.accessor:null}_readAttributesFromProgram(t){const{gl:e}=t,n=e.getProgramParameter(t.handle,35721);for(let i=0;i<n;i++){const{name:n,type:r,size:o}=e.getActiveAttrib(t.handle,i),s=e.getAttribLocation(t.handle,n);s>=0&&this._addAttribute(s,n,r,o)}this.attributeInfos.sort(((t,e)=>t.location-e.location))}_readVaryingsFromProgram(t){const{gl:e}=t;if(!rr(e))return;const n=e.getProgramParameter(t.handle,35971);for(let i=0;i<n;i++){const{name:n,type:r,size:o}=e.getTransformFeedbackVarying(t.handle,i);this._addVarying(i,n,r,o)}this.varyingInfos.sort(((t,e)=>t.location-e.location))}_addAttribute(t,e,n,i){const{type:r,components:o}=Ss(n),s={type:r,size:i*o};this._inferProperties(t,e,s);const a={location:t,name:e,accessor:new po(s)};this.attributeInfos.push(a),this.attributeInfosByLocation[t]=a,this.attributeInfosByName[a.name]=a}_inferProperties(t,e,n){/instance/i.test(e)&&(n.divisor=1)}_addVarying(t,e,n,i){const{type:r,components:o}=Ss(n),s={location:t,name:e,accessor:new po({type:r,size:i*o})};this.varyingInfos.push(s),this.varyingInfosByName[s.name]=s}}const Cs=35981,As=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class Ms extends oo{get[Symbol.toStringTag](){return"Program"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.stubRemovedMethods("Program","v6.0",As),this._isCached=!1,this.initialize(e),Object.seal(this),this._setId(e.id)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{hash:e,vs:n,fs:i,varyings:r,bufferMode:o=Cs}=t;return this.hash=e||"",this.vs="string"==typeof n?new ps(this.gl,{id:"".concat(t.id,"-vs"),source:n}):n,this.fs="string"==typeof i?new gs(this.gl,{id:"".concat(t.id,"-fs"),source:i}):i,Kr(this.vs instanceof ps),Kr(this.fs instanceof gs),this.uniforms={},this._textureUniforms={},r&&r.length>0&&(sr(this.gl),this.varyings=r,this.gl2.transformFeedbackVaryings(this.handle,r,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new Ts(this),this.setProps(t)}delete(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isCached?this:super.delete(t)}setProps(t){return"uniforms"in t&&this.setUniforms(t.uniforms),this}draw(t){let{logPriority:e,drawMode:n=4,vertexCount:i,offset:r=0,start:o,end:s,isIndexed:a=!1,indexType:l=5123,instanceCount:c=0,isInstanced:u=c>0,vertexArray:h=null,transformFeedback:d,framebuffer:f,parameters:p={},uniforms:g,samplers:m}=t;if((g||m)&&(tr.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(g||{})),tr.priority>=e){const t=f?f.id:"default",r="mode=".concat($r(this.gl,n)," verts=").concat(i," ")+"instances=".concat(c," indexType=").concat($r(this.gl,l)," ")+"isInstanced=".concat(u," isIndexed=").concat(a," ")+"Framebuffer=".concat(t);tr.log(e,r)()}return Kr(h),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===i||u&&0===c||(h.bindForDraw(i,c,(()=>{if(void 0!==f&&(p=Object.assign({},p,{framebuffer:f})),d){const t=function(t){switch(t){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return Kr(!1),0}}(n);d.begin(t)}this._bindTextures(),Dr(this.gl,p,(()=>{a&&u?this.gl2.drawElementsInstanced(n,i,l,r,c):a&&rr(this.gl)&&!isNaN(o)&&!isNaN(s)?this.gl2.drawRangeElements(n,o,s,i,l,r):a?this.gl.drawElements(n,i,l,r):u?this.gl2.drawArraysInstanced(n,r,i,c):this.gl.drawArrays(n,r,i)})),d&&d.end()})),0))}setUniforms(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};tr.priority>=2&&function(t,e,n){for(const i in t){const r=t[i];if((!n||Boolean(n[i]))&&!rs(r))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(i),r),new Error("".concat(e," Bad uniform ").concat(i))}}(t,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const e in t){const n=t[e],i=this._uniformSetters[e];if(i){let t=n,r=!1;if(t instanceof qo&&(t=t.texture),t instanceof So)if(r=this.uniforms[e]!==n,r){void 0===i.textureIndex&&(i.textureIndex=this._textureIndexCounter++);const n=t,{textureIndex:r}=i;n.bind(r),t=r,this._textureUniforms[e]=n}else t=i.textureIndex;else this._textureUniforms[e]&&delete this._textureUniforms[e];(i(t)||r)&&os(this.uniforms,e,n)}}return this}_areTexturesRenderable(){let t=!0;for(const e in this._textureUniforms){const n=this._textureUniforms[e];n.update(),t=t&&n.loaded}return t}_bindTextures(){for(const t in this._textureUniforms){const e=this._uniformSetters[t].textureIndex;this._textureUniforms[t].bind(e)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(t){const e=this.gl.getAttachedShaders(t),n={};for(const t of e)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:n.vs=new ps({handle:t});break;case 35632:n.fs=new gs({handle:t})}return n}_getParameter(t){return this.gl.getProgramParameter(this.handle,t)}_setId(t){if(!t){const t=this._getName();this.id=to(t)}}_getName(){let t=this.vs.getName()||this.fs.getName();return t=t.replace(/shader/i,""),t=t?"".concat(t,"-program"):"program",t}_compileAndLink(){const{gl:t}=this;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),tr.time(4,"linkProgram for ".concat(this._getName()))(),t.linkProgram(this.handle),tr.timeEnd(4,"linkProgram for ".concat(this._getName()))(),t.debug||tr.level>0){if(!t.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(t.getProgramInfoLog(this.handle)));if(t.validateProgram(this.handle),!t.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(t.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:t}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let e=0;e<this._uniformCount;e++){const n=this.gl.getActiveUniform(this.handle,e),{name:i}=is(n.name);let r=t.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=ns(t,r,n),n.size>1)for(let e=0;e<n.size;e++)r=t.getUniformLocation(this.handle,"".concat(i,"[").concat(e,"]")),this._uniformSetters["".concat(i,"[").concat(e,"]")]=ns(t,r,n)}this._textureIndexCounter=0}getActiveUniforms(t,e){return this.gl2.getActiveUniforms(this.handle,t,e)}getUniformBlockIndex(t){return this.gl2.getUniformBlockIndex(this.handle,t)}getActiveUniformBlockParameter(t,e){return this.gl2.getActiveUniformBlockParameter(this.handle,t,e)}uniformBlockBinding(t,e){this.gl2.uniformBlockBinding(this.handle,t,e)}}class Ls{static getDefaultProgramManager(t){return t.luma=t.luma||{},t.luma.defaultProgramManager=t.luma.defaultProgramManager||new Ls(t),t.luma.defaultProgramManager}constructor(t){this.gl=t,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(t){this._defaultModules.find((e=>e.name===t.name))||this._defaultModules.push(t),this.stateHash++}removeDefaultModule(t){const e="string"==typeof t?t:t.name;this._defaultModules=this._defaultModules.filter((t=>t.name!==e)),this.stateHash++}addShaderHook(t,e){e&&(t=Object.assign(e,{hook:t})),this._hookFunctions.push(t),this.stateHash++}get(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{vs:e="",fs:n="",defines:i={},inject:r={},varyings:o=[],bufferMode:s=35981,transpileToGLSL100:a=!1}=t,l=this._getModuleList(t.modules),c=this._getHash(e),u=this._getHash(n),h=l.map((t=>this._getHash(t.name))).sort(),d=o.map((t=>this._getHash(t))),f=Object.keys(i).sort(),p=Object.keys(r).sort(),g=[],m=[];for(const t of f)g.push(this._getHash(t)),g.push(this._getHash(i[t]));for(const t of p)m.push(this._getHash(t)),m.push(this._getHash(r[t]));const v="".concat(c,"/").concat(u,"D").concat(g.join("/"),"M").concat(h.join("/"),"I").concat(m.join("/"),"V").concat(d.join("/"),"H").concat(this.stateHash,"B").concat(s).concat(a?"T":"");if(!this._programCache[v]){const t=function(t,e){const{vs:n,fs:i}=e,r=bi(e.modules||[]);return{gl:t,vs:$i(t,Object.assign({},e,{source:n,type:fi,modules:r})),fs:$i(t,Object.assign({},e,{source:i,type:pi,modules:r})),getUniforms:Ji(r)}}(this.gl,{vs:e,fs:n,modules:l,inject:r,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:a});this._programCache[v]=new Ms(this.gl,{hash:v,vs:t.vs,fs:t.fs,varyings:o,bufferMode:s}),this._getUniforms[v]=t.getUniforms||(t=>{}),this._useCounts[v]=0}return this._useCounts[v]++,this._programCache[v]}getUniforms(t){return this._getUniforms[t.hash]||null}release(t){const e=t.hash;this._useCounts[e]--,0===this._useCounts[e]&&(this._programCache[e].delete(),delete this._programCache[e],delete this._getUniforms[e],delete this._useCounts[e])}_getHash(t){return void 0===this._hashes[t]&&(this._hashes[t]=this._hashCounter++),this._hashes[t]}_getModuleList(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e=new Array(this._defaultModules.length+t.length),n={};let i=0;for(let t=0,r=this._defaultModules.length;t<r;++t){const r=this._defaultModules[t],o=r.name;e[i++]=r,n[o]=!0}for(let r=0,o=t.length;r<o;++r){const o=t[r],s=o.name;n[s]||(e[i++]=o,n[s]=!0)}return e.length=i,e}}const ks="#define SMOOTH_EDGE_RADIUS 0.5",Os={name:"geometry",vs:"\n".concat(ks,"\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n"),fs:"\n".concat(ks,"\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n")},Is=Object.keys(ri).map((t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(ri[t],";"))).join(""),Rs=Object.keys(oi).map((t=>"const int PROJECTION_MODE_".concat(t," = ").concat(oi[t],";"))).join(""),Ns=Object.keys(si).map((t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(si[t],";"))).join(""),zs="".concat(Is,"\n").concat(Rs,"\n").concat(Ns,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size_at_latitude(float lat) {\n  float y = clamp(lat, -89.9, 89.9);\n  return 1.0 / cos(radians(y));\n}\n\nfloat project_size() {\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n    project_uPseudoMeters == false) {\n    \n    if (geometry.position.w == 0.0) {\n      return project_size_at_latitude(geometry.worldPosition.y);\n    }\n  \n    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    float y2 = y * y;\n    float y4 = y2 * y2;\n    float y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\n\nfloat project_size_at_latitude(float meters, float lat) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);\n}\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size();\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter * project_size();\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n  mat3 rotation;\n  if (project_needs_rotation(geometry.position.xyz, rotation)) {\n    n = rotation * n;\n  }\n  return n;\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size_at_latitude(position_world.z, position_world.y),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\n  if (unit == UNIT_METERS) return project_size_to_pixel(size);\n  if (unit == UNIT_COMMON) return size * project_uScale;\n  return size;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\n");function Fs(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}return!1}function Ds(t){let e,n={};return i=>{for(const r in i)if(!Fs(i[r],n[r])){e=t(i),n=i;break}return e}}const js=[0,0,0,0],Bs=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Us=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Vs=[0,0,0],Ws=[0,0,0],Gs=Ds((function({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:i}){const{projectionCenter:r,viewProjectionMatrix:o,originCommon:s,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:c}=function(t,e,n){const{viewMatrixUncentered:i,projectionMatrix:r}=t;let{viewMatrix:o,viewProjectionMatrix:s}=t,a=js,l=js,c=t.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:h,offsetMode:d}=Hs(t,e,n);return d&&(l=t.projectPosition(u||h),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=Sn([],l,s),o=i||o,s=gn([],r,o),s=gn([],s,Bs)),{viewMatrix:o,viewProjectionMatrix:s,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:h,geospatialOrigin:u}}(t,n,i),u=t.getDistanceScales(),h=[t.width*e,t.height*e],d=Sn([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,f={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:s.slice(0,3),project_uCenter:r,project_uPseudoMeters:Boolean(t._pseudoMeters),project_uViewportSize:h,project_uDevicePixelRatio:e,project_uFocalDistance:d,project_uCommonUnitsPerMeter:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:Vs,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:o,project_uModelMatrix:Us,project_uCameraPosition:a};if(c){const e=t.getDistanceScales(c);switch(n){case ri.METER_OFFSETS:f.project_uCommonUnitsPerWorldUnit=e.unitsPerMeter,f.project_uCommonUnitsPerWorldUnit2=e.unitsPerMeter2;break;case ri.LNGLAT:case ri.LNGLAT_OFFSETS:t._pseudoMeters||(f.project_uCommonUnitsPerMeter=e.unitsPerMeter),f.project_uCommonUnitsPerWorldUnit=e.unitsPerDegree,f.project_uCommonUnitsPerWorldUnit2=e.unitsPerDegree2;break;case ri.CARTESIAN:f.project_uCommonUnitsPerWorldUnit=[1,1,e.unitsPerMeter[2]],f.project_uCommonUnitsPerWorldUnit2=[0,0,e.unitsPerMeter2[2]]}}return f}));function Hs(t,e,n=Ws){n.length<3&&(n=[n[0],n[1],0]);let i,r=n,o=!0;switch(i=e===ri.LNGLAT_OFFSETS||e===ri.METER_OFFSETS?n:t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case oi.WEB_MERCATOR:e!==ri.LNGLAT&&e!==ri.CARTESIAN||(i=[0,0,0],o=!1);break;case oi.WEB_MERCATOR_AUTO_OFFSET:e===ri.LNGLAT?r=i:e===ri.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case oi.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case oi.GLOBE:o=!1,i=null;break;default:o=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:o}}const qs={},Xs={name:"project",dependencies:[{name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null},Os],vs:zs,getUniforms:function(t=qs){return"viewport"in t?function({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:i=ri.DEFAULT,coordinateOrigin:r=Ws,autoWrapLongitude:o=!1}){i===ri.DEFAULT&&(i=t.isGeospatial?ri.LNGLAT:ri.CARTESIAN);const s=Gs({viewport:t,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return s.project_uWrapLongitude=o,s.project_uModelMatrix=n||Us,s}(t):{}}},Zs=[Xs],Ys=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function Ks(t){const e=Ls.getDefaultProgramManager(t);for(const t of Zs)e.addDefaultModule(t);for(const t of Ys)e.addShaderHook(t);return e}class Qs{constructor(t,{deck:e,stats:n,viewport:r,timeline:o}={}){i(this,"layers",void 0),i(this,"context",void 0),i(this,"resourceManager",void 0),i(this,"_lastRenderedLayers",[]),i(this,"_needsRedraw",!1),i(this,"_needsUpdate",!1),i(this,"_nextLayers",null),i(this,"_debug",!1),i(this,"activateViewport",(t=>{F("layerManager.activateViewport",this,t),t&&(this.context.viewport=t)})),this.layers=[],this.resourceManager=new ke({gl:t,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:t,deck:e,programManager:t&&Ks(t),stats:n||new W({id:"deck.gl"}),viewport:r||new di({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:o||new s,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const t of this.layers)this._finalizeLayer(t)}needsRedraw(t={clearRedrawFlags:!1}){let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const i=n.getNeedsRedraw(t);e=e||i}return e}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(t){this._needsRedraw=this._needsRedraw||t}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t}getLayers({layerIds:t}={}){return t?this.layers.filter((e=>t.find((t=>0===e.id.indexOf(t))))):this.layers}setProps(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}setLayers(t,e){F("layerManager.setLayers",this,e,t),this._lastRenderedLayers=t;const n=D(t,Boolean);for(const t of n)t.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const t=this.needsUpdate();t&&(this.setNeedsRedraw("updating layers: ".concat(t)),this.setLayers(this._nextLayers||this._lastRenderedLayers,t)),this._nextLayers=null}_handleError(t,e,n){n.raiseError(e,"".concat(t," of ").concat(n))}_updateLayers(t,e){const n={};for(const e of t)n[e.id]?R.warn("Multiple old layers with same id ".concat(e.id))():n[e.id]=e;const i=[];this._updateSublayersRecursively(e,n,i),this._finalizeOldLayers(n);let r=!1;for(const t of i)if(t.hasUniformTransition()){r="Uniform transition in ".concat(t);break}this._needsUpdate=r,this.layers=i}_updateSublayersRecursively(t,e,n){for(const i of t){i.context=this.context;const t=e[i.id];null===t&&R.warn("Multiple new layers with same id ".concat(i.id))(),e[i.id]=null;let r=null;try{this._debug&&t!==i&&i.validateProps(),t?(this._transferLayerState(t,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),r=i.isComposite?i.getSubLayers():null}catch(t){this._handleError("matching",t,i)}r&&this._updateSublayersRecursively(r,e,n)}}_finalizeOldLayers(t){for(const e in t){const n=t[e];n&&this._finalizeLayer(n)}}_initializeLayer(t){try{t._initialize(),t.lifecycle="Initialized"}catch(e){this._handleError("initialization",e,t)}}_transferLayerState(t,e){e._transferState(t),e.lifecycle="Matched. State transferred from previous layer",e!==t&&(t.lifecycle="Discarded. Awaiting garbage collection")}_updateLayer(t){try{t._update()}catch(e){this._handleError("update",e,t)}}_finalizeLayer(t){this._needsRedraw=this._needsRedraw||"finalized ".concat(t),t.lifecycle="No longer matched. Awaiting garbage collection";try{t._finalize(),t.lifecycle="Finalized! Awaiting garbage collection"}catch(e){this._handleError("finalization",e,t)}}}function $s(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!$s(t[i],e[i],n-1))return!1;return!0}if(Array.isArray(e))return!1;if("object"==typeof t&&"object"==typeof e){const i=Object.keys(t),r=Object.keys(e);if(i.length!==r.length)return!1;for(const r of i){if(!e.hasOwnProperty(r))return!1;if(!$s(t[r],e[r],n-1))return!1}return!0}return!1}class Js{constructor(t){i(this,"width",void 0),i(this,"height",void 0),i(this,"views",void 0),i(this,"viewState",void 0),i(this,"controllers",void 0),i(this,"timeline",void 0),i(this,"_viewports",void 0),i(this,"_viewportMap",void 0),i(this,"_isUpdating",void 0),i(this,"_needsRedraw",void 0),i(this,"_needsUpdate",void 0),i(this,"_eventManager",void 0),i(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}finalize(){for(const t in this.controllers){const e=this.controllers[t];e&&e.finalize()}this.controllers={}}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(const t in this.controllers){const e=this.controllers[t];e&&e.updateTransition()}}getViewports(t){return t?this._viewports.filter((e=>e.containsPixel(t))):this._viewports}getViews(){const t={};return this.views.forEach((e=>{t[e.id]=e})),t}getView(t){return this.views.find((e=>e.id===t))}getViewState(t){const e="string"==typeof t?this.getView(t):t,n=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(n):n}getViewport(t){return this._viewportMap[t]}unproject(t,e){const n=this.getViewports(),i={x:t[0],y:t[1]};for(let r=n.length-1;r>=0;--r){const o=n[r];if(o.containsPixel(i)){const n=t.slice();return n[0]-=o.x,n[1]-=o.y,o.unproject(n,e)}}return null}setProps(t){t.views&&this._setViews(t.views),t.viewState&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,e){t===this.width&&e===this.height||(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}_setViews(t){t=D(t,Boolean),this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){t?(!$s(t,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=t):R.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(t,e){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...e,viewId:t})}_createController(t,e){return new(0,e.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,e.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:e=>{var n;return null===(n=this.getView(t.id))||void 0===n?void 0:n.makeViewport({viewState:e,width:this.width,height:this.height})}})}_updateController(t,e,n,i){const r=t.controller;if(r&&n){const o={...e,...r,id:t.id,x:n.x,y:n.y,width:n.width,height:n.height};return i&&i.constructor===t.ControllerType||(i=this._createController(t,o)),i&&i.setProps(o),i}return null}_rebuildViewports(){const{views:t}=this,e=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let i=t.length;i--;){const r=t[i],o=this.getViewState(r),s=r.makeViewport({viewState:o,width:this.width,height:this.height});let a=e[r.id];const l=Boolean(r.controller);l&&!a&&(n=!0),!n&&l||!a||(a.finalize(),a=null),this.controllers[r.id]=this._updateController(r,o,s,a),s&&this._viewports.unshift(s)}for(const t in e){const n=e[t];n&&!this.controllers[t]&&n.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach((t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)}))}_diffViews(t,e){return t.length!==e.length||t.some(((n,i)=>!t[i].equals(e[i])))}}const ta=/([0-9]+\.?[0-9]*)(%|px)/;function ea(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=ta.exec(t);if(e&&e.length>=3){const t="%"===e[2],n=parseFloat(e[1]);return{position:t?n/100:n,relative:t}}default:throw new Error("Could not parse position string ".concat(t))}}function na(t,e){return t.relative?Math.round(t.position*e):t.position}function ia(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class ra{constructor(t){i(this,"id",void 0),i(this,"viewportInstance",void 0),i(this,"_x",void 0),i(this,"_y",void 0),i(this,"_width",void 0),i(this,"_height",void 0),i(this,"_padding",void 0),i(this,"props",void 0);const{id:e,x:n=0,y:r=0,width:o="100%",height:s="100%",padding:a=null,viewportInstance:l}=t||{};ia(!l||l instanceof di),this.viewportInstance=l,this.id=e||this.constructor.displayName||"view",this.props={...t,id:this.id},this._x=ea(n),this._y=ea(r),this._width=ea(o),this._height=ea(s),this._padding=a&&{left:ea(a.left||0),right:ea(a.right||0),top:ea(a.top||0),bottom:ea(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(t){return this===t||(this.viewportInstance?!!t.viewportInstance&&this.viewportInstance.equals(t.viewportInstance):this.ViewportType===t.ViewportType&&$s(this.props,t.props,2))}makeViewport({width:t,height:e,viewState:n}){if(this.viewportInstance)return this.viewportInstance;n=this.filterViewState(n);const i=this.getDimensions({width:t,height:e});return i.height&&i.width?new this.ViewportType({...n,...this.props,...i}):null}getViewStateId(){const{viewState:t}=this.props;return"string"==typeof t?t:(null==t?void 0:t.id)||this.id}filterViewState(t){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const e={...t};for(const t in this.props.viewState)"id"!==t&&(e[t]=this.props.viewState[t]);return e}return t}getDimensions({width:t,height:e}){const n={x:na(this._x,t),y:na(this._y,e),width:na(this._width,t),height:na(this._height,e)};return this._padding&&(n.padding={left:na(this._padding.left,t),top:na(this._padding.top,e),right:na(this._padding.right,t),bottom:na(this._padding.bottom,e)}),n}get controller(){const t=this.props.controller;return t?!0===t?{type:this.ControllerType}:"function"==typeof t?{type:t}:{type:this.ControllerType,...t}:null}}class oa extends di{constructor(t={}){const{latitude:e=0,longitude:n=0,zoom:r=0,pitch:o=0,bearing:s=0,nearZMultiplier:a=.1,farZMultiplier:l=1.01,orthographic:c=!1,projectionMatrix:u,repeat:h=!1,worldOffset:d=0,position:f,padding:p,legacyMeterSizes:g=!1}=t;let{width:m,height:v,altitude:y=1.5}=t;const _=Math.pow(2,r);let b;m=m||1,v=v||1;let w=null;if(u)y=u[5]/2,b=$n(y);else{let n;if(t.fovy?(b=t.fovy,y=Jn(b)):b=$n(y),p){const{top:t=0,bottom:e=0}=p;n=[0,ze((t+v-e)/2,0,v)-v/2]}w=function(t){const{width:e,height:n,altitude:i,pitch:r=0,offset:o,center:s,scale:a,nearZMultiplier:l=1,farZMultiplier:c=1}=t;let{fovy:u=$n(qn)}=t;void 0!==i&&(u=$n(i));const h=u*Un,d=r*Un,f=Jn(u);let p=f;s&&(p+=s[2]*a/Math.cos(d)/n);const g=h*(.5+(o?o[1]:0)/n),m=Math.sin(g)*p/Math.sin(zn(Math.PI/2-d-g,.01,Math.PI-.01)),v=Math.sin(d)*m+p,y=10*p;return{fov:h,aspect:e/n,focalDistance:f,near:l,far:Math.min(v*c,y)}}({width:m,height:v,scale:_,center:f&&[0,0,f[2]*Yn(e)],offset:n,pitch:o,fovy:b,nearZMultiplier:a,farZMultiplier:l})}let x=function(t){const{height:e,pitch:n,bearing:i,altitude:r,scale:o,center:s}=t,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];mn(a,a,[0,0,-r]),yn(a,a,-n*Un),_n(a,a,i*Un);const l=o/e;var c,u;return vn(a,a,[l,l,l]),s&&mn(a,a,((c=[])[0]=-(u=s)[0],c[1]=-u[1],c[2]=-u[2],c)),a}({height:v,pitch:o,bearing:s,scale:_,altitude:y});d&&(x=(new Ln).translate([512*d,0,0]).multiplyLeft(x)),super({...t,width:m,height:v,viewMatrix:x,longitude:n,latitude:e,zoom:r,...w,fovy:b,focalDistance:y}),i(this,"longitude",void 0),i(this,"latitude",void 0),i(this,"pitch",void 0),i(this,"bearing",void 0),i(this,"altitude",void 0),i(this,"fovy",void 0),i(this,"orthographic",void 0),i(this,"_subViewports",void 0),i(this,"_pseudoMeters",void 0),this.latitude=e,this.longitude=n,this.zoom=r,this.pitch=o,this.bearing=s,this.altitude=y,this.fovy=b,this.orthographic=c,this._subViewports=h?[]:null,this._pseudoMeters=g,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),e=Math.floor((t[0]+180)/360),n=Math.ceil((t[2]-180)/360);for(let t=e;t<=n;t++){const e=t?new oa({...this,worldOffset:t}):this;this._subViewports.push(e)}}return this._subViewports}projectPosition(t){if(this._pseudoMeters)return super.projectPosition(t);const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*Yn(t[1])]}unprojectPosition(t){if(this._pseudoMeters)return super.unprojectPosition(t);const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)/Yn(n)]}addMetersToLngLat(t,e){return Qn(t,e)}panByPosition(t,e){const n=ei(e,this.pixelUnprojectionMatrix),i=wn([],this.projectFlat(t),((r=[])[0]=-(o=n)[0],r[1]=-o[1],r));var r,o;const s=wn([],this.center,i),[a,l]=this.unprojectFlat(s);return{longitude:a,latitude:l}}getBounds(t={}){const e=function(t,e=0){const{width:n,height:i,unproject:r}=t,o={targetZ:e},s=r([0,i],o),a=r([n,i],o);let l,c;return(t.fovy?.5*t.fovy*ni:Math.atan(.5/t.altitude))>(90-t.pitch)*ni-.01?(l=ii(t,0,e),c=ii(t,n,e)):(l=r([0,0],o),c=r([n,0],o)),[s,a,c,l]}(this,t.z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(t,e={}){const{width:n,height:i}=this,{longitude:r,latitude:o,zoom:s}=function(t){const{width:e,height:n,bounds:i,minExtent:r=0,maxZoom:o=24,offset:s=[0,0]}=t,[[a,l],[c,u]]=i,h=function(t=0){return"number"==typeof t?{top:t,bottom:t,left:t,right:t}:(Dn(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}(t.padding),d=Xn([a,zn(u,-85.051129,Hn)]),f=Xn([c,zn(l,-85.051129,Hn)]),p=[Math.max(Math.abs(f[0]-d[0]),r),Math.max(Math.abs(f[1]-d[1]),r)],g=[e-h.left-h.right-2*Math.abs(s[0]),n-h.top-h.bottom-2*Math.abs(s[1])];Dn(g[0]>0&&g[1]>0);const m=g[0]/p[0],v=g[1]/p[1],y=(h.right-h.left)/2/m,_=(h.top-h.bottom)/2/v,b=Zn([(f[0]+d[0])/2+y,(f[1]+d[1])/2+_]),w=Math.min(o,Fn(Math.abs(Math.min(m,v))));return Dn(Number.isFinite(w)),{longitude:b[0],latitude:b[1],zoom:w}}({width:n,height:i,bounds:t,...e});return new oa({width:n,height:i,longitude:r,latitude:o,zoom:s})}}i(oa,"displayName","WebMercatorViewport");class sa{constructor(t){i(this,"_inProgress",void 0),i(this,"_handle",void 0),i(this,"_timeline",void 0),i(this,"time",void 0),i(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=t,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(t){var e,n;this.cancel(),this.settings=t,this._inProgress=!0,null===(e=(n=this.settings).onStart)||void 0===e||e.call(n,this)}end(){var t,e;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,null===(t=(e=this.settings).onEnd)||void 0===t||t.call(e,this))}cancel(){var t,e;this._inProgress&&(null===(t=(e=this.settings).onInterrupt)||void 0===t||t.call(e,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var t,e;if(!this._inProgress)return!1;if(null===this._handle){const{_timeline:t,settings:e}=this;this._handle=t.addChannel({delay:t.getTime(),duration:e.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),null===(t=(e=this.settings).onUpdate)||void 0===t||t.call(e,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const aa=()=>{},la=t=>t;class ca{constructor(t){i(this,"getControllerState",void 0),i(this,"props",void 0),i(this,"propsInTransition",void 0),i(this,"transition",void 0),i(this,"onViewStateChange",void 0),i(this,"onStateChange",void 0),i(this,"_onTransitionUpdate",(t=>{const{time:e,settings:{interpolator:n,startProps:i,endProps:r,duration:o,easing:s}}=t,a=s(e/o),l=n.interpolateProps(i,r,a);this.propsInTransition=this.getControllerState({...this.props,...l}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})})),this.getControllerState=t.getControllerState,this.propsInTransition=null,this.transition=new sa(t.timeline),this.onViewStateChange=t.onViewStateChange||aa,this.onStateChange=t.onStateChange||aa}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let e=!1;const n=this.props;if(this.props=t,!n||this._shouldIgnoreViewportChange(n,t))return!1;if(this._isTransitionEnabled(t)){let i=n;if(this.transition.inProgress){const{interruption:t,endProps:e}=this.transition.settings;i={...n,...2===t?e:this.propsInTransition||n}}this._triggerTransition(i,t),e=!0}else this.transition.cancel();return e}updateTransition(){this.transition.update()}_isTransitionEnabled(t){const{transitionDuration:e,transitionInterpolator:n}=t;return(e>0||"auto"===e)&&Boolean(n)}_isUpdateDueToCurrentTransition(t){return!(!this.transition.inProgress||!this.propsInTransition)&&this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition)}_shouldIgnoreViewportChange(t,e){return this.transition.inProgress?3===this.transition.settings.interruption||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e)}_triggerTransition(t,e){const n=this.getControllerState(t),i=this.getControllerState(e).shortestPathFrom(n),r=e.transitionInterpolator,o=r.getDuration?r.getDuration(t,e):e.transitionDuration;if(0===o)return;const s=r.initializeProps(t,i);this.propsInTransition={};const a={duration:o,easing:e.transitionEasing||la,interpolator:r,interruption:e.transitionInterruption||1,startProps:s.start,endProps:s.end,onStart:e.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(e.onTransitionInterrupt),onEnd:this._onTransitionEnd(e.onTransitionEnd)};this.transition.start(a),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return e=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),null==t||t(e)}}}class ua{constructor(t){i(this,"_propsToCompare",void 0),i(this,"_propsToExtract",void 0),i(this,"_requiredProps",void 0);const{compare:e,extract:n,required:r}=t;this._propsToCompare=e,this._propsToExtract=n||e,this._requiredProps=r}arePropsEqual(t,e){for(const n of this._propsToCompare)if(!(n in t)||!(n in e)||!De(t[n],e[n]))return!1;return!0}initializeProps(t,e){const n={},i={};for(const r of this._propsToExtract)(r in t||r in e)&&(n[r]=t[r],i[r]=e[r]);return this._checkRequiredProps(n),this._checkRequiredProps(i),{start:n,end:i}}getDuration(t,e){return e.transitionDuration}_checkRequiredProps(t){this._requiredProps&&this._requiredProps.forEach((e=>{const n=t[e];ia(Number.isFinite(n)||Array.isArray(n),"".concat(e," is required for transition"))}))}}const ha=["longitude","latitude","zoom","bearing","pitch"],da=["longitude","latitude","zoom"];class fa extends ua{constructor(t={}){const e=Array.isArray(t)?t:t.transitionProps,n=Array.isArray(t)?{}:t;n.transitionProps=Array.isArray(e)?{compare:e,required:e}:e||{compare:ha,required:da},super(n.transitionProps),i(this,"opts",void 0),this.opts=n}initializeProps(t,e){const n=super.initializeProps(t,e),{makeViewport:i,around:r}=this.opts;if(i&&r){const o=i(t),s=i(e),a=o.unproject(r);n.start.around=r,Object.assign(n.end,{around:s.project(a),aroundPosition:a,width:e.width,height:e.height})}return n}interpolateProps(t,e,n){const i={};for(const r of this._propsToExtract)i[r]=Fe(t[r]||0,e[r]||0,n);if(e.aroundPosition&&this.opts.makeViewport){const r=this.opts.makeViewport({...e,...i});Object.assign(i,r.panByPosition(e.aroundPosition,Fe(t.around,e.around,n)))}return i}}const pa={transitionDuration:0},ga=t=>1-(1-t)*(1-t),ma=["wheel"],va=["panstart","panmove","panend"],ya=["pinchstart","pinchmove","pinchend"],_a=["tripanstart","tripanmove","tripanend"],ba=["doubletap"],wa=["keydown"],xa={};class Ea{constructor(t){i(this,"props",void 0),i(this,"state",{}),i(this,"transitionManager",void 0),i(this,"eventManager",void 0),i(this,"onViewStateChange",void 0),i(this,"onStateChange",void 0),i(this,"makeViewport",void 0),i(this,"_controllerState",void 0),i(this,"_events",{}),i(this,"_interactionState",{isDragging:!1}),i(this,"_customEvents",[]),i(this,"_eventStartBlocked",null),i(this,"_panMove",!1),i(this,"invertPan",!1),i(this,"dragMode","rotate"),i(this,"inertia",0),i(this,"scrollZoom",!0),i(this,"dragPan",!0),i(this,"dragRotate",!0),i(this,"doubleClickZoom",!0),i(this,"touchZoom",!0),i(this,"touchRotate",!1),i(this,"keyboard",!0),this.transitionManager=new ca({...t,getControllerState:t=>new this.ControllerState(t),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=t.eventManager,this.onViewStateChange=t.onViewStateChange||(()=>{}),this.onStateChange=t.onStateChange||(()=>{}),this.makeViewport=t.makeViewport}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events){var t;this._events[e]&&(null===(t=this.eventManager)||void 0===t||t.off(e,this.handleEvent))}this.transitionManager.finalize()}handleEvent(t){this._controllerState=void 0;const e=this._eventStartBlocked;switch(t.type){case"panstart":return!e&&this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return!e&&this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return!e&&this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(t){const{x:e,y:n}=this.props,{offsetCenter:i}=t;return[i.x-e,i.y-n]}isPointInBounds(t,e){const{width:n,height:i}=this.props;if(e&&e.handled)return!1;const r=t[0]>=0&&t[0]<=n&&t[1]>=0&&t[1]<=i;return r&&e&&e.stopPropagation(),r}isFunctionKeyPressed(t){const{srcEvent:e}=t;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(t){const e=setTimeout((()=>{this._eventStartBlocked===e&&(this._eventStartBlocked=null)}),t);this._eventStartBlocked=e}setProps(t){t.dragMode&&(this.dragMode=t.dragMode),this.props=t,"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);const{inertia:e}=t;this.inertia=Number.isFinite(e)?e:!0===e?300:0;const{scrollZoom:n=!0,dragPan:i=!0,dragRotate:r=!0,doubleClickZoom:o=!0,touchZoom:s=!0,touchRotate:a=!1,keyboard:l=!0}=t,c=Boolean(this.onViewStateChange);this.toggleEvents(ma,c&&n),this.toggleEvents(va,c&&(i||r)),this.toggleEvents(ya,c&&(s||a)),this.toggleEvents(_a,c&&a),this.toggleEvents(ba,c&&o),this.toggleEvents(wa,c&&l),this.scrollZoom=n,this.dragPan=i,this.dragRotate=r,this.doubleClickZoom=o,this.touchZoom=s,this.touchRotate=a,this.keyboard=l}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,e){this.eventManager&&t.forEach((t=>{this._events[t]!==e&&(this._events[t]=e,e?this.eventManager.on(t,this.handleEvent):this.eventManager.off(t,this.handleEvent))}))}updateViewport(t,e=null,n={}){const i={...t.getViewportProps(),...e},r=this.controllerState!==t;if(this.state=t.getState(),this._setInteractionState(n),r){const t=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:t})}}_onTransition(t){this.onViewStateChange({...t,interactionState:this._interactionState})}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange(this._interactionState)}_onPanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;let n=this.isFunctionKeyPressed(t)||t.rightButton||!1;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const i=this.controllerState[n?"panStart":"rotateStart"]({pos:e});return this._panMove=n,this.updateViewport(i,pa,{isDragging:!0}),!0}_onPan(t){return!!this.isDragging()&&(this._panMove?this._onPanMove(t):this._onPanRotate(t))}_onPanEnd(t){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t))}_onPanMove(t){if(!this.dragPan)return!1;const e=this.getCenter(t),n=this.controllerState.pan({pos:e});return this.updateViewport(n,pa,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){const{inertia:e}=this;if(this.dragPan&&e&&t.velocity){const n=this.getCenter(t),i=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],r=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:ga},{isDragging:!1,isPanning:!0})}else{const t=this.controllerState.panEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;const e=this.getCenter(t),n=this.controllerState.rotate({pos:e});return this.updateViewport(n,pa,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){const{inertia:e}=this;if(this.dragRotate&&e&&t.velocity){const n=this.getCenter(t),i=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],r=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:ga},{isDragging:!1,isRotating:!0})}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;t.srcEvent.preventDefault();const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const{speed:n=.01,smooth:i=!1}=!0===this.scrollZoom?{}:this.scrollZoom,{delta:r}=t;let o=2/(1+Math.exp(-Math.abs(r*n)));r<0&&0!==o&&(o=1/o);const s=this.controllerState.zoom({pos:e,scale:o});return this.updateViewport(s,{...this._getTransitionProps({around:e}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.rotateStart({pos:e});return this.updateViewport(n,pa,{isDragging:!0}),!0}_onTriplePan(t){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const e=this.getCenter(t);e[0]-=t.deltaX;const n=this.controllerState.rotate({pos:e});return this.updateViewport(n,pa,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this;if(this.touchRotate&&e&&t.velocityY){const n=this.getCenter(t),i=[n[0],n[1]+=t.velocityY*e/2],r=this.controllerState.rotate({pos:i});this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:ga},{isDragging:!1,isRotating:!0}),this.blockEvents(e)}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return xa._startPinchRotation=t.rotation,xa._lastPinchEvent=t,this.updateViewport(n,pa,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let e=this.controllerState;if(this.touchZoom){const{scale:n}=t,i=this.getCenter(t);e=e.zoom({pos:i,scale:n})}if(this.touchRotate){const{rotation:n}=t;e=e.rotate({deltaAngleX:xa._startPinchRotation-n})}return this.updateViewport(e,pa,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),xa._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this,{_lastPinchEvent:n}=xa;if(this.touchZoom&&e&&n&&t.scale!==n.scale){const i=this.getCenter(t);let r=this.controllerState.rotateEnd();const o=Math.log2(t.scale),s=(o-Math.log2(n.scale))/(t.deltaTime-n.deltaTime),a=Math.pow(2,o+s*e/2);r=r.zoom({pos:i,scale:a}).zoomEnd(),this.updateViewport(r,{...this._getTransitionProps({around:i}),transitionDuration:e,transitionEasing:ga},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(e)}else{const t=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return xa._startPinchRotation=null,xa._lastPinchEvent=null,!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.isFunctionKeyPressed(t),i=this.controllerState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(i,this._getTransitionProps({around:e}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;const e=this.isFunctionKeyPressed(t),{zoomSpeed:n,moveSpeed:i,rotateSpeedX:r,rotateSpeedY:o}=!0===this.keyboard?{}:this.keyboard,{controllerState:s}=this;let a;const l={};switch(t.srcEvent.code){case"Minus":a=e?s.zoomOut(n).zoomOut(n):s.zoomOut(n),l.isZooming=!0;break;case"Equal":a=e?s.zoomIn(n).zoomIn(n):s.zoomIn(n),l.isZooming=!0;break;case"ArrowLeft":e?(a=s.rotateLeft(r),l.isRotating=!0):(a=s.moveLeft(i),l.isPanning=!0);break;case"ArrowRight":e?(a=s.rotateRight(r),l.isRotating=!0):(a=s.moveRight(i),l.isPanning=!0);break;case"ArrowUp":e?(a=s.rotateUp(o),l.isRotating=!0):(a=s.moveUp(i),l.isPanning=!0);break;case"ArrowDown":e?(a=s.rotateDown(o),l.isRotating=!0):(a=s.moveDown(i),l.isPanning=!0);break;default:return!1}return this.updateViewport(a,this._getTransitionProps(),l),!0}_getTransitionProps(t){const{transition:e}=this;return e&&e.transitionInterpolator?t?{...e,transitionInterpolator:new fa({...t,...e.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:e:pa}}class Sa{constructor(t,e){i(this,"_viewportProps",void 0),i(this,"_state",void 0),this._viewportProps=this.applyConstraints(t),this._state=e}getViewportProps(){return this._viewportProps}getState(){return this._state}}class Pa extends Sa{constructor(t){const{width:e,height:n,latitude:r,longitude:o,zoom:s,bearing:a=0,pitch:l=0,altitude:c=1.5,position:u=[0,0,0],maxZoom:h=20,minZoom:d=0,maxPitch:f=60,minPitch:p=0,startPanLngLat:g,startZoomLngLat:m,startRotatePos:v,startBearing:y,startPitch:_,startZoom:b,normalize:w=!0}=t;ia(Number.isFinite(o)),ia(Number.isFinite(r)),ia(Number.isFinite(s)),super({width:e,height:n,latitude:r,longitude:o,zoom:s,bearing:a,pitch:l,altitude:c,maxZoom:h,minZoom:d,maxPitch:f,minPitch:p,normalize:w,position:u},{startPanLngLat:g,startZoomLngLat:m,startRotatePos:v,startBearing:y,startPitch:_,startZoom:b}),i(this,"makeViewport",void 0),this.makeViewport=t.makeViewport}panStart({pos:t}){return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan({pos:t,startPos:e}){const n=this.getState().startPanLngLat||this._unproject(e);if(!n)return this;const i=this.makeViewport(this.getViewportProps()).panByPosition(n,t);return this._getUpdatedState(i)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:i,startBearing:r,startPitch:o}=this.getState();if(!i||void 0===r||void 0===o)return this;let s;return s=t?this._getNewRotation(t,i,o,r):{bearing:r+e,pitch:o+n},this._getUpdatedState(s)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:t}){return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom({pos:t,startPos:e,scale:n}){let{startZoom:i,startZoomLngLat:r}=this.getState();if(r||(i=this.getViewportProps().zoom,r=this._unproject(e)||this._unproject(t)),!r)return this;const{maxZoom:o,minZoom:s}=this.getViewportProps();let a=i+Math.log2(n);a=ze(a,s,o);const l=this.makeViewport({...this.getViewportProps(),zoom:a});return this._getUpdatedState({zoom:a,...l.panByPosition(r,t)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(t=2){return this._zoomFromCenter(t)}zoomOut(t=2){return this._zoomFromCenter(1/t)}moveLeft(t=100){return this._panFromCenter([t,0])}moveRight(t=100){return this._panFromCenter([-t,0])}moveUp(t=100){return this._panFromCenter([0,t])}moveDown(t=100){return this._panFromCenter([0,-t])}rotateLeft(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-t})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this.getViewportProps()},{bearing:i,longitude:r}=n;return Math.abs(i-e.bearing)>180&&(n.bearing=i<0?i+360:i-360),Math.abs(r-e.longitude)>180&&(n.longitude=r<0?r+360:r-360),n}applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:i}=t;t.zoom=ze(i,n,e);const{maxPitch:r,minPitch:o,pitch:s}=t;t.pitch=ze(s,o,r);const{normalize:a=!0}=t;return a&&Object.assign(t,function(t){const{width:e,height:n,pitch:i=0}=t;let{longitude:r,latitude:o,zoom:s,bearing:a=0}=t;(r<-180||r>180)&&(r=Nn(r+180,360)-180),(a<-180||a>180)&&(a=Nn(a+180,360)-180);const l=Fn(n/512);if(s<=l)s=l,o=0;else{const t=n/2/Math.pow(2,s),e=Zn([0,t])[1];if(o<e)o=e;else{const e=Zn([0,512-t])[1];o>e&&(o=e)}}return{width:e,height:n,longitude:r,latitude:o,zoom:s,pitch:i,bearing:a}}(t)),t}_zoomFromCenter(t){const{width:e,height:n}=this.getViewportProps();return this.zoom({pos:[e/2,n/2],scale:t})}_panFromCenter(t){const{width:e,height:n}=this.getViewportProps();return this.pan({startPos:[e/2,n/2],pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}_unproject(t){const e=this.makeViewport(this.getViewportProps());return t&&e.unproject(t)}_getNewRotation(t,e,n,i){const r=t[0]-e[0],o=t[1]-e[1],s=t[1],a=e[1],{width:l,height:c}=this.getViewportProps(),u=r/l;let h=0;o>0?Math.abs(c-a)>5&&(h=o/(a-c)*1.2):o<0&&a>5&&(h=1-s/a),h=ze(h,-1,1);const{minPitch:d,maxPitch:f}=this.getViewportProps();let p=n;return h>0?p=n+h*(f-n):h<0&&(p=n-h*(d-n)),{pitch:p,bearing:i+180*u}}}class Ta extends Ea{constructor(...t){super(...t),i(this,"ControllerState",Pa),i(this,"transition",{transitionDuration:300,transitionInterpolator:new fa({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),i(this,"dragMode","pan")}setProps(t){t.position=t.position||[0,0,0];const e=this.props;super.setProps(t),(!e||e.height!==t.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...t,...this.state}))}}class Ca extends ra{get ViewportType(){return oa}get ControllerType(){return Ta}}i(Ca,"displayName","MapView");const Aa=[255,255,255],Ma=1;let La=0;class ka{constructor(t={}){i(this,"id",void 0),i(this,"color",void 0),i(this,"intensity",void 0),i(this,"type","ambient");const{color:e=Aa}=t,{intensity:n=Ma}=t;this.id=t.id||"ambient-".concat(La++),this.color=e,this.intensity=n}}const Oa=[255,255,255],Ia=1,Ra=[0,0,-1];let Na=0;class za{constructor(t={}){i(this,"id",void 0),i(this,"color",void 0),i(this,"intensity",void 0),i(this,"type","directional"),i(this,"direction",void 0),i(this,"shadow",void 0);const{color:e=Oa}=t,{intensity:n=Ia}=t,{direction:r=Ra}=t,{_shadow:o=!1}=t;this.id=t.id||"directional-".concat(Na++),this.color=e,this.intensity=n,this.type="directional",this.direction=new an(r).normalize().toArray(),this.shadow=o}getProjectedLight(t){return this}}class Fa{constructor(t,e={id:"pass"}){i(this,"id",void 0),i(this,"gl",void 0),i(this,"props",void 0);const{id:n}=e;this.id=n,this.gl=t,this.props={...e}}setProps(t){Object.assign(this.props,t)}render(t){}cleanup(){}}class Da extends Fa{constructor(...t){super(...t),i(this,"_lastRenderIndex",-1)}render(t){return Fr(this.gl,{framebuffer:t.target}),this._drawLayers(t)}_drawLayers(t){const{target:e,moduleParameters:n,viewports:i,views:r,onViewportActive:o,clearStack:s=!0,clearCanvas:a=!0}=t;t.pass=t.pass||"unknown";const l=this.gl;a&&function(t,e){Fr(t,{viewport:[0,0,e?e.width:t.drawingBufferWidth,e?e.height:t.drawingBufferHeight]}),t.clear(16640)}(l,e),s&&(this._lastRenderIndex=-1);const c=[];for(const s of i){const i=r&&r[s.id];null==o||o(s);const a=this._getDrawLayerParams(s,t),u=s.subViewports||[s];for(const r of u){const o=this._drawLayersInViewport(l,{target:e,moduleParameters:n,viewport:r,view:i,pass:t.pass,layers:t.layers},a);c.push(o)}}return c}_getDrawLayerParams(t,{layers:e,pass:n,isPicking:i=!1,layerFilter:r,cullRect:o,effects:s,moduleParameters:a},l=!1){const c=[],u=ja(this._lastRenderIndex+1),h={layer:e[0],viewport:t,isPicking:i,renderPass:n,cullRect:o},d={};for(let i=0;i<e.length;i++){const o=e[i],f=this._shouldDrawLayer(o,h,r,d),p={shouldDrawLayer:f};f&&!l&&(p.layerRenderIndex=u(o,f),p.moduleParameters=this._getModuleParameters(o,s,n,a),p.layerParameters=this.getLayerParameters(o,i,t)),c[i]=p}return c}_drawLayersInViewport(t,{layers:e,moduleParameters:n,pass:i,target:r,viewport:o,view:s},a){const l=function(t,{moduleParameters:e,target:n,viewport:i}){const r=n&&"default-framebuffer"!==n.id,o=e&&e.devicePixelRatio||jr(t),s=r?n.height:t.drawingBufferHeight,a=i;return[a.x*o,s-(a.y+a.height)*o,a.width*o,a.height*o]}(t,{moduleParameters:n,target:r,viewport:o});if(s&&s.props.clear){const e=!0===s.props.clear?{color:!0,depth:!0}:s.props.clear;Dr(t,{scissorTest:!0,scissor:l},(()=>ko(t,e)))}const c={totalCount:e.length,visibleCount:0,compositeCount:0,pickableCount:0};Fr(t,{viewport:l});for(let t=0;t<e.length;t++){const n=e[t],{shouldDrawLayer:r,layerRenderIndex:s,moduleParameters:l,layerParameters:u}=a[t];if(r&&n.props.pickable&&c.pickableCount++,n.isComposite)c.compositeCount++;else if(r){c.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,s),l.viewport=o;try{n._drawLayer({moduleParameters:l,uniforms:{layerIndex:s},parameters:u})}catch(t){n.raiseError(t,"drawing ".concat(n," to ").concat(i))}}}return c}shouldDrawLayer(t){return!0}getModuleParameters(t,e){return null}getLayerParameters(t,e,n){return t.props.parameters}_shouldDrawLayer(t,e,n,i){if(!t.props.visible||!this.shouldDrawLayer(t))return!1;e.layer=t;let r=t.parent;for(;r;){if(!r.props.visible||!r.filterSubLayer(e))return!1;e.layer=r,r=r.parent}if(n){const t=e.layer.id;if(t in i||(i[t]=n(e)),!i[t])return!1}return t.activateViewport(e.viewport),!0}_getModuleParameters(t,e,n,i){var r;const o=Object.assign(Object.create((null===(r=t.internalState)||void 0===r?void 0:r.propsInTransition)||t.props),{autoWrapLongitude:t.wrapLongitude,viewport:t.context.viewport,mousePosition:t.context.mousePosition,pickingActive:0,devicePixelRatio:jr(this.gl)});if(e)for(const n of e){var s;Object.assign(o,null===(s=n.getModuleParameters)||void 0===s?void 0:s.call(n,t))}return Object.assign(o,this.getModuleParameters(t,e),i)}}function ja(t=0,e={}){const n={},i=(r,o)=>{const s=r.props._offset,a=r.id,l=r.parent&&r.parent.id;let c;if(l&&!(l in e)&&i(r.parent,!1),l in n){const t=n[l]=n[l]||ja(e[l],e);c=t(r,o),n[a]=t}else Number.isFinite(s)?(c=s+(e[l]||0),n[a]=null):c=t;return o&&c>=t&&(t=c+1),e[a]=c,c};return i}class Ba extends Da{constructor(t,e){super(t,e),i(this,"shadowMap",void 0),i(this,"depthBuffer",void 0),i(this,"fbo",void 0),this.shadowMap=new Po(t,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Ao(t,{format:33189,width:1,height:1}),this.fbo=new qo(t,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(t){const e=this.fbo;Dr(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},(()=>{const n=t.viewports[0],i=jr(this.gl),r=n.width*i,o=n.height*i;r===e.width&&o===e.height||e.resize({width:r,height:o}),super.render({...t,target:e,pass:"shadow"})}))}shouldDrawLayer(t){return!1!==t.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const Ua=Ds((function({viewport:t,center:e}){return new Ln(t.viewProjectionMatrix).invert().transform(e)})),Va=Ds((function({viewport:t,shadowMatrices:e}){const n=[],i=t.pixelUnprojectionMatrix,r=t.isGeospatial?void 0:1,o=[[0,0,r],[t.width,0,r],[0,t.height,r],[t.width,t.height,r],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map((t=>function(t,e){const[n,i,r]=t,o=ei([n,i,r],e);return Number.isFinite(r)?o:[o[0],o[1],0]}(t,i)));for(const i of e){const e=i.clone().translate(new an(t.center).negate()),r=o.map((t=>e.transform(t))),s=(new Ln).ortho({left:Math.min(...r.map((t=>t[0]))),right:Math.max(...r.map((t=>t[0]))),bottom:Math.min(...r.map((t=>t[1]))),top:Math.max(...r.map((t=>t[1]))),near:Math.min(...r.map((t=>-t[2]))),far:Math.max(...r.map((t=>-t[2])))});n.push(s.multiplyRight(i))}return n})),Wa=[0,0,0,1],Ga=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Ha={name:"shadow",dependencies:[Xs],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?function(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const i={shadow_uDrawShadowMap:Boolean(t.drawToShadowMap),shadow_uUseShadowMap:!!t.shadowMaps&&t.shadowMaps.length>0,shadow_uColor:t.shadowColor||Wa,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},r=Ua({viewport:t.viewport,center:e.project_uCenter}),o=[],s=Va({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let n=0;n<t.shadowMatrices.length;n++){const i=s[n],a=i.clone().translate(new an(t.viewport.center).negate());e.project_uCoordinateSystem===ri.LNGLAT&&e.project_uProjectionMode===oi.WEB_MERCATOR?(s[n]=a,o[n]=r):(s[n]=i.clone().multiplyRight(Ga),o[n]=a.transform(r))}for(let e=0;e<s.length;e++)i["shadow_uViewProjectionMatrices[".concat(e,"]")]=s[e],i["shadow_uProjectCenters[".concat(e,"]")]=o[e],t.shadowMaps&&t.shadowMaps.length>0?i["shadow_uShadowMap".concat(e)]=t.shadowMaps[e]:i["shadow_uShadowMap".concat(e)]=t.dummyShadowMap;return i}(t,e):{}},qa={color:[255,255,255],intensity:1},Xa=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],Za=[0,0,0,200/255];class Ya{constructor(t={}){i(this,"id","lighting-effect"),i(this,"props",void 0),i(this,"shadowColor",Za),i(this,"shadow",void 0),i(this,"ambientLight",void 0),i(this,"directionalLights",void 0),i(this,"pointLights",void 0),i(this,"shadowPasses",[]),i(this,"shadowMaps",[]),i(this,"dummyShadowMap",null),i(this,"programManager",void 0),i(this,"shadowMatrices",void 0),this.setProps(t)}setProps(t){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const e in t){const n=t[e];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some((t=>t.shadow)),this.props=t}preRender(t,{layers:e,layerFilter:n,viewports:i,onViewportActive:r,views:o}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),0===this.shadowPasses.length&&this._createShadowPasses(t),this.programManager||(this.programManager=Ls.getDefaultProgramManager(t),Ha&&this.programManager.addDefaultModule(Ha)),this.dummyShadowMap||(this.dummyShadowMap=new Po(t,{width:1,height:1}));for(let t=0;t<this.shadowPasses.length;t++)this.shadowPasses[t].render({layers:e,layerFilter:n,viewports:i,onViewportActive:r,views:o,moduleParameters:{shadowLightId:t,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(t){const e=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return e.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map((e=>e.getProjectedLight({layer:t}))),pointLights:this.pointLights.map((e=>e.getProjectedLight({layer:t})))},e}cleanup(){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(Ha),this.programManager=null)}_calculateMatrices(){const t=[];for(const e of this.directionalLights){const n=(new Ln).lookAt({eye:new an(e.direction).negate()});t.push(n)}return t}_createShadowPasses(t){for(let e=0;e<this.directionalLights.length;e++){const n=new Ba(t);this.shadowPasses[e]=n,this.shadowMaps[e]=n.shadowMap}}_applyDefaultLights(){const{ambientLight:t,pointLights:e,directionalLights:n}=this;t||0!==e.length||0!==n.length||(this.ambientLight=new ka(qa),this.directionalLights.push(new za(Xa[0]),new za(Xa[1])))}}const Ka=new Ya;class Qa{constructor(){i(this,"effects",void 0),i(this,"_resolvedEffects",[]),i(this,"_defaultEffects",[]),i(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(t){const e=this._defaultEffects;if(!e.find((e=>e.id===t.id))){const n=e.findIndex((e=>{return n=t,(null!==(i=e.order)&&void 0!==i?i:1/0)-(null!==(r=n.order)&&void 0!==r?r:1/0)>0;var n,i,r}));n<0?e.push(t):e.splice(n,0,t),this._setEffects(this.effects)}}setProps(t){"effects"in t&&($s(t.effects,this.effects,1)||this._setEffects(t.effects))}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}getEffects(){return this._resolvedEffects}_setEffects(t){const e={};for(const t of this.effects)e[t.id]=t;const n=[];for(const i of t){const t=e[i.id];t&&t!==i?t.setProps?(t.setProps(i.props),n.push(t)):(t.cleanup(),n.push(i)):n.push(i),delete e[i.id]}for(const t in e)e[t].cleanup();this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),t.some((t=>t instanceof Ya))||this._resolvedEffects.push(Ka),this._needsRedraw="effects changed"}finalize(){for(const t of this._resolvedEffects)t.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class $a extends Da{shouldDrawLayer(t){const{operation:e}=t.props;return e.includes("draw")||e.includes("terrain")}}const Ja={blendFunc:[1,0,32771,0],blendEquation:32774};class tl extends Da{constructor(...t){super(...t),i(this,"pickZ",void 0),i(this,"_colorEncoderState",null)}render(t){return"pickingFBO"in t?this._drawPickingBuffer(t):super.render(t)}_drawPickingBuffer({layers:t,layerFilter:e,views:n,viewports:i,onViewportActive:r,pickingFBO:o,deviceRect:{x:s,y:a,width:l,height:c},cullRect:u,effects:h,pass:d="picking",pickZ:f,moduleParameters:p}){const g=this.gl;this.pickZ=f;const m=this._resetColorEncoder(f),v=Dr(g,{scissorTest:!0,scissor:[s,a,l,c],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...Ja,blend:!f},(()=>super.render({target:o,layers:t,layerFilter:e,views:n,viewports:i,onViewportActive:r,cullRect:u,effects:null==h?void 0:h.filter((t=>t.useInPicking)),pass:d,isPicking:!0,moduleParameters:p})));return this._colorEncoderState=null,{decodePickingColor:m&&el.bind(null,m),stats:v}}shouldDrawLayer(t){const{pickable:e,operation:n}=t.props;return e&&n.includes("draw")||n.includes("terrain")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(t,e,n){const i={...t.props.parameters},{pickable:r,operation:o}=t.props;return this._colorEncoderState?r&&o.includes("draw")&&(Object.assign(i,Ja),i.blend=!0,i.blendColor=function(t,e,n){const{byLayer:i,byAlpha:r}=t;let o,s=i.get(e);return s?(s.viewports.push(n),o=s.a):(o=i.size+1,o<=255?(s={a:o,layer:e,viewports:[n]},i.set(e,s),r[o]=s):(R.warn("Too many pickable layers, only picking the first 255")(),o=0)),[0,0,0,o/255]}(this._colorEncoderState,t,n)):i.blend=!1,o.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(t){return this._colorEncoderState=t?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function el(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}class nl{constructor(t){i(this,"gl",void 0),i(this,"layerFilter",void 0),i(this,"drawPickingColors",void 0),i(this,"drawLayersPass",void 0),i(this,"pickLayersPass",void 0),i(this,"renderCount",void 0),i(this,"_needsRedraw",void 0),i(this,"renderBuffers",void 0),i(this,"lastPostProcessEffect",void 0),this.gl=t,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new $a(t),this.pickLayersPass=new tl(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(t){this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(t){const e=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...t,target:t.target||qo.getDefaultFramebuffer(this.gl)};n.effects&&this._preRender(n.effects,n);const i=this.lastPostProcessEffect?this.renderBuffers[0]:n.target,r=e.render({...n,target:i});n.effects&&this._postRender(n.effects,n),this.renderCount++,F("deckRenderer.renderLayers",this,r,t)}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}finalize(){const{renderBuffers:t}=this;for(const e of t)e.delete();t.length=0}_preRender(t,e){this.lastPostProcessEffect=null,e.preRenderStats=e.preRenderStats||{};for(const n of t)e.preRenderStats[n.id]=n.preRender(this.gl,e),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:t}=this;0===t.length&&t.push(new qo(this.gl),new qo(this.gl));for(const e of t)e.resize()}_postRender(t,e){const{renderBuffers:n}=this,i={...e,inputBuffer:n[0],swapBuffer:n[1],target:null};for(const r of t)if(r.postRender){if(r.id===this.lastPostProcessEffect){i.target=e.target,r.postRender(this.gl,i);break}const t=r.postRender(this.gl,i);i.inputBuffer=t,i.swapBuffer=t===n[0]?n[1]:n[0]}}}const il={pickedColor:null,pickedObjectIndex:-1};function rl({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:i,deviceRadius:r,deviceRect:o}){const{x:s,y:a,width:l,height:c}=o;let u=r*r,h=-1,d=0;for(let e=0;e<c;e++){const r=e+a-i,o=r*r;if(o>u)d+=4*l;else for(let e=0;e<l;e++){if(t[d+3]-1>=0){const t=e+s-n,i=t*t+o;i<=u&&(u=i,h=d)}d+=4}}if(h>=0){const n=t.slice(h,h+4),i=e(n);if(i){const t=Math.floor(h/4/l),e=h/4-t*l;return{...i,pickedColor:n,pickedX:s+e,pickedY:a+t}}R.error("Picked non-existent layer. Is picking buffer corrupt?")()}return il}function ol({pickInfo:t,viewports:e,pixelRatio:n,x:i,y:r,z:o}){let s,a=e[0];if(e.length>1&&(a=function(t,e){for(let n=t.length-1;n>=0;n--){const i=t[n];if(i.containsPixel(e))return i}return t[0]}((null==t?void 0:t.pickedViewports)||e,{x:i,y:r})),a){const t=[i-a.x,r-a.y];void 0!==o&&(t[2]=o),s=a.unproject(t)}return{color:null,layer:null,viewport:a,index:-1,picked:!1,x:i,y:r,pixel:[i,r],coordinate:s,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function sl(t){const{pickInfo:e,lastPickedInfo:n,mode:i,layers:r}=t,{pickedColor:o,pickedLayer:s,pickedObjectIndex:a}=e,l=s?[s]:[];if("hover"===i){const t=n.index,e=n.layerId,i=s?s.props.id:null;if(i!==e||a!==t){if(i!==e){const t=r.find((t=>t.props.id===e));t&&l.unshift(t)}n.layerId=i,n.index=a,n.info=null}}const c=ol(t),u=new Map;return u.set(null,c),l.forEach((t=>{let e={...c};t===s&&(e.color=o,e.index=a,e.picked=!0),e=al({layer:t,info:e,mode:i});const r=e.layer;t===s&&"hover"===i&&(n.info=e),u.set(r.id,e),"hover"===i&&r.updateAutoHighlight(e)})),u}function al({layer:t,info:e,mode:n}){for(;t&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:i}),t=t.parent}return e}class ll{constructor(t){i(this,"gl",void 0),i(this,"pickingFBO",void 0),i(this,"depthFBO",void 0),i(this,"pickLayersPass",void 0),i(this,"layerFilter",void 0),i(this,"lastPickedInfo",void 0),i(this,"_pickable",!0),this.gl=t,this.pickLayersPass=new tl(t),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(t){return this._pickClosestObject(t)}pickObjects(t){return this._pickVisibleObjects(t)}getLastPickedObject({x:t,y:e,layers:n,viewports:i},r=this.lastPickedInfo.info){const o=r&&r.layer&&r.layer.id,s=r&&r.viewport&&r.viewport.id,a=o?n.find((t=>t.id===o)):null,l=s&&i.find((t=>t.id===s))||i[0],c=l&&l.unproject([t-l.x,e-l.y]),u={x:t,y:e,viewport:l,coordinate:c,layer:a};return{...r,...u}}_resizeBuffer(){var t,e;const{gl:n}=this;if(!this.pickingFBO&&(this.pickingFBO=new qo(n),qo.isSupported(n,{colorBufferFloat:!0}))){const t=new qo(n);t.attach({36064:new Po(n,{format:rr(n)?34836:6408,type:5126})}),this.depthFBO=t}null===(t=this.pickingFBO)||void 0===t||t.resize({width:n.canvas.width,height:n.canvas.height}),null===(e=this.depthFBO)||void 0===e||e.resize({width:n.canvas.width,height:n.canvas.height})}_getPickable(t){if(!1===this._pickable)return null;const e=t.filter((t=>this.pickLayersPass.shouldDrawLayer(t)&&!t.isComposite));return e.length?e:null}_pickClosestObject({layers:t,views:e,viewports:n,x:i,y:r,radius:o=0,depth:s=1,mode:a="query",unproject3D:l,onViewportActive:c,effects:u}){const h=this._getPickable(t),d=jr(this.gl);if(!h)return{result:[],emptyInfo:ol({viewports:n,x:i,y:r,pixelRatio:d})};this._resizeBuffer();const f=Br(this.gl,[i,r],!0),p=[f.x+Math.floor(f.width/2),f.y+Math.floor(f.height/2)],g=Math.round(o*d),{width:m,height:v}=this.pickingFBO,y=this._getPickingRect({deviceX:p[0],deviceY:p[1],deviceRadius:g,deviceWidth:m,deviceHeight:v}),_={x:i-o,y:r-o,width:2*o+1,height:2*o+1};let b;const w=[],x=new Set;for(let t=0;t<s;t++){let o,f;if(o=y?rl({...this._drawAndSample({layers:h,views:e,viewports:n,onViewportActive:c,deviceRect:y,cullRect:_,effects:u,pass:"picking:".concat(a)}),deviceX:p[0],deviceY:p[1],deviceRadius:g,deviceRect:y}):{pickedColor:null,pickedObjectIndex:-1},o.pickedLayer&&l&&this.depthFBO){const{pickedColors:t}=this._drawAndSample({layers:[o.pickedLayer],views:e,viewports:n,onViewportActive:c,deviceRect:{x:o.pickedX,y:o.pickedY,width:1,height:1},cullRect:_,effects:u,pass:"picking:".concat(a,":z")},!0);t[3]&&(f=t[0])}o.pickedLayer&&t+1<s&&(x.add(o.pickedLayer),o.pickedLayer.disablePickingIndex(o.pickedObjectIndex)),b=sl({pickInfo:o,lastPickedInfo:this.lastPickedInfo,mode:a,layers:h,viewports:n,x:i,y:r,z:f,pixelRatio:d});for(const t of b.values())t.layer&&w.push(t);if(!o.pickedColor)break}for(const t of x)t.restorePickingColors();return{result:w,emptyInfo:b.get(null)}}_pickVisibleObjects({layers:t,views:e,viewports:n,x:i,y:r,width:o=1,height:s=1,mode:a="query",maxObjects:l=null,onViewportActive:c,effects:u}){const h=this._getPickable(t);if(!h)return[];this._resizeBuffer();const d=jr(this.gl),f=Br(this.gl,[i,r],!0),p=f.x,g=f.y+f.height,m=Br(this.gl,[i+o,r+s],!0),v=m.x+m.width,y=m.y,_={x:p,y,width:v-p,height:g-y},b=function({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t)for(let i=0;i<t.length;i+=4)if(t[i+3]-1>=0){const r=t.slice(i,i+4),o=r.join(",");if(!n.has(o)){const t=e(r);t?n.set(o,{...t,color:r}):R.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Array.from(n.values())}(this._drawAndSample({layers:h,views:e,viewports:n,onViewportActive:c,deviceRect:_,cullRect:{x:i,y:r,width:o,height:s},effects:u,pass:"picking:".concat(a)})),w=new Map,x=Number.isFinite(l);for(let t=0;t<b.length&&!(x&&l&&w.size>=l);t++){const e=b[t];let n={color:e.pickedColor,layer:null,index:e.pickedObjectIndex,picked:!0,x:i,y:r,pixelRatio:d};n=al({layer:e.pickedLayer,info:n,mode:a}),w.has(n.object)||w.set(n.object,n)}return Array.from(w.values())}_drawAndSample({layers:t,views:e,viewports:n,onViewportActive:i,deviceRect:r,cullRect:o,effects:s,pass:a},l=!1){const c=l?this.depthFBO:this.pickingFBO,u={layers:t,layerFilter:this.layerFilter,views:e,viewports:n,onViewportActive:i,pickingFBO:c,deviceRect:r,cullRect:o,effects:s,pass:a,pickZ:l,preRenderStats:{}};for(const t of s)t.useInPicking&&(u.preRenderStats[t.id]=t.preRender(this.gl,u));const{decodePickingColor:h}=this.pickLayersPass.render(u),{x:d,y:f,width:p,height:g}=r,m=new(l?Float32Array:Uint8Array)(p*g*4);return zo(c,{sourceX:d,sourceY:f,sourceWidth:p,sourceHeight:g,target:m}),{pickedColors:m,decodePickingColor:h}}_getPickingRect({deviceX:t,deviceY:e,deviceRadius:n,deviceWidth:i,deviceHeight:r}){const o=Math.max(0,t-n),s=Math.max(0,e-n),a=Math.min(i,t+n+1)-o,l=Math.min(r,e+n+1)-s;return a<=0||l<=0?null:{x:o,y:s,width:a,height:l}}}const cl={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class ul{constructor(t){i(this,"el",null),i(this,"isVisible",!1);const e=t.parentElement;e&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,cl),e.appendChild(this.el))}setTooltip(t,e,n){const i=this.el;if(i){if("string"==typeof t)i.innerText=t;else{if(!t)return this.isVisible=!1,void(i.style.display="none");t.text&&(i.innerText=t.text),t.html&&(i.innerHTML=t.html),t.className&&(i.className=t.className)}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(e,"px, ").concat(n,"px)"),t&&"object"==typeof t&&"style"in t&&Object.assign(i.style,t.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}const{_parseImageNode:hl}=globalThis,dl="undefined"!=typeof Image,fl="undefined"!=typeof ImageBitmap,pl=Boolean(hl),gl=!!Rt||pl;function ml(t){const e=function(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&t instanceof Image?"image":t&&"object"==typeof t&&t.data&&t.width&&t.height?"data":null}(t);if(!e)throw new Error("Not an image");return e}const vl=/^data:image\/svg\+xml/,yl=/\.svg((\?|#).*)?$/;function _l(t){return t&&(vl.test(t)||yl.test(t))}function bl(t,e){if(_l(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function wl(t,e,n){const i=function(t,e){if(_l(e)){let e=(new TextDecoder).decode(t);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(e=unescape(encodeURIComponent(e)))}catch(t){throw new Error(t.message)}return"data:image/svg+xml;base64,".concat(btoa(e))}return bl(t,e)}(t,n),r=self.URL||self.webkitURL,o="string"!=typeof i&&r.createObjectURL(i);try{return await async function(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise(((e,i)=>{try{n.onload=()=>e(n),n.onerror=e=>i(new Error("Could not load image ".concat(t,": ").concat(e)))}catch(t){i(t)}}))}(o||i,e)}finally{o&&r.revokeObjectURL(o)}}const xl={};let El=!0;const Sl=!1,Pl=!0;function Tl(t){const e=Cl(t);return function(t){const e=Cl(t);return e.byteLength>=24&&2303741511===e.getUint32(0,Sl)?{mimeType:"image/png",width:e.getUint32(16,Sl),height:e.getUint32(20,Sl)}:null}(e)||function(t){const e=Cl(t);if(!(e.byteLength>=3&&65496===e.getUint16(0,Sl)&&255===e.getUint8(2)))return null;const{tableMarkers:n,sofMarkers:i}=function(){const t=new Set([65499,65476,65484,65501,65534]);for(let e=65504;e<65520;++e)t.add(e);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let r=2;for(;r+9<e.byteLength;){const t=e.getUint16(r,Sl);if(i.has(t))return{mimeType:"image/jpeg",height:e.getUint16(r+5,Sl),width:e.getUint16(r+7,Sl)};if(!n.has(t))return null;r+=2,r+=e.getUint16(r,Sl)}return null}(e)||function(t){const e=Cl(t);return e.byteLength>=10&&1195984440===e.getUint32(0,Sl)?{mimeType:"image/gif",width:e.getUint16(6,Pl),height:e.getUint16(8,Pl)}:null}(e)||function(t){const e=Cl(t);return e.byteLength>=14&&16973===e.getUint16(0,Sl)&&e.getUint32(2,Pl)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Pl),height:e.getUint32(22,Pl)}:null}(e)||function(t){const e=function(t){return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=(r=e,[...r].map((t=>t.charCodeAt(0))));var r;for(let e=0;e<i.length;++e)if(i[e]!==t[e+n])return!1;return!0}(t,"ftyp",4)?0==(96&t[8])?null:function(t){switch((e=t,String.fromCharCode(...e.slice(8,12))).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}var e}(t):null}(new Uint8Array(t instanceof DataView?t.buffer:t));return e?{mimeType:e.mimeType,width:0,height:0}:null}(e)}function Cl(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}const Al={id:"image",module:"images",name:"Images",version:"3.4.4",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:async function(t,e,n){const i=((e=e||{}).image||{}).type||"auto",{url:r}=n||{};let o;switch(function(t){switch(t){case"auto":case"data":return function(){if(fl)return"imagebitmap";if(dl)return"image";if(gl)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(t){switch(t){case"auto":return fl||dl||gl;case"imagebitmap":return fl;case"image":return dl;case"data":return gl;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}(t),t}}(i)){case"imagebitmap":o=await async function(t,e,n){let i;i=_l(n)?await wl(t,e,n):bl(t,n);const r=e&&e.imagebitmap;return await async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!function(t){for(const e in t||xl)return!1;return!0}(e)&&El||(e=null),e)try{return await createImageBitmap(t,e)}catch(t){console.warn(t),El=!1}return await createImageBitmap(t)}(i,r)}(t,e,r);break;case"image":o=await wl(t,e,r);break;case"data":o=await async function(t,e){const{mimeType:n}=Tl(t)||{},i=globalThis._parseImageNode;return J(i),await i(t,n)}(t);break;default:J(!1)}return"data"===i&&(o=function(t){switch(ml(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}(o)),o},tests:[t=>Boolean(Tl(new DataView(t)))],options:{image:{type:"auto",decode:!0}}},Ml={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(t){const e=t[0],n=t[t.length-1];return"{"===e&&"}"===n||"["===e&&"]"===n},parseTextSync:JSON.parse},Ll=function(){const t="8.9.18",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(R.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:R,_registerLoggers:z},function(t){const e=ye();t=Array.isArray(t)?t:[t];for(const n of t){const t=et(n);e.find((e=>t===e))||e.unshift(t)}}([Ml,[Al,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}(),kl=globalThis;function Ol(t){if(!t&&!p())return"Node";if(f(t))return"Electron";const e="undefined"!=typeof navigator?navigator:{},n=t||e.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const i=-1!==n.indexOf("MSIE "),r=-1!==n.indexOf("Trident/");return i||r?"IE":kl.chrome?"Chrome":kl.safari?"Safari":kl.mozInnerScreenX?"Firefox":"Unknown"}class Il extends oo{get[Symbol.toStringTag](){return"Query"}static isSupported(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=rr(t),i=Wo(t,jo);let r=n||i;for(const t of e)switch(t){case"queries":r=r&&n;break;case"timers":r=r&&i;break;default:Kr(!1)}return r}constructor(t){super(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery(){let{conservative:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.begin(t?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(t){return this._queryPending||(this.target=t,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const t=this.gl2.getQueryParameter(this.handle,34919);return t&&(this._queryPending=!1),t}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let e=0;return this._pollingPromise=new Promise(((n,i)=>{const r=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):e++>t?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(r)};requestAnimationFrame(r)})),this._pollingPromise}_createHandle(){return Il.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const Rl=p()&&"undefined"!=typeof document;let Nl=0;class zl{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{onCreateContext:e=(t=>qr(t)),onAddHTML:n=null,onInitialize:i=(()=>{}),onRender:r=(()=>{}),onFinalize:o=(()=>{}),onError:s,gl:a=null,glOptions:l={},debug:c=!1,createFramebuffer:u=!1,autoResizeViewport:h=!0,autoResizeDrawingBuffer:d=!0,stats:f=Yr.get("animation-loop-".concat(Nl++))}=t;let{useDevicePixels:p=!0}=t;"useDevicePixelRatio"in t&&(tr.deprecated("useDevicePixelRatio","useDevicePixels")(),p=t.useDevicePixelRatio),this.props={onCreateContext:e,onAddHTML:n,onInitialize:i,onRender:r,onFinalize:o,onError:s,gl:a,glOptions:l,debug:c,createFramebuffer:u},this.gl=a,this.needsRedraw=null,this.timeline=null,this.stats=f,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:h,autoResizeDrawingBuffer:d,useDevicePixels:p}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(t){return Kr("string"==typeof t),this.needsRedraw=this.needsRedraw||t,this}setProps(t){return"autoResizeViewport"in t&&(this.autoResizeViewport=t.autoResizeViewport),"autoResizeDrawingBuffer"in t&&(this.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer),"useDevicePixels"in t&&(this.useDevicePixels=t.useDevicePixels),this}start(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._running)return this;this._running=!0;const e=this._getPageLoadPromise().then((()=>!this._running||this._initialized?null:(this._createWebGLContext(t),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Il.isSupported(this.gl,["timers"])?new Il(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps)))).then((t=>{this._running&&(this._addCallbackData(t||{}),!1!==t&&this._startLoop())}));return this.props.onError&&e.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(t){return this.timeline=t,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise((t=>{this._resolveNextFrame=t}))),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=document.getElementById(t);return n?Number(n.value):e}setViewParameters(){return tr.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const t=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(t))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(t)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=Rl?new Promise(((t,e)=>{Rl&&"complete"===document.readyState?t(document):window.addEventListener("load",(()=>{t(document)}))})):Promise.resolve({})),this._pageLoadPromise}_setDisplay(t){this.display&&(this.display.delete(),this.display.animationLoop=null),t&&(t.animationLoop=this),this.display=t}_cancelAnimationFrame(t){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(t):(e=t,"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e));var e}_requestAnimationFrame(t){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(t):(e=t,"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60));var e}_renderFrame(){this.display?this.display._renderFrame(...arguments):this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:t,height:e,aspect:n}=this._getSizeAndAspect();t===this.animationProps.width&&e===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=t,this.animationProps.height=e,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(t){"object"==typeof t&&null!==t&&(this.animationProps=Object.assign({},this.animationProps,t))}_createWebGLContext(t){if(this.offScreen=t.canvas&&"undefined"!=typeof OffscreenCanvas&&t.canvas instanceof OffscreenCanvas,t=Object.assign({},t,this.props.glOptions),this.gl=this.props.gl?Xr(this.props.gl,t):this.onCreateContext(t),!ir(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");Fr(this.gl,_r),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";const e=document.createElement("div");e.style.position="absolute",e.style.left="10px",e.style.bottom="10px",e.style.width="300px",e.style.background="white",t.appendChild(this.gl.canvas),t.appendChild(e);const n=this.props.onAddHTML(e);n&&(e.innerHTML=n)}}_getSizeAndAspect(){const t=this.gl.drawingBufferWidth,e=this.gl.drawingBufferHeight;let n=1;const{canvas:i}=this.gl;return i&&i.clientHeight?n=i.clientWidth/i.clientHeight:t>0&&e>0&&(n=t/e),{width:t,height:e,aspect:n}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.canvas)return void function(t,e,n){let i="width"in n?n.width:t.canvas.clientWidth,r="height"in n?n.height:t.canvas.clientHeight;i&&r||(tr.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=t.canvas.width||1,r=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const o=t.luma.canvasSizeInfo;if(o.clientWidth!==i||o.clientHeight!==r||o.devicePixelRatio!==e){let n=e;const o=Math.floor(i*n),s=Math.floor(r*n);t.canvas.width=o,t.canvas.height=s,t.drawingBufferWidth===o&&t.drawingBufferHeight===s||(tr.warn("Device pixel ratio clamped")(),n=Math.min(t.drawingBufferWidth/i,t.drawingBufferHeight/r),t.canvas.width=Math.floor(i*n),t.canvas.height=Math.floor(r*n)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}(t,function(t){const e="undefined"==typeof window?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}(e.useDevicePixels),e);const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new qo(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:t}=this.gl;t&&(t.addEventListener("mousemove",this._onMousemove),t.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(t){this.animationProps._mousePosition=[t.offsetX,t.offsetY]}_onMouseleave(t){this.animationProps._mousePosition=null}}var Fl=n(797);const Dl={mousedown:1,mousemove:2,mouseup:4};!function(t){const e=t.prototype.handler;t.prototype.handler=function(t){const n=this.store;t.button>0&&"pointerdown"===t.type&&(function(e,n){for(let n=0;n<e.length;n++)if(e[n].pointerId===t.pointerId)return!0;return!1}(n)||n.push(t)),e.call(this,t)}}(Fl.PointerEventInput),Fl.MouseInput.prototype.handler=function(t){let e=Dl[t.type];1&e&&t.button>=0&&(this.pressed=!0),2&e&&0===t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))};const jl=Fl.Manager,Bl=Fl;class Ul{constructor(t,e,n){this.element=t,this.callback=e,this.options={enable:!0,...n}}}const Vl=Bl?[[Bl.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Bl.Rotate,{enable:!1}],[Bl.Pinch,{enable:!1}],[Bl.Swipe,{enable:!1}],[Bl.Pan,{threshold:0,enable:!1}],[Bl.Press,{enable:!1}],[Bl.Tap,{event:"doubletap",taps:2,enable:!1}],[Bl.Tap,{event:"anytap",enable:!1}],[Bl.Tap,{enable:!1}]]:null,Wl={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},Gl={doubletap:["tap"]},Hl={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},ql={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},Xl={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},Zl={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},Yl="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Kl="undefined"!=typeof window?window:n.g;void 0!==n.g?n.g:window,"undefined"!=typeof document&&document;let Ql=!1;try{const t={get passive(){return Ql=!0,!0}};Kl.addEventListener("test",null,t),Kl.removeEventListener("test",null)}catch(t){Ql=!1}const $l=-1!==Yl.indexOf("firefox"),{WHEEL_EVENTS:Jl}=ql,tc="wheel",ec=4.000244140625;class nc extends Ul{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{if(!this.options.enable)return;let e=t.deltaY;Kl.WheelEvent&&($l&&t.deltaMode===Kl.WheelEvent.DOM_DELTA_PIXEL&&(e/=Kl.devicePixelRatio),t.deltaMode===Kl.WheelEvent.DOM_DELTA_LINE&&(e*=40)),0!==e&&e%ec==0&&(e=Math.floor(e/ec)),t.shiftKey&&e&&(e*=.25),this.callback({type:tc,center:{x:t.clientX,y:t.clientY},delta:-e,srcEvent:t,pointerType:"mouse",target:t.target})},this.events=(this.options.events||[]).concat(Jl),this.events.forEach((e=>t.addEventListener(e,this.handleEvent,!!Ql&&{passive:!1})))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===tc&&(this.options.enable=e)}}const{MOUSE_EVENTS:ic}=ql,rc="pointermove",oc="pointerover",sc="pointerout",ac="pointerenter",lc="pointerleave";class cc extends Ul{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{this.handleOverEvent(t),this.handleOutEvent(t),this.handleEnterEvent(t),this.handleLeaveEvent(t),this.handleMoveEvent(t)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(ic),this.events.forEach((e=>t.addEventListener(e,this.handleEvent)))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===rc&&(this.enableMoveEvent=e),t===oc&&(this.enableOverEvent=e),t===sc&&(this.enableOutEvent=e),t===ac&&(this.enableEnterEvent=e),t===lc&&(this.enableLeaveEvent=e)}handleOverEvent(t){this.enableOverEvent&&"mouseover"===t.type&&this._emit(oc,t)}handleOutEvent(t){this.enableOutEvent&&"mouseout"===t.type&&this._emit(sc,t)}handleEnterEvent(t){this.enableEnterEvent&&"mouseenter"===t.type&&this._emit(ac,t)}handleLeaveEvent(t){this.enableLeaveEvent&&"mouseleave"===t.type&&this._emit(lc,t)}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":0===t.which&&(this.pressed=!1),this.pressed||this._emit(rc,t);break;case"mouseup":this.pressed=!1}}_emit(t,e){this.callback({type:t,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}const{KEY_EVENTS:uc}=ql,hc="keydown",dc="keyup";class fc extends Ul{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{const e=t.target||t.srcElement;"INPUT"===e.tagName&&"text"===e.type||"TEXTAREA"===e.tagName||(this.enableDownEvent&&"keydown"===t.type&&this.callback({type:hc,srcEvent:t,key:t.key,target:t.target}),this.enableUpEvent&&"keyup"===t.type&&this.callback({type:dc,srcEvent:t,key:t.key,target:t.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(uc),t.tabIndex=this.options.tabIndex||0,t.style.outline="none",this.events.forEach((e=>t.addEventListener(e,this.handleEvent)))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===hc&&(this.enableDownEvent=e),t===dc&&(this.enableUpEvent=e)}}const pc="contextmenu";class gc extends Ul{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{this.options.enable&&this.callback({type:pc,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})},t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,e){t===pc&&(this.options.enable=e)}}const mc={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};function vc(t){const e=mc[t.srcEvent.type];if(!e)return null;const{buttons:n,button:i,which:r}=t.srcEvent;let o=!1,s=!1,a=!1;return 4===e||2===e&&!Number.isFinite(n)?(o=1===r,s=2===r,a=3===r):2===e?(o=Boolean(1&n),s=Boolean(4&n),a=Boolean(2&n)):1===e&&(o=0===i,s=1===i,a=2===i),{leftButton:o,middleButton:s,rightButton:a}}function yc(t,e){const n=t.center;if(!n)return null;const i=e.getBoundingClientRect(),r=i.width/e.offsetWidth||1,o=i.height/e.offsetHeight||1;return{center:n,offsetCenter:{x:(n.x-i.left-e.clientLeft)/r,y:(n.y-i.top-e.clientTop)/o}}}const _c={srcElement:"root",priority:0};class bc{constructor(t){this.handleEvent=t=>{if(this.isEmpty())return;const e=this._normalizeEvent(t);let n=t.srcEvent.target;for(;n&&n!==e.rootElement;){if(this._emit(e,n),e.handled)return;n=n.parentNode}this._emit(e,"root")},this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(t,e,n,i=!1,r=!1){const{handlers:o,handlersByElement:s}=this;let a=_c;"string"==typeof n||n&&n.addEventListener?a={..._c,srcElement:n}:n&&(a={..._c,...n});let l=s.get(a.srcElement);l||(l=[],s.set(a.srcElement,l));const c={type:t,handler:e,srcElement:a.srcElement,priority:a.priority};i&&(c.once=!0),r&&(c.passive=!0),o.push(c),this._active=this._active||!c.passive;let u=l.length-1;for(;u>=0&&!(l[u].priority>=c.priority);)u--;l.splice(u+1,0,c)}remove(t,e){const{handlers:n,handlersByElement:i}=this;for(let r=n.length-1;r>=0;r--){const o=n[r];if(o.type===t&&o.handler===e){n.splice(r,1);const t=i.get(o.srcElement);t.splice(t.indexOf(o),1),0===t.length&&i.delete(o.srcElement)}}this._active=n.some((t=>!t.passive))}_emit(t,e){const n=this.handlersByElement.get(e);if(n){let e=!1;const i=()=>{t.handled=!0},r=()=>{t.handled=!0,e=!0},o=[];for(let s=0;s<n.length;s++){const{type:a,handler:l,once:c}=n[s];if(l({...t,type:a,stopPropagation:i,stopImmediatePropagation:r}),c&&o.push(n[s]),e)break}for(let t=0;t<o.length;t++){const{type:e,handler:n}=o[t];this.remove(e,n)}}}_normalizeEvent(t){const e=this.eventManager.getElement();return{...t,...vc(t),...yc(t,e),preventDefault:()=>{t.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:e}}}const wc={events:null,recognizers:null,recognizerOptions:{},Manager:jl,touchAction:"none",tabIndex:0};class xc{constructor(t=null,e){this._onBasicInput=t=>{const{srcEvent:e}=t,n=Hl[e.type];n&&this.manager.emit(n,t)},this._onOtherEvent=t=>{this.manager.emit(t.type,t)},this.options={...wc,...e},this.events=new Map,this.setElement(t);const{events:n}=this.options;n&&this.on(n)}getElement(){return this.element}setElement(t){if(this.element&&this.destroy(),this.element=t,!t)return;const{options:e}=this,n=e.Manager;this.manager=new n(t,{touchAction:e.touchAction,recognizers:e.recognizers||Vl}).on("hammer.input",this._onBasicInput),e.recognizers||Object.keys(Wl).forEach((t=>{const e=this.manager.get(t);e&&Wl[t].forEach((t=>{e.recognizeWith(t)}))}));for(const t in e.recognizerOptions){const n=this.manager.get(t);if(n){const i=e.recognizerOptions[t];delete i.enable,n.set(i)}}this.wheelInput=new nc(t,this._onOtherEvent,{enable:!1}),this.moveInput=new cc(t,this._onOtherEvent,{enable:!1}),this.keyInput=new fc(t,this._onOtherEvent,{enable:!1,tabIndex:e.tabIndex}),this.contextmenuInput=new gc(t,this._onOtherEvent,{enable:!1});for(const[t,e]of this.events)e.isEmpty()||(this._toggleRecognizer(e.recognizerName,!0),this.manager.on(t,e.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(t,e,n){this._addEventHandler(t,e,n,!1)}once(t,e,n){this._addEventHandler(t,e,n,!0)}watch(t,e,n){this._addEventHandler(t,e,n,!1,!0)}off(t,e){this._removeEventHandler(t,e)}_toggleRecognizer(t,e){const{manager:n}=this;if(!n)return;const i=n.get(t);if(i&&i.options.enable!==e){i.set({enable:e});const r=Gl[t];r&&!this.options.recognizers&&r.forEach((r=>{const o=n.get(r);e?(o.requireFailure(t),i.dropRequireFailure(r)):o.dropRequireFailure(t)}))}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}_addEventHandler(t,e,n,i,r){if("string"!=typeof t){n=e;for(const e in t)this._addEventHandler(e,t[e],n,i,r);return}const{manager:o,events:s}=this,a=Zl[t]||t;let l=s.get(a);l||(l=new bc(this),s.set(a,l),l.recognizerName=Xl[a]||a,o&&o.on(a,l.handleEvent)),l.add(t,e,n,i,r),l.isEmpty()||this._toggleRecognizer(l.recognizerName,!0)}_removeEventHandler(t,e){if("string"!=typeof t){for(const e in t)this._removeEventHandler(e,t[e]);return}const{events:n}=this,i=Zl[t]||t,r=n.get(i);if(r&&(r.remove(t,e),r.isEmpty())){const{recognizerName:t}=r;let e=!1;for(const i of n.values())if(i.recognizerName===t&&!i.isEmpty()){e=!0;break}e||this._toggleRecognizer(t,!1)}}}function Ec(){}const Sc={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Ec,onResize:Ec,onViewStateChange:Ec,onInteractionStateChange:Ec,onBeforeRender:Ec,onAfterRender:Ec,onLoad:Ec,onError:t=>R.error(t.message)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:({isDragging:t})=>t?"grabbing":"grab",getTooltip:null,debug:!1,drawPickingColors:!1};class Pc{constructor(t){i(this,"props",void 0),i(this,"width",0),i(this,"height",0),i(this,"userData",{}),i(this,"canvas",null),i(this,"viewManager",null),i(this,"layerManager",null),i(this,"effectManager",null),i(this,"deckRenderer",null),i(this,"deckPicker",null),i(this,"eventManager",null),i(this,"tooltip",null),i(this,"metrics",void 0),i(this,"animationLoop",void 0),i(this,"stats",void 0),i(this,"viewState",void 0),i(this,"cursorState",void 0),i(this,"_needsRedraw",void 0),i(this,"_pickRequest",void 0),i(this,"_lastPointerDownInfo",null),i(this,"_metricsCounter",void 0),i(this,"_onPointerMove",(t=>{const{_pickRequest:e}=this;if("pointerleave"===t.type)e.x=-1,e.y=-1,e.radius=0;else{if(t.leftButton||t.rightButton)return;{const n=t.offsetCenter;if(!n)return;e.x=n.x,e.y=n.y,e.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:e.x,y:e.y}),e.event=t})),i(this,"_onEvent",(t=>{const e=ai[t.type],n=t.offsetCenter;if(!e||!n||!this.layerManager)return;const i=this.layerManager.getLayers(),r=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:i,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:o}=r,s=o&&(o[e.handler]||o.props[e.handler]),a=this.props[e.handler];let l=!1;s&&(l=s.call(o,r,t)),!l&&a&&a(r,t)})),i(this,"_onPointerDown",(t=>{const e=t.offsetCenter,n=this._pick("pickObject","pickObject Time",{x:e.x,y:e.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=n.result[0]||n.emptyInfo})),this.props={...Sc,...t},t=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},t.viewState&&t.initialViewState&&R.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===Ol()&&R.warn("IE 11 is not supported")(),this.viewState=t.initialViewState,t.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(t)),this.animationLoop=this._createAnimationLoop(t),this.stats=new W({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(t),t._typedArrayManagerProps&&Oe.setOptions(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){var t,e,n,i,r,o,s,a,l;null===(t=this.animationLoop)||void 0===t||t.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,null===(e=this.layerManager)||void 0===e||e.finalize(),this.layerManager=null,null===(n=this.viewManager)||void 0===n||n.finalize(),this.viewManager=null,null===(i=this.effectManager)||void 0===i||i.finalize(),this.effectManager=null,null===(r=this.deckRenderer)||void 0===r||r.finalize(),this.deckRenderer=null,null===(o=this.deckPicker)||void 0===o||o.finalize(),this.deckPicker=null,null===(s=this.eventManager)||void 0===s||s.destroy(),this.eventManager=null,null===(a=this.tooltip)||void 0===a||a.remove(),this.tooltip=null,this.props.canvas||this.props.gl||!this.canvas||(null===(l=this.canvas.parentElement)||void 0===l||l.removeChild(this.canvas),this.canvas=null)}setProps(t){this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&R.removed("onLayerHover","onHover")(),"onLayerClick"in t&&R.removed("onLayerClick","onClick")(),t.initialViewState&&!$s(this.props.initialViewState,t.initialViewState,3)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);const e=Object.create(this.props);Object.assign(e,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(e),this.layerManager&&(this.viewManager.setProps(e),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(e),this.effectManager.setProps(e),this.deckRenderer.setProps(e),this.deckPicker.setProps(e)),this.stats.get("setProps Time").timeEnd()}needsRedraw(t={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(t),i=this.layerManager.needsRedraw(t),r=this.effectManager.needsRedraw(t),o=this.deckRenderer.needsRedraw(t);return e=e||n||i||r||o,e}redraw(t){if(!this.layerManager)return;let e=this.needsRedraw({clearRedrawFlags:!0});e=t||e,e&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(e):this._drawLayers(e))}get isInitialized(){return null!==this.viewManager}getViews(){return ia(this.viewManager),this.viewManager.views}getViewports(t){return ia(this.viewManager),this.viewManager.getViewports(t)}pickObject(t){const e=this._pick("pickObject","pickObject Time",t).result;return e.length?e[0]:null}pickMultipleObjects(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}pickObjects(t){return this._pick("pickObjects","pickObjects Time",t)}_addResources(t,e=!1){for(const n in t)this.layerManager.resourceManager.add({resourceId:n,data:t[n],forceUpdate:e})}_removeResources(t){for(const e of t)this.layerManager.resourceManager.remove(e)}_addDefaultEffect(t){this.effectManager.addDefaultEffect(t)}_pick(t,e,n){ia(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(e).timeStart();const r=this.deckPicker[t]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return i.get(e).timeEnd(),r}_createCanvas(t){let e=t.canvas;return"string"==typeof e&&(e=document.getElementById(e),ia(e)),e||(e=document.createElement("canvas"),e.id=t.id||"deckgl-overlay",(t.parent||document.body).appendChild(e)),Object.assign(e.style,t.style),e}_setCanvasSize(t){if(!this.canvas)return;const{width:e,height:n}=t;if(e||0===e){const t=Number.isFinite(e)?"".concat(e,"px"):e;this.canvas.style.width=t}if(n||0===n){var i;const e=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.position=(null===(i=t.style)||void 0===i?void 0:i.position)||"absolute",this.canvas.style.height=e}}_updateCanvasSize(){var t,e;const{canvas:n}=this;if(!n)return;const i=null!==(t=n.clientWidth)&&void 0!==t?t:n.width,r=null!==(e=n.clientHeight)&&void 0!==e?e:n.height;var o,s;i===this.width&&r===this.height||(this.width=i,this.height=r,null===(o=this.viewManager)||void 0===o||o.setProps({width:i,height:r}),null===(s=this.layerManager)||void 0===s||s.activateViewport(this.getViewports()[0]),this.props.onResize({width:i,height:r}))}_createAnimationLoop(t){const{width:e,height:n,gl:i,glOptions:r,debug:o,onError:s,onBeforeRender:a,onAfterRender:l,useDevicePixels:c}=t;return new zl({width:e,height:n,useDevicePixels:c,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:t=>qr({...r,...t,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:t=>this._setGLContext(t.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:a,onAfterRender:l,onError:s})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let t=this.props.views||[new Ca({id:"default-view"})];return t=Array.isArray(t)?t:[t],t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:t}=this.props;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:t}=this;if(t.event){const{result:n,emptyInfo:i}=this._pick("pickObject","pickObject Time",t);this.cursorState.isHovering=n.length>0;let r=i,o=!1;for(const i of n){var e;r=i,o=(null===(e=i.layer)||void 0===e?void 0:e.onHover(i,t.event))||o}if(!o&&this.props.onHover&&this.props.onHover(r,t.event),this.props.getTooltip&&this.tooltip){const t=this.props.getTooltip(r);this.tooltip.setTooltip(t,r.x,r.y)}t.event=null}}_updateCursor(){const t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(t){if(this.layerManager)return;this.canvas||(this.canvas=t.canvas,Xr(t,{enable:!0,copyState:!0})),this.tooltip=new ul(this.canvas),Fr(t,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(t);const e=new s;e.play(),this.animationLoop.attachTimeline(e),this.eventManager=new xc(this.props.parent||t.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const t in ai)this.eventManager.on(t,this._onEvent);this.viewManager=new Js({timeline:e,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new Qs(t,{deck:this,stats:this.stats,viewport:n,timeline:e}),this.effectManager=new Qa,this.deckRenderer=new nl(t),this.deckPicker=new ll(t),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(t,e){const{gl:n}=this.layerManager.context;Fr(n,this.props.parameters),this.props.onBeforeRender({gl:n}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...e}),this.props.onAfterRender({gl:n})}_onRenderFrame(t){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),R.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(t){const e=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState={...this.viewState,[t.viewId]:e},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(t){this.cursorState.isDragging=t.isDragging||!1,this.props.onInteractionStateChange(t)}_getFrameStats(){const{stats:t}=this;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();const e=this.animationLoop.stats;t.get("GPU Time").addTime(e.get("GPU Time").lastTiming),t.get("CPU Time").addTime(e.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:t,stats:e}=this;t.fps=e.get("frameRate").getHz(),t.setPropsTime=e.get("setProps Time").time,t.updateAttributesTime=e.get("Update Attributes").time,t.framesRedrawn=e.get("Redraw Count").count,t.pickTime=e.get("pickObject Time").time+e.get("pickMultipleObjects Time").time+e.get("pickObjects Time").time,t.pickCount=e.get("Pick Count").count,t.gpuTime=e.get("GPU Time").time,t.cpuTime=e.get("CPU Time").time,t.gpuTimePerFrame=e.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=e.get("CPU Time").getAverageTime();const n=Yr.get("Memory Usage");t.bufferMemory=n.get("Buffer Memory").count,t.textureMemory=n.get("Texture Memory").count,t.renderbufferMemory=n.get("Renderbuffer Memory").count,t.gpuMemory=n.get("GPU Memory").count}}i(Pc,"defaultProps",Sc),i(Pc,"VERSION",Ll);const Tc="undefined"!=typeof window?t.useLayoutEffect:t.useEffect;function Cc(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}class Ac{constructor(t,e){i(this,"opts",void 0),i(this,"source",void 0),this.opts=e,this.source=t}get value(){return this.source.value}getValue(){const t=this.source.getBuffer(),e=this.getAccessor();if(t)return[t,e];const{value:n}=this.source,{size:i}=e;let r=n;if(n&&n.length!==i){r=new Float32Array(i);const t=e.elementOffset||0;for(let e=0;e<i;++e)r[e]=n[t+e]}return r}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function Mc(t){return t.stride||t.size*t.bytesPerElement}function Lc(t,e){e.offset&&R.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=Mc(t),i=(void 0!==e.vertexOffset?e.vertexOffset:t.vertexOffset||0)*n+(e.elementOffset||0)*t.bytesPerElement+(t.offset||0);return{...e,offset:i,stride:n}}class kc{constructor(t,e,n){i(this,"gl",void 0),i(this,"id",void 0),i(this,"size",void 0),i(this,"settings",void 0),i(this,"value",void 0),i(this,"doublePrecision",void 0),i(this,"_buffer",void 0),i(this,"state",void 0),this.gl=t,this.id=e.id||"",this.size=e.size||1;const r=e.logicalType||e.type,o=5130===r;let s,{defaultValue:a}=e;a=Number.isFinite(a)?[a]:a||new Array(this.size).fill(0),s=o?5126:!r&&e.isIndexed?t&&function(t,e){return Wo(t,e)}(t,Bo)?5125:5123:r||5126;let l=function(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(r||s||5126);this.doublePrecision=o,o&&!1===e.fp64&&(l=Float32Array),this.value=null,this.settings={...e,defaultType:l,defaultValue:a,logicalType:r,type:s,size:this.size,bytesPerElement:l.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:t,type:e}=this.settings;this._buffer=new yo(this.gl,{id:this.id,target:t?34963:34962,accessor:{type:e}})}return this._buffer}get byteOffset(){const t=this.getAccessor();return t.vertexOffset?t.vertexOffset*Mc(t):0}get numInstances(){return this.state.numInstances}set numInstances(t){this.state.numInstances=t}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Oe.release(this.state.allocatedValue)}getShaderAttributes(t,e){if(this.doublePrecision){const n={},i=this.value instanceof Float64Array,r=function(t,e){const n=Lc(t,e);return{high:n,low:{...n,offset:n.offset+4*t.size}}}(this.getAccessor(),e||{});return n[t]=new Ac(this,r.high),n["".concat(t,"64Low")]=i?new Ac(this,r.low):new Float32Array(this.size),n}if(e){const n=Lc(this.getAccessor(),e);return{[t]:new Ac(this,n)}}return{[t]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let t=null;if(this.state.constant&&this.value){const e=Array.from(this.value);t=[e,e]}else{const{value:e,numInstances:n,size:i}=this,r=n*i;if(e&&r&&e.length>=r){const n=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let t=0;t<r;)for(let r=0;r<i;r++){const i=e[t++];i<n[r]&&(n[r]=i),i>o[r]&&(o[r]=i)}t=[n,o]}}return this.state.bounds=t,t}setData(t){const{state:e}=this;let n;n=ArrayBuffer.isView(t)?{value:t}:t instanceof yo?{buffer:t}:t;const i={...this.settings,...n};if(e.bufferAccessor=i,e.bounds=null,n.constant){let t=n.value;if(t=this._normalizeValue(t,[],0),this.settings.normalized&&(t=this.normalizeConstant(t)),e.constant&&this._areValuesEqual(t,this.value))return!1;e.externalBuffer=null,e.constant=!0,this.value=t}else if(n.buffer){const t=n.buffer;e.externalBuffer=t,e.constant=!1,this.value=n.value||null;const r=n.value instanceof Float64Array;i.type=n.type||t.accessor.type,i.bytesPerElement=t.accessor.BYTES_PER_ELEMENT*(r?2:1),i.stride=Mc(i)}else if(n.value){this._checkExternalBuffer(n);let t=n.value;e.externalBuffer=null,e.constant=!1,this.value=t,i.bytesPerElement=t.BYTES_PER_ELEMENT,i.stride=Mc(i);const{buffer:r,byteOffset:o}=this;this.doublePrecision&&t instanceof Float64Array&&(t=hn(t,i));const s=t.byteLength+o+2*i.stride;r.byteLength<s&&r.reallocate(s),r.setAccessor(null),r.subData({data:t,offset:o}),i.type=n.type||r.accessor.type}return!0}updateSubBuffer(t={}){this.state.bounds=null;const e=this.value,{startOffset:n=0,endOffset:i}=t;this.buffer.subData({data:this.doublePrecision&&e instanceof Float64Array?hn(e,{size:this.size,startIndex:n,endIndex:i}):e.subarray(n,i),offset:n*e.BYTES_PER_ELEMENT+this.byteOffset})}allocate(t,e=!1){const{state:n}=this,i=n.allocatedValue,r=Oe.allocate(i,t+1,{size:this.size,type:this.settings.defaultType,copy:e});this.value=r;const{buffer:o,byteOffset:s}=this;return o.byteLength<r.byteLength+s&&(o.reallocate(r.byteLength+s),e&&i&&o.subData({data:i instanceof Float64Array?hn(i,this):i,offset:s})),n.allocatedValue=r,n.constant=!1,n.externalBuffer=null,n.bufferAccessor=this.settings,!0}_checkExternalBuffer(t){const{value:e}=t;if(!ArrayBuffer.isView(e))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const n=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=e.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(e.constructor.name));e instanceof n||!this.settings.normalized||"normalized"in t||R.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(t){switch(this.settings.type){case 5120:return new Float32Array(t).map((t=>(t+128)/255*2-1));case 5122:return new Float32Array(t).map((t=>(t+32768)/65535*2-1));case 5121:return new Float32Array(t).map((t=>t/255));case 5123:return new Float32Array(t).map((t=>t/65535));default:return t}}_normalizeValue(t,e,n){const{defaultValue:i,size:r}=this.settings;if(Number.isFinite(t))return e[n]=t,e;if(!t){let t=r;for(;--t>=0;)e[n+t]=i[t];return e}switch(r){case 4:e[n+3]=Number.isFinite(t[3])?t[3]:i[3];case 3:e[n+2]=Number.isFinite(t[2])?t[2]:i[2];case 2:e[n+1]=Number.isFinite(t[1])?t[1]:i[1];case 1:e[n+0]=Number.isFinite(t[0])?t[0]:i[0];break;default:let o=r;for(;--o>=0;)e[n+o]=Number.isFinite(t[o])?t[o]:i[o]}return e}_areValuesEqual(t,e){if(!t||!e)return!1;const{size:n}=this;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}}const Oc=[],Ic=[];function Rc(t,e=0,n=1/0){let i=Oc;const r={index:-1,data:t,target:[]};return t?"function"==typeof t[Symbol.iterator]?i=t:t.length>0&&(Ic.length=t.length,i=Ic):i=Oc,(e>0||Number.isFinite(n))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,n),r.index=e-1),{iterable:i,objectInfo:r}}function Nc(t){return t&&t[Symbol.asyncIterator]}function zc(t,e){const{size:n,stride:i,offset:r,startIndices:o,nested:s}=e,a=t.BYTES_PER_ELEMENT,l=i?i/a:n,c=r?r/a:0,u=Math.floor((t.length-c)/l);return(e,{index:i,target:r})=>{if(!o){const e=i*l+c;for(let i=0;i<n;i++)r[i]=t[e+i];return r}const a=o[i],h=o[i+1]||u;let d;if(s){d=new Array(h-a);for(let e=a;e<h;e++){const i=e*l+c;r=new Array(n);for(let e=0;e<n;e++)r[e]=t[i+e];d[e-a]=r}}else if(l===n)d=t.subarray(a*n+c,h*n+c);else{d=new t.constructor((h-a)*n);let e=0;for(let i=a;i<h;i++){const r=i*l+c;for(let i=0;i<n;i++)d[e++]=t[r+i]}}return d}}const Fc=[],Dc=[[0,1/0]];function jc(t){const{source:e,target:n,start:i=0,size:r,getData:o}=t,s=t.end||n.length,a=e.length,l=s-i;if(a>l)return void n.set(e.subarray(0,l),i);if(n.set(e,i),!o)return;let c=a;for(;c<l;){const t=o(c,e);for(let e=0;e<r;e++)n[i+c]=t[e]||0,c++}}const Bc={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function Uc(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...Bc[n],...e,...t,type:n}}function Vc(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function Wc(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function Gc(t){t.push(t.shift())}function Hc(t,e){const{doublePrecision:n,settings:i,value:r,size:o}=t,s=n&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*o)*s}function qc({buffer:t,numInstances:e,attribute:n,fromLength:i,fromStartIndices:r,getData:o=(t=>t)}){const s=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*s,l=n.byteOffset,c=n.startIndices,u=r&&c,h=Hc(n,e),d=n.isConstant;if(!u&&i>=h)return;const f=d?n.value:n.getBuffer().getData({srcByteOffset:l});if(n.settings.normalized&&!d){const t=o;o=(e,i)=>n.normalizeConstant(t(e,i))}const p=d?(t,e)=>o(f,e):(t,e)=>o(f.subarray(t,t+a),e),g=t.getData({length:i}),m=new Float32Array(h);!function({source:t,target:e,size:n,getData:i,sourceStartIndices:r,targetStartIndices:o}){if(!Array.isArray(o))return jc({source:t,target:e,size:n,getData:i}),e;let s=0,a=0;const l=i&&((t,e)=>i(t+a,e)),c=Math.min(r.length,o.length);for(let i=1;i<c;i++){const c=r[i]*n,u=o[i]*n;jc({source:t.subarray(s,c),target:e,start:a,end:u,size:n,getData:l}),s=c,a=u}a<e.length&&jc({source:[],target:e,start:a,size:n,getData:l})}({source:g,target:m,sourceStartIndices:r,targetStartIndices:c,size:a,getData:p}),t.byteLength<m.byteLength+l&&t.reallocate(m.byteLength+l),t.subData({data:m,offset:l})}class Xc extends kc{constructor(t,e){super(t,e,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:Dc}),i(this,"constant",!1),this.settings.update=e.update||(e.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:t=!1}={}){const e=this.state.needsRedraw;return this.state.needsRedraw=e&&!t,e}getUpdateTriggers(){const{accessor:t}=this.settings;return[this.id].concat("function"!=typeof t&&t||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;const{accessor:e}=this.settings,n=this.settings.transition;return Uc(Array.isArray(e)?t[e.find((e=>t[e]))]:t[e],n)}setNeedsUpdate(t=this.id,e){if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),e){const{startRow:t=0,endRow:n=1/0}=e;this.state.updateRanges=function(t,e){if(t===Dc)return t;if(e[0]<0&&(e[0]=0),e[0]>=e[1])return t;const n=[],i=t.length;let r=0;for(let o=0;o<i;o++){const i=t[o];i[1]<e[0]?(n.push(i),r=o+1):i[0]>e[1]?n.push(i):e=[Math.min(i[0],e[0]),Math.max(i[1],e[1])]}return n.splice(r,0,e),n}(this.state.updateRanges,[t,n])}else this.state.updateRanges=Dc}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Fc}setNeedsRedraw(t=this.id){this.state.needsRedraw=this.state.needsRedraw||t}allocate(t){const{state:e,settings:n}=this;return!n.noAlloc&&!!n.update&&(super.allocate(t,e.updateRanges!==Dc),!0)}updateBuffer({numInstances:t,data:e,props:n,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:r},settings:{update:o,noAlloc:s}}=this;let a=!0;if(o){for(const[s,a]of r)o.call(i,this,{data:e,startRow:s,endRow:a,props:n,numInstances:t});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[e,n]of r){const i=Number.isFinite(e)?this.getVertexOffset(e):0,r=Number.isFinite(n)?this.getVertexOffset(n):s||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:i,endOffset:r})}this._checkAttributeArray()}else a=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),a}setConstantValue(t){return void 0!==t&&"function"!=typeof t&&(this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(t){const{state:e}=this;return t?(this.clearNeedsUpdate(),e.lastExternalBuffer===t||(e.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t)),!0):(e.lastExternalBuffer=null,!1)}setBinaryValue(t,e=null){const{state:n,settings:i}=this;if(!t)return n.binaryValue=null,n.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(n.binaryValue===t)return this.clearNeedsUpdate(),!0;if(n.binaryValue=t,this.setNeedsRedraw(),i.transform||e!==this.startIndices){ArrayBuffer.isView(t)&&(t={value:t});const r=t;ia(ArrayBuffer.isView(r.value),"invalid ".concat(i.accessor));const o=Boolean(r.size)&&r.size!==this.size;return n.binaryAccessor=zc(r.value,{size:r.size||this.size,stride:r.stride,offset:r.offset,startIndices:e,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){const{startIndices:e}=this;return(e?t<e.length?e[t]:this.numInstances:t)*this.size}getShaderAttributes(){const t=this.settings.shaderAttributes||{[this.id]:null},e={};for(const n in t)Object.assign(e,super.getShaderAttributes(n,t[n]));return e}_autoUpdater(t,{data:e,startRow:n,endRow:i,props:r,numInstances:o}){if(t.constant)return;const{settings:s,state:a,value:l,size:c,startIndices:u}=t,{accessor:h,transform:d}=s,f=a.binaryAccessor||("function"==typeof h?h:r[h]);ia("function"==typeof f,'accessor "'.concat(h,'" is not a function'));let p=t.getVertexOffset(n);const{iterable:g,objectInfo:m}=Rc(e,n,i);for(const e of g){m.index++;let n=f(e,m);if(d&&(n=d.call(this,n)),u){const e=(m.index<u.length-1?u[m.index+1]:o)-u[m.index];if(n&&Array.isArray(n[0])){let e=p;for(const i of n)t._normalizeValue(i,l,e),e+=c}else n&&n.length>c?l.set(n,p):(t._normalizeValue(n,m.target,0),B({target:l,source:m.target,start:p,count:e}));p+=e*c}else t._normalizeValue(n,l,p),p+=c}}_validateAttributeUpdaters(){const{settings:t}=this;if(!t.noAlloc&&"function"!=typeof t.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:t}=this,e=Math.min(4,this.size);if(t&&t.length>=e){let n=!0;switch(e){case 4:n=n&&Number.isFinite(t[3]);case 3:n=n&&Number.isFinite(t[2]);case 2:n=n&&Number.isFinite(t[1]);case 1:n=n&&Number.isFinite(t[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}const Zc="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",Yc="#version 300 es\n".concat(Zc);function Kc(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[i,r,o]=n;return e.includes(i)&&r&&o?{qualifier:i,type:r,name:o.split(";")[0]}:null}function Qc(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{version:e=100,input:n,inputType:i,output:r}=t;if(!n)return 300===e?Yc:e>300?"#version ".concat(e,"\n").concat(Zc):"void main() {gl_FragColor = vec4(0);}";const o=function(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return gi(!1),null}}(n,i);return e>=300?"#version ".concat(e," ").concat(300===e?"es":"","\nin ").concat(i," ").concat(n,";\nout vec4 ").concat(r,";\nvoid main() {\n  ").concat(r," = ").concat(o,";\n}"):"varying ".concat(i," ").concat(n,";\nvoid main() {\n  gl_FragColor = ").concat(o,";\n}")}class $c extends oo{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(t){return rr(t)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};sr(t),super(t,e),this.initialize(e),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,no(this.buffers)||this.bind((()=>this._unbindBuffers())),this.setProps(t),this}setProps(t){"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"bindOnUse"in t&&(t=t.bindOnUse),"buffers"in t&&this.setBuffers(t.buffers)}setBuffers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.bind((()=>{for(const e in t)this.setBuffer(e,t[e])})),this}setBuffer(t,e){const n=this._getVaryingIndex(t),{buffer:i,byteSize:r,byteOffset:o}=this._getBufferParams(e);return n<0?(this.unused[t]=i,tr.warn("".concat(this.id," unused varying buffer ").concat(t))(),this):(this.buffers[n]=e,this.bindOnUse||this._bindBuffer(n,i,o,r),this)}begin(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(t),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(t){let e,n,i;return t instanceof yo==0?(i=t.buffer,n=t.byteSize,e=t.byteOffset):i=t,void 0===e&&void 0===n||(e=e||0,n=n||i.byteLength-e),{buffer:i,byteOffset:e,byteSize:n}}_getVaryingInfo(t){return this.configuration&&this.configuration.getVaryingInfo(t)}_getVaryingIndex(t){if(this.configuration)return this.configuration.getVaryingInfo(t).location;const e=Number(t);return Number.isFinite(e)?e:-1}_bindBuffers(){if(this.bindOnUse)for(const t in this.buffers){const{buffer:e,byteSize:n,byteOffset:i}=this._getBufferParams(this.buffers[t]);this._bindBuffer(t,e,i,n)}}_unbindBuffers(){if(this.bindOnUse)for(const t in this.buffers)this._bindBuffer(t,null)}_bindBuffer(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const r=e&&e.handle;return r&&void 0!==i?this.gl.bindBufferRange(35982,t,r,n,i):this.gl.bindBufferBase(35982,t,r),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(t){this.gl.bindTransformFeedback(36386,this.handle)}}class Jc{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}setupResources(t){for(const e of this.bindings)this._setupTransformFeedback(e,t)}updateModelProps(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyings:e}=this;return e.length>0&&(t=Object.assign({},t,{varyings:e})),t}getDrawOptions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this.bindings[this.currentIndex],{sourceBuffers:n,transformFeedback:i}=e;return{attributes:Object.assign({},n,t.attributes),transformFeedback:i}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(t)}getBuffer(t){const{feedbackBuffers:e}=this.bindings[this.currentIndex],n=t?e[t]:null;return n?n instanceof yo?n:n.buffer:null}getData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyingName:e}=t,n=this.getBuffer(e);return n?n.getData():null}delete(){for(const t in this.resources)this.resources[t].delete()}_initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(t),this.varyings=t.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&Kr(rr(this.gl))}_getFeedbackBuffers(t){const{sourceBuffers:e={}}=t,n={};if(this.bindings[this.currentIndex]&&Object.assign(n,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const t in this.feedbackMap){const i=this.feedbackMap[t];t in e&&(n[i]=t)}Object.assign(n,t.feedbackBuffers);for(const t in n){const i=n[t];if("string"==typeof i){const r=e[i],{byteLength:o,usage:s,accessor:a}=r;n[t]=this._createNewBuffer(t,{byteLength:o,usage:s,accessor:a})}}return n}_setupBuffers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:e=null}=t;Object.assign(this.feedbackMap,t.feedbackMap);const n=this._getFeedbackBuffers(t);this._updateBindings({sourceBuffers:e,feedbackBuffers:n})}_setupTransformFeedback(t,e){let{model:n}=e;const{program:i}=n;t.transformFeedback=new $c(this.gl,{program:i,buffers:t.feedbackBuffers})}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:e}=this._swapBuffers(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceBuffers:t,feedbackBuffers:e})}}_updateBinding(t,e){return t?(Object.assign(t.sourceBuffers,e.sourceBuffers),Object.assign(t.feedbackBuffers,e.feedbackBuffers),t.transformFeedback&&t.transformFeedback.setBuffers(t.feedbackBuffers),t):{sourceBuffers:Object.assign({},e.sourceBuffers),feedbackBuffers:Object.assign({},e.feedbackBuffers)}}_swapBuffers(t){if(!this.feedbackMap)return null;const e=Object.assign({},t.sourceBuffers),n=Object.assign({},t.feedbackBuffers);for(const i in this.feedbackMap){const r=this.feedbackMap[i];e[i]=t.feedbackBuffers[r],n[r]=t.sourceBuffers[i],Kr(n[r]instanceof yo)}return{sourceBuffers:e,feedbackBuffers:n}}_createNewBuffer(t,e){const n=new yo(this.gl,e);return this.resources[t]&&this.resources[t].delete(),this.resources[t]=n,n}_getNextIndex(){return(this.currentIndex+1)%2}}function tu(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&"#version"===n[0]){const t=parseInt(n[1],10);Number.isFinite(t)&&(e=t)}return e}const eu={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},nu="transform_uSize_",iu="transform_position";const ru={10241:9728,10240:9728,10242:33071,10243:33071};class ou{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}updateModelProps(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this._processVertexShader(t);return Object.assign({},t,e)}getDrawOptions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:e,sourceTextures:n,framebuffer:i,targetTexture:r}=this.bindings[this.currentIndex],o=Object.assign({},e,t.attributes),s=Object.assign({},t.uniforms),a=Object.assign({},t.parameters);let l=t.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const t in this.samplerTextureMap){const e=this.samplerTextureMap[t];s[t]=n[e]}this._setSourceTextureParameters();const t=function(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:i}=t;const r={};let o,s;n&&(({width:o,height:s}=i),r["".concat(nu).concat(n)]=[o,s]);for(const t in e)({width:o,height:s}=e[t]),r["".concat(nu).concat(t)]=[o,s];return r}({sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r});Object.assign(s,t)}return this.hasTargetTexture&&(l=!1,a.viewport=[0,0,i.width,i.height]),{attributes:o,framebuffer:i,uniforms:s,discard:l,parameters:a}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupTextures(t)}getTargetTexture(){const{targetTexture:t}=this.bindings[this.currentIndex];return t}getData(){let{packed:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{framebuffer:e}=this.bindings[this.currentIndex],n=zo(e);if(!t)return n;const i=n.constructor,r=function(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return gi(!1),null}}(this.targetTextureType),o=new i(n.length*r/4);let s=0;for(let t=0;t<n.length;t+=4)for(let e=0;e<r;e++)o[s++]=n[t+e];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{_targetTextureVarying:e,_swapTexture:n}=t;this._swapTexture=n,this.targetTextureVarying=e,this.hasTargetTexture=e,this._setupTextures(t)}_createTargetTexture(t){const{sourceTextures:e,textureOrReference:n}=t;if(n instanceof Po)return n;const i=e[n];return i?(this._targetRefTexName=n,this._createNewTexture(i)):null}_setupTextures(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:e,_sourceTextures:n={},_targetTexture:i}=t,r=this._createTargetTexture({sourceTextures:n,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||n&&Object.keys(n).length>0,this._updateBindings({sourceBuffers:e,sourceTextures:n,targetTexture:r}),"elementCount"in t&&this._updateElementIDBuffer(t.elementCount)}_updateElementIDBuffer(t){if("number"!=typeof t||this.elementCount>=t)return;const e=new Float32Array(t);e.forEach(((t,e,n)=>{n[e]=e})),this.elementIDBuffer?this.elementIDBuffer.setData({data:e}):this.elementIDBuffer=new yo(this.gl,{data:e,accessor:{size:1}}),this.elementCount=t}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this._swapTexture){const{sourceTextures:t,targetTexture:e}=this._swapTextures(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceTextures:t,targetTexture:e})}}_updateBinding(t,e){const{sourceBuffers:n,sourceTextures:i,targetTexture:r}=e;if(t||(t={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(t.sourceTextures,i),Object.assign(t.sourceBuffers,n),r){t.targetTexture=r;const{width:e,height:n}=r,{framebuffer:i}=t;i?(i.update({attachments:{36064:r},resizeAttachments:!1}),i.resize({width:e,height:n})):t.framebuffer=new qo(this.gl,{id:"transform-framebuffer",width:e,height:n,attachments:{36064:r}})}return t}_setSourceTextureParameters(){const t=this.currentIndex,{sourceTextures:e}=this.bindings[t];for(const t in e)e[t].setParameters(ru)}_swapTextures(t){if(!this._swapTexture)return null;const e=Object.assign({},t.sourceTextures);return e[this._swapTexture]=t.targetTexture,{sourceTextures:e,targetTexture:t.sourceTextures[this._swapTexture]}}_createNewTexture(t){const e=function(t,e){Kr(t instanceof Po||t instanceof Io||t instanceof Ro);const n=t.constructor,{gl:i,width:r,height:o,format:s,type:a,dataFormat:l,border:c,mipmaps:u}=t;return new n(i,Object.assign({width:r,height:o,format:s,type:a,dataFormat:l,border:c,mipmaps:u},{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}}))}(t);return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=e,e}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceTextures:e,targetTexture:n}=this.bindings[this.currentIndex],{vs:i,uniforms:r,targetTextureType:o,inject:s,samplerTextureMap:a}=function(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:i,targetTexture:r}=t,o=Object.keys(n).length,s=null;const a={};let l=e,c={};if(o>0||i){const t=l.split("\n"),e=t.slice();if(t.forEach(((t,r,l)=>{if(o>0){const i=function(t,e){const n={},i=function(t){return Kc(t,["attribute","in"])}(t);if(!i)return null;const{type:r,name:o}=i;if(o&&e[o]){const e="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:i,sizeName:s,uniformDeclerations:a}=function(t){const e="".concat("transform_uSampler_").concat(t),n="".concat(nu).concat(t);return{samplerName:e,sizeName:n,uniformDeclerations:"  uniform sampler2D ".concat(e,";\n  uniform vec2 ").concat(n,";")}}(o),l=function(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return gi(!1),null}}(r),c="  ".concat(r," ").concat(o," = transform_getInput(").concat(i,", ").concat(s,").").concat(l,";\n");return n[i]=o,{updatedLine:e,inject:{"vs:#decl":a,"vs:#main-start":c},samplerTextureMap:n}}return null}(t,n);if(i){const{updatedLine:t,inject:n}=i;e[r]=t,c=Di([c,n]),Object.assign(a,i.samplerTextureMap),o--}}i&&!s&&(s=function(t,e){const n=Kc(t,["varying","out"]);return n&&n.name===e?n.type:null}(t,i))})),i){Kr(r);const t="".concat(nu).concat(i),e="uniform vec2 ".concat(t,";\n"),n="     vec2 ".concat(iu," = transform_getPos(").concat(t,");\n     gl_Position = vec4(").concat(iu,", 0, 1.);\n");c=Di([c,{"vs:#decl":e,"vs:#main-start":n}])}l=e.join("\n")}return{vs:l,targetTextureType:s,inject:c,samplerTextureMap:a}}({vs:t.vs,sourceTextureMap:e,targetTextureVarying:this.targetTextureVarying,targetTexture:n}),l=Di([t.inject||{},s]);return this.targetTextureType=o,this.samplerTextureMap=a,{vs:i,fs:t._fs||Qc({version:tu(i),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[eu].concat(t.modules||[]):t.modules,uniforms:r,inject:l}}}let su=null;class au extends oo{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(t){return!(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).constantAttributeZero||rr(t)||"Chrome"===Ol()}static getDefaultArray(t){return t.luma=t.luma||{},t.luma.defaultVertexArray||(t.luma.defaultVertexArray=new au(t,{handle:null,isDefaultArray:!0})),t.luma.defaultVertexArray}static getMaxAttributes(t){return au.MAX_ATTRIBUTES=au.MAX_ATTRIBUTES||t.getParameter(34921),au.MAX_ATTRIBUTES}static setConstant(t,e,n){switch(n.constructor){case Float32Array:au._setConstantFloatArray(t,e,n);break;case Int32Array:au._setConstantIntArray(t,e,n);break;case Uint32Array:au._setConstantUintArray(t,e,n);break;default:Kr(!1)}}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.id||e.program&&e.program.id;super(t,Object.assign({},e,{id:n})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=e.isDefaultArray||!1,this.gl2=t,this.initialize(e),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return au.getMaxAttributes(this.gl)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.setProps(t)}setProps(t){return this}setElementBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Kr(!t||34963===t.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind((()=>{this.gl.bindBuffer(34963,t?t.handle:null)})),this}setBuffer(t,e,n){if(34963===e.target)return this.setElementBuffer(e,n);const{size:i,type:r,stride:o,offset:s,normalized:a,integer:l,divisor:c}=n,{gl:u,gl2:h}=this;return t=Number(t),this.bind((()=>{u.bindBuffer(34962,e.handle),l?(Kr(rr(u)),h.vertexAttribIPointer(t,i,r,o,s)):u.vertexAttribPointer(t,i,r,a,o,s),u.enableVertexAttribArray(t),h.vertexAttribDivisor(t,c||0)})),this}enable(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!e&&0===t&&!au.isSupported(this.gl,{constantAttributeZero:!0})||(t=Number(t),this.bind((()=>e?this.gl.enableVertexAttribArray(t):this.gl.disableVertexAttribArray(t)))),this}getConstantBuffer(t,e){const n=this._normalizeConstantArrayValue(e),i=n.byteLength*t,r=n.length*t;let o=!this.buffer;if(this.buffer=this.buffer||new yo(this.gl,i),o=o||this.buffer.reallocate(i),o=o||!this._compareConstantArrayValues(n,this.bufferValue),o){const t=function(t,e){var n;return new t((n=t.BYTES_PER_ELEMENT*e,(!su||su.byteLength<n)&&(su=new ArrayBuffer(n)),su),0,e)}(e.constructor,r);!function(t){let{target:e,source:n,start:i=0,count:r=1}=t;const o=n.length,s=r*o;let a=0;for(let t=i;a<o;a++)e[t++]=n[a];for(;a<s;)a<s-a?(e.copyWithin(i+a,i,i+a),a*=2):(e.copyWithin(i+a,i,i+s-a),a=s)}({target:t,source:n,start:0,count:r}),this.buffer.subData(t),this.bufferValue=e}return this.buffer}_normalizeConstantArrayValue(t){return Array.isArray(t)?new Float32Array(t):t}_compareConstantArrayValues(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}static _setConstantFloatArray(t,e,n){switch(n.length){case 1:t.vertexAttrib1fv(e,n);break;case 2:t.vertexAttrib2fv(e,n);break;case 3:t.vertexAttrib3fv(e,n);break;case 4:t.vertexAttrib4fv(e,n);break;default:Kr(!1)}}static _setConstantIntArray(t,e,n){switch(Kr(rr(t)),n.length){case 1:t.vertexAttribI1iv(e,n);break;case 2:t.vertexAttribI2iv(e,n);break;case 3:t.vertexAttribI3iv(e,n);break;case 4:t.vertexAttribI4iv(e,n);break;default:Kr(!1)}}static _setConstantUintArray(t,e,n){switch(Kr(rr(t)),n.length){case 1:t.vertexAttribI1uiv(e,n);break;case 2:t.vertexAttribI2uiv(e,n);break;case 3:t.vertexAttribI3uiv(e,n);break;case 4:t.vertexAttribI4uiv(e,n);break;default:Kr(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(t){return this.gl2.deleteVertexArray(t),[this.elements]}_bindHandle(t){this.gl2.bindVertexArray(t)}_getParameter(t,e){let{location:n}=e;return Kr(Number.isFinite(n)),this.bind((()=>34373===t?this.gl.getVertexAttribOffset(n,t):this.gl.getVertexAttrib(n,t)))}}const lu=/^(.+)__LOCATION_([0-9]+)$/,cu=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class uu{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.id||e.program&&e.program.id;this.id=n,this.gl=t,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new au(t),io(this,"VertexArray","v6.0",cu),this.initialize(e),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(t)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:t}=this.vertexArrayObject;return this.values=new Array(t).fill(null),this.accessors=new Array(t).fill(null),this.unused={},this.drawParams=null,this}setProps(t){return"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"attributes"in t&&this.setAttributes(t.attributes),"elements"in t&&this.setElementBuffer(t.elements),"bindOnUse"in t&&(t=t.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(t){return Object.assign(this.attributes,t),this.vertexArrayObject.bind((()=>{for(const e in t){const n=t[e];this._setAttribute(e,n)}this.gl.bindBuffer(34962,null)})),this}setElementBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.elements=t,this.elementsAccessor=e,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(t,e),this}setBuffer(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(34963===e.target)return this.setElementBuffer(e,n);const{location:i,accessor:r}=this._resolveLocationAndAccessor(t,e,e.accessor,n);return i>=0&&(this.values[i]=e,this.accessors[i]=r,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,e,r)),this}setConstant(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{location:i,accessor:r}=this._resolveLocationAndAccessor(t,e,Object.assign({size:e.length},n));return i>=0&&(e=this.vertexArrayObject._normalizeConstantArrayValue(e),this.values[i]=e,this.accessors[i]=r,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new yo(this.gl,{accessor:{size:4}});for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this.values[t]instanceof yo&&(this.gl.disableVertexAttribArray(t),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(t,1,5126,!1,0,0))})),this}bindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.setElementBuffer(this.elements);for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++){const e=this.values[t];e instanceof yo&&this.setBuffer(t,e)}})),this}bindForDraw(t,e,n){let i;return this.vertexArrayObject.bind((()=>{this._setConstantAttributes(t,e),i=n()})),i}_resolveLocationAndAccessor(t,e,n,i){const r={location:-1,accessor:null},{location:o,name:s}=this._getAttributeIndex(t);if(!Number.isFinite(o)||o<0)return this.unused[t]=e,tr.once(3,(()=>"unused value ".concat(t," in ").concat(this.id)))(),r;const a=this._getAttributeInfo(s||o);if(!a)return r;const l=this.accessors[o]||{},c=po.resolve(a.accessor,l,n,i),{size:u,type:h}=c;return Kr(Number.isFinite(u)&&Number.isFinite(h)),{location:o,accessor:c}}_getAttributeInfo(t){return this.configuration&&this.configuration.getAttributeInfo(t)}_getAttributeIndex(t){const e=Number(t);if(Number.isFinite(e))return{location:e};const n=lu.exec(t),i=n?n[1]:t,r=n?Number(n[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+r,name:i}:{location:-1}}_setAttribute(t,e){if(e instanceof yo)this.setBuffer(t,e);else if(Array.isArray(e)&&e.length&&e[0]instanceof yo){const n=e[0],i=e[1];this.setBuffer(t,n,i)}else if(ArrayBuffer.isView(e)||Array.isArray(e)){const n=e;this.setConstant(t,n)}else{if(!(e.buffer instanceof yo))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");{const n=e;this.setBuffer(t,n.buffer,n)}}}_setConstantAttributes(t,e){const n=Math.max(0|t,0|e);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,n);for(let t=1;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)i=this.values[t],ArrayBuffer.isView(i)&&this._setConstantAttribute(t,i)}_setConstantAttributeZero(t,e){if(au.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,t);const n=this.vertexArrayObject.getConstantBuffer(e,t);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}_setConstantAttribute(t,e){au.setConstant(this.gl,t,e)}_updateDrawParams(){const t={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this._updateDrawParamsForLocation(t,e);return this.elements&&(t.elementCount=this.elements.getElementCount(this.elements.accessor),t.isIndexed=!0,t.indexType=this.elementsAccessor.type||this.elements.accessor.type,t.indexOffset=this.elementsAccessor.offset||0),t.indexCount===1/0&&(t.indexCount=0),t.vertexCount===1/0&&(t.vertexCount=0),t.instanceCount===1/0&&(t.instanceCount=0),t}_updateDrawParamsForLocation(t,e){const n=this.values[e],i=this.accessors[e];if(!n)return;const{divisor:r}=i,o=r>0;if(t.isInstanced=t.isInstanced||o,n instanceof yo){const e=n;if(o){const n=e.getVertexCount(i);t.instanceCount=Math.min(t.instanceCount,n)}else{const n=e.getVertexCount(i);t.vertexCount=Math.min(t.vertexCount,n)}}}setElements(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return tr.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(t,e)}}function hu(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{isInteger:n=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return function(t,e){const{maxElts:n=16,size:i=1}=e;let r="[";for(let o=0;o<t.length&&o<n;++o)o>0&&(r+=",".concat(o%i==0?" ":"")),r+=hu(t[o],e);const o=t.length>n?"...":"]";return"".concat(r).concat(o)}(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<1e-16)return n?"0":"0.";if(n)return t.toFixed(0);if(Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function du(t,e,n,i){const{gl:r}=t;if(!e)return{[i]:"null","Format ":"N/A"};let o,s,a,l="NOT PROVIDED",c=1,u=0,h=0;if(n&&(l=n.type,c=n.size,l=String(l).replace("Array",""),o=-1!==l.indexOf("nt")),e instanceof yo){const t=e,{data:d,changed:f}=t.getDebugData();let p;if(s=f?"*":"",a=d,h=t.byteLength,u=h/d.BYTES_PER_ELEMENT/c,n){const t=n.divisor>0;p="".concat(t?"I ":"P "," ").concat(u," (x").concat(c,"=").concat(h," bytes ").concat($r(r,l),")")}else o=!0,p="".concat(h," bytes");return{[i]:"".concat(s).concat(hu(a,{size:c,isInteger:o})),"Format ":p}}return a=e,c=e.length,l=String(e.constructor.name).replace("Array",""),o=-1!==l.indexOf("nt"),{[i]:"".concat(hu(a,{size:c,isInteger:o})," (constant)"),"Format ":"".concat(c,"x").concat(l," (constant)")}}function fu(t,e){const{type:n,size:i}=e,r=Ps(n,i);return r?"".concat(t," (").concat(r.name,")"):t}function pu(t){let{header:e="Uniforms",program:n,uniforms:i,undefinedOnly:r=!1}=t;Kr(n);const o=".*Matrix",s=n._uniformSetters,a={},l=Object.keys(s).sort();let c=0;for(const t of l)t.match(".*_.*")||t.match(o)||gu({table:a,header:e,uniforms:i,uniformName:t,undefinedOnly:r})&&c++;for(const t of l)t.match(o)&&gu({table:a,header:e,uniforms:i,uniformName:t,undefinedOnly:r})&&c++;for(const t of l)a[t]||gu({table:a,header:e,uniforms:i,uniformName:t,undefinedOnly:r})&&c++;let u=0;const h={};if(!r)for(const t in i){const n=i[t];a[t]||(u++,h[t]={Type:"NOT USED: ".concat(n),[e]:hu(n)})}return{table:a,count:c,unusedTable:h,unusedCount:u}}function gu(t){let{table:e,header:n,uniforms:i,uniformName:r,undefinedOnly:o}=t;const s=i[r],a=function(t){return null!=t}(s);return!(o&&a||(e[r]={[n]:a?hu(s):"N/A","Uniform Type":a?s:"NOT PROVIDED"},0))}function mu(t){const{type:e,size:n}=t.accessor,i=Ps(e,n);return i?"".concat(i.name," ").concat(t.name):t.name}const vu={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function yu(t,e){const{attributeMap:n=vu}=e||{};return n&&n[t]||t}function _u(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors"}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}Kr(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const bu=()=>{},wu={};class xu{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{id:n=to("model")}=e;Kr(ir(t)),this.id=n,this.gl=t,this.id=e.id||to("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(e)}initialize(t){this.props={},this.programManager=t.programManager||Ls.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:e=null,vs:n,fs:i,modules:r,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:c}=t;this.programProps={program:e,vs:n,fs:i,modules:r,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:c},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(t.moduleSettings))),this.drawMode=void 0!==t.drawMode?t.drawMode:4,this.vertexCount=t.vertexCount||0,this.geometryBuffers={},this.isInstanced=t.isInstanced||t.instanced||t.instanceCount>0,this._setModelProps(t),this.geometry={},Kr(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(t){this._setModelProps(t)}delete(){for(const t in this._attributes)this._attributes[t]!==this.attributes[t]&&this._attributes[t].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(t){const{program:e,vs:n,fs:i,modules:r,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:c}=t;this.programProps={program:e,vs:n,fs:i,modules:r,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:c},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(t){return this.drawMode=t,this}setVertexCount(t){return Kr(Number.isFinite(t)),this.vertexCount=t,this}setInstanceCount(t){return Kr(Number.isFinite(t)),this.instanceCount=t,this}setGeometry(t){return this.drawMode=t.drawMode,this.vertexCount=t.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(t,e,n){const i={};let r=e.indices;for(const n in e.attributes){const o=e.attributes[n],s=yu(n,undefined);if("indices"===n)r=o;else if(o.constant)i[s]=o.value;else{const e=o.value,r={...o};delete r.value,i[s]=[new yo(t,e),r],_u(n,r)}}if(r){const e=r.value||r;Kr(e instanceof Uint16Array||e instanceof Uint32Array,'attribute array for "indices" must be of integer type');const n={size:1,isIndexed:void 0===r.isIndexed||r.isIndexed};i.indices=[new yo(t,{data:e,target:34963}),n]}return i}(this.gl,t),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(no(t))return this;const e={};for(const n in t){const i=t[n];e[n]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(e),this}setUniforms(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(this.uniforms,t),this}getModuleUniforms(t){this._checkProgram();const e=this.programManager.getUniforms(this.program);return e?e(t):{}}updateModuleSettings(t){const e=this.getModuleUniforms(t||{});return this.setUniforms(e)}clear(t){return ko(this.program.gl,t),this}draw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._checkProgram();const{moduleSettings:e=null,framebuffer:n,uniforms:i={},attributes:r={},transformFeedback:o=this.transformFeedback,parameters:s={},vertexArray:a=this.vertexArray}=t;let l;this.setAttributes(r),this.updateModuleSettings(e),this.setUniforms(i),tr.priority>=2&&(l=this._logDrawCallStart(2));const c=this.vertexArray.getDrawParams(),{isIndexed:u=c.isIndexed,indexType:h=c.indexType,indexOffset:d=c.indexOffset,vertexArrayInstanced:f=c.isInstanced}=this.props;f&&!this.isInstanced&&tr.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:p,instanceCount:g}=this,{onBeforeRender:m=bu,onAfterRender:v=bu}=this.props;m(),this.program.setUniforms(this.uniforms);const y=this.program.draw(Object.assign(wu,t,{logPriority:l,uniforms:null,framebuffer:n,parameters:s,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:a,transformFeedback:o,isIndexed:u,indexType:h,isInstanced:p,instanceCount:g,offset:u?d:0}));return v(),tr.priority>=2&&this._logDrawCallEnd(l,a,n),y}transform(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{discard:e=!0,feedbackBuffers:n,unbindModels:i=[]}=t;let{parameters:r}=t;n&&this._setFeedbackBuffers(n),e&&(r=Object.assign({},r,{35977:e})),i.forEach((t=>t.vertexArray.unbindBuffers()));try{this.draw(Object.assign({},t,{parameters:r}))}finally{i.forEach((t=>t.vertexArray.bindBuffers()))}return this}render(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return tr.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(t).draw()}_setModelProps(t){Object.assign(this.props,t),"uniforms"in t&&this.setUniforms(t.uniforms),"pickable"in t&&(this.pickable=t.pickable),"instanceCount"in t&&(this.instanceCount=t.instanceCount),"geometry"in t&&this.setGeometry(t.geometry),"attributes"in t&&this.setAttributes(t.attributes),"_feedbackBuffers"in t&&this._setFeedbackBuffers(t._feedbackBuffers)}_checkProgram(){if(!this._programDirty&&this.programManager.stateHash===this._programManagerState)return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:e,fs:n,modules:i,inject:r,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:l}=this.programProps;t=this.programManager.get({vs:e,fs:n,modules:i,inject:r,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:l}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Kr(t instanceof Ms,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new uu(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const t in this.geometryBuffers){const e=this.geometryBuffers[t][0]||this.geometryBuffers[t];e instanceof yo&&e.delete()}}_setAnimationProps(t){this.animated&&Kr(t,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(no(t))return this;const{gl:e}=this.program;return this.transformFeedback=this.transformFeedback||new $c(e,{program:this.program}),this.transformFeedback.setBuffers(t),this}_logDrawCallStart(t){const e=t>3?0:1e4;if(!(Date.now()-this.lastLogTime<e))return this.lastLogTime=Date.now(),tr.group(2,">>> DRAWING MODEL ".concat(this.id),{collapsed:tr.level<=2})(),t}_logDrawCallEnd(t,e,n,i){if(void 0===t)return;const r=function(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const i={};e.elements&&(i.ELEMENT_ARRAY_BUFFER=du(e,e.elements,null,n));const r=e.values;for(const t in r){const o=e._getAttributeInfo(t);if(o){let s="".concat(t,": ").concat(o.name);const a=e.accessors[o.location];a&&(s="".concat(t,": ").concat(fu(o.name,a))),i[s]=du(e,r[t],a,n)}}return i}({vertexArray:e,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:o,unusedTable:s,unusedCount:a}=pu({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),{table:l,count:c}=pu({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0});c>0&&tr.log("MISSING UNIFORMS",Object.keys(l))(),a>0&&tr.log("UNUSED UNIFORMS",Object.keys(s))();const u=function(t){const e={},n="Accessors for ".concat(t.id);for(const i of t.attributeInfos)if(i){const t=mu(i);e["in ".concat(t)]={[n]:JSON.stringify(i.accessor)}}for(const i of t.varyingInfos)if(i){const t=mu(i);e["out ".concat(t)]={[n]:JSON.stringify(i.accessor)}}return e}(this.vertexArray.configuration);tr.table(t,r)(),tr.table(t,o)(),tr.table(t+1,u)(),i&&i.log({logLevel:2,message:"Rendered to ".concat(i.id)}),tr.groupEnd(2)()}}class Eu{static isSupported(t){return rr(t)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(e),Object.seal(this)}delete(){const{model:t,bufferTransform:e,textureTransform:n}=this;t&&t.delete(),e&&e.delete(),n&&n.delete()}run(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{clearRenderTarget:e=!0}=t,n=this._updateDrawOptions(t);e&&n.framebuffer&&n.framebuffer.clear({color:!0}),this.model.transform(n)}swap(){let t=!1;const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)t=t||n.swap();Kr(t,"Nothing to swap")}getBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(t)}getData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e){const e=n.getData(t);if(e)return e}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"elementCount"in t&&this.model.setVertexCount(t.elementCount);const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)n.update(t)}_initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{gl:e}=this;this._buildResourceTransforms(e,t),t=this._updateModelProps(t),this.model=new xu(e,Object.assign({},t,{fs:t.fs||Qc({version:tu(t.vs)}),id:t.id||"transform-model",drawMode:t.drawMode||0,vertexCount:t.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const t of n)e=t.updateModelProps(e);return e}_buildResourceTransforms(t,e){(function(t){return!(no(t.feedbackBuffers)&&no(t.feedbackMap)&&!(t.varyings&&t.varyings.length>0))})(e)&&(this.bufferTransform=new Jc(t,e)),function(t){return!(no(t._sourceTextures)&&!t._targetTexture&&!t._targetTextureVarying)}(e)&&(this.textureTransform=new ou(t,e)),Kr(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const t of n)e=Object.assign(e,t.getDrawOptions(e));return e}}const Su={interpolation:class{constructor({gl:t,attribute:e,timeline:n}){i(this,"gl",void 0),i(this,"type","interpolation"),i(this,"attributeInTransition",void 0),i(this,"settings",void 0),i(this,"attribute",void 0),i(this,"transition",void 0),i(this,"currentStartIndices",void 0),i(this,"currentLength",void 0),i(this,"transform",void 0),i(this,"buffers",void 0),this.gl=t,this.transition=new sa(n),this.attribute=e,this.attributeInTransition=new Xc(t,e.settings),this.currentStartIndices=e.startIndices,this.currentLength=0,this.transform=function(t,e){const n=Wc(e.size);return new Eu(t,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}(t,e);const r={byteLength:0,usage:35050};this.buffers=[new yo(t,r),new yo(t,r)]}get inProgress(){return this.transition.inProgress}start(t,e){if(t.duration<=0)return void this.transition.cancel();this.settings=t;const{gl:n,buffers:i,attribute:r}=this;Gc(i);const o={numInstances:e,attribute:r,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const t of i)qc({buffer:t,...o});this.currentStartIndices=r.startIndices,this.currentLength=Hc(r,e),this.attributeInTransition.setData({buffer:i[1],value:r.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/r.size),sourceBuffers:{aFrom:i[0],aTo:Vc(0,r)},feedbackBuffers:{vCurrent:i[1]}})}update(){const t=this.transition.update();if(t){const{duration:t,easing:e}=this.settings,{time:n}=this.transition;let i=n/t;e&&(i=e(i)),this.transform.run({uniforms:{time:i}})}return t}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0}},spring:class{constructor({gl:t,attribute:e,timeline:n}){i(this,"gl",void 0),i(this,"type","spring"),i(this,"attributeInTransition",void 0),i(this,"settings",void 0),i(this,"attribute",void 0),i(this,"transition",void 0),i(this,"currentStartIndices",void 0),i(this,"currentLength",void 0),i(this,"texture",void 0),i(this,"framebuffer",void 0),i(this,"transform",void 0),i(this,"buffers",void 0),this.gl=t,this.type="spring",this.transition=new sa(n),this.attribute=e,this.attributeInTransition=new Xc(t,{...e.settings,normalized:!1}),this.currentStartIndices=e.startIndices,this.currentLength=0,this.texture=function(t){return new Po(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(t),this.framebuffer=function(t,e){return new qo(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(t,this.texture),this.transform=function(t,e,n){const i=Wc(e.size);return new Eu(t,{framebuffer:n,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}(t,e,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new yo(t,r),new yo(t,r),new yo(t,r)]}get inProgress(){return this.transition.inProgress}start(t,e){const{gl:n,buffers:i,attribute:r}=this,o={numInstances:e,attribute:r,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const t of i)qc({buffer:t,...o});this.settings=t,this.currentStartIndices=r.startIndices,this.currentLength=Hc(r,e),this.attributeInTransition.setData({buffer:i[1],value:r.value}),this.transition.start({...t,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/r.size),sourceBuffers:{aTo:Vc(0,r)}})}update(){const{buffers:t,transform:e,framebuffer:n,transition:i}=this;if(!i.update())return!1;const r=this.settings;return e.update({sourceBuffers:{aPrev:t[0],aCur:t[1]},feedbackBuffers:{vNext:t[2]}}),e.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:r.stiffness,damping:r.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),Gc(t),this.attributeInTransition.setData({buffer:t[1],value:this.attribute.value}),zo(n)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}};class Pu{constructor(t,{id:e,timeline:n}){i(this,"id",void 0),i(this,"isSupported",void 0),i(this,"gl",void 0),i(this,"timeline",void 0),i(this,"transitions",void 0),i(this,"needsRedraw",void 0),i(this,"numInstances",void 0),this.id=e,this.gl=t,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=Eu.isSupported(t)}finalize(){for(const t in this.transitions)this._removeTransition(t)}update({attributes:t,transitions:e,numInstances:n}){this.numInstances=n||1;for(const n in t){const i=t[n],r=i.getTransitionSetting(e);r&&this._updateAttribute(n,i,r)}for(const n in this.transitions){const i=t[n];i&&i.getTransitionSetting(e)||this._removeTransition(n)}}hasAttribute(t){const e=this.transitions[t];return e&&e.inProgress}getAttributes(){const t={};for(const e in this.transitions){const n=this.transitions[e];n.inProgress&&(t[e]=n.attributeInTransition)}return t}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].cancel(),delete this.transitions[t]}_updateAttribute(t,e,n){const i=this.transitions[t];let r=!i||i.type!==n.type;if(r){if(!this.isSupported)return void R.warn("WebGL2 not supported by this browser. Transition for ".concat(t," is disabled."))();i&&this._removeTransition(t);const o=Su[n.type];o?this.transitions[t]=new o({attribute:e,timeline:this.timeline,gl:this.gl}):(R.error("unsupported transition type '".concat(n.type,"'"))(),r=!1)}(r||e.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(n,this.numInstances))}}const Tu="attributeManager.invalidate";class Cu{constructor(t,{id:e="attribute-manager",stats:n,timeline:r}={}){i(this,"id",void 0),i(this,"gl",void 0),i(this,"attributes",void 0),i(this,"updateTriggers",void 0),i(this,"needsRedraw",void 0),i(this,"userData",void 0),i(this,"stats",void 0),i(this,"attributeTransitionManager",void 0),i(this,"mergeBoundsMemoized",Ds(dn)),this.id=e,this.gl=t,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new Pu(t,{id:"".concat(e,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(t={clearRedrawFlags:!1}){const e=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,e&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(t){this._add(t)}addInstanced(t){this._add(t,{instanced:1})}remove(t){for(const e of t)void 0!==this.attributes[e]&&(this.attributes[e].delete(),delete this.attributes[e])}invalidate(t,e){const n=this._invalidateTrigger(t,e);F(Tu,this,t,n)}invalidateAll(t){for(const e in this.attributes)this.attributes[e].setNeedsUpdate(e,t);F(Tu,this,"all")}update({data:t,numInstances:e,startIndices:n=null,transitions:i,props:r={},buffers:o={},context:s={}}){let a=!1;F("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const i in this.attributes){const l=this.attributes[i],c=l.settings.accessor;l.startIndices=n,l.numInstances=e,r[i]&&R.removed("props.".concat(i),"data.attributes.".concat(i))(),l.setExternalBuffer(o[i])||l.setBinaryValue("string"==typeof c?o[c]:void 0,t.startIndices)||"string"==typeof c&&!o[c]&&l.setConstantValue(r[c])||l.needsUpdate()&&(a=!0,this._updateAttribute({attribute:l,numInstances:e,data:t,props:r,context:s})),this.needsRedraw=this.needsRedraw||l.needsRedraw()}a&&F("attributeManager.updateEnd",this,e),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:e,transitions:i})}updateTransition(){const{attributeTransitionManager:t}=this,e=t.run();return this.needsRedraw=this.needsRedraw||e,e}getAttributes(){return this.attributes}getBounds(t){const e=t.map((t=>{var e;return null===(e=this.attributes[t])||void 0===e?void 0:e.getBounds()}));return this.mergeBoundsMemoized(e)}getChangedAttributes(t={clearChangedFlags:!1}){const{attributes:e,attributeTransitionManager:n}=this,i={...n.getAttributes()};for(const r in e){const o=e[r];o.needsRedraw(t)&&!n.hasAttribute(r)&&(i[r]=o)}return i}getShaderAttributes(t,e={}){t||(t=this.getAttributes());const n={};for(const i in t)e[i]||Object.assign(n,t[i].getShaderAttributes());return n}_add(t,e={}){for(const n in t){const i=t[n];this.attributes[n]=this._createAttribute(n,i,e)}this._mapUpdateTriggersToAttributes()}_createAttribute(t,e,n){const i={...e,id:t,size:(e.isIndexed?1:e.size)||1,divisor:n.instanced?1:e.divisor||0};return new Xc(this.gl,i)}_mapUpdateTriggersToAttributes(){const t={};for(const e in this.attributes)this.attributes[e].getUpdateTriggers().forEach((n=>{t[n]||(t[n]=[]),t[n].push(e)}));this.updateTriggers=t}_invalidateTrigger(t,e){const{attributes:n,updateTriggers:i}=this,r=i[t];return r&&r.forEach((t=>{const i=n[t];i&&i.setNeedsUpdate(i.id,e)})),r}_updateAttribute(t){const{attribute:e,numInstances:n}=t;F("attribute.updateStart",e),e.constant?e.setConstantValue(e.value):(e.allocate(n)&&F("attribute.allocate",e,n),e.updateBuffer(t)&&(this.needsRedraw=!0,F("attribute.updateEnd",e,n)))}}const Au=1e-5;function Mu(t,e,n,i,r){const o=e-t;return(n-e)*r+-o*i+o+e}function Lu(t,e){if(Array.isArray(t)){let n=0;for(let i=0;i<t.length;i++){const r=t[i]-e[i];n+=r*r}return Math.sqrt(n)}return Math.abs(t-e)}const ku={interpolation:class extends sa{get value(){return this._value}_onUpdate(){const{time:t,settings:{fromValue:e,toValue:n,duration:i,easing:r}}=this,o=r(t/i);this._value=Fe(e,n,o)}},spring:class extends sa{get value(){return this._currValue}_onUpdate(){const{fromValue:t,toValue:e,damping:n,stiffness:i}=this.settings,{_prevValue:r=t,_currValue:o=t}=this;let s=function(t,e,n,i,r){if(Array.isArray(n)){const o=[];for(let s=0;s<n.length;s++)o[s]=Mu(t[s],e[s],n[s],i,r);return o}return Mu(t,e,n,i,r)}(r,o,e,n,i);const a=Lu(s,e),l=Lu(s,o);a<Au&&l<Au&&(s=e,this.end()),this._prevValue=o,this._currValue=s}}};class Ou{constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,e,n,i){const{transitions:r}=this;if(r.has(t)){const n=r.get(t),{value:i=n.settings.fromValue}=n;e=i,this.remove(t)}if(!(i=Uc(i)))return;const o=ku[i.type];if(!o)return void R.error("unsupported transition type '".concat(i.type,"'"))();const s=new o(this.timeline);s.start({...i,fromValue:e,toValue:n}),r.set(t,s)}remove(t){const{transitions:e}=this;e.has(t)&&(e.get(t).cancel(),e.delete(t))}update(){const t={};for(const[e,n]of this.transitions)n.update(),t[e]=n.value,n.inProgress||this.remove(e);return t}clear(){for(const t of this.transitions.keys())this.remove(t)}}function Iu(t,e){if(!t.transitions)return!1;const n={},i=t[l];let r=!1;for(const o in t.transitions){const s=i[o],a=s&&s.type;("number"===a||"color"===a||"array"===a)&&Nu(t[o],e[o],s)&&(n[o]=!0,r=!0)}return!!r&&n}function Ru({newProps:t,oldProps:e,ignoreProps:n={},propTypes:i={},triggerName:r="props"}){if(e===t)return!1;if("object"!=typeof t||null===t)return"".concat(r," changed shallowly");if("object"!=typeof e||null===e)return"".concat(r," changed shallowly");for(const o of Object.keys(t))if(!(o in n)){if(!(o in e))return"".concat(r,".").concat(o," added");const n=Nu(t[o],e[o],i[o]);if(n)return"".concat(r,".").concat(o," ").concat(n)}for(const o of Object.keys(e))if(!(o in n)){if(!(o in t))return"".concat(r,".").concat(o," dropped");if(!Object.hasOwnProperty.call(t,o)){const n=Nu(t[o],e[o],i[o]);if(n)return"".concat(r,".").concat(o," ").concat(n)}}return!1}function Nu(t,e,n){let i=n&&n.equal;return i&&!i(t,e,n)?"changed deeply":i||(i=t&&e&&t.equals,!i||i.call(t,e))?i||e===t?null:"changed shallowly":"changed deeply"}function zu(t,e){if(null===e)return!0;const n=e.extensions,{extensions:i}=t;if(i===n)return!1;if(!n||!i)return!0;if(i.length!==n.length)return!0;for(let t=0;t<i.length;t++)if(!i[t].equals(n[t]))return!0;return!1}function Fu(t,e,n){let i=t.updateTriggers[n];i=null==i?{}:i;let r=e.updateTriggers[n];return r=null==r?{}:r,Ru({oldProps:r,newProps:i,triggerName:n})}function Du(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some((t=>"project64"===t.name)))){const t=n.modules.findIndex((t=>"project32"===t.name));t>=0&&n.modules.splice(t,1)}if("inject"in e)if(t.inject){const i={...t.inject};for(const t in e.inject)i[t]=(i[t]||"")+e.inject[t];n.inject=i}else n.inject=e.inject;return n}const ju=[0,0,0];function Bu(t,e,n=!1){const i=e.projectPosition(t);if(n&&e instanceof oa){const[n,r,o=0]=t,s=e.getDistanceScales([n,r]);i[2]=o*s.unitsPerMeter[2]}return i}function Uu(t,{viewport:e,modelMatrix:n,coordinateSystem:i,coordinateOrigin:r,offsetMode:o}){let[s,a,l=0]=t;switch(n&&([s,a,l]=Sn([],[s,a,l,1],n)),i){case ri.LNGLAT:return Bu([s,a,l],e,o);case ri.LNGLAT_OFFSETS:return Bu([s+r[0],a+r[1],l+(r[2]||0)],e,o);case ri.METER_OFFSETS:return Bu(Qn(r,[s,a,l]),e,o);case ri.CARTESIAN:default:return e.isGeospatial?[s+r[0],a+r[1],l+r[2]]:e.projectPosition([s,a,l])}}const Vu={10241:9987,10240:9729,10242:33071,10243:33071},Wu={},Gu={boolean:{validate:(t,e)=>!0,equal:(t,e,n)=>Boolean(t)===Boolean(e)},number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},color:{validate:(t,e)=>e.optional&&!t||Xu(t)&&(3===t.length||4===t.length),equal:(t,e,n)=>$s(t,e,1)},accessor:{validate(t,e){const n=Zu(t);return"function"===n||n===Zu(e.value)},equal:(t,e,n)=>"function"==typeof e||$s(t,e,1)},array:{validate:(t,e)=>e.optional&&!t||Xu(t),equal(t,e,n){const{compare:i}=n,r=Number.isInteger(i)?i:i?1:0;return i?$s(t,e,r):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:i}=n,r=Number.isInteger(i)?i:i?1:0;return i?$s(t,e,r):t===e}},function:{validate:(t,e)=>e.optional&&!t||"function"==typeof t,equal:(t,e,n)=>!n.compare&&!1!==n.ignore||t===e},data:{transform:(t,e,n)=>{const{dataTransform:i}=n.props;return i&&t?i(t):t}},image:{transform:(t,e,n)=>{const i=n.context;return i&&i.gl?function(t,e,n,i){if(n instanceof Po)return n;n.constructor&&"Object"!==n.constructor.name&&(n={data:n});let r=null;n.compressed&&(r={10241:n.data.length>1?9985:9729});const o=new Po(e,{...n,parameters:{...Vu,...r,...i}});return Wu[o.id]=t,o}(n.id,i.gl,t,{...e.parameters,...n.props.textureParameters}):null},release:(t,e,n)=>{var i,r;i=n.id,(r=t)&&r instanceof Po&&Wu[r.id]===i&&(r.delete(),delete Wu[r.id])}}};function Hu(t,e){switch(Zu(e)){case"object":return qu(t,e);case"array":return qu(t,{type:"array",value:e,compare:!1});case"boolean":return qu(t,{type:"boolean",value:e});case"number":return qu(t,{type:"number",value:e});case"function":return qu(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function qu(t,e){return"type"in e?{name:t,...Gu[e.type],...e}:"value"in e?{name:t,type:Zu(e.value),...e}:{name:t,type:"object",value:e}}function Xu(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Zu(t){return Xu(t)?"array":null===t?"null":typeof t}function Yu(t,e){let n="_mergedDefaultProps";if(e)for(const t of e){const e=t.constructor;e&&(n+=":".concat(e.extensionName||e.name))}return $u(t,n)||(t[n]=function(t,e){if(!t.prototype)return null;const n=Yu(Object.getPrototypeOf(t)),i=function(t){const e={},n={},i={};for(const[r,o]of Object.entries(t)){const t=null==o?void 0:o.deprecatedFor;if(t)i[r]=Array.isArray(t)?t:[t];else{const t=Hu(r,o);e[r]=t,n[r]=t.value}}return{propTypes:e,defaultProps:n,deprecatedProps:i}}($u(t,"defaultProps")||{}),r=Object.assign(Object.create(null),n,i.defaultProps),o=Object.assign(Object.create(null),null==n?void 0:n[l],i.propTypes),s=Object.assign(Object.create(null),null==n?void 0:n[c],i.deprecatedProps);for(const t of e){const e=Yu(t.constructor);e&&(Object.assign(r,e),Object.assign(o,e[l]),Object.assign(s,e[c]))}return function(t,e){const n=function(t){const e=t.componentName;return e||R.warn("".concat(t.name,".componentName not specified"))(),e||t.name}(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}(r,t),function(t,e){const n={},i={};for(const t in e){const r=e[t],{name:o,value:s}=r;r.async&&(n[o]=s,i[o]=Ku(o))}t[u]=n,t[h]={},Object.defineProperties(t,i)}(r,o),function(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(t){const i="".concat(this.id,": ").concat(n);for(const i of e[n])Qu(this,i)||(this[i]=t);R.deprecated(i,e[n].join("/"))()}})}(r,s),r[l]=o,r[c]=s,0!==e.length||Qu(t,"_propTypes")||(t._propTypes=o),r}(t,e||[]))}function Ku(t){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||Nc(e)?this[h][t]=e:this[d][t]=e},get(){if(this[d]){if(t in this[d])return this[d][t]||this[u][t];if(t in this[h]){const e=this[a]&&this[a].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[u][t]}}return this[u][t]}}}function Qu(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function $u(t,e){return Qu(t,e)&&t[e]}let Ju=0;class th{constructor(...t){i(this,"id",void 0),i(this,"props",void 0),i(this,"count",void 0),this.props=function(t,e){let n;for(let t=e.length-1;t>=0;t--){const i=e[t];"extensions"in i&&(n=i.extensions)}const i=Yu(t.constructor,n),r=Object.create(i);r[a]=t,r[h]={},r[d]={};for(let t=0;t<e.length;++t){const n=e[t];for(const t in n)r[t]=n[t]}return Object.freeze(r),r}(this,t),this.id=this.props.id,this.count=Ju++}clone(t){const{props:e}=this,n={};for(const t in e[u])t in e[d]?n[t]=e[d][t]:t in e[h]&&(n[t]=e[h][t]);return new this.constructor({...e,...n,...t})}}i(th,"componentName","Component"),i(th,"defaultProps",{});const eh=Object.freeze({});class nh{constructor(t){i(this,"component",void 0),i(this,"onAsyncPropUpdated",void 0),i(this,"asyncProps",void 0),i(this,"oldProps",void 0),i(this,"oldAsyncProps",void 0),this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const t in this.asyncProps){const e=this.asyncProps[t];e&&e.type&&e.type.release&&e.type.release(e.resolvedValue,e.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||eh}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){const e=this.asyncProps[t];return e&&e.resolvedValue}isAsyncPropLoading(t){if(t){const e=this.asyncProps[t];return Boolean(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(t,e){this._watchPromise(t,Promise.resolve(e))}setAsyncProps(t){this.component=t[a]||this.component;const e=t[d]||{},n=t[h]||t,i=t[u]||{};for(const t in e){const n=e[t];this._createAsyncPropData(t,i[t]),this._updateAsyncProp(t,n),e[t]=this.getAsyncProp(t)}for(const t in n){const e=n[t];this._createAsyncPropData(t,i[t]),this._updateAsyncProp(t,e)}}_fetch(t,e){return null}_onResolve(t,e){}_onError(t,e){}_updateAsyncProp(t,e){this._didAsyncInputValueChange(t,e)&&("string"==typeof e&&(e=this._fetch(t,e)),e instanceof Promise?this._watchPromise(t,e):Nc(e)?this._resolveAsyncIterable(t,e):this._setPropValue(t,e))}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}_didAsyncInputValueChange(t,e){const n=this.asyncProps[t];return e!==n.resolvedValue&&e!==n.lastValue&&(n.lastValue=e,!0)}_setPropValue(t,e){this._freezeAsyncOldProps();const n=this.asyncProps[t];n&&(e=this._postProcessValue(n,e),n.resolvedValue=e,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(t,e,n){const i=this.asyncProps[t];i&&n>=i.resolvedLoadCount&&void 0!==e&&(this._freezeAsyncOldProps(),i.resolvedValue=e,i.resolvedLoadCount=n,this.onAsyncPropUpdated(t,e))}_watchPromise(t,e){const n=this.asyncProps[t];if(n){n.pendingLoadCount++;const i=n.pendingLoadCount;e.then((e=>{this.component&&(e=this._postProcessValue(n,e),this._setAsyncPropValue(t,e,i),this._onResolve(t,e))})).catch((e=>{this._onError(t,e)}))}}async _resolveAsyncIterable(t,e){if("data"!==t)return void this._setPropValue(t,e);const n=this.asyncProps[t];if(!n)return;n.pendingLoadCount++;const i=n.pendingLoadCount;let r=[],o=0;for await(const n of e){if(!this.component)return;const{dataTransform:e}=this.component.props;r=e?e(n,r):r.concat(n),Object.defineProperty(r,"__diff",{enumerable:!1,value:[{startRow:o,endRow:r.length}]}),o=r.length,this._setAsyncPropValue(t,r,i)}this._onResolve(t,r)}_postProcessValue(t,e){const n=t.type;return n&&this.component&&(n.release&&n.release(t.resolvedValue,n,this.component),n.transform)?n.transform(e,n,this.component):e}_createAsyncPropData(t,e){if(!this.asyncProps[t]){const n=this.component&&this.component.props[l];this.asyncProps[t]={type:n&&n[t],lastValue:null,resolvedValue:e,pendingLoadCount:0,resolvedLoadCount:0}}}}class ih extends nh{constructor({attributeManager:t,layer:e}){super(e),i(this,"attributeManager",void 0),i(this,"needsRedraw",void 0),i(this,"needsUpdate",void 0),i(this,"subLayers",void 0),i(this,"usesPickingColorCache",void 0),i(this,"hasPickingBuffer",void 0),i(this,"changeFlags",void 0),i(this,"viewport",void 0),i(this,"uniformTransitions",void 0),i(this,"propsInTransition",void 0),this.attributeManager=t,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(t,e){const n=this.layer,i=null==n?void 0:n.props.fetch;return i?i(e,{propName:t,layer:n}):super._fetch(t,e)}_onResolve(t,e){const n=this.layer;if(n){const i=n.props.onDataLoad;"data"===t&&i&&i(e,{propName:t,layer:n})}}_onError(t,e){const n=this.layer;n&&n.raiseError(e,"loading ".concat(t," of ").concat(this.layer))}}const rh=2**24-1,oh=Object.freeze([]),sh=Ds((({oldViewport:t,viewport:e})=>t.equals(e)));let ah=new Uint8ClampedArray(0);const lh={data:{type:"data",value:oh,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:i,loadOptions:r,signal:o})=>{const{resourceManager:s}=n.context;var a;r=r||n.getLoadOptions(),i=i||n.props.loaders,o&&(r={...r,fetch:{...null===(a=r)||void 0===a?void 0:a.fetch,signal:o}});let l=s.contains(t);return l||r||(s.add({resourceId:t,data:Me(t,i),persistent:!1}),l=!0),l?s.subscribe({resourceId:t,onChange:t=>{var i;return null===(i=n.internalState)||void 0===i?void 0:i.reloadAsyncProp(e,t)},consumerId:n.id,requestId:e}):Me(t,i,r)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:ri.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,100*-t]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class ch extends th{constructor(...t){super(...t),i(this,"internalState",null),i(this,"lifecycle","Awaiting state"),i(this,"context",void 0),i(this,"state",void 0),i(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let t=this;for(;t.parent;)t=t.parent;return t}toString(){const t=this.constructor.layerName||this.constructor.name;return"".concat(t,"({id: '").concat(this.props.id,"'})")}project(t){ia(this.internalState);const e=this.internalState.viewport||this.context.viewport,n=Uu(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,r,o]=ti(n,e.pixelProjectionMatrix);return 2===t.length?[i,r]:[i,r,o]}unproject(t){return ia(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(t)}projectPosition(t,e){return ia(this.internalState),function(t,e){const{viewport:n,coordinateSystem:i,coordinateOrigin:r,modelMatrix:o,fromCoordinateSystem:s,fromCoordinateOrigin:a}=function(t){const{viewport:e,modelMatrix:n,coordinateOrigin:i}=t;let{coordinateSystem:r,fromCoordinateSystem:o,fromCoordinateOrigin:s}=t;return r===ri.DEFAULT&&(r=e.isGeospatial?ri.LNGLAT:ri.CARTESIAN),void 0===o&&(o=r),void 0===s&&(s=i),{viewport:e,coordinateSystem:r,coordinateOrigin:i,modelMatrix:n,fromCoordinateSystem:o,fromCoordinateOrigin:s}}(e),{autoOffset:l=!0}=e,{geospatialOrigin:c=ju,shaderCoordinateOrigin:u=ju,offsetMode:h=!1}=l?Hs(n,i,r):{},d=Uu(t,{viewport:n,modelMatrix:o,coordinateSystem:s,coordinateOrigin:a,offsetMode:h});if(h){const t=n.projectPosition(c||u);Je(d,d,t)}return d}(t,{viewport:this.internalState.viewport||this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...e})}get isComposite(){return!1}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(t){for(const e of this.getModels())e.updateModuleSettings(t)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===ri.DEFAULT||t===ri.LNGLAT||t===ri.CARTESIAN}onHover(t,e){return this.props.onHover&&this.props.onHover(t,e)||!1}onClick(t,e){return this.props.onClick&&this.props.onClick(t,e)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(t,e=[]){return e[0]=t+1&255,e[1]=t+1>>8&255,e[2]=t+1>>8>>8&255,e}decodePickingColor(t){ia(t instanceof Uint8Array);const[e,n,i]=t;return e+256*n+65536*i-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:function(t){if(null===(e=t)||"object"!=typeof e)throw new Error("count(): argument not an object");var e;if("function"==typeof t.count)return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(function(t){return null!==t&&"object"==typeof t&&t.constructor===Object}(t))return Object.keys(t).length;throw new Error("count(): argument not a container")}(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var t;return null===(t=this.getAttributeManager())||void 0===t?void 0:t.getBounds(["positions","instancePositions"])}getShaders(t){for(const e of this.props.extensions)t=Du(t,e.getShaders.call(this,e));return t}shouldUpdateState(t){return t.changeFlags.propsOrDataChanged}updateState(t){const e=this.getAttributeManager(),{dataChanged:n}=t.changeFlags;if(n&&e)if(Array.isArray(n))for(const t of n)e.invalidateAll(t);else e.invalidateAll();if(e){const{props:n}=t,i=this.internalState.hasPickingBuffer,r=Number.isInteger(n.highlightedObjectIndex)||n.pickable||n.extensions.some((t=>t.getNeedsPickingBuffer.call(this,t)));if(i!==r){this.internalState.hasPickingBuffer=r;const{pickingColors:t,instancePickingColors:n}=e.attributes,i=t||n;i&&(r&&i.constant&&(i.constant=!1,e.invalidate(i.id)),i.value||r||(i.constant=!0,i.value=[0,0,0]))}}}finalizeState(t){for(const t of this.getModels())t.delete();const e=this.getAttributeManager();e&&e.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(t){for(const e of this.getModels())e.draw(t)}getPickingInfo({info:t,mode:e,sourceLayer:n}){const{index:i}=t;return i>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[i]),t}raiseError(t,e){var n,i,r,o;e&&(t.message="".concat(e,": ").concat(t.message)),null!==(n=(i=this.props).onError)&&void 0!==n&&n.call(i,t)||null===(r=this.context)||void 0===r||null===(o=r.onError)||void 0===o||o.call(r,t,this)}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}hasUniformTransition(){var t;return(null===(t=this.internalState)||void 0===t?void 0:t.uniformTransitions.active)||!1}activateViewport(t){if(!this.internalState)return;const e=this.internalState.viewport;this.internalState.viewport=t,e&&sh({oldViewport:e,viewport:t})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all"){const e=this.getAttributeManager();e&&("all"===t?e.invalidateAll():e.invalidate(t))}updateAttributes(t){for(const e of this.getModels())this._setModelAttributes(e,t)}_updateAttributes(){const t=this.getAttributeManager();if(!t)return;const e=this.props,n=this.getNumInstances(),i=this.getStartIndices();t.update({data:e.data,numInstances:n,startIndices:i,props:e,transitions:e.transitions,buffers:e.data.attributes,context:this});const r=t.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(r)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const e=t.update(),n=Object.create(this.props);for(const t in e)Object.defineProperty(n,t,{value:e[t]});return n}return this.props}calculateInstancePickingColors(t,{numInstances:e}){if(t.constant)return;const n=Math.floor(ah.length/3);if(this.internalState.usesPickingColorCache=!0,n<e){e>rh&&R.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),ah=Oe.allocate(ah,e,{size:3,copy:!0,maxCount:Math.max(e,rh)});const t=Math.floor(ah.length/3),i=[];for(let e=n;e<t;e++)this.encodePickingColor(e,i),ah[3*e+0]=i[0],ah[3*e+1]=i[1],ah[3*e+2]=i[2]}t.value=ah.subarray(0,3*e)}_setModelAttributes(t,e){const n=this.getAttributeManager(),i=t.userData.excludeAttributes||{},r=n.getShaderAttributes(e,i);t.setAttributes(r)}disablePickingIndex(t){const e=this.props.data;if(!("attributes"in e))return void this._disablePickingIndex(t);const{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,r=n||i,o=r&&e.attributes&&e.attributes[r.id];if(o&&o.value){const n=o.value,i=this.encodePickingColor(t);for(let t=0;t<e.length;t++){const e=r.getVertexOffset(t);n[e]===i[0]&&n[e+1]===i[1]&&n[e+2]===i[2]&&this._disablePickingIndex(t)}}else this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,i=e||n;if(!i)return;const r=i.getVertexOffset(t),o=i.getVertexOffset(t+1);i.buffer.subData({data:new Uint8Array(o-r),offset:r})}restorePickingColors(){const{pickingColors:t,instancePickingColors:e}=this.getAttributeManager().attributes,n=t||e;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==ah.buffer&&(n.value=ah.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){ia(!this.internalState),ia(Number.isFinite(this.props.coordinateSystem)),F("layer.initialize",this);const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new ih({attributeManager:t,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(R.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),t)}),this.internalState.uniformTransitions=new Ou(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(t){F("layer.matched",this,this===t);const{state:e,internalState:n}=t;this!==t&&(this.internalState=n,this.state=e,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const t=this.needsUpdate();if(F("layer.update",this,t),!t)return;const e=this.props,n=this.context,i=this.internalState,r=n.viewport,o=this._updateUniformTransition();i.propsInTransition=o,n.viewport=i.viewport||r,this.props=o;try{const t=this._getUpdateParams(),e=this.getModels();if(n.gl)this.updateState(t);else try{this.updateState(t)}catch(t){}for(const e of this.props.extensions)e.updateState.call(this,t,e);const i=this.getModels()[0]!==e[0];this._postUpdate(t,i)}finally{n.viewport=r,this.props=e,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){F("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,this.context,t)}_drawLayer({moduleParameters:t=null,uniforms:e={},parameters:n={}}){this._updateAttributeTransition();const i=this.props,r=this.context;this.props=this.internalState.propsInTransition||i;const o=this.props.opacity;e.opacity=Math.pow(o,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:i}=this.props,o=i&&i(e)||[0,0];Fr(r.gl,{polygonOffset:o}),Dr(r.gl,n,(()=>{const i={moduleParameters:t,uniforms:e,parameters:n,context:r};for(const t of this.props.extensions)t.draw.call(this,i,t);this.draw(i)}))}finally{this.props=i}}getChangeFlags(){var t;return null===(t=this.internalState)||void 0===t?void 0:t.changeFlags}setChangeFlags(t){if(!this.internalState)return;const{changeFlags:e}=this.internalState;for(const n in t)if(t[n]){let i=!1;if("dataChanged"===n){const r=t[n],o=e[n];r&&Array.isArray(o)&&(e.dataChanged=Array.isArray(r)?o.concat(r):r,i=!0)}e[n]||(e[n]=t[n],i=!0),i&&F("layer.changeFlag",this,n,t)}const n=Boolean(e.dataChanged||e.updateTriggersChanged||e.propsChanged||e.extensionsChanged);e.propsOrDataChanged=n,e.somethingChanged=n||e.viewportChanged||e.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(t,e){const n=function(t,e){const n=Ru({newProps:t,oldProps:e,propTypes:t[l],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=function(t,e){if(null===e)return"oldProps is null, initial diff";let n=!1;const{dataComparator:i,_dataDiff:r}=t;return i?i(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&r&&(n=r(t.data,e.data)||n),n}(t,e);let r=!1;return i||(r=function(t,e){if(null===e)return{all:!0};if("all"in t.updateTriggers&&Fu(t,e,"all"))return{all:!0};const n={};let i=!1;for(const r in t.updateTriggers)"all"!==r&&Fu(t,e,r)&&(n[r]=!0,i=!0);return!!i&&n}(t,e)),{dataChanged:i,propsChanged:n,updateTriggersChanged:r,extensionsChanged:zu(t,e),transitionsChanged:Iu(t,e)}}(t,e);if(n.updateTriggersChanged)for(const t in n.updateTriggersChanged)n.updateTriggersChanged[t]&&this.invalidateAttribute(t);if(n.transitionsChanged)for(const r in n.transitionsChanged){var i;this.internalState.uniformTransitions.add(r,e[r],t[r],null===(i=t.transitions)||void 0===i?void 0:i[r])}return this.setChangeFlags(n)}validateProps(){!function(t){const e=t[l];for(const n in e){const i=e[n],{validate:r}=i;if(r&&!r(t[n],i))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}(this.props)}updateAutoHighlight(t){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const e={pickingSelectedColor:t.picked?t.color:null},{highlightColor:n}=this.props;t.picked&&"function"==typeof n&&(e.pickingHighlightColor=n(t)),this.setModuleParameters(e),this.setNeedsRedraw()}_getAttributeManager(){const t=this.context;return new Cu(t.gl,{id:this.props.id,stats:t.stats,timeline:t.timeline})}_postUpdate(t,e){const{props:n,oldProps:i}=t;this.setNeedsRedraw(),this._updateAttributes();const{model:r}=this.state;null==r||r.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:s,highlightColor:a}=n;if(e||i.autoHighlight!==o||i.highlightedObjectIndex!==s||i.highlightColor!==a){const t={};o||(t.pickingSelectedColor=null),Array.isArray(a)&&(t.pickingHighlightColor=a),(e||s!==i.highlightedObjectIndex)&&(t.pickingSelectedColor=Number.isFinite(s)&&s>=0?this.encodePickingColor(s):null),this.setModuleParameters(t)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let e=!1;e=e||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),i=!!n&&n.getNeedsRedraw(t);if(e=e||i,e)for(const t of this.props.extensions)t.onNeedsRedraw.call(this,t);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags,e}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}i(ch,"defaultProps",lh),i(ch,"layerName","Layer");const uh={position:"absolute",zIndex:-1};function hh(e,n){if("function"==typeof e)return e(n);if(Array.isArray(e))return e.map((t=>hh(t,n)));if(dh(e)){if(null===(i=e.props)||void 0===i?void 0:i.mapStyle)return n.style=uh,(0,t.cloneElement)(e,n);if(function(t){const e=t.type;return e&&e.deckGLViewProps}(e))return(0,t.cloneElement)(e,n)}var i;return e}function dh(t){return t&&"object"==typeof t&&"type"in t||!1}function fh(e){if("function"==typeof e)return(0,t.createElement)(ra,{},e);if(Array.isArray(e))return e.map(fh);if(dh(e)){if(e.type===t.Fragment)return fh(e.props.children);if(Cc(e.type,ra))return e}return e}const ph={mixBlendMode:null};function gh(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}const mh=(0,t.forwardRef)(((e,n)=>{const[i,r]=(0,t.useState)(0),o=(0,t.useRef)({control:null,version:i,forceUpdate:()=>r((t=>t+1))}).current,s=(0,t.useRef)(null),a=(0,t.useRef)(null),l=(0,t.useMemo)((()=>function({children:e,layers:n=[],views:i=null}){const r=[],o=[],s={};return t.Children.forEach(fh(e),(t=>{if(dh(t)){const e=t.type;if(Cc(e,ch)){const n=function(t,e){const n={},i=t.defaultProps||{};for(const t in e)i[t]!==e[t]&&(n[t]=e[t]);return new t(n)}(e,t.props);o.push(n)}else r.push(t);if(Cc(e,ra)&&e!==ra&&t.props.id){const n=new e(t.props);s[n.id]=n}}else t&&r.push(t)})),Object.keys(s).length>0&&(Array.isArray(i)?i.forEach((t=>{s[t.id]=t})):i&&(s[i.id]=i),i=Object.values(s)),{layers:n=o.length>0?[...o,...n]:n,children:r,views:i}}(e)),[e.layers,e.views,e.children]);let c=!0;const u=t=>{var n;return c&&e.viewState?(o.viewStateUpdateRequested=t,null):(o.viewStateUpdateRequested=null,null===(n=e.onViewStateChange)||void 0===n?void 0:n.call(e,t))},h=t=>{var n;c?o.interactionStateUpdateRequested=t:(o.interactionStateUpdateRequested=null,null===(n=e.onInteractionStateChange)||void 0===n||n.call(e,t))},d=(0,t.useMemo)((()=>{const t={...e,style:null,width:"100%",height:"100%",parent:s.current,canvas:a.current,layers:l.layers,views:l.views,onViewStateChange:u,onInteractionStateChange:h};return delete t._customRender,o.deck&&o.deck.setProps(t),t}),[e]);(0,t.useEffect)((()=>{const t=e.Deck||Pc;return o.deck=function(t,e,n){const i=new e({...n,_customRender:e=>{t.redrawReason=e;const n=i.getViewports();t.lastRenderedViewports!==n?t.forceUpdate():gh(t)}});return i}(o,t,{...d,parent:s.current,canvas:a.current}),()=>{var t;return null===(t=o.deck)||void 0===t?void 0:t.finalize()}}),[]),Tc((()=>{gh(o);const{viewStateUpdateRequested:t,interactionStateUpdateRequested:e}=o;t&&u(t),e&&h(e)})),(0,t.useImperativeHandle)(n,(()=>function(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}(o)),[]);const f=o.deck&&o.deck.isInitialized?o.deck.getViewports():void 0,{ContextProvider:p,width:g,height:m,id:v,style:y}=e,{containerStyle:_,canvasStyle:b}=(0,t.useMemo)((()=>function({width:t,height:e,style:n}){const i={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},r={left:0,top:0};if(n)for(const t in n)t in ph?r[t]=n[t]:i[t]=n[t];return{containerStyle:i,canvasStyle:r}}({width:g,height:m,style:y})),[g,m,y]);if(!o.viewStateUpdateRequested&&o.lastRenderedViewports===f||o.version!==i){o.lastRenderedViewports=f,o.version=i;const e=function({children:e,deck:n,ContextProvider:i}){const{viewManager:r}=n||{};if(!r||!r.views.length)return[];const o={},s=r.views[0].id;for(const t of e){let e=s,n=t;dh(t)&&Cc(t.type,ra)&&(e=t.props.id||s,n=t.props.children);const i=r.getViewport(e),a=r.getViewState(e);if(i){a.padding=i.padding;const{x:t,y:r,width:s,height:l}=i;n=hh(n,{x:t,y:r,width:s,height:l,viewport:i,viewState:a}),o[e]||(o[e]={viewport:i,children:[]}),o[e].children.push(n)}}return Object.keys(o).map((e=>{const{viewport:r,children:s}=o[e],{x:a,y:l,width:c,height:u}=r,h={position:"absolute",left:a,top:l,width:c,height:u},d="view-".concat(e),f=(0,t.createElement)("div",{key:d,id:d,style:h},...s);if(i){const o={viewport:r,container:n.canvas.offsetParent,eventManager:n.eventManager,onViewStateChange:t=>{t.viewId=e,n._onViewStateChange(t)}};return(0,t.createElement)(i,{key:d,value:o},f)}return f}))}({children:l.children,deck:o.deck,ContextProvider:p}),n=(0,t.createElement)("canvas",{key:"canvas",id:v||"deckgl-overlay",ref:a,style:b});o.control=(0,t.createElement)("div",{id:"".concat(v||"deckgl","-wrapper"),ref:s,style:_},[n,e])}return c=!1,o.control}));mh.defaultProps=Pc.defaultProps;const vh=mh;class yh extends ch{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every((t=>t.isLoaded))}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(t){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){const{object:e}=t;return e&&e.__source&&e.__source.parent&&e.__source.parent.id===this.id?(t.object=e.__source.object,t.index=e.__source.index,t):t}filterSubLayer(t){return!0}shouldRenderSubLayer(t,e){return e&&e.length}getSubLayerClass(t,e){const{_subLayerProps:n}=this.props;return n&&n[t]&&n[t].type||e}getSubLayerRow(t,e,n){return t.__source={parent:this,object:e,index:n},t}getSubLayerAccessor(t){if("function"==typeof t){const e={index:-1,data:this.props.data,target:[]};return(n,i)=>n&&n.__source?(e.index=n.__source.index,t(n.__source.object,e)):t(n,i)}return t}getSubLayerProps(t={}){var e;const{opacity:n,pickable:i,visible:r,parameters:o,getPolygonOffset:s,highlightedObjectIndex:a,autoHighlight:c,highlightColor:u,coordinateSystem:h,coordinateOrigin:d,wrapLongitude:f,positionFormat:p,modelMatrix:g,extensions:m,fetch:v,operation:y,_subLayerProps:_}=this.props,b={id:"",updateTriggers:{},opacity:n,pickable:i,visible:r,parameters:o,getPolygonOffset:s,highlightedObjectIndex:a,autoHighlight:c,highlightColor:u,coordinateSystem:h,coordinateOrigin:d,wrapLongitude:f,positionFormat:p,modelMatrix:g,extensions:m,fetch:v,operation:y},w=_&&t.id&&_[t.id],x=w&&w.updateTriggers,E=t.id||"sublayer";if(w){const e=this.props[l],n=t.type?t.type._propTypes:{};for(const t in w){const i=n[t]||e[t];i&&"accessor"===i.type&&(w[t]=this.getSubLayerAccessor(w[t]))}}Object.assign(b,t,w),b.id="".concat(this.props.id,"-").concat(E),b.updateTriggers={all:null===(e=this.props.updateTriggers)||void 0===e?void 0:e.all,...t.updateTriggers,...x};for(const t of m){const e=t.getSubLayerProps.call(this,t);e&&Object.assign(b,e,{updateTriggers:Object.assign(b.updateTriggers,e.updateTriggers)})}return b}_updateAutoHighlight(t){for(const e of this.getSubLayers())e.updateAutoHighlight(t)}_getAttributeManager(){return null}_postUpdate(t,e){let n=this.internalState.subLayers;const i=!n||this.needsUpdate();i&&(n=D(this.renderLayers(),Boolean),this.internalState.subLayers=n),F("compositeLayer.renderLayers",this,i,n);for(const t of n)t.parent=this}}function _h({data:t,getIndex:e,dataRange:n,replace:i}){const{startRow:r=0,endRow:o=1/0}=n,s=t.length;let a=s,l=s;for(let n=0;n<s;n++){const i=e(t[n]);if(a>n&&i>=r&&(a=n),i>=o){l=n;break}}let c=a;const u=l-a!==i.length?t.slice(l):void 0;for(let e=0;e<i.length;e++)t[c++]=i[e];if(u){for(let e=0;e<u.length;e++)t[c++]=u[e];t.length=c}return{startRow:a,endRow:a+i.length}}i(yh,"layerName","CompositeLayer");const bh={name:"project32",dependencies:[Xs],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},wh={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1},xh={inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:#decl":"\nuniform bool picking_uAttribute;\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}},name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wh;const e={};if(void 0!==t.pickingSelectedColor)if(t.pickingSelectedColor){const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}else e.picking_uSelectedColorValid=0;if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,(t=>t/255));Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return void 0!==t.pickingActive&&(e.picking_uActive=Boolean(t.pickingActive),e.picking_uAttribute=Boolean(t.pickingAttribute)),e}},Eh={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class Sh{static get DRAW_MODE(){return Eh}constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:e=to("geometry"),drawMode:n=Eh.TRIANGLES,attributes:i={},indices:r=null,vertexCount:o=null}=t;this.id=e,this.drawMode=0|n,this.attributes={},this.userData={},this._setAttributes(i,r),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(t){return"Geometry ".concat(this.id," attribute ").concat(t)}_setAttributes(t,e){e&&(this.indices=ArrayBuffer.isView(e)?{value:e,size:1}:e);for(const e in t){let n=t[e];n=ArrayBuffer.isView(n)?{value:n}:n,Kr(ArrayBuffer.isView(n.value),"".concat(this._print(e),": must be typed array or object with value as typed array")),"POSITION"!==e&&"positions"!==e||n.size||(n.size=3),"indices"===e?(Kr(!this.indices),this.indices=n):this.attributes[e]=n}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(t,e){if(e)return e.value.length;let n=1/0;for(const e in t){const i=t[e],{value:r,size:o,constant:s}=i;!s&&r&&o>=1&&(n=Math.min(n,r.length/o))}return Kr(Number.isFinite(n)),n}}const Ph=()=>{},Th={10241:9987,10240:9729,10242:33071,10243:33071};function Ch(t,e,n,i){const r=Math.min(n/e.width,i/e.height),o=Math.floor(e.width*r),s=Math.floor(e.height*r);return 1===r?{data:e,width:o,height:s}:(t.canvas.height=s,t.canvas.width=o,t.clearRect(0,0,o,s),t.drawImage(e,0,0,e.width,e.height,0,0,o,s),{data:t.canvas,width:o,height:s})}function Ah(t){return t&&(t.id||t.url)}function Mh(t,e,n){for(let i=0;i<e.length;i++){const{icon:r,xOffset:o}=e[i];t[Ah(r)]={...r,x:o,y:n}}}class Lh{constructor(t,{onUpdate:e=Ph,onError:n=Ph}){i(this,"gl",void 0),i(this,"onUpdate",void 0),i(this,"onError",void 0),i(this,"_loadOptions",null),i(this,"_texture",null),i(this,"_externalTexture",null),i(this,"_mapping",{}),i(this,"_textureParameters",null),i(this,"_pendingCount",0),i(this,"_autoPacking",!1),i(this,"_xOffset",0),i(this,"_yOffset",0),i(this,"_rowHeight",0),i(this,"_buffer",4),i(this,"_canvasWidth",1024),i(this,"_canvasHeight",0),i(this,"_canvas",null),this.gl=t,this.onUpdate=e,this.onError=n}finalize(){var t;null===(t=this._texture)||void 0===t||t.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(t){const e=this._autoPacking?Ah(t):t;return this._mapping[e]||{}}setProps({loadOptions:t,autoPacking:e,iconAtlas:n,iconMapping:i,textureParameters:r}){var o;t&&(this._loadOptions=t),void 0!==e&&(this._autoPacking=e),i&&(this._mapping=i),n&&(null===(o=this._texture)||void 0===o||o.delete(),this._texture=null,this._externalTexture=n),r&&(this._textureParameters=r)}get isLoaded(){return 0===this._pendingCount}packIcons(t,e){if(!this._autoPacking||"undefined"==typeof document)return;const n=Object.values(function(t,e,n){if(!t||!e)return null;n=n||{};const i={},{iterable:r,objectInfo:o}=Rc(t);for(const t of r){o.index++;const r=e(t,o),s=Ah(r);if(!r)throw new Error("Icon is missing.");if(!r.url)throw new Error("Icon url is missing.");i[s]||n[s]&&r.url===n[s].url||(i[s]={...r,source:t,sourceIndex:o.index})}return i}(t,e,this._mapping)||{});if(n.length>0){const{mapping:t,xOffset:e,yOffset:i,rowHeight:r,canvasHeight:o}=function({icons:t,buffer:e,mapping:n={},xOffset:i=0,yOffset:r=0,rowHeight:o=0,canvasWidth:s}){let a=[];for(let l=0;l<t.length;l++){const c=t[l];if(!n[Ah(c)]){const{height:t,width:l}=c;i+l+e>s&&(Mh(n,a,r),i=0,r=o+r+e,o=0,a=[]),a.push({icon:c,xOffset:i}),i=i+l+e,o=Math.max(o,t)}}return a.length>0&&Mh(n,a,r),{mapping:n,rowHeight:o,xOffset:i,yOffset:r,canvasWidth:s,canvasHeight:(l=o+r+e,Math.pow(2,Math.ceil(Math.log2(l))))};var l}({icons:n,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=r,this._mapping=t,this._xOffset=e,this._yOffset=i,this._canvasHeight=o,this._texture||(this._texture=new Po(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||Th})),this._texture.height!==this._canvasHeight&&(this._texture=function(t,e,n,i){const r=t.width,o=t.height,s=new Po(t.gl,{width:e,height:n,parameters:i});return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{sourceX:i=0,sourceY:r=0,targetMipmaplevel:o=0,targetInternalFormat:s=6408}=n;let{targetX:a,targetY:l,targetZ:c,width:u,height:h}=n;const{framebuffer:d,deleteFramebuffer:f}=Do(t);Kr(d);const{gl:p,handle:g}=d,m=void 0!==a||void 0!==l||void 0!==c;a=a||0,l=l||0,c=c||0;const v=p.bindFramebuffer(36160,g);Kr(e);let y=null;if(e instanceof So&&(y=e,u=Number.isFinite(u)?u:y.width,h=Number.isFinite(h)?h:y.height,y.bind(0),e=y.target),m)switch(e){case 3553:case 34067:p.copyTexSubImage2D(e,o,a,l,i,r,u,h);break;case 35866:case 32879:sr(p).copyTexSubImage3D(e,o,a,l,c,i,r,u,h)}else p.copyTexImage2D(e,o,s,i,r,u,h,0);y&&y.unbind(),p.bindFramebuffer(36160,v||null),f&&d.delete()}(t,s,{targetY:0,width:r,height:o}),t.delete(),s}(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||Th)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(n)}}_loadIcons(t){const e=this._canvas.getContext("2d",{willReadFrequently:!0});for(const n of t)this._pendingCount++,Me(n.url,this._loadOptions).then((t=>{const i=Ah(n),r=this._mapping[i],{x:o,y:s,width:a,height:l}=r,{data:c,width:u,height:h}=Ch(e,t,a,l);this._texture.setSubImageData({data:c,x:o+(a-u)/2,y:s+(l-h)/2,width:u,height:h}),r.width=u,r.height=h,this._texture.generateMipmap(),this.onUpdate()})).catch((t=>{this.onError({url:n.url,source:n.source,sourceIndex:n.sourceIndex,loadOptions:this._loadOptions,error:t})})).finally((()=>{this._pendingCount--}))}}const kh=[0,0,0,255],Oh={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:kh},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class Ih extends ch{constructor(...t){super(...t),i(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\nuniform int sizeUnits;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), \n    sizeMinPixels, sizeMaxPixels\n  );\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n",fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[bh,xh]})}initializeState(){this.state={iconManager:new Lh(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:kh},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(t){super.updateState(t);const{props:e,oldProps:n,changeFlags:i}=t,r=this.getAttributeManager(),{iconAtlas:o,iconMapping:s,data:a,getIcon:l,textureParameters:c}=e,{iconManager:u}=this.state,h=o||this.internalState.isAsyncPropLoading("iconAtlas");if(u.setProps({loadOptions:e.loadOptions,autoPacking:!h,iconAtlas:o,iconMapping:h?s:null,textureParameters:c}),h?n.iconMapping!==e.iconMapping&&r.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&u.packIcons(a,l),i.extensionsChanged){var d;const{gl:t}=this.context;null===(d=this.state.model)||void 0===d||d.delete(),this.state.model=this._getModel(t),r.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(t){super.finalizeState(t),this.state.iconManager.finalize()}draw({uniforms:t}){const{sizeScale:e,sizeMinPixels:n,sizeMaxPixels:i,sizeUnits:r,billboard:o,alphaCutoff:s}=this.props,{iconManager:a}=this.state,l=a.getTexture();l&&this.state.model.setUniforms(t).setUniforms({iconsTexture:l,iconsTextureDim:[l.width,l.height],sizeUnits:si[r],sizeScale:e,sizeMinPixels:n,sizeMaxPixels:i,billboard:o,alphaCutoff:s}).draw()}_getModel(t){return new xu(t,{...this.getShaders(),id:this.props.id,geometry:new Sh({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(t){var e;const n=null===(e=this.getCurrentLayer())||void 0===e?void 0:e.props.onIconError;n?n(t):R.error(t.error.message)()}getInstanceOffset(t){const{width:e,height:n,anchorX:i=e/2,anchorY:r=n/2}=this.state.iconManager.getIconMapping(t);return[e/2-i,n/2-r]}getInstanceColorMode(t){return this.state.iconManager.getIconMapping(t).mask?1:0}getInstanceIconFrame(t){const{x:e,y:n,width:i,height:r}=this.state.iconManager.getIconMapping(t);return[e,n,i,r]}}i(Ih,"defaultProps",Oh),i(Ih,"layerName","IconLayer");const Rh=[0,0,0,255],Nh={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:Rh},getLineColor:{type:"accessor",value:Rh},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class zh extends ch{getShaders(){return super.getShaders({vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\nuniform bool antialiasing;\nuniform bool billboard;\nuniform int radiusUnits;\nuniform int lineWidthUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),\n    radiusMinPixels, radiusMaxPixels\n  );\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;\n  unitPosition = edgePadding * positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  if (billboard) {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n    vec3 offset = edgePadding * positions * outerRadiusPixels;\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\nuniform bool antialiasing;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = antialiasing ? \n    smoothedge(distToCenter, outerRadiusPixels) : \n    step(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  if (stroked > 0.5) {\n    float isLine = antialiasing ? \n      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\n      step(innerUnitRadius * outerRadiusPixels, distToCenter);\n\n    if (filled) {\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n    }\n  } else if (filled) {\n    gl_FragColor = vFillColor;\n  } else {\n    discard;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[bh,xh]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(t){if(super.updateState(t),t.changeFlags.extensionsChanged){var e;const{gl:t}=this.context;null===(e=this.state.model)||void 0===e||e.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{radiusUnits:e,radiusScale:n,radiusMinPixels:i,radiusMaxPixels:r,stroked:o,filled:s,billboard:a,antialiasing:l,lineWidthUnits:c,lineWidthScale:u,lineWidthMinPixels:h,lineWidthMaxPixels:d}=this.props;this.state.model.setUniforms(t).setUniforms({stroked:o?1:0,filled:s,billboard:a,antialiasing:l,radiusUnits:si[e],radiusScale:n,radiusMinPixels:i,radiusMaxPixels:r,lineWidthUnits:si[c],lineWidthScale:u,lineWidthMinPixels:h,lineWidthMaxPixels:d}).draw()}_getModel(t){return new xu(t,{...this.getShaders(),id:this.props.id,geometry:new Sh({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}}}),isInstanced:!0})}}i(zh,"defaultProps",Nh),i(zh,"layerName","ScatterplotLayer");const Fh=.75,Dh=[];class jh extends Ih{constructor(...t){super(...t),i(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float sdfBuffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(t,{index:e,target:n})=>this.encodePickingColor(e,n)}})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;let{outlineColor:i}=e;i!==n.outlineColor&&(i=i.map((t=>t/255)),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!e.sdf&&e.outlineWidth&&R.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(t){const{sdf:e,smoothing:n,outlineWidth:i}=this.props,{outlineColor:r}=this.state,o=i?Math.max(n,Fh*(1-i)):-1;if(t.uniforms={...t.uniforms,sdfBuffer:Fh,outlineBuffer:o,gamma:n,sdf:Boolean(e),outlineColor:r},super.draw(t),e&&i){const{iconManager:t}=this.state;t.getTexture()&&this.state.model.draw({uniforms:{outlineBuffer:Fh}})}}getInstanceOffset(t){return t?Array.from(t).flatMap((t=>super.getInstanceOffset(t))):Dh}getInstanceColorMode(t){return 1}getInstanceIconFrame(t){return t?Array.from(t).flatMap((t=>super.getInstanceIconFrame(t))):Dh}}i(jh,"defaultProps",{getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}}),i(jh,"layerName","MultiIconLayer");const Bh=1e20;class Uh{constructor({fontSize:t=24,buffer:e=3,radius:n=8,cutoff:i=.25,fontFamily:r="sans-serif",fontWeight:o="normal",fontStyle:s="normal"}={}){this.buffer=e,this.cutoff=i,this.radius=n;const a=this.size=t+4*e,l=this._createCanvas(a),c=this.ctx=l.getContext("2d",{willReadFrequently:!0});c.font=`${s} ${o} ${t}px ${r}`,c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:i,actualBoundingBoxLeft:r,actualBoundingBoxRight:o}=this.ctx.measureText(t),s=Math.ceil(n),a=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-r))),l=Math.min(this.size-this.buffer,s+Math.ceil(i)),c=a+2*this.buffer,u=l+2*this.buffer,h=Math.max(c*u,0),d=new Uint8ClampedArray(h),f={data:d,width:c,height:u,glyphWidth:a,glyphHeight:l,glyphTop:s,glyphLeft:0,glyphAdvance:e};if(0===a||0===l)return f;const{ctx:p,buffer:g,gridInner:m,gridOuter:v}=this;p.clearRect(g,g,a,l),p.fillText(t,g,g+s);const y=p.getImageData(g,g,a,l);v.fill(Bh,0,h),m.fill(0,0,h);for(let t=0;t<l;t++)for(let e=0;e<a;e++){const n=y.data[4*(t*a+e)+3]/255;if(0===n)continue;const i=(t+g)*c+e+g;if(1===n)v[i]=0,m[i]=Bh;else{const t=.5-n;v[i]=t>0?t*t:0,m[i]=t<0?t*t:0}}Vh(v,0,0,c,u,c,this.f,this.v,this.z),Vh(m,g,g,a,l,c,this.f,this.v,this.z);for(let t=0;t<h;t++){const e=Math.sqrt(v[t])-Math.sqrt(m[t]);d[t]=Math.round(255-255*(e/this.radius+this.cutoff))}return f}}function Vh(t,e,n,i,r,o,s,a,l){for(let c=e;c<e+i;c++)Wh(t,n*o+c,o,r,s,a,l);for(let c=n;c<n+r;c++)Wh(t,c*o+e,1,i,s,a,l)}function Wh(t,e,n,i,r,o,s){o[0]=0,s[0]=-Bh,s[1]=Bh,r[0]=t[e];for(let a=1,l=0,c=0;a<i;a++){r[a]=t[e+a*n];const i=a*a;do{const t=o[l];c=(r[a]-r[t]+i-t*t)/(a-t)/2}while(c<=s[l]&&--l>-1);l++,o[l]=a,s[l]=c,s[l+1]=Bh}for(let a=0,l=0;a<i;a++){for(;s[l+1]<a;)l++;const i=o[l],c=a-i;t[e+a*n]=r[i]+c*c}}const Gh=[];function Hh(t,e,n,i){let r=0;for(let s=e;s<n;s++){var o;r+=(null===(o=i[t[s]])||void 0===o?void 0:o.layoutWidth)||0}return r}function qh(t,e,n,i,r,o){let s=e,a=0;for(let l=e;l<n;l++){const e=Hh(t,l,l+1,r);a+e>i&&(s<l&&o.push(l),s=l,a=0),a+=e}return a}function Xh(t,e,n,i,r=0,o){void 0===o&&(o=t.length);const s=[];return"break-all"===e?qh(t,r,o,n,i,s):function(t,e,n,i,r,o){let s=e,a=e,l=e,c=0;for(let u=e;u<n;u++)if(" "===t[u]?l=u+1:" "!==t[u+1]&&u+1!==n||(l=u+1),l>a){let e=Hh(t,a,l,r);c+e>i&&(s<a&&(o.push(a),s=a,c=0),e>i&&(e=qh(t,a,l,i,r,o),s=o[o.length-1])),a=l,c+=e}}(t,r,o,n,i,s),s}function Zh(t,e,n,i,r,o){let s=0,a=0;for(let o=e;o<n;o++){const e=t[o],n=i[e];n?(a||(a=n.layoutHeight),r[o]=s+n.layoutWidth/2,s+=n.layoutWidth):(R.warn("Missing character: ".concat(e," (").concat(e.codePointAt(0),")"))(),r[o]=s,s+=32)}o[0]=s,o[1]=a}class Yh{constructor(t=5){i(this,"limit",void 0),i(this,"_cache",{}),i(this,"_order",[]),this.limit=t}get(t){const e=this._cache[t];return e&&(this._deleteOrder(t),this._appendOrder(t)),e}set(t,e){this._cache[t]?(this.delete(t),this._cache[t]=e,this._appendOrder(t)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[t]=e,this._appendOrder(t))}delete(t){this._cache[t]&&(delete this._cache[t],this._deleteOrder(t))}_deleteOrder(t){const e=this._order.indexOf(t);e>=0&&this._order.splice(e,1)}_appendOrder(t){this._order.push(t)}}const Kh={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:function(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1};let Qh=new Yh(3);function $h(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function Jh(t,e,n,i){t.font="".concat(i," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}class td{constructor(){i(this,"props",{...Kh}),i(this,"_key",void 0),i(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:t,buffer:e}=this.props;return(1.2*t+2*e)/t}setProps(t={}){Object.assign(this.props,t),this._key=this._getKey();const e=function(t,e){let n;n="string"==typeof e?new Set(Array.from(e)):new Set(e);const i=Qh.get(t);if(!i)return n;for(const t in i.mapping)n.has(t)&&n.delete(t);return n}(this._key,this.props.characterSet),n=Qh.get(this._key);if(n&&0===e.size)return void(this._atlas!==n&&(this._atlas=n));const i=this._generateFontAtlas(e,n);this._atlas=i,Qh.set(this._key,i)}_generateFontAtlas(t,e){const{fontFamily:n,fontWeight:i,fontSize:r,buffer:o,sdf:s,radius:a,cutoff:l}=this.props;let c=e&&e.data;c||(c=document.createElement("canvas"),c.width=1024);const u=c.getContext("2d",{willReadFrequently:!0});Jh(u,n,r,i);const{mapping:h,canvasHeight:d,xOffset:f,yOffset:p}=function({characterSet:t,getFontWidth:e,fontHeight:n,buffer:i,maxCanvasWidth:r,mapping:o={},xOffset:s=0,yOffset:a=0}){let l=0,c=s;const u=n+2*i;for(const s of t)if(!o[s]){const t=e(s);c+t+2*i>r&&(c=0,l++),o[s]={x:c+i,y:a+l*u+i,width:t,height:u,layoutWidth:t,layoutHeight:n},c+=t+2*i}return{mapping:o,xOffset:c,yOffset:a+l*u,canvasHeight:(h=a+(l+1)*u,Math.pow(2,Math.ceil(Math.log2(h))))};var h}({getFontWidth:t=>u.measureText(t).width,fontHeight:1.2*r,buffer:o,characterSet:t,maxCanvasWidth:1024,...e&&{mapping:e.mapping,xOffset:e.xOffset,yOffset:e.yOffset}});if(c.height!==d){const t=u.getImageData(0,0,c.width,c.height);c.height=d,u.putImageData(t,0,0)}if(Jh(u,n,r,i),s){const e=new Uh({fontSize:r,buffer:o,radius:a,cutoff:l,fontFamily:n,fontWeight:"".concat(i)});for(const n of t){const{data:t,width:i,height:o,glyphTop:s}=e.draw(n);h[n].width=i,h[n].layoutOffsetY=.9*r-s;const a=u.createImageData(i,o);$h(t,a),u.putImageData(a,h[n].x,h[n].y)}}else for(const e of t)u.fillText(e,h[e].x,h[e].y+o+.9*r);return{xOffset:f,yOffset:p,mapping:h,data:c,width:c.width,height:c.height}}_getKey(){const{fontFamily:t,fontWeight:e,fontSize:n,buffer:i,sdf:r,radius:o,cutoff:s}=this.props;return r?"".concat(t," ").concat(e," ").concat(n," ").concat(i," ").concat(o," ").concat(s):"".concat(t," ").concat(e," ").concat(n," ").concat(i)}}const ed={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class nd extends ch{constructor(...t){super(...t),i(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\nuniform int sizeUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[bh,xh]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(t){super.updateState(t);const{changeFlags:e}=t;if(e.extensionsChanged){var n;const{gl:t}=this.context;null===(n=this.state.model)||void 0===n||n.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{billboard:e,sizeScale:n,sizeUnits:i,sizeMinPixels:r,sizeMaxPixels:o,getLineWidth:s}=this.props;let{padding:a}=this.props;a.length<4&&(a=[a[0],a[1],a[0],a[1]]),this.state.model.setUniforms(t).setUniforms({billboard:e,stroked:Boolean(s),padding:a,sizeUnits:si[i],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:o}).draw()}_getModel(t){return new xu(t,{...this.getShaders(),id:this.props.id,geometry:new Sh({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0})}}i(nd,"defaultProps",ed),i(nd,"layerName","TextBackgroundLayer");const id={start:1,middle:0,end:-1},rd={top:1,center:0,bottom:-1},od=[0,0,0,255],sd={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:od},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:Kh.characterSet},fontFamily:Kh.fontFamily,fontWeight:Kh.fontWeight,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:od},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:od},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class ad extends yh{constructor(...t){super(...t),i(this,"state",void 0),i(this,"getBoundingRect",((t,e)=>{let{size:[n,i]}=this.transformParagraph(t,e);const{fontSize:r}=this.state.fontAtlasManager.props;n/=r,i/=r;const{getTextAnchor:o,getAlignmentBaseline:s}=this.props;return[(id["function"==typeof o?o(t,e):o]-1)*n/2,(rd["function"==typeof s?s(t,e):s]-1)*i/2,n,i]})),i(this,"getIconOffsets",((t,e)=>{const{getTextAnchor:n,getAlignmentBaseline:i}=this.props,{x:r,y:o,rowWidth:s,size:[a,l]}=this.transformParagraph(t,e),c=id["function"==typeof n?n(t,e):n],u=rd["function"==typeof i?i(t,e):i],h=r.length,d=new Array(2*h);let f=0;for(let t=0;t<h;t++){const e=(1-c)*(a-s[t])/2;d[f++]=(c-1)*a/2+e+r[t],d[f++]=(u-1)*l/2+o[t]}return d}))}initializeState(){this.state={styleVersion:0,fontAtlasManager:new td},this.props.maxWidth>0&&R.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(t){const{props:e,oldProps:n,changeFlags:i}=t;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||e.lineHeight!==n.lineHeight||e.wordBreak!==n.wordBreak||e.maxWidth!==n.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:t}){return t.object=t.index>=0?this.props.data[t.index]:null,t}_updateFontAtlas(){const{fontSettings:t,fontFamily:e,fontWeight:n}=this.props,{fontAtlasManager:i,characterSet:r}=this.state,o={...t,characterSet:r,fontFamily:e,fontWeight:n};if(!i.mapping)return i.setProps(o),!0;for(const t in o)if(o[t]!==i.props[t])return i.setProps(o),!0;return!1}_updateText(){var t;const{data:e,characterSet:n}=this.props,i=null===(t=e.attributes)||void 0===t?void 0:t.getText;let r,{getText:o}=this.props,s=e.startIndices;const a="auto"===n&&new Set;if(i&&s){const{texts:t,characterCount:n}=function({value:t,length:e,stride:n,offset:i,startIndices:r,characterSet:o}){const s=t.BYTES_PER_ELEMENT,a=n?n/s:1,l=i?i/s:0,c=r[e]||Math.ceil((t.length-l)/a),u=o&&new Set,h=new Array(e);let d=t;if(a>1||l>0){d=new(0,t.constructor)(c);for(let e=0;e<c;e++)d[e]=t[e*a+l]}for(let t=0;t<e;t++){const e=r[t],n=r[t+1]||c,i=d.subarray(e,n);h[t]=String.fromCodePoint.apply(null,i),u&&i.forEach(u.add,u)}if(u)for(const t of u)o.add(String.fromCodePoint(t));return{texts:h,characterCount:c}}({...ArrayBuffer.isView(i)?{value:i}:i,length:e.length,startIndices:s,characterSet:a});r=n,o=(e,{index:n})=>t[n]}else{const{iterable:t,objectInfo:n}=Rc(e);s=[0],r=0;for(const e of t){n.index++;const t=Array.from(o(e,n)||"");a&&t.forEach(a.add,a),r+=t.length,s.push(r)}}this.setState({getText:o,startIndices:s,numInstances:r,characterSet:a||n})}transformParagraph(t,e){const{fontAtlasManager:n}=this.state,i=n.mapping,r=this.state.getText,{wordBreak:o,lineHeight:s,maxWidth:a}=this.props;return function(t,e,n,i,r){const o=Array.from(t),s=o.length,a=new Array(s),l=new Array(s),c=new Array(s),u=("break-word"===n||"break-all"===n)&&isFinite(i)&&i>0,h=[0,0],d=[0,0];let f=0,p=0,g=0;for(let t=0;t<=s;t++){const v=o[t];if("\n"!==v&&t!==s||(g=t),g>p){const t=u?Xh(o,n,i,r,p,g):Gh;for(let n=0;n<=t.length;n++){const i=0===n?p:t[n-1],s=n<t.length?t[n]:g;Zh(o,i,s,r,a,d);for(let t=i;t<s;t++){var m;const e=(null===(m=r[o[t]])||void 0===m?void 0:m.layoutOffsetY)||0;l[t]=f+d[1]/2+e,c[t]=d[0]}f+=d[1]*e,h[0]=Math.max(h[0],d[0])}p=g}"\n"===v&&(a[p]=0,l[p]=0,c[p]=0,p++)}return h[1]=f,{x:a,y:l,rowWidth:c,size:h}}(r(t,e)||"",s,o,a*n.props.fontSize,i)}renderLayers(){const{startIndices:t,numInstances:e,getText:n,fontAtlasManager:{scale:i,texture:r,mapping:o},styleVersion:s}=this.state,{data:a,_dataDiff:l,getPosition:c,getColor:u,getSize:h,getAngle:d,getPixelOffset:f,getBackgroundColor:p,getBorderColor:g,getBorderWidth:m,backgroundPadding:v,background:y,billboard:_,fontSettings:b,outlineWidth:w,outlineColor:x,sizeScale:E,sizeUnits:S,sizeMinPixels:P,sizeMaxPixels:T,transitions:C,updateTriggers:A}=this.props,M=this.getSubLayerClass("characters",jh),L=this.getSubLayerClass("background",nd);return[y&&new L({getFillColor:p,getLineColor:g,getLineWidth:m,padding:v,getPosition:c,getSize:h,getAngle:d,getPixelOffset:f,billboard:_,sizeScale:E,sizeUnits:S,sizeMinPixels:P,sizeMaxPixels:T,transitions:C&&{getPosition:C.getPosition,getAngle:C.getAngle,getSize:C.getSize,getFillColor:C.getBackgroundColor,getLineColor:C.getBorderColor,getLineWidth:C.getBorderWidth,getPixelOffset:C.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:A.getPosition,getAngle:A.getAngle,getSize:A.getSize,getFillColor:A.getBackgroundColor,getLineColor:A.getBorderColor,getLineWidth:A.getBorderWidth,getPixelOffset:A.getPixelOffset,getBoundingRect:{getText:A.getText,getTextAnchor:A.getTextAnchor,getAlignmentBaseline:A.getAlignmentBaseline,styleVersion:s}}}),{data:a.attributes&&a.attributes.background?{length:a.length,attributes:a.attributes.background}:a,_dataDiff:l,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new M({sdf:b.sdf,smoothing:Number.isFinite(b.smoothing)?b.smoothing:Kh.smoothing,outlineWidth:w/(b.radius||Kh.radius),outlineColor:x,iconAtlas:r,iconMapping:o,getPosition:c,getColor:u,getSize:h,getAngle:d,getPixelOffset:f,billboard:_,sizeScale:E*i,sizeUnits:S,sizeMinPixels:P*i,sizeMaxPixels:T*i,transitions:C&&{getPosition:C.getPosition,getAngle:C.getAngle,getColor:C.getColor,getSize:C.getSize,getPixelOffset:C.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:A.getText,getPosition:A.getPosition,getAngle:A.getAngle,getColor:A.getColor,getSize:A.getSize,getPixelOffset:A.getPixelOffset,getIconOffsets:{getTextAnchor:A.getTextAnchor,getAlignmentBaseline:A.getAlignmentBaseline,styleVersion:s}}}),{data:a,_dataDiff:l,startIndices:t,numInstances:e,getIconOffsets:this.getIconOffsets,getIcon:n})]}static set fontAtlasCacheLimit(t){!function(t){R.assert(Number.isFinite(t)&&t>=3,"Invalid cache limit"),Qh=new Yh(t)}(t)}}i(ad,"defaultProps",sd),i(ad,"layerName","TextLayer");class ld{constructor(t){i(this,"opts",void 0),i(this,"typedArrayManager",void 0),i(this,"indexStarts",[0]),i(this,"vertexStarts",[0]),i(this,"vertexCount",0),i(this,"instanceCount",0),i(this,"attributes",void 0),i(this,"_attributeDefs",void 0),i(this,"data",void 0),i(this,"getGeometry",void 0),i(this,"geometryBuffer",void 0),i(this,"buffers",void 0),i(this,"positionSize",void 0),i(this,"normalize",void 0);const{attributes:e={}}=t;this.typedArrayManager=Oe,this.attributes={},this._attributeDefs=e,this.opts=t,this.updateGeometry(t)}updateGeometry(t){Object.assign(this.opts,t);const{data:e,buffers:n={},getGeometry:i,geometryBuffer:r,positionFormat:o,dataChanged:s,normalize:a=!0}=this.opts;if(this.data=e,this.getGeometry=i,this.positionSize=r&&r.size||("XY"===o?2:3),this.buffers=n,this.normalize=a,r&&(ia(e.startIndices),this.getGeometry=this.getGeometryFromBuffer(r),a||(n.positions=r)),this.geometryBuffer=n.positions,Array.isArray(s))for(const t of s)this._rebuildGeometry(t);else this._rebuildGeometry()}updatePartialGeometry({startRow:t,endRow:e}){this._rebuildGeometry({startRow:t,endRow:e})}getGeometryFromBuffer(t){const e=t.value||t;return ArrayBuffer.isView(e)?zc(e,{size:this.positionSize,offset:t.offset,stride:t.stride,startIndices:this.data.startIndices}):null}_allocate(t,e){const{attributes:n,buffers:i,_attributeDefs:r,typedArrayManager:o}=this;for(const s in r)if(s in i)o.release(n[s]),n[s]=null;else{const i=r[s];i.copy=e,n[s]=o.allocate(n[s],t,i)}}_forEachGeometry(t,e,n){const{data:i,getGeometry:r}=this,{iterable:o,objectInfo:s}=Rc(i,e,n);for(const e of o)s.index++,t(r?r(e,s):null,s.index)}_rebuildGeometry(t){if(!this.data)return;let{indexStarts:e,vertexStarts:n,instanceCount:i}=this;const{data:r,geometryBuffer:o}=this,{startRow:s=0,endRow:a=1/0}=t||{},l={};if(t||(e=[0],n=[0]),this.normalize||!o)this._forEachGeometry(((t,e)=>{const i=t&&this.normalizeGeometry(t);l[e]=i,n[e+1]=n[e]+(i?this.getGeometrySize(i):0)}),s,a),i=n[n.length-1];else if(n=r.startIndices,i=n[r.length]||0,ArrayBuffer.isView(o))i=i||o.length/this.positionSize;else if(o instanceof yo){const t=o.accessor.stride||4*this.positionSize;i=i||o.byteLength/t}else if(o.buffer){const t=o.stride||4*this.positionSize;i=i||o.buffer.byteLength/t}else if(o.value){const t=o.value,e=o.stride/t.BYTES_PER_ELEMENT||this.positionSize;i=i||t.length/e}this._allocate(i,Boolean(t)),this.indexStarts=e,this.vertexStarts=n,this.instanceCount=i;const c={};this._forEachGeometry(((t,r)=>{const o=l[r]||t;c.vertexStart=n[r],c.indexStart=e[r];const s=r<n.length-1?n[r+1]:i;c.geometrySize=s-n[r],c.geometryIndex=r,this.updateGeometryAttributes(o,c)}),s,a),this.vertexCount=e[e.length-1]}}function cd(t,e,n={}){const i=function(t,e={}){return Math.sign(function(t,e={}){const{start:n=0,end:i=t.length}=e,r=e.size||2;let o=0;for(let e=n,s=i-r;e<i;e+=r)o+=(t[e]-t[s])*(t[e+1]+t[s+1]),s=e;return o/2}(t,e))}(t,n);return i!==e&&(function(t,e){const{start:n=0,end:i=t.length,size:r=2}=e,o=(i-n)/r,s=Math.floor(o/2);for(let e=0;e<s;++e){const i=n+e*r,s=n+(o-1-e)*r;for(let e=0;e<r;++e){const n=t[i+e];t[i+e]=t[s+e],t[s+e]=n}}}(t,n),!0)}function ud(t,e,n,i,r=[]){let o,s;if(8&n)o=(i[3]-t[1])/(e[1]-t[1]),s=3;else if(4&n)o=(i[1]-t[1])/(e[1]-t[1]),s=1;else if(2&n)o=(i[2]-t[0])/(e[0]-t[0]),s=2;else{if(!(1&n))return null;o=(i[0]-t[0])/(e[0]-t[0]),s=0}for(let n=0;n<t.length;n++)r[n]=(1&s)===n?i[s]:o*(e[n]-t[n])+t[n];return r}function hd(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function dd(t,e){const n=e.length,i=t.length;if(i>0){let r=!0;for(let o=0;o<n;o++)if(t[i-n+o]!==e[o]){r=!1;break}if(r)return!1}for(let r=0;r<n;r++)t[i+r]=e[r];return!0}function fd(t,e){const n=e.length;for(let i=0;i<n;i++)t[i]=e[i]}function pd(t,e,n,i,r=[]){const o=i+e*n;for(let e=0;e<n;e++)r[e]=t[o+e];return r}function gd(t,e){const{size:n=2,broken:i=!1,gridResolution:r=10,gridOffset:o=[0,0],startIndex:s=0,endIndex:a=t.length}=e||{},l=(a-s)/n;let c=[];const u=[c],h=pd(t,0,n,s);let d,f;const p=bd(h,r,o,[]),g=[];dd(c,h);for(let e=1;e<l;e++){for(d=pd(t,e,n,s,d),f=hd(d,p);f;){ud(h,d,f,p,g);const t=hd(g,p);t&&(ud(h,g,t,p,g),f=t),dd(c,g),fd(h,g),wd(p,r,f),i&&c.length>n&&(c=[],u.push(c),dd(c,h)),f=hd(d,p)}dd(c,d),fd(h,d)}return i?u:u[0]}const md=0;function vd(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function yd(t,e=null,n){if(!t.length)return[];const{size:i=2,gridResolution:r=10,gridOffset:o=[0,0],edgeTypes:s=!1}=n||{},a=[],l=[{pos:t,types:s?new Array(t.length/i).fill(1):null,holes:e||[]}],c=[[],[]];let u=[];for(;l.length;){const{pos:t,types:e,holes:n}=l.shift();xd(t,i,n[0]||t.length,c),u=bd(c[0],r,o,u);const h=hd(c[1],u);if(h){let r=_d(t,e,i,0,n[0]||t.length,u,h);const o={pos:r[0].pos,types:r[0].types,holes:[]},a={pos:r[1].pos,types:r[1].types,holes:[]};l.push(o,a);for(let l=0;l<n.length;l++)r=_d(t,e,i,n[l],n[l+1]||t.length,u,h),r[0]&&(o.holes.push(o.pos.length),o.pos=vd(o.pos,r[0].pos),s&&(o.types=vd(o.types,r[0].types))),r[1]&&(a.holes.push(a.pos.length),a.pos=vd(a.pos,r[1].pos),s&&(a.types=vd(a.types,r[1].types)))}else{const i={positions:t};s&&(i.edgeTypes=e),n.length&&(i.holeIndices=n),a.push(i)}}return a}function _d(t,e,n,i,r,o,s){const a=(r-i)/n,l=[],c=[],u=[],h=[],d=[];let f,p,g;const m=pd(t,a-1,n,i);let v=Math.sign(8&s?m[1]-o[3]:m[0]-o[2]),y=e&&e[a-1],_=0,b=0;for(let r=0;r<a;r++)f=pd(t,r,n,i,f),p=Math.sign(8&s?f[1]-o[3]:f[0]-o[2]),g=e&&e[i/n+r],p&&v&&v!==p&&(ud(m,f,s,o,d),dd(l,d)&&u.push(y),dd(c,d)&&h.push(y)),p<=0?(dd(l,f)&&u.push(g),_-=p):u.length&&(u[u.length-1]=md),p>=0?(dd(c,f)&&h.push(g),b+=p):h.length&&(h[h.length-1]=md),fd(m,f),v=p,y=g;return[_?{pos:l,types:e&&u}:null,b?{pos:c,types:e&&h}:null]}function bd(t,e,n,i){const r=Math.floor((t[0]-n[0])/e)*e+n[0],o=Math.floor((t[1]-n[1])/e)*e+n[1];return i[0]=r,i[1]=o,i[2]=r+e,i[3]=o+e,i}function wd(t,e,n){8&n?(t[1]+=e,t[3]+=e):4&n?(t[1]-=e,t[3]-=e):2&n?(t[0]+=e,t[2]+=e):1&n&&(t[0]-=e,t[2]-=e)}function xd(t,e,n,i){let r=1/0,o=-1/0,s=1/0,a=-1/0;for(let i=0;i<n;i+=e){const e=t[i],n=t[i+1];r=e<r?e:r,o=e>o?e:o,s=n<s?n:s,a=n>a?n:a}return i[0][0]=r,i[0][1]=s,i[1][0]=o,i[1][1]=a,i}function Ed(t,e,n,i){let r=-1,o=-1;for(let s=n+1;s<i;s+=e){const e=Math.abs(t[s]);e>r&&(r=e,o=s-1)}return o}function Sd(t,e,n,i,r=85.051129){const o=t[n],s=t[i-e];if(Math.abs(o-s)>180){const i=pd(t,0,e,n);i[0]+=360*Math.round((s-o)/360),dd(t,i),i[1]=Math.sign(i[1])*r,dd(t,i),i[0]=o,dd(t,i)}}function Pd(t,e,n,i){let r,o=t[0];for(let s=n;s<i;s+=e){r=t[s];const e=r-o;(e>180||e<-180)&&(r-=360*Math.round(e/360)),t[s]=o=r}}function Td(t,e){let n;const i=t.length/e;for(let r=0;r<i&&(n=t[r*e],(n+180)%360==0);r++);const r=360*-Math.round(n/360);if(0!==r)for(let n=0;n<i;n++)t[n*e]+=r}class Cd extends ld{constructor(t){super({...t,attributes:{positions:{size:3,padding:18,initialize:!0,type:t.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(t){return this.attributes[t]}getGeometryFromBuffer(t){return this.normalize?super.getGeometryFromBuffer(t):null}normalizeGeometry(t){return this.normalize?function(t,e,n,i){let r;if(Array.isArray(t[0])){const n=t.length*e;r=new Array(n);for(let n=0;n<t.length;n++)for(let i=0;i<e;i++)r[n*e+i]=t[n][i]||0}else r=t;return n?gd(r,{size:e,gridResolution:n}):i?function(t,e){const{size:n=2,startIndex:i=0,endIndex:r=t.length,normalize:o=!0}=e||{},s=t.slice(i,r);Pd(s,n,0,r-i);const a=gd(s,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(const t of a)Td(t,n);return a}(r,{size:e}):r}(t,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):t}getGeometrySize(t){if(Ad(t)){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}const e=this.getPathLength(t);return e<2?0:this.isClosed(t)?e<3?0:e+2:e}updateGeometryAttributes(t,e){if(0!==e.geometrySize)if(t&&Ad(t))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t}else this._updateSegmentTypes(t,e),this._updatePositions(t,e)}_updateSegmentTypes(t,e){const n=this.attributes.segmentTypes,i=!!t&&this.isClosed(t),{vertexStart:r,geometrySize:o}=e;n.fill(0,r,r+o),i?(n[r]=4,n[r+o-2]=4):(n[r]+=1,n[r+o-2]+=2),n[r+o-1]=4}_updatePositions(t,e){const{positions:n}=this.attributes;if(!n||!t)return;const{vertexStart:i,geometrySize:r}=e,o=new Array(3);for(let e=i,s=0;s<r;e++,s++)this.getPointOnPath(t,s,o),n[3*e]=o[0],n[3*e+1]=o[1],n[3*e+2]=o[2]}getPathLength(t){return t.length/this.positionSize}getPointOnPath(t,e,n=[]){const{positionSize:i}=this;e*i>=t.length&&(e+=1-t.length/i);const r=e*i;return n[0]=t[r],n[1]=t[r+1],n[2]=3===i&&t[r+2]||0,n}isClosed(t){if(!this.normalize)return Boolean(this.opts.loop);const{positionSize:e}=this,n=t.length-e;return t[0]===t[n]&&t[1]===t[n+1]&&(2===e||t[2]===t[n+2])}}function Ad(t){return Array.isArray(t[0])}const Md=[0,0,0,255],Ld={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:Md},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},kd={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class Od extends ch{constructor(...t){super(...t),i(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute float instanceTypes;\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec3 instanceLeftPositions;\nattribute vec3 instanceRightPositions;\nattribute vec3 instanceLeftPositions64Low;\nattribute vec3 instanceStartPositions64Low;\nattribute vec3 instanceEndPositions64Low;\nattribute vec3 instanceRightPositions64Low;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float capType;\nuniform float miterLimit;\nuniform bool billboard;\nuniform int widthUnits;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\nvec3 getLineJoinOffset(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  vec2 width\n) {\n  bool isEnd = positions.x > 0.0;\n  float sideOfPath = positions.y;\n  float isJoint = float(sideOfPath == 0.0);\n\n  vec3 deltaA3 = (currPoint - prevPoint);\n  vec3 deltaB3 = (nextPoint - currPoint);\n\n  mat3 rotationMatrix;\n  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\n  if (needsRotation) {\n    deltaA3 = deltaA3 * rotationMatrix;\n    deltaB3 = deltaB3 * rotationMatrix;\n  }\n  vec2 deltaA = deltaA3.xy / width;\n  vec2 deltaB = deltaB3.xy / width;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n  vec2 tangent = dirA + dirB;\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  vec2 dir = isEnd ? dirA : dirB;\n  vec2 perp = isEnd ? perpA : perpB;\n  float L = isEnd ? lenA : lenB;\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\n  float cornerPosition = sideOfPath * turnDirection;\n\n  float miterSize = 1.0 / max(sinHalfA, EPSILON);\n  miterSize = mix(\n    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\n    miterSize,\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n    * (sideOfPath + isJoint * turnDirection);\n  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\n  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\n  bool isCap = isStartCap || isEndCap;\n  if (isCap) {\n    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);\n    vJointType = capType;\n  } else {\n    vJointType = jointType;\n  }\n  vPathLength = L;\n  vCornerOffset = offsetVec;\n  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);\n  vMiterLength = isCap ? isJoint : vMiterLength;\n\n  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\n  vPathPosition = vec2(\n    dot(offsetFromStartOfPath, perp),\n    dot(offsetFromStartOfPath, dir)\n  );\n  geometry.uv = vPathPosition;\n\n  float isValid = step(instanceTypes, 3.5);\n  vec3 offset = vec3(offsetVec * width * isValid, 0.0);\n\n  if (needsRotation) {\n    offset = rotationMatrix * offset;\n  }\n  return offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\n  if (position.w < EPSILON) {\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\n    position = refPosition + (position - refPosition) * r;\n  }\n}\n\nvoid main() {\n  geometry.pickingColor = instancePickingColors;\n\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\n  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\n\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\n  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\n\n  geometry.worldPosition = currPosition;\n  vec2 widthPixels = vec2(clamp(\n    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels) / 2.0);\n  vec3 width;\n\n  if (billboard) {\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\n\n    clipLine(prevPositionScreen, currPositionScreen);\n    clipLine(nextPositionScreen, currPositionScreen);\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\n\n    width = vec3(widthPixels, 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 offset = getLineJoinOffset(\n      prevPositionScreen.xyz / prevPositionScreen.w,\n      currPositionScreen.xyz / currPositionScreen.w,\n      nextPositionScreen.xyz / nextPositionScreen.w,\n      project_pixel_size_to_clipspace(width.xy)\n    );\n\n    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);\n    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);\n  } else {\n    prevPosition = project_position(prevPosition, prevPosition64Low);\n    currPosition = project_position(currPosition, currPosition64Low);\n    nextPosition = project_position(nextPosition, nextPosition64Low);\n\n    width = vec3(project_pixel_size(widthPixels), 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);\n    geometry.position = vec4(currPosition + offset, 1.0);\n    gl_Position = project_common_position_to_clipspace(geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float miterLimit;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nvoid main(void) {\n  geometry.uv = vPathPosition;\n\n  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\n    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\n      discard;\n    }\n    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {\n      discard;\n    }\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[bh,xh]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:kd,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:kd,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:kd,defaultValue:Md},instancePickingColors:{size:3,type:5121,accessor:(t,{index:e,target:n})=>this.encodePickingColor(t&&t.__source?t.__source.index:e,n)}}),this.setState({pathTesselator:new Cd({fp64:this.use64bitPositions()})})}updateState(t){super.updateState(t);const{props:e,changeFlags:n}=t,i=this.getAttributeManager();if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPath)){const{pathTesselator:t}=this.state,r=e.data.attributes||{};t.updateGeometry({data:e.data,geometryBuffer:r.getPath,buffers:r,normalize:!e._pathType,loop:"loop"===e._pathType,getGeometry:e.getPath,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:n.dataChanged}),this.setState({numInstances:t.instanceCount,startIndices:t.vertexStarts}),n.dataChanged||i.invalidateAll()}if(n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),i.invalidateAll()}}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,{data:i}=this.props;return i[0]&&i[0].__source&&(e.object=i.find((t=>t.__source.index===n))),e}disablePickingIndex(t){const{data:e}=this.props;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else super.disablePickingIndex(t)}draw({uniforms:t}){const{jointRounded:e,capRounded:n,billboard:i,miterLimit:r,widthUnits:o,widthScale:s,widthMinPixels:a,widthMaxPixels:l}=this.props;this.state.model.setUniforms(t).setUniforms({jointType:Number(e),capType:Number(n),billboard:i,widthUnits:si[o],widthScale:s,miterLimit:r,widthMinPixels:a,widthMaxPixels:l}).draw()}_getModel(t){return new xu(t,{...this.getShaders(),id:this.props.id,geometry:new Sh({drawMode:4,attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0})}calculatePositions(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateSegmentTypes(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("segmentTypes")}}i(Od,"defaultProps",Ld),i(Od,"layerName","PathLayer");const Id="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",Rd={lightSources:{}};function Nd(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.map((t=>t*e/255))}const zd={};const Fd={name:"gouraud-lighting",dependencies:[{name:"lights",vs:Id,fs:Id,getUniforms:function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Rd;if("lightSources"in e){const{ambientLight:t,pointLights:n,directionalLights:i}=e.lightSources||{};return t||n&&n.length>0||i&&i.length>0?Object.assign({},function(t){let{ambientLight:e,pointLights:n=[],directionalLights:i=[]}=t;const r={};return r["lighting_uAmbientLight.color"]=e?Nd(e):[0,0,0],n.forEach(((t,e)=>{r["lighting_uPointLight[".concat(e,"].color")]=Nd(t),r["lighting_uPointLight[".concat(e,"].position")]=t.position,r["lighting_uPointLight[".concat(e,"].attenuation")]=t.attenuation||[1,0,0]})),r.lighting_uPointLightCount=n.length,i.forEach(((t,e)=>{r["lighting_uDirectionalLight[".concat(e,"].color")]=Nd(t),r["lighting_uDirectionalLight[".concat(e,"].direction")]=t.direction})),r.lighting_uDirectionalLightCount=i.length,r}({ambientLight:t,pointLights:n,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in e){const n={pointLights:[],directionalLights:[]};for(const t of e.lights||[])switch(t.type){case"ambient":n.ambientLight=t;break;case"directional":n.directionalLights.push(t);break;case"point":n.pointLights.push(t)}return t({lightSources:n})}return{}},defines:{MAX_LIGHTS:3}}],vs:"\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",defines:{LIGHTING_VERTEX:1},getUniforms:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zd;if(!("material"in t))return{};const{material:e}=t;return e?function(t){const{ambient:e=.35,diffuse:n=.6,shininess:i=32,specularColor:r=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:i,lighting_uSpecularColor:r.map((t=>t/255))}}(e):{lighting_uEnabled:!1}}};var Dd=n(187),jd=n.n(Dd);const Bd={isClosed:!0};function Ud(t){return"positions"in t?t.positions:t}function Vd(t){return"holeIndices"in t?t.holeIndices:null}function Wd(t,e,n,i,r){let o=e;const s=n.length;for(let e=0;e<s;e++)for(let r=0;r<i;r++)t[o++]=n[e][r]||0;if(!function(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}(n))for(let e=0;e<i;e++)t[o++]=n[0][e]||0;return Bd.start=e,Bd.end=o,Bd.size=i,cd(t,r,Bd),o}function Gd(t,e,n,i,r=0,o,s){const a=(o=o||n.length)-r;if(a<=0)return e;let l=e;for(let e=0;e<a;e++)t[l++]=n[r+e];if(!function(t,e,n,i){for(let r=0;r<e;r++)if(t[n+r]!==t[i-e+r])return!1;return!0}(n,i,r,o))for(let e=0;e<i;e++)t[l++]=n[r+e];return Bd.start=e,Bd.end=l,Bd.size=i,cd(t,s,Bd),l}function Hd(t,e,n){const i=t.length/3;let r=0;for(let o=0;o<i;o++){const s=(o+1)%i;r+=t[3*o+e]*t[3*s+n],r-=t[3*s+e]*t[3*o+n]}return Math.abs(r/2)}function qd(t,e,n,i){const r=t.length/3;for(let o=0;o<r;o++){const r=3*o,s=t[r+0],a=t[r+1],l=t[r+2];t[r+e]=s,t[r+n]=a,t[r+i]=l}}class Xd extends ld{constructor(t){const{fp64:e,IndexType:n=Uint32Array}=t;super({...t,attributes:{positions:{size:3,type:e?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:n,size:1}}})}get(t){const{attributes:e}=this;return"indices"===t?e.indices&&e.indices.subarray(0,this.vertexCount):e[t]}updateGeometry(t){super.updateGeometry(t);const e=this.buffers.indices;if(e)this.vertexCount=(e.value||e).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(t){if(this.normalize){const e=function(t,e){!function(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}(t);const n=[],i=[];if("positions"in t){const{positions:r,holeIndices:o}=t;if(o){let t=0;for(let s=0;s<=o.length;s++)t=Gd(n,t,r,e,o[s-1],o[s],0===s?1:-1),i.push(t);return i.pop(),{positions:n,holeIndices:i}}t=r}if(!function(t){return Array.isArray(t[0])}(t))return Gd(n,0,t,e,0,n.length,1),n;if(!function(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}(t)){let r=0;for(const[o,s]of t.entries())r=Wd(n,r,s,e,0===o?1:-1),i.push(r);return i.pop(),{positions:n,holeIndices:i}}return Wd(n,0,t,e,1),n}(t,this.positionSize);return this.opts.resolution?yd(Ud(e),Vd(e),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?function(t,e=null,n){const{size:i=2,normalize:r=!0,edgeTypes:o=!1}=n||{};e=e||[];const s=[],a=[];let l=0,c=0;for(let r=0;r<=e.length;r++){const o=e[r]||t.length,u=c,h=Ed(t,i,l,o);for(let e=h;e<o;e++)s[c++]=t[e];for(let e=l;e<h;e++)s[c++]=t[e];Pd(s,i,u,c),Sd(s,i,u,c,null==n?void 0:n.maxLatitude),l=o,a[r]=c}a.pop();const u=yd(s,a,{size:i,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(r)for(const t of u)Td(t.positions,i);return u}(Ud(e),Vd(e),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):e}return t}getGeometrySize(t){if(Zd(t)){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}return Ud(t).length/this.positionSize}getGeometryFromBuffer(t){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(t):null}updateGeometryAttributes(t,e){if(t&&Zd(t))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t,e.indexStart=this.indexStarts[e.geometryIndex+1]}else this._updateIndices(t,e),this._updatePositions(t,e),this._updateVertexValid(t,e)}_updateIndices(t,{geometryIndex:e,vertexStart:n,indexStart:i}){const{attributes:r,indexStarts:o,typedArrayManager:s}=this;let a=r.indices;if(!a||!t)return;let l=i;const c=function(t,e,n,i){let r=Vd(t);r&&(r=r.map((t=>t/e)));let o=Ud(t);const s=i&&3===e;if(n){const t=o.length;o=o.slice();const i=[];for(let r=0;r<t;r+=e){i[0]=o[r],i[1]=o[r+1],s&&(i[2]=o[r+2]);const t=n(i);o[r]=t[0],o[r+1]=t[1],s&&(o[r+2]=t[2])}}if(s){const t=Hd(o,0,1),e=Hd(o,0,2),i=Hd(o,1,2);if(!t&&!e&&!i)return[];t>e&&t>i||(e>i?(n||(o=o.slice()),qd(o,0,2,1)):(n||(o=o.slice()),qd(o,2,0,1)))}return jd()(o,r,e)}(t,this.positionSize,this.opts.preproject,this.opts.full3d);a=s.allocate(a,i+c.length,{copy:!0});for(let t=0;t<c.length;t++)a[l++]=c[t]+n;o[e+1]=i+c.length,r.indices=a}_updatePositions(t,{vertexStart:e,geometrySize:n}){const{attributes:{positions:i},positionSize:r}=this;if(!i||!t)return;const o=Ud(t);for(let t=e,s=0;s<n;t++,s++){const e=o[s*r],n=o[s*r+1],a=r>2?o[s*r+2]:0;i[3*t]=e,i[3*t+1]=n,i[3*t+2]=a}}_updateVertexValid(t,{vertexStart:e,geometrySize:n}){const{positionSize:i}=this,r=this.attributes.vertexValid,o=t&&Vd(t);if(t&&t.edgeTypes?r.set(t.edgeTypes,e):r.fill(1,e,e+n),o)for(let t=0;t<o.length;t++)r[e+o[t]/i-1]=0;r[e+n-1]=0}}function Zd(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const Yd="\nattribute vec2 vertexPositions;\nattribute float vertexValid;\n\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\n\nstruct PolygonProps {\n  vec4 fillColors;\n  vec4 lineColors;\n  vec3 positions;\n  vec3 nextPositions;\n  vec3 pickingColors;\n  vec3 positions64Low;\n  vec3 nextPositions64Low;\n  float elevations;\n};\n\nvec3 project_offset_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    return normalize(vector * project_uCommonUnitsPerWorldUnit);\n  }\n  return project_normal(vector);\n}\n\nvoid calculatePosition(PolygonProps props) {\n#ifdef IS_SIDE_VERTEX\n  if(vertexValid < 0.5){\n    gl_Position = vec4(0.);\n    return;\n  }\n#endif\n\n  vec3 pos;\n  vec3 pos64Low;\n  vec3 normal;\n  vec4 colors = isWireframe ? props.lineColors : props.fillColors;\n\n  geometry.worldPosition = props.positions;\n  geometry.worldPositionAlt = props.nextPositions;\n  geometry.pickingColor = props.pickingColors;\n\n#ifdef IS_SIDE_VERTEX\n  pos = mix(props.positions, props.nextPositions, vertexPositions.x);\n  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);\n#else\n  pos = props.positions;\n  pos64Low = props.positions64Low;\n#endif\n\n  if (extruded) {\n    pos.z += props.elevations * vertexPositions.y * elevationScale;\n  }\n  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  if (extruded) {\n  #ifdef IS_SIDE_VERTEX\n    normal = vec3(\n      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),\n      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),\n      0.0);\n    normal = project_offset_normal(normal);\n  #else\n    normal = project_normal(vec3(0.0, 0.0, 1.0));\n  #endif\n    geometry.normal = normal;\n    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);\n    vColor = vec4(lightColor, colors.a * opacity);\n  } else {\n    vColor = vec4(colors.rgb, colors.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",Kd="#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\n".concat(Yd,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = positions;\n  props.positions64Low = positions64Low;\n  props.elevations = elevations;\n  props.fillColors = fillColors;\n  props.lineColors = lineColors;\n  props.pickingColors = pickingColors;\n\n  calculatePosition(props);\n}\n"),Qd="#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\n\n\nattribute vec3 instancePositions;\nattribute vec3 nextPositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 nextPositions64Low;\nattribute float instanceElevations;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\n".concat(Yd,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  #if RING_WINDING_ORDER_CW == 1\n    props.positions = instancePositions;\n    props.positions64Low = instancePositions64Low;\n    props.nextPositions = nextPositions;\n    props.nextPositions64Low = nextPositions64Low;\n  #else\n    props.positions = nextPositions;\n    props.positions64Low = nextPositions64Low;\n    props.nextPositions = instancePositions;\n    props.nextPositions64Low = instancePositions64Low;\n  #endif\n  props.elevations = instanceElevations;\n  props.fillColors = instanceFillColors;\n  props.lineColors = instanceLineColors;\n  props.pickingColors = instancePickingColors;\n\n  calculatePosition(props);\n}\n"),$d=[0,0,0,255],Jd={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:$d},getLineColor:{type:"accessor",value:$d},material:!0},tf={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class ef extends ch{constructor(...t){super(...t),i(this,"state",void 0)}getShaders(t){return super.getShaders({vs:"top"===t?Kd:Qd,fs:"#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[bh,Fd,xh]})}get wrapLongitude(){return!1}initializeState(){const{gl:t,viewport:e}=this.context;let{coordinateSystem:n}=this.props;const{_full3d:i}=this.props;let r;e.isGeospatial&&n===ri.DEFAULT&&(n=ri.LNGLAT),n===ri.LNGLAT&&(r=i?e.projectPosition.bind(e):e.projectFlat.bind(e)),this.setState({numInstances:0,polygonTesselator:new Xd({preproject:r,fp64:this.use64bitPositions(),IndexType:!t||Wo(t,Bo)?Uint32Array:Uint16Array})});const o=this.getAttributeManager(),s=!0;o.remove(["instancePickingColors"]),o.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:s},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:tf,accessor:"getPolygon",update:this.calculatePositions,noAlloc:s,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:s},elevations:{size:1,transition:tf,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:tf,accessor:"getFillColor",defaultValue:$d,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:tf,accessor:"getLineColor",defaultValue:$d,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(t,{index:e,target:n})=>this.encodePickingColor(t&&t.__source?t.__source.index:e,n),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,{data:i}=this.props;return i[0]&&i[0].__source&&(e.object=i.find((t=>t.__source.index===n))),e}disablePickingIndex(t){const{data:e}=this.props;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else super.disablePickingIndex(t)}draw({uniforms:t}){const{extruded:e,filled:n,wireframe:i,elevationScale:r}=this.props,{topModel:o,sideModel:s,polygonTesselator:a}=this.state,l={...t,extruded:Boolean(e),elevationScale:r};s&&(s.setInstanceCount(a.instanceCount-1),s.setUniforms(l),i&&(s.setDrawMode(3),s.setUniforms({isWireframe:!0}).draw()),n&&(s.setDrawMode(6),s.setUniforms({isWireframe:!1}).draw())),o&&(o.setVertexCount(a.vertexCount),o.setUniforms(l).draw())}updateState(t){super.updateState(t),this.updateGeometry(t);const{props:e,oldProps:n,changeFlags:i}=t,r=this.getAttributeManager();var o;(i.extensionsChanged||e.filled!==n.filled||e.extruded!==n.extruded)&&(null===(o=this.state.models)||void 0===o||o.forEach((t=>t.delete())),this.setState(this._getModels(this.context.gl)),r.invalidateAll())}updateGeometry({props:t,oldProps:e,changeFlags:n}){if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon)){const{polygonTesselator:e}=this.state,i=t.data.attributes||{};e.updateGeometry({data:t.data,normalize:t._normalize,geometryBuffer:i.getPolygon,buffers:i,getGeometry:t.getPolygon,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:n.dataChanged,full3d:t._full3d}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),n.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(t){const{id:e,filled:n,extruded:i}=this.props;let r,o;if(n){const n=this.getShaders("top");n.defines.NON_INSTANCED_MODEL=1,r=new xu(t,{...n,id:"".concat(e,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(o=new xu(t,{...this.getShaders("side"),id:"".concat(e,"-side"),geometry:new Sh({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),o.userData.excludeAttributes={indices:!0}),{models:[o,r].filter(Boolean),topModel:r,sideModel:o}}calculateIndices(t){const{polygonTesselator:e}=this.state;t.startIndices=e.indexStarts,t.value=e.get("indices")}calculatePositions(t){const{polygonTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateVertexValid(t){t.value=this.state.polygonTesselator.get("vertexValid")}}i(ef,"defaultProps",Jd),i(ef,"layerName","SolidPolygonLayer");const nf={circle:{type:zh,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:Ih,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:ad,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},rf={type:Od,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},of={type:ef,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function sf({type:t,props:e}){const n={};for(const i in e)n[i]=t.defaultProps[e[i]];return n}function af(t,e){const{transitions:n,updateTriggers:i}=t.props,r={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const o in e){const s=e[o];let a=t.props[o];o.startsWith("get")&&(a=t.getSubLayerAccessor(a),r.updateTriggers[s]=i[o],n&&(r.transitions[s]=n[o])),r[s]=a}return r}function lf(t,e,n={}){const i={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:r=0,endRow:o=t.length}=n;for(let n=r;n<o;n++){const r=t[n],{geometry:o}=r;if(o)if("GeometryCollection"===o.type){R.assert(Array.isArray(o.geometries),"GeoJSON does not have geometries array");const{geometries:t}=o;for(let o=0;o<t.length;o++)cf(t[o],i,e,r,n)}else cf(o,i,e,r,n)}return i}function cf(t,e,n,i,r){const{type:o,coordinates:s}=t,{pointFeatures:a,lineFeatures:l,polygonFeatures:c,polygonOutlineFeatures:u}=e;if(function(t,e){let n=uf[t];for(R.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}(o,s))switch(o){case"Point":a.push(n({geometry:t},i,r));break;case"MultiPoint":s.forEach((t=>{a.push(n({geometry:{type:"Point",coordinates:t}},i,r))}));break;case"LineString":l.push(n({geometry:t},i,r));break;case"MultiLineString":s.forEach((t=>{l.push(n({geometry:{type:"LineString",coordinates:t}},i,r))}));break;case"Polygon":c.push(n({geometry:t},i,r)),s.forEach((t=>{u.push(n({geometry:{type:"LineString",coordinates:t}},i,r))}));break;case"MultiPolygon":s.forEach((t=>{c.push(n({geometry:{type:"Polygon",coordinates:t}},i,r)),t.forEach((t=>{u.push(n({geometry:{type:"LineString",coordinates:t}},i,r))}))}))}else R.warn("".concat(o," coordinates are malformed"))()}const uf={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function hf(t){return t.geometry.coordinates}const df=["points","linestrings","polygons"],ff={...sf(nf.circle),...sf(nf.icon),...sf(nf.text),...sf(rf),...sf(of),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class pf extends yh{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:t,changeFlags:e}){if(!e.dataChanged)return;const{data:n}=this.props,i=n&&"points"in n&&"polygons"in n&&"lines"in n;this.setState({binary:i}),i?this._updateStateBinary({props:t,changeFlags:e}):this._updateStateJSON({props:t,changeFlags:e})}_updateStateBinary({props:t,changeFlags:e}){const n=function(t,e){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{points:i,lines:r,polygons:o}=t,s=function(t,e){const n={points:null,lines:null,polygons:null};for(const i in n){const r=t[i].globalFeatureIds.value;n[i]=new Uint8ClampedArray(3*r.length);const o=[];for(let t=0;t<r.length;t++)e(r[t],o),n[i][3*t+0]=o[0],n[i][3*t+1]=o[1],n[i][3*t+2]=o[2]}return n}(t,e);return n.points.data={length:i.positions.value.length/i.positions.size,attributes:{...i.attributes,getPosition:i.positions,instancePickingColors:{size:3,value:s.points}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines.data={length:r.pathIndices.value.length-1,startIndices:r.pathIndices.value,attributes:{...r.attributes,getPath:r.positions,instancePickingColors:{size:3,value:s.lines}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines._pathType="open",n.polygons.data={length:o.polygonIndices.value.length-1,startIndices:o.polygonIndices.value,attributes:{...o.attributes,getPolygon:o.positions,pickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygons._normalize=!1,o.triangles&&(n.polygons.data.attributes.indices=o.triangles.value),n.polygonsOutline.data={length:o.primitivePolygonIndices.value.length-1,startIndices:o.primitivePolygonIndices.value,attributes:{...o.attributes,getPath:o.positions,instancePickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygonsOutline._pathType="open",n}(t.data,this.encodePickingColor);this.setState({layerProps:n})}_updateStateJSON({props:t,changeFlags:e}){const n=function(t){if(Array.isArray(t))return t;switch(R.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return R.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}(t.data),i=this.getSubLayerRow.bind(this);let r={};const o={};if(Array.isArray(e.dataChanged)){const t=this.state.features;for(const e in t)r[e]=t[e].slice(),o[e]=[];for(const s of e.dataChanged){const e=lf(n,i,s);for(const n in t)o[n].push(_h({data:r[n],getIndex:t=>t.__source.index,dataRange:s,replace:e[n]}))}}else r=lf(n,i);const s=function(t,e){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{pointFeatures:i,lineFeatures:r,polygonFeatures:o,polygonOutlineFeatures:s}=t;return n.points.data=i,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=hf,n.lines.data=r,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=hf,n.polygons.data=o,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=hf,n.polygonsOutline.data=s,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=hf,n}(r,o);this.setState({features:r,featuresDiff:o,layerProps:s})}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n,sourceLayer:i}=e;return e.featureType=df.find((t=>i.id.startsWith("".concat(this.id,"-").concat(t,"-")))),n>=0&&i.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(e.index=this.props.data.points.globalFeatureIds.value[n]),e}_updateAutoHighlight(t){const e="".concat(this.id,"-points-"),n="points"===t.featureType;for(const i of this.getSubLayers())i.id.startsWith(e)===n&&i.updateAutoHighlight(t)}_renderPolygonLayer(){const{extruded:t,wireframe:e}=this.props,{layerProps:n}=this.state,i="polygons-fill",r=this.shouldRenderSubLayer(i,n.polygons.data)&&this.getSubLayerClass(i,of.type);if(r){const o=af(this,of.props),s=t&&e;return s||delete o.getLineColor,o.updateTriggers.lineColors=s,new r(o,this.getSubLayerProps({id:i,updateTriggers:o.updateTriggers}),n.polygons)}return null}_renderLineLayers(){const{extruded:t,stroked:e}=this.props,{layerProps:n}=this.state,i="polygons-stroke",r="linestrings",o=!t&&e&&this.shouldRenderSubLayer(i,n.polygonsOutline.data)&&this.getSubLayerClass(i,rf.type),s=this.shouldRenderSubLayer(r,n.lines.data)&&this.getSubLayerClass(r,rf.type);if(o||s){const t=af(this,rf.props);return[o&&new o(t,this.getSubLayerProps({id:i,updateTriggers:t.updateTriggers}),n.polygonsOutline),s&&new s(t,this.getSubLayerProps({id:r,updateTriggers:t.updateTriggers}),n.lines)]}return null}_renderPointLayers(){const{pointType:t}=this.props,{layerProps:e,binary:n}=this.state;let{highlightedObjectIndex:i}=this.props;!n&&Number.isFinite(i)&&(i=e.points.data.findIndex((t=>t.__source.index===i)));const r=new Set(t.split("+")),o=[];for(const t of r){const r="points-".concat(t),s=nf[t],a=s&&this.shouldRenderSubLayer(r,e.points.data)&&this.getSubLayerClass(r,s.type);if(a){const l=af(this,s.props);let c=e.points;if("text"===t&&n){const{instancePickingColors:t,...e}=c.data.attributes;c={...c,data:{...c.data,attributes:e}}}o.push(new a(l,this.getSubLayerProps({id:r,updateTriggers:l.updateTriggers,highlightedObjectIndex:i}),c))}}return o}renderLayers(){const{extruded:t}=this.props,e=this._renderPolygonLayer();return[!t&&e,this._renderLineLayers(),this._renderPointLayers(),t&&e]}getSubLayerAccessor(t){const{binary:e}=this.state;return e&&"function"==typeof t?(e,n)=>{const{data:i,index:r}=n,o=function(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,i=t.featureIds.value[n];return-1!==n?function(t,e,n){const i={properties:{...t.properties[e]}};for(const e in t.numericProps)i.properties[e]=t.numericProps[e].value[n];return i}(t,i,n):null}(i,r);return t(o,n)}:super.getSubLayerAccessor(t)}}function gf(){let t;if("undefined"!=typeof window&&window.performance)t=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const e=process.hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}i(pf,"layerName","GeoJsonLayer"),i(pf,"defaultProps",ff);class mf{constructor(t,e){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=t,this.type=e,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=gf(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(gf()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class vf{constructor(t){this.id=void 0,this.stats={},this.id=t.id,this.stats={},this._initializeStats(t.stats),Object.seal(this)}get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:t,type:e})}get size(){return Object.keys(this.stats).length}reset(){for(const t of Object.values(this.stats))t.reset();return this}forEach(t){for(const e of Object.values(this.stats))t(e)}getTable(){const t={};return this.forEach((e=>{t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}})),t}_initializeStats(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((t=>this._getOrCreate(t)))}_getOrCreate(t){const{name:e,type:n}=t;let i=this.stats[e];return i||(i=t instanceof mf?t:new mf(e,n),this.stats[e]=i),i}}const yf={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class _f{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,"props",void 0),i(this,"stats",void 0),i(this,"activeRequestCount",0),i(this,"requestQueue",[]),i(this,"requestMap",new Map),i(this,"deferredUpdate",null),this.props={...yf,...t},this.stats=new vf({id:this.props.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever")}scheduleRequest(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(t))return this.requestMap.get(t);const n={handle:t,priority:0,getPriority:e},i=new Promise((t=>(n.resolve=t,n)));return this.requestQueue.push(n),this.requestMap.set(t,i),this._issueNewRequests(),i}_issueRequest(t){const{handle:e,resolve:n}=t;let i=!1;const r=()=>{i||(i=!0,this.requestMap.delete(e),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,n?n({done:r}):Promise.resolve({done:r})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout((()=>this._issueNewRequestsAsync()),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const t=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==t){this._updateAllRequests();for(let e=0;e<t;++e){const t=this.requestQueue.shift();t&&this._issueRequest(t)}}}_updateAllRequests(){const t=this.requestQueue;for(let e=0;e<t.length;++e){const n=t[e];this._updateRequest(n)||(t.splice(e,1),this.requestMap.delete(n.handle),e--)}t.sort(((t,e)=>t.priority-e.priority))}_updateRequest(t){return t.priority=t.getPriority(t.handle),!(t.priority<0&&(t.resolve(null),1))}}class bf{constructor(t){i(this,"index",void 0),i(this,"isVisible",void 0),i(this,"isSelected",void 0),i(this,"parent",void 0),i(this,"children",void 0),i(this,"content",void 0),i(this,"state",void 0),i(this,"layers",void 0),i(this,"id",void 0),i(this,"zoom",void 0),i(this,"userData",void 0),i(this,"boundingBox",void 0),i(this,"_abortController",void 0),i(this,"_loader",void 0),i(this,"_loaderId",void 0),i(this,"_isLoaded",void 0),i(this,"_isCancelled",void 0),i(this,"_needsReload",void 0),i(this,"_bbox",void 0),this.index=t,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(t){this._bbox||(this._bbox=t,this.boundingBox="west"in t?[[t.west,t.south],[t.east,t.north]]:[[t.left,t.top],[t.right,t.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then((()=>this.data)):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return Boolean(this._loader)&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const t=this.content?this.content.byteLength:0;return Number.isFinite(t)||console.error("byteLength not defined in tile data"),t}async _loadData({getData:t,requestScheduler:e,onLoad:n,onError:i}){const{index:r,id:o,bbox:s,userData:a,zoom:l}=this,c=this._loaderId;this._abortController=new AbortController;const{signal:u}=this._abortController,h=await e.scheduleRequest(this,(t=>t.isSelected?1:-1));if(!h)return void(this._isCancelled=!0);if(this._isCancelled)return void h.done();let d,f=null;try{f=await t({index:r,id:o,bbox:s,userData:a,zoom:l,signal:u})}catch(t){d=t||!0}finally{h.done()}c===this._loaderId&&(this._loader=void 0,this.content=f,!this._isCancelled||f?(this._isLoaded=!0,this._isCancelled=!1,d?i(d,this):n(this)):this._isLoaded=!1)}loadData(t){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(t),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var t;this.isLoaded||(this._isCancelled=!0,null===(t=this._abortController)||void 0===t||t.abort())}}const wf=Math.PI/180,xf=180/Math.PI,Ef=6370972,Sf=256;function Pf(){const t=4018225162502676e-20,e=Math.PI/180*Sf;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[24886.609375,24886.609375,24886.609375],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,24886.609375]}}class Tf extends di{constructor(t={}){const{latitude:e=0,longitude:n=0,zoom:r=0,nearZMultiplier:o=.1,farZMultiplier:s=2,resolution:a=10}=t;let{height:l,altitude:c=1.5}=t;l=l||1,c=Math.max(.75,c);const u=(new Ln).lookAt({eye:[0,-c,0],up:[0,0,1]}),h=Math.pow(2,r);u.rotateX(e*wf),u.rotateZ(-n*wf),u.scale(h/l);const d=Math.atan(.5/c),f=512*h/l;super({...t,height:l,viewMatrix:u,longitude:n,latitude:e,zoom:r,distanceScales:Pf(),fovyRadians:2*d,focalDistance:c,near:o,far:Math.min(2,1/f+1)*c*s}),i(this,"longitude",void 0),i(this,"latitude",void 0),i(this,"resolution",void 0),this.latitude=e,this.longitude=n,this.resolution=a}get projectionMode(){return oi.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(t={}){const e={targetZ:t.z||0},n=this.unproject([0,this.height/2],e),i=this.unproject([this.width/2,0],e),r=this.unproject([this.width,this.height/2],e),o=this.unproject([this.width/2,this.height],e);return r[0]<this.longitude&&(r[0]+=360),n[0]>this.longitude&&(n[0]-=360),[Math.min(n[0],r[0],i[0],o[0]),Math.min(n[1],r[1],i[1],o[1]),Math.max(n[0],r[0],i[0],o[0]),Math.max(n[1],r[1],i[1],o[1])]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[i,r,o]=t,s=e?r:this.height-r,{pixelUnprojectionMatrix:a}=this;let l;if(Number.isFinite(o))l=Cf(a,[i,s,o,1]);else{const t=Cf(a,[i,s,-1,1]),e=Cf(a,[i,s,1,1]),r=((n||0)/Ef+1)*Sf,o=en(Je([],t,e)),c=en(t),u=en(e),h=(4*c*u-(o-c-u)**2)/16*4/o;l=function(t,e,n,i){var r=e[0],o=e[1],s=e[2];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=s+i*(n[2]-s),t}([],t,e,(Math.sqrt(c-h)-Math.sqrt(Math.max(0,r*r-h)))/Math.sqrt(o))}const[c,u,h]=this.unprojectPosition(l);return Number.isFinite(o)?[c,u,h]:Number.isFinite(n)?[c,u,n]:[c,u]}projectPosition(t){const[e,n,i=0]=t,r=e*wf,o=n*wf,s=Math.cos(o),a=(i/Ef+1)*Sf;return[Math.sin(r)*s*a,-Math.cos(r)*s*a,Math.sin(o)*a]}unprojectPosition(t){const[e,n,i]=t,r=tn(t),o=Math.asin(i/r);return[Math.atan2(e,-n)*xf,o*xf,(r/Sf-1)*Ef]}projectFlat(t){return t}unprojectFlat(t){return t}panByPosition(t,e){const n=this.unproject(e);return{longitude:t[0]-n[0]+this.longitude,latitude:t[1]-n[1]+this.latitude}}}function Cf(t,e){const n=Sn([],e,t);return En(n,n,1/n[3]),n}const Af=-1,Mf=new an,Lf=new an;class kf{constructor(t=[0,0,0],e=[0,0,0],n){i(this,"center",void 0),i(this,"halfDiagonal",void 0),i(this,"minimum",void 0),i(this,"maximum",void 0),n=n||Mf.copy(t).add(e).scale(.5),this.center=new an(n),this.halfDiagonal=new an(e).subtract(this.center),this.minimum=new an(t),this.maximum=new an(e)}clone(){return new kf(this.minimum,this.maximum,this.center)}equals(t){return this===t||Boolean(t)&&this.minimum.equals(t.minimum)&&this.maximum.equals(t.maximum)}transform(t){return this.center.transformAsPoint(t),this.halfDiagonal.transform(t),this.minimum.transform(t),this.maximum.transform(t),this}intersectPlane(t){const{halfDiagonal:e}=this,n=Lf.from(t.normal),i=e.x*Math.abs(n.x)+e.y*Math.abs(n.y)+e.z*Math.abs(n.z),r=this.center.dot(n)+t.distance;return r-i>0?1:r+i<0?Af:0}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){const e=Mf.from(t).subtract(this.center),{halfDiagonal:n}=this;let i,r=0;return i=Math.abs(e.x)-n.x,i>0&&(r+=i*i),i=Math.abs(e.y)-n.y,i>0&&(r+=i*i),i=Math.abs(e.z)-n.z,i>0&&(r+=i*i),r}}const Of=new an,If=new an;class Rf{constructor(t=[0,0,0],e=0){i(this,"center",void 0),i(this,"radius",void 0),this.radius=-0,this.center=new an,this.fromCenterRadius(t,e)}fromCenterRadius(t,e){return this.center.from(t),this.radius=e,this}fromCornerPoints(t,e){return e=Of.from(e),this.center=(new an).from(t).add(e).scale(.5),this.radius=this.center.distance(e),this}equals(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.radius===t.radius}clone(){return new Rf(this.center,this.radius)}union(t){const e=this.center,n=this.radius,i=t.center,r=t.radius,o=Of.copy(i).subtract(e),s=o.magnitude();if(n>=s+r)return this.clone();if(r>=s+n)return t.clone();const a=.5*(n+s+r);return If.copy(o).scale((-n+a)/s).add(e),this.center.copy(If),this.radius=a,this}expand(t){const e=Of.from(t).subtract(this.center).magnitude();return e>this.radius&&(this.radius=e),this}transform(t){this.center.transform(t);const e=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[4],s=e[5],a=e[6],l=e[8],c=e[9],u=e[10];return t[0]=Math.hypot(n,i,r),t[1]=Math.hypot(o,s,a),t[2]=Math.hypot(l,c,u),t}(Of,t);return this.radius=Math.max(e[0],Math.max(e[1],e[2]))*this.radius,this}distanceSquaredTo(t){const e=this.distanceTo(t);return e*e}distanceTo(t){const e=Of.from(t).subtract(this.center);return Math.max(0,e.len()-this.radius)}intersectPlane(t){const e=this.center,n=this.radius,i=t.normal.dot(e)+t.distance;return i<-n?Af:i<n?0:1}}function Nf(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=n[0],f=n[1],p=n[2],g=n[3],m=n[4],v=n[5],y=n[6],_=n[7],b=n[8];return t[0]=d*i+f*s+p*c,t[1]=d*r+f*a+p*u,t[2]=d*o+f*l+p*h,t[3]=g*i+m*s+v*c,t[4]=g*r+m*a+v*u,t[5]=g*o+m*l+v*h,t[6]=y*i+_*s+b*c,t[7]=y*r+_*a+b*u,t[8]=y*o+_*l+b*h,t}function zf(t,e,n){var i=n[0],r=n[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}var Ff;!function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"}(Ff||(Ff={}));const Df=Object.freeze([1,0,0,0,1,0,0,0,1]);class jf extends fn{static get IDENTITY(){return Uf||(Uf=new jf,Object.freeze(Uf)),Uf}static get ZERO(){return Bf||(Bf=new jf([0,0,0,0,0,0,0,0,0]),Object.freeze(Bf)),Bf}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return Ff}constructor(t,...e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):e.length>0?this.copy([t,...e]):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}identity(){return this.copy(Df)}fromObject(t){return this.check()}fromQuaternion(t){return function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=n+n,a=i+i,l=r+r,c=n*s,u=i*s,h=i*a,d=r*s,f=r*a,p=r*l,g=o*s,m=o*a,v=o*l;t[0]=1-h-p,t[3]=u-v,t[6]=d+m,t[1]=u+v,t[4]=1-c-p,t[7]=f-g,t[2]=d-m,t[5]=f+g,t[8]=1-c-h}(this,t),this.check()}set(t,e,n,i,r,o,s,a,l){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this[4]=r,this[5]=o,this[6]=s,this[7]=a,this[8]=l,this.check()}setRowMajor(t,e,n,i,r,o,s,a,l){return this[0]=t,this[1]=i,this[2]=s,this[3]=e,this[4]=r,this[5]=a,this[6]=n,this[7]=o,this[8]=l,this.check()}determinant(){return e=(t=this)[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],l=t[7],e*((c=t[8])*o-s*l)+n*(-c*r+s*a)+i*(l*r-o*a);var t,e,n,i,r,o,s,a,l,c}transpose(){return function(t,e){if(t===e){var n=e[1],i=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=i,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8]}(this,this),this.check()}invert(){var t,e,n,i,r,o,s,a,l,c,u,h,d,f,p;return t=this,n=(e=this)[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],(p=n*(h=(u=e[8])*s-a*c)+i*(d=-u*o+a*l)+r*(f=c*o-s*l))&&(p=1/p,t[0]=h*p,t[1]=(-u*i+r*c)*p,t[2]=(a*i-r*s)*p,t[3]=d*p,t[4]=(u*n-r*l)*p,t[5]=(-a*n+r*o)*p,t[6]=f*p,t[7]=(-c*n+i*l)*p,t[8]=(s*n-i*o)*p),this.check()}multiplyLeft(t){return Nf(this,t,this),this.check()}multiplyRight(t){return Nf(this,this,t),this.check()}rotate(t){var e,n,i,r,o,s,a,l,c,u,h,d,f,p;return e=this,i=t,r=(n=this)[0],o=n[1],s=n[2],a=n[3],l=n[4],c=n[5],u=n[6],h=n[7],d=n[8],f=Math.sin(i),p=Math.cos(i),e[0]=p*r+f*a,e[1]=p*o+f*l,e[2]=p*s+f*c,e[3]=p*a-f*r,e[4]=p*l-f*o,e[5]=p*c-f*s,e[6]=u,e[7]=h,e[8]=d,this.check()}scale(t){return Array.isArray(t)?zf(this,this,t):zf(this,this,[t,t]),this.check()}translate(t){var e,n,i,r,o,s,a,l,c,u,h,d,f,p;return e=this,i=t,r=(n=this)[0],o=n[1],s=n[2],a=n[3],l=n[4],c=n[5],u=n[6],h=n[7],d=n[8],f=i[0],p=i[1],e[0]=r,e[1]=o,e[2]=s,e[3]=a,e[4]=l,e[5]=c,e[6]=f*r+p*a+u,e[7]=f*o+p*l+h,e[8]=f*s+p*c+d,this.check()}transform(t,e){let n;switch(t.length){case 2:n=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[3]*r+n[6],t[1]=n[1]*i+n[4]*r+n[7],t}(e||[-0,-0],t,this);break;case 3:n=Qe(e||[-0,-0,-0],t,this);break;case 4:n=rn(e||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Ue(n,t.length),n}transformVector(t,e){return this.transform(t,e)}transformVector2(t,e){return this.transform(t,e)}transformVector3(t,e){return this.transform(t,e)}}let Bf,Uf,Vf;class Wf extends We{static get ZERO(){return Vf||(Vf=new Wf(0,0,0,0),Object.freeze(Vf)),Vf}constructor(t=0,e=0,n=0,i=0){super(-0,-0,-0,-0),Ne(t)&&1===arguments.length?this.copy(t):(Ie.debug&&(Be(t),Be(e),Be(n),Be(i)),this[0]=t,this[1]=e,this[2]=n,this[3]=i)}set(t,e,n,i){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return Ie.debug&&(Be(t.x),Be(t.y),Be(t.z),Be(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=Be(t)}get w(){return this[3]}set w(t){this[3]=Be(t)}transform(t){return Ke(this,this,t),this.check()}transformByMatrix3(t){return rn(this,this,t),this.check()}transformByMatrix2(t){return function(t,e,n){const i=e[0],r=e[1];t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2],t[3]=e[3]}(this,this,t),this.check()}transformByQuaternion(t){return $e(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}}function Gf(){var t=new He(4);return He!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Hf(t,e,n){n*=.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function qf(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=n[0],l=n[1],c=n[2],u=n[3];return t[0]=i*u+s*a+r*c-o*l,t[1]=r*u+s*l+o*a-i*c,t[2]=o*u+s*c+i*l-r*a,t[3]=s*u-i*a-r*l-o*c,t}var Xf,Zf,Yf,Kf,Qf=En,$f=function(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.hypot(e,n,i,r)},Jf=function(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r},tp=(Xf=qe(),Zf=Xe(1,0,0),Yf=Xe(0,1,0),function(t,e,n){var i=Ze(e,n);return i<-.999999?(Ye(Xf,Zf,e),tn(Xf)<1e-6&&Ye(Xf,Yf,e),function(t,e){var n=e[0],i=e[1],r=e[2],o=n*n+i*i+r*r;o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o}(Xf,Xf),Hf(t,Xf,Math.PI),t):i>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(Ye(Xf,e,n),t[0]=Xf[0],t[1]=Xf[1],t[2]=Xf[2],t[3]=1+i,function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=n*n+i*i+r*r+o*o;return s>0&&(s=1/Math.sqrt(s)),t[0]=n*s,t[1]=i*s,t[2]=r*s,t[3]=o*s,t}(t,t))});Gf(),Gf(),Kf=new He(9),He!=Float32Array&&(Kf[1]=0,Kf[2]=0,Kf[3]=0,Kf[5]=0,Kf[6]=0,Kf[7]=0),Kf[0]=1,Kf[4]=1,Kf[8]=1;const ep=[0,0,0,1];class np extends je{constructor(t=0,e=0,n=0,i=1){super(-0,-0,-0,-0),Array.isArray(t)&&1===arguments.length?this.copy(t):this.set(t,e,n,i)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,e,n,i){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this.check()}fromObject(t){return this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this.check()}fromMatrix3(t){return function(t,e){var n,i=e[0]+e[4]+e[8];if(i>0)n=Math.sqrt(i+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var o=(r+1)%3,s=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*o+o]-e[3*s+s]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*o+s]-e[3*s+o])*n,t[o]=(e[3*o+r]+e[3*r+o])*n,t[s]=(e[3*s+r]+e[3*r+s])*n}}(this,t),this.check()}fromAxisRotation(t,e){return Hf(this,t,e),this.check()}identity(){return function(t){t[0]=0,t[1]=0,t[2]=0,t[3]=1}(this),this.check()}setAxisAngle(t,e){return this.fromAxisRotation(t,e)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=Be(t)}get y(){return this[1]}set y(t){this[1]=Be(t)}get z(){return this[2]}set z(t){this[2]=Be(t)}get w(){return this[3]}set w(t){this[3]=Be(t)}len(){return $f(this)}lengthSquared(){return Jf(this)}dot(t){return function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}(this,t)}rotationTo(t,e){return tp(this,t,e),this.check()}add(t){return function(t,e,n){t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3]}(this,this,t),this.check()}calculateW(){return function(t,e){var n=e[0],i=e[1],r=e[2];t[0]=n,t[1]=i,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r))}(this,this),this.check()}conjugate(){return function(t,e){t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3]}(this,this),this.check()}invert(){return function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=n*n+i*i+r*r+o*o,a=s?1/s:0;t[0]=-n*a,t[1]=-i*a,t[2]=-r*a,t[3]=o*a}(this,this),this.check()}lerp(t,e,n){return void 0===n?this.lerp(this,t,e):(function(t,e,n,i){var r=e[0],o=e[1],s=e[2],a=e[3];t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=s+i*(n[2]-s),t[3]=a+i*(n[3]-a)}(this,t,e,n),this.check())}multiplyRight(t){return qf(this,this,t),this.check()}multiplyLeft(t){return qf(this,t,this),this.check()}normalize(){const t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,0===t&&(this[3]=1),this.check()}rotateX(t){return function(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);t[0]=i*l+s*a,t[1]=r*l+o*a,t[2]=o*l-r*a,t[3]=s*l-i*a}(this,this,t),this.check()}rotateY(t){return function(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);t[0]=i*l-o*a,t[1]=r*l+s*a,t[2]=o*l+i*a,t[3]=s*l-r*a}(this,this,t),this.check()}rotateZ(t){return function(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);t[0]=i*l+r*a,t[1]=r*l-i*a,t[2]=o*l+s*a,t[3]=s*l-o*a}(this,this,t),this.check()}scale(t){return Qf(this,this,t),this.check()}slerp(t,e,n){let i,r,o;switch(arguments.length){case 1:({start:i=ep,target:r,ratio:o}=t);break;case 2:i=this,r=t,o=e;break;default:i=t,r=e,o=n}return function(t,e,n,i){var r,o,s,a,l,c=e[0],u=e[1],h=e[2],d=e[3],f=n[0],p=n[1],g=n[2],m=n[3];(o=c*f+u*p+h*g+d*m)<0&&(o=-o,f=-f,p=-p,g=-g,m=-m),1-o>Ge?(r=Math.acos(o),s=Math.sin(r),a=Math.sin((1-i)*r)/s,l=Math.sin(i*r)/s):(a=1-i,l=i),t[0]=a*c+l*f,t[1]=a*u+l*p,t[2]=a*h+l*g,t[3]=a*d+l*m}(this,i,r,o),this.check()}transformVector4(t,e=new Wf){return function(t,e,n){var i=e[0],r=e[1],o=e[2],s=n[0],a=n[1],l=n[2],c=n[3],u=c*i+a*o-l*r,h=c*r+l*i-s*o,d=c*o+s*r-a*i,f=-s*i-a*r-l*o;t[0]=u*c+f*-s+h*-l-d*-a,t[1]=h*c+f*-a+d*-s-u*-l,t[2]=d*c+f*-l+u*-a-h*-s,t[3]=e[3]}(e,t,this),Ue(e,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,e){return this.setAxisAngle(t,e)}premultiply(t){return this.multiplyLeft(t)}multiply(t){return this.multiplyRight(t)}}const ip=new an,rp=new an,op=new an,sp=new an,ap=new an,lp=new an,cp=new an;class up{constructor(t=[0,0,0],e=[0,0,0,0,0,0,0,0,0]){i(this,"center",void 0),i(this,"halfAxes",void 0),this.center=(new an).from(t),this.halfAxes=new jf(e)}get halfSize(){const t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new an(t).len(),new an(e).len(),new an(n).len()]}get quaternion(){const t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),i=new an(t).normalize(),r=new an(e).normalize(),o=new an(n).normalize();return(new np).fromMatrix3(new jf([...i,...r,...o]))}fromCenterHalfSizeQuaternion(t,e,n){const i=new np(n),r=(new jf).fromQuaternion(i);return r[0]=r[0]*e[0],r[1]=r[1]*e[0],r[2]=r[2]*e[0],r[3]=r[3]*e[1],r[4]=r[4]*e[1],r[5]=r[5]*e[1],r[6]=r[6]*e[2],r[7]=r[7]*e[2],r[8]=r[8]*e[2],this.center=(new an).from(t),this.halfAxes=r,this}clone(){return new up(this.center,this.halfAxes)}equals(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.halfAxes.equals(t.halfAxes)}getBoundingSphere(t=new Rf){const e=this.halfAxes,n=e.getColumn(0,op),i=e.getColumn(1,sp),r=e.getColumn(2,ap),o=ip.copy(n).add(i).add(r);return t.center.copy(this.center),t.radius=o.magnitude(),t}intersectPlane(t){const e=this.center,n=t.normal,i=this.halfAxes,r=n.x,o=n.y,s=n.z,a=Math.abs(r*i[0]+o*i[1]+s*i[2])+Math.abs(r*i[3]+o*i[4]+s*i[5])+Math.abs(r*i[6]+o*i[7]+s*i[8]),l=n.dot(e)+t.distance;return l<=-a?Af:l>=a?1:0}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){const e=rp.from(t).subtract(this.center),n=this.halfAxes,i=n.getColumn(0,op),r=n.getColumn(1,sp),o=n.getColumn(2,ap),s=i.magnitude(),a=r.magnitude(),l=o.magnitude();i.normalize(),r.normalize(),o.normalize();let c,u=0;return c=Math.abs(e.dot(i))-s,c>0&&(u+=c*c),c=Math.abs(e.dot(r))-a,c>0&&(u+=c*c),c=Math.abs(e.dot(o))-l,c>0&&(u+=c*c),u}computePlaneDistances(t,e,n=[-0,-0]){let i=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;const o=this.center,s=this.halfAxes,a=s.getColumn(0,op),l=s.getColumn(1,sp),c=s.getColumn(2,ap),u=lp.copy(a).add(l).add(c).add(o),h=cp.copy(u).subtract(t);let d=e.dot(h);return i=Math.min(d,i),r=Math.max(d,r),u.copy(o).add(a).add(l).subtract(c),h.copy(u).subtract(t),d=e.dot(h),i=Math.min(d,i),r=Math.max(d,r),u.copy(o).add(a).subtract(l).add(c),h.copy(u).subtract(t),d=e.dot(h),i=Math.min(d,i),r=Math.max(d,r),u.copy(o).add(a).subtract(l).subtract(c),h.copy(u).subtract(t),d=e.dot(h),i=Math.min(d,i),r=Math.max(d,r),o.copy(u).subtract(a).add(l).add(c),h.copy(u).subtract(t),d=e.dot(h),i=Math.min(d,i),r=Math.max(d,r),o.copy(u).subtract(a).add(l).subtract(c),h.copy(u).subtract(t),d=e.dot(h),i=Math.min(d,i),r=Math.max(d,r),o.copy(u).subtract(a).subtract(l).add(c),h.copy(u).subtract(t),d=e.dot(h),i=Math.min(d,i),r=Math.max(d,r),o.copy(u).subtract(a).subtract(l).subtract(c),h.copy(u).subtract(t),d=e.dot(h),i=Math.min(d,i),r=Math.max(d,r),n[0]=i,n[1]=r,n}transform(t){this.center.transformAsPoint(t);const e=this.halfAxes.getColumn(0,op);e.transformAsPoint(t);const n=this.halfAxes.getColumn(1,sp);n.transformAsPoint(t);const i=this.halfAxes.getColumn(2,ap);return i.transformAsPoint(t),this.halfAxes=new jf([...e,...n,...i]),this}getTransform(){throw new Error("not implemented")}}const hp=new an,dp=new an;class fp{constructor(t=[0,0,1],e=0){i(this,"normal",void 0),i(this,"distance",void 0),this.normal=new an,this.distance=-0,this.fromNormalDistance(t,e)}fromNormalDistance(t,e){return Ve(Number.isFinite(e)),this.normal.from(t).normalize(),this.distance=e,this}fromPointNormal(t,e){t=hp.from(t),this.normal.from(e).normalize();const n=-this.normal.dot(t);return this.distance=n,this}fromCoefficients(t,e,n,i){return this.normal.set(t,e,n),Ve(De(this.normal.len(),1)),this.distance=i,this}clone(){return new fp(this.normal,this.distance)}equals(t){return De(this.distance,t.distance)&&De(this.normal,t.normal)}getPointDistance(t){return this.normal.dot(t)+this.distance}transform(t){const e=dp.copy(this.normal).transformAsVector(t).normalize(),n=this.normal.scale(-this.distance).transform(t);return this.fromPointNormal(n,e)}projectPointOntoPlane(t,e=[0,0,0]){t=hp.from(t);const n=this.getPointDistance(t),i=dp.copy(this.normal).scale(n);return t.subtract(i).to(e)}}const pp=[new an([1,0,0]),new an([0,1,0]),new an([0,0,1])],gp=new an,mp=new an;new fp(new an(1,0,0),0);class vp{constructor(t=[]){i(this,"planes",void 0),this.planes=t}fromBoundingSphere(t){this.planes.length=2*pp.length;const e=t.center,n=t.radius;let i=0;for(const t of pp){let r=this.planes[i],o=this.planes[i+1];r||(r=this.planes[i]=new fp),o||(o=this.planes[i+1]=new fp);const s=gp.copy(t).scale(-n).add(e);t.dot(s),r.fromPointNormal(s,t);const a=gp.copy(t).scale(n).add(e),l=mp.copy(t).negate();l.dot(a),o.fromPointNormal(a,l),i+=2}return this}computeVisibility(t){let e=1;for(const n of this.planes)switch(t.intersectPlane(n)){case Af:return Af;case 0:e=0}return e}computeVisibilityWithPlaneMask(t,e){if(Ve(Number.isFinite(e),"parentPlaneMask is required."),e===vp.MASK_OUTSIDE||e===vp.MASK_INSIDE)return e;let n=vp.MASK_INSIDE;const i=this.planes;for(let r=0;r<this.planes.length;++r){const o=r<31?1<<r:0;if(r<31&&0==(e&o))continue;const s=i[r],a=t.intersectPlane(s);if(a===Af)return vp.MASK_OUTSIDE;0===a&&(n|=o)}return n}}i(vp,"MASK_OUTSIDE",4294967295),i(vp,"MASK_INSIDE",0),i(vp,"MASK_INDETERMINATE",2147483647),new an,new an,new an,new an,new an,new an,new an,new an,new an,new an,new an,new an,new an,new an,new an,new an,new an,Math.PI;const yp={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:2*Math.PI},_p=new jf,bp=new jf,wp=new jf,xp=new jf,Ep=new jf;const Sp=[1,0,0],Pp=[2,2,1];function Tp(t){let e=0;for(let n=0;n<3;++n){const i=t[_p.getElementIndex(Pp[n],Sp[n])];e+=2*i*i}return Math.sqrt(e)}function Cp(t,e){const n=yp.EPSILON15;let i=0,r=1;for(let e=0;e<3;++e){const n=Math.abs(t[_p.getElementIndex(Pp[e],Sp[e])]);n>i&&(r=e,i=n)}const o=Sp[r],s=Pp[r];let a=1,l=0;if(Math.abs(t[_p.getElementIndex(s,o)])>n){const e=(t[_p.getElementIndex(s,s)]-t[_p.getElementIndex(o,o)])/2/t[_p.getElementIndex(s,o)];let n;n=e<0?-1/(-e+Math.sqrt(1+e*e)):1/(e+Math.sqrt(1+e*e)),a=1/Math.sqrt(1+n*n),l=n*a}return jf.IDENTITY.to(e),e[_p.getElementIndex(o,o)]=e[_p.getElementIndex(s,s)]=a,e[_p.getElementIndex(s,o)]=l,e[_p.getElementIndex(o,s)]=-l,e}const Ap=new an,Mp=new an,Lp=new an,kp=new an,Op=new an,Ip=new jf,Rp={diagonal:new jf,unitary:new jf},Np=512,zp=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],Fp=zp.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),Dp=Fp.concat([[.25,.5],[.75,.5]]);class jp{constructor(t,e,n){i(this,"x",void 0),i(this,"y",void 0),i(this,"z",void 0),i(this,"childVisible",void 0),i(this,"selected",void 0),i(this,"_children",void 0),this.x=t,this.y=e,this.z=n}get children(){if(!this._children){const t=2*this.x,e=2*this.y,n=this.z+1;this._children=[new jp(t,e,n),new jp(t,e+1,n),new jp(t+1,e,n),new jp(t+1,e+1,n)]}return this._children}update(t){const{viewport:e,cullingVolume:n,elevationBounds:i,minZ:r,maxZ:o,bounds:s,offset:a,project:l}=t,c=this.getBoundingVolume(i,a,l);if(s&&!this.insideBounds(s))return!1;if(n.computeVisibility(c)<0)return!1;if(!this.childVisible){let{z:t}=this;if(t<o&&t>=r){const n=c.distanceTo(e.cameraPosition)*e.scale/e.height;t+=Math.floor(Math.log2(n))}if(t>=o)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const e of this.children)e.update(t);return!0}getSelected(t=[]){if(this.selected&&t.push(this),this._children)for(const e of this._children)e.getSelected(t);return t}insideBounds([t,e,n,i]){const r=Math.pow(2,this.z),o=Np/r;return this.x*o<n&&this.y*o<i&&(this.x+1)*o>t&&(this.y+1)*o>e}getBoundingVolume(t,e,n){if(n){const e=this.z<1?Dp:this.z<2?Fp:zp,i=[];for(const r of e){const e=Xp(this.x+r[0],this.y+r[1],this.z);e[2]=t[0],i.push(n(e)),t[0]!==t[1]&&(e[2]=t[1],i.push(n(e)))}return function(t,e=new up){if(!t||0===t.length)return e.halfAxes=new jf([0,0,0,0,0,0,0,0,0]),e.center=new an,e;const n=t.length,i=new an(0,0,0);for(const e of t)i.add(e);const r=1/n;i.multiplyByScalar(r);let o=0,s=0,a=0,l=0,c=0,u=0;for(const e of t){const t=Ap.copy(e).subtract(i);o+=t.x*t.x,s+=t.x*t.y,a+=t.x*t.z,l+=t.y*t.y,c+=t.y*t.z,u+=t.z*t.z}o*=r,s*=r,a*=r,l*=r,c*=r,u*=r;const h=Ip;h[0]=o,h[1]=s,h[2]=a,h[3]=s,h[4]=l,h[5]=c,h[6]=a,h[7]=c,h[8]=u;const{unitary:d}=function(t,e={}){const n=yp.EPSILON20;let i=0,r=0;const o=bp,s=wp;o.identity(),s.copy(t);const a=n*function(t){let e=0;for(let n=0;n<9;++n){const i=t[n];e+=i*i}return Math.sqrt(e)}(s);for(;r<10&&Tp(s)>a;)Cp(s,xp),Ep.copy(xp).transpose(),s.multiplyRight(xp),s.multiplyLeft(Ep),o.multiplyRight(xp),++i>2&&(++r,i=0);return e.unitary=o.toTarget(e.unitary),e.diagonal=s.toTarget(e.diagonal),e}(h,Rp),f=e.halfAxes.copy(d);let p=f.getColumn(0,Lp),g=f.getColumn(1,kp),m=f.getColumn(2,Op),v=-Number.MAX_VALUE,y=-Number.MAX_VALUE,_=-Number.MAX_VALUE,b=Number.MAX_VALUE,w=Number.MAX_VALUE,x=Number.MAX_VALUE;for(const e of t)Ap.copy(e),v=Math.max(Ap.dot(p),v),y=Math.max(Ap.dot(g),y),_=Math.max(Ap.dot(m),_),b=Math.min(Ap.dot(p),b),w=Math.min(Ap.dot(g),w),x=Math.min(Ap.dot(m),x);p=p.multiplyByScalar(.5*(b+v)),g=g.multiplyByScalar(.5*(w+y)),m=m.multiplyByScalar(.5*(x+_)),e.center.copy(p).add(g).add(m);const E=Mp.set(v-b,y-w,_-x).multiplyByScalar(.5),S=new jf([E[0],0,0,0,E[1],0,0,0,E[2]]);return e.halfAxes.multiplyRight(S),e}(i)}const i=Math.pow(2,this.z),r=Np/i,o=this.x*r+e*Np,s=Np-(this.y+1)*r;return new kf([o,s,t[0]],[o+r,s+r,t[1]])}}const Bp=512,Up=[-1/0,-1/0,1/0,1/0],Vp={type:"object",value:null,validate:(t,e)=>e.optional&&null===t||"string"==typeof t||Array.isArray(t)&&t.every((t=>"string"==typeof t)),equal:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}};function Wp(t,e){const n=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min(...n.map((t=>t[0]))),Math.min(...n.map((t=>t[1]))),Math.max(...n.map((t=>t[0]))),Math.max(...n.map((t=>t[1])))]}function Gp({viewport:t,z:e=0,cullRect:n}){return(t.subViewports||[t]).map((t=>Hp(t,e,n)))}function Hp(t,e,n){if(!Array.isArray(e)){const i=n.x-t.x,r=n.y-t.y,{width:o,height:s}=n,a={targetZ:e},l=t.unproject([i,r],a),c=t.unproject([i+o,r],a),u=t.unproject([i,r+s],a),h=t.unproject([i+o,r+s],a);return[Math.min(l[0],c[0],u[0],h[0]),Math.min(l[1],c[1],u[1],h[1]),Math.max(l[0],c[0],u[0],h[0]),Math.max(l[1],c[1],u[1],h[1])]}const i=Hp(t,e[0],n),r=Hp(t,e[1],n);return[Math.min(i[0],r[0]),Math.min(i[1],r[1]),Math.max(i[2],r[2]),Math.max(i[3],r[3])]}function qp(t,e){return Math.pow(2,t)*Bp/e}function Xp(t,e,n){const i=qp(n,Bp),r=t/i*360-180,o=Math.PI-2*Math.PI*e/i;return[r,180/Math.PI*Math.atan(.5*(Math.exp(o)-Math.exp(-o)))]}function Zp(t,e,n,i){const r=qp(n,i);return[t/r*Bp,e/r*Bp]}function Yp(t,e,n,i,r=Bp){if(t.isGeospatial){const[t,r]=Xp(e,n,i),[o,s]=Xp(e+1,n+1,i);return{west:t,north:r,east:o,south:s}}const[o,s]=Zp(e,n,i,r),[a,l]=Zp(e+1,n+1,i,r);return{left:o,top:s,right:a,bottom:l}}function Kp({viewport:t,maxZoom:e,minZoom:n,zRange:i,extent:r,tileSize:o=Bp,modelMatrix:s,modelMatrixInverse:a,zoomOffset:l=0}){let c=t.isGeospatial?Math.round(t.zoom+Math.log2(Bp/o))+l:Math.ceil(t.zoom)+l;if("number"==typeof n&&Number.isFinite(n)&&c<n){if(!r)return[];c=n}"number"==typeof e&&Number.isFinite(e)&&c>e&&(c=e);let u=r;return s&&a&&r&&!t.isGeospatial&&(u=Wp(r,s)),t.isGeospatial?function(t,e,n,i){const r=t instanceof Tf&&t.resolution?t.projectPosition:null,o=Object.values(t.getFrustumPlanes()).map((({normal:t,distance:e})=>new fp(t.clone().negate(),e))),s=new vp(o),a=t.distanceScales.unitsPerMeter[2],l=n&&n[0]*a||0,c=n&&n[1]*a||0,u=t instanceof oa&&t.pitch<=60?e:0;if(i){const[t,e,n,r]=i,o=Xn([t,r]),s=Xn([n,e]);i=[o[0],Np-o[1],s[0],Np-s[1]]}const h=new jp(0,0,0),d={viewport:t,project:r,cullingVolume:s,elevationBounds:[l,c],minZ:u,maxZ:e,bounds:i,offset:0};if(h.update(d),t instanceof oa&&t.subViewports&&t.subViewports.length>1){for(d.offset=-1;h.update(d)&&!(--d.offset<-3););for(d.offset=1;h.update(d)&&!(++d.offset>3););}return h.getSelected()}(t,c,i,r):function(t,e,n,i,r){const o=function(t,e,n){let i;return i=t.getBounds(),t.isGeospatial?[Math.max(i[0],n[0]),Math.max(i[1],n[1]),Math.min(i[2],n[2]),Math.min(i[3],n[3])]:[Math.max(Math.min(i[0],n[2]),n[0]),Math.max(Math.min(i[1],n[3]),n[1]),Math.min(Math.max(i[2],n[0]),n[2]),Math.min(Math.max(i[3],n[1]),n[3])]}(t,0,i),s=qp(e,n),[a,l,c,u]=function(t,e,n){return n?Wp(t,n).map((t=>t*e/Bp)):t.map((t=>t*e/Bp))}(o,s,r),h=[];for(let t=Math.floor(a);t<c;t++)for(let n=Math.floor(l);n<u;n++)h.push({x:t,y:n,z:e});return h}(t,c,o,u||Up,a)}function Qp(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}return!1}const $p="best-available",Jp={[$p]:function(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&!eg(e)&&ng(e);for(const e of t)e.isVisible=Boolean(2&e.state)},"no-overlap":function(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&eg(e);const e=Array.from(t).sort(((t,e)=>t.zoom-e.zoom));for(const t of e)if(t.isVisible=Boolean(2&t.state),t.children&&(t.isVisible||1&t.state))for(const e of t.children)e.state=1;else t.isSelected&&ng(t)},never:()=>{}},tg={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};function eg(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=2,!0;e=e.parent}return!1}function ng(t){for(const e of t.children)e.isLoaded||e.content?e.state|=2:ng(e)}const ig={TilesetClass:class{constructor(t){i(this,"opts",void 0),i(this,"_requestScheduler",void 0),i(this,"_cache",void 0),i(this,"_dirty",void 0),i(this,"_tiles",void 0),i(this,"_cacheByteSize",void 0),i(this,"_viewport",void 0),i(this,"_zRange",void 0),i(this,"_selectedTiles",void 0),i(this,"_frameNumber",void 0),i(this,"_modelMatrix",void 0),i(this,"_modelMatrixInverse",void 0),i(this,"_maxZoom",void 0),i(this,"_minZoom",void 0),i(this,"onTileLoad",void 0),i(this,"_getCullBounds",function(t){let e,n={};return i=>{for(const r in i)if(!Qp(i[r],n[r])){e=t(i),n=i;break}return e}}(Gp)),this.opts={...tg,...t},this.onTileLoad=t=>{var e,n;null===(e=(n=this.opts).onTileLoad)||void 0===e||e.call(n,t),this.opts.maxCacheByteSize&&(this._cacheByteSize+=t.byteLength,this._resizeCache())},this._requestScheduler=new _f({maxRequests:t.maxRequests,throttleRequests:Boolean(t.maxRequests&&t.maxRequests>0)}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new Ln,this._modelMatrixInverse=new Ln,this.setOptions(t)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return null!==this._selectedTiles&&this._selectedTiles.every((t=>t.isLoaded))}get needsReload(){return null!==this._selectedTiles&&this._selectedTiles.some((t=>t.needsReload))}setOptions(t){Object.assign(this.opts,t),Number.isFinite(t.maxZoom)&&(this._maxZoom=Math.floor(t.maxZoom)),Number.isFinite(t.minZoom)&&(this._minZoom=Math.ceil(t.minZoom))}finalize(){for(const t of this._cache.values())t.isLoading&&t.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const t of this._cache.keys()){const e=this._cache.get(t);this._selectedTiles&&this._selectedTiles.includes(e)?e.setNeedsReload():this._cache.delete(t)}}update(t,{zRange:e,modelMatrix:n}={}){const i=new Ln(n),r=!i.equals(this._modelMatrix);if(this._viewport&&t.equals(this._viewport)&&De(this._zRange,e)&&!r)this.needsReload&&(this._selectedTiles=this._selectedTiles.map((t=>this._getTile(t.index,!0))));else{r&&(this._modelMatrixInverse=i.clone().invert(),this._modelMatrix=i),this._viewport=t,this._zRange=e;const n=this.getTileIndices({viewport:t,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:e,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=n.map((t=>this._getTile(t,!0))),this._dirty&&this._rebuildTree()}const o=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),o&&this._frameNumber++,this._frameNumber}isTileVisible(t,e){if(!t.isVisible)return!1;if(e&&this._viewport){const n=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:e}),{bbox:i}=t;for(const[t,e,r,o]of n){let n;if("west"in i)n=i.west<r&&i.east>t&&i.south<o&&i.north>e;else{const s=Math.min(i.top,i.bottom),a=Math.max(i.top,i.bottom);n=i.left<r&&i.right>t&&s<o&&a>e}if(n)return!0}return!1}return!0}getTileIndices({viewport:t,maxZoom:e,minZoom:n,zRange:i,modelMatrix:r,modelMatrixInverse:o}){const{tileSize:s,extent:a,zoomOffset:l}=this.opts;return Kp({viewport:t,maxZoom:e,minZoom:n,zRange:i,tileSize:s,extent:a,modelMatrix:r,modelMatrixInverse:o,zoomOffset:l})}getTileId(t){return"".concat(t.x,"-").concat(t.y,"-").concat(t.z)}getTileZoom(t){return t.z}getTileMetadata(t){const{tileSize:e}=this.opts;return{bbox:Yp(this._viewport,t.x,t.y,t.z,e)}}getParentIndex(t){return{x:Math.floor(t.x/2),y:Math.floor(t.y/2),z:t.z-1}}updateTileStates(){const t=this.opts.refinementStrategy||$p,e=new Array(this._cache.size);let n=0;for(const t of this._cache.values())e[n++]=t.isVisible,t.isSelected=!1,t.isVisible=!1;for(const t of this._selectedTiles)t.isSelected=!0,t.isVisible=!0;("function"==typeof t?t:Jp[t])(Array.from(this._cache.values())),n=0;for(const t of this._cache.values())if(e[n++]!==t.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:t=0}=this.opts,e=[];let n=0;for(const t of this._cache.values())t.isLoading&&(n++,t.isSelected||t.isVisible||e.push(t));for(;t>0&&n>t&&e.length>0;)e.shift().abort(),n--}_rebuildTree(){const{_cache:t}=this;for(const e of t.values())e.parent=null,e.children&&(e.children.length=0);for(const e of t.values()){const t=this._getNearestAncestor(e);e.parent=t,null!=t&&t.children&&t.children.push(e)}}_resizeCache(){const{_cache:t,opts:e}=this,n=e.maxCacheSize||(e.maxCacheByteSize?1/0:5*this.selectedTiles.length),i=e.maxCacheByteSize||1/0;if(t.size>n||this._cacheByteSize>i){for(const[s,a]of t){var r,o;if(a.isVisible||a.isSelected||(this._cacheByteSize-=e.maxCacheByteSize?a.byteLength:0,t.delete(s),null===(r=(o=this.opts).onTileUnload)||void 0===r||r.call(o,a)),t.size<=n&&this._cacheByteSize<=i)break}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort(((t,e)=>t.zoom-e.zoom)),this._dirty=!1)}_getTile(t,e){const n=this.getTileId(t);let i=this._cache.get(n),r=!1;return!i&&e?(i=new bf(t),Object.assign(i,this.getTileMetadata(i.index)),Object.assign(i,{id:n,zoom:this.getTileZoom(i.index)}),r=!0,this._cache.set(n,i),this._dirty=!0):i&&i.needsReload&&(r=!0),i&&r&&i.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),i}_getNearestAncestor(t){const{_minZoom:e=0}=this;let n=t.index;for(;this.getTileZoom(n)>e;){n=this.getParentIndex(n);const t=this._getTile(n);if(t)return t}return null}},data:{type:"data",value:[]},dataComparator:Vp.equal,renderSubLayers:{type:"function",value:t=>new pf(t)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:t=>console.error(t)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:$p,zRange:null,maxRequests:6,zoomOffset:0};class rg extends yh{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var t,e;null===(t=this.state)||void 0===t||null===(e=t.tileset)||void 0===e||e.finalize()}get isLoaded(){var t,e;return null===(t=this.state)||void 0===t||null===(e=t.tileset)||void 0===e?void 0:e.selectedTiles.every((t=>t.isLoaded&&t.layers&&t.layers.every((t=>t.isLoaded))))}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState({changeFlags:t}){let{tileset:e}=this.state;const n=t.propsOrDataChanged||t.updateTriggersChanged,i=t.dataChanged||t.updateTriggersChanged&&(t.updateTriggersChanged.all||t.updateTriggersChanged.getTileData);e?n&&(e.setOptions(this._getTilesetOptions()),i?e.reloadAll():this.state.tileset.tiles.forEach((t=>{t.layers=null}))):(e=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:e})),this._updateTileset()}_getTilesetOptions(){const{tileSize:t,maxCacheSize:e,maxCacheByteSize:n,refinementStrategy:i,extent:r,maxZoom:o,minZoom:s,maxRequests:a,zoomOffset:l}=this.props;return{maxCacheSize:e,maxCacheByteSize:n,maxZoom:o,minZoom:s,tileSize:t,refinementStrategy:i,extent:r,maxRequests:a,zoomOffset:l,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const{tileset:t}=this.state,{zRange:e,modelMatrix:n}=this.props,i=t.update(this.context.viewport,{zRange:e,modelMatrix:n}),{isLoaded:r}=t,o=this.state.isLoaded!==r,s=this.state.frameNumber!==i;r&&(o||s)&&this._onViewportLoad(),s&&this.setState({frameNumber:i}),this.state.isLoaded=r}_onViewportLoad(){const{tileset:t}=this.state,{onViewportLoad:e}=this.props;e&&e(t.selectedTiles)}_onTileLoad(t){this.props.onTileLoad(t),t.layers=null,this.setNeedsUpdate()}_onTileError(t,e){this.props.onTileError(t),e.layers=null,this.setNeedsUpdate()}_onTileUnload(t){this.props.onTileUnload(t)}getTileData(t){const{data:e,getTileData:n,fetch:i}=this.props,{signal:r}=t;return t.url="string"==typeof e||Array.isArray(e)?function(t,e){if(!t||!t.length)return null;const{index:n,id:i}=e;var r;Array.isArray(t)&&(t=t[(r=i,Math.abs(r.split("").reduce(((t,e)=>(t<<5)-t+e.charCodeAt(0)|0),0))%t.length)]);let o=t;for(const t of Object.keys(n)){const e=new RegExp("{".concat(t,"}"),"g");o=o.replace(e,String(n[t]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(o=o.replace(/\{-y\}/g,String(Math.pow(2,n.z)-n.y-1))),o}(e,t):null,n?n(t):i&&t.url?i(t.url,{propName:"data",layer:this,signal:r}):null}renderSubLayers(t){return this.props.renderSubLayers(t)}getSubLayerPropsByTile(t){return null}getPickingInfo({info:t,sourceLayer:e}){const n=e.props.tile;return t.picked&&(t.tile=n),t.sourceTile=n,t}_updateAutoHighlight(t){const e=t.sourceTile;if(e&&e.layers)for(const n of e.layers)n.updateAutoHighlight(t)}renderLayers(){return this.state.tileset.tiles.map((t=>{const e=this.getSubLayerPropsByTile(t);if(t.isLoaded||t.content)if(t.layers)e&&t.layers[0]&&Object.keys(e).some((n=>t.layers[0].props[n]!==e[n]))&&(t.layers=t.layers.map((t=>t.clone(e))));else{const n=this.renderSubLayers({...this.props,id:"".concat(this.id,"-").concat(t.id),data:t.content,_offset:0,tile:t});t.layers=D(n,Boolean).map((n=>n.clone({tile:t,...e})))}return t.layers}))}filterSubLayer({layer:t,cullRect:e}){const{tile:n}=t.props;return this.state.tileset.isTileVisible(n,e)}}i(rg,"defaultProps",ig),i(rg,"layerName","TileLayer");const og=new Uint16Array([0,2,1,0,3,2]),sg=new Float32Array([0,1,0,0,1,0,1,1]);function ag(t,e,n){return Fe(Fe(t[0],t[1],n),Fe(t[3],t[2],n),e)}const lg="\n#define SHADER_NAME bitmap-layer-fragment-shader\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D bitmapTexture;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float desaturate;\nuniform vec4 transparentColor;\nuniform vec3 tintColor;\nuniform float opacity;\n\nuniform float coordinateConversion;\nuniform vec4 bounds;\n\n/* projection utils */\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / PI / 2.0;\n\n// from degrees to Web Mercator\nvec2 lnglat_to_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// from Web Mercator to degrees\nvec2 mercator_to_lnglat(vec2 xy) {\n  xy /= WORLD_SCALE;\n  return degrees(vec2(\n    xy.x - PI,\n    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5\n  ));\n}\n/* End projection utils */\n\n// apply desaturation\nvec3 color_desaturate(vec3 color) {\n  float luminance = (color.r + color.g + color.b) * 0.333333333;\n  return mix(color, vec3(luminance), desaturate);\n}\n\n// apply tint\nvec3 color_tint(vec3 color) {\n  return color * tintColor;\n}\n\n// blend with background color\nvec4 apply_opacity(vec3 color, float alpha) {\n  if (transparentColor.a == 0.0) {\n    return vec4(color, alpha);\n  }\n  float blendedAlpha = alpha + transparentColor.a * (1.0 - alpha);\n  float highLightRatio = alpha / blendedAlpha;\n  vec3 blendedRGB = mix(transparentColor.rgb, color, highLightRatio);\n  return vec4(blendedRGB, blendedAlpha);\n}\n\nvec2 getUV(vec2 pos) {\n  return vec2(\n    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),\n    (pos.y - bounds[3]) / (bounds[1] - bounds[3])\n  );\n}\n\n".concat("\nvec3 packUVsIntoRGB(vec2 uv) {\n  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction\n  vec2 uv8bit = floor(uv * 256.);\n\n  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits\n  // Scale and clamp to 0-1 range\n  vec2 uvFraction = fract(uv * 256.);\n  vec2 uvFraction4bit = floor(uvFraction * 16.);\n\n  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates\n  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;\n\n  return vec3(uv8bit, fractions) / 255.;\n}\n","\n\nvoid main(void) {\n  vec2 uv = vTexCoord;\n  if (coordinateConversion < -0.5) {\n    vec2 lnglat = mercator_to_lnglat(vTexPos);\n    uv = getUV(lnglat);\n  } else if (coordinateConversion > 0.5) {\n    vec2 commonPos = lnglat_to_mercator(vTexPos);\n    uv = getUV(commonPos);\n  }\n  vec4 bitmapColor = texture2D(bitmapTexture, uv);\n\n  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);\n\n  geometry.uv = uv;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n\n  if (picking_uActive && !picking_uAttribute) {\n    // Since instance information is not used, we can use picking color for pixel index\n    gl_FragColor.rgb = packUVsIntoRGB(uv);\n  }\n}\n"),cg={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:ri.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0}};class ug extends ch{constructor(...t){super(...t),i(this,"state",void 0)}getShaders(){return super.getShaders({vs:"\n#define SHADER_NAME bitmap-layer-vertex-shader\n\nattribute vec2 texCoords;\nattribute vec3 positions;\nattribute vec3 positions64Low;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float coordinateConversion;\n\nconst vec3 pickingColor = vec3(1.0, 0.0, 0.0);\n\nvoid main(void) {\n  geometry.worldPosition = positions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = pickingColor;\n\n  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTexCoord = texCoords;\n\n  if (coordinateConversion < -0.5) {\n    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;\n  } else if (coordinateConversion > 0.5) {\n    vTexPos = geometry.worldPosition.xy;\n  }\n\n  vec4 color = vec4(0.0);\n  DECKGL_FILTER_COLOR(color, geometry);\n}\n",fs:lg,modules:[bh,xh]})}initializeState(){const t=this.getAttributeManager();t.remove(["instancePickingColors"]);const e=!0;t.add({indices:{size:1,isIndexed:!0,update:t=>t.value=this.state.mesh.indices,noAlloc:e},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:t=>t.value=this.state.mesh.positions,noAlloc:e},texCoords:{size:2,update:t=>t.value=this.state.mesh.texCoords,noAlloc:e}})}updateState({props:t,oldProps:e,changeFlags:n}){const i=this.getAttributeManager();if(n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),i.invalidateAll()}if(t.bounds!==e.bounds){const t=this.state.mesh,e=this._createMesh();this.state.model.setVertexCount(e.vertexCount);for(const n in e)t&&t[n]!==e[n]&&i.invalidate(n);this.setState({mesh:e,...this._getCoordinateUniforms()})}else t._imageCoordinateSystem!==e._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(t){const{image:e}=this.props,n=t.info;if(!n.color||!e)return n.bitmap=null,n;const{width:i,height:r}=e;n.index=0;const o=function(t){const[e,n,i]=t;return[(e+(15&i)/16)/256,(n+(240&i)/256)/256]}(n.color),s=[Math.floor(o[0]*i),Math.floor(o[1]*r)];return n.bitmap={size:{width:i,height:r},uv:o,pixel:s},n}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(t){super._updateAutoHighlight({...t,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:t}=this.props;let e=t;return hg(t)&&(e=[[t[0],t[1]],[t[0],t[3]],[t[2],t[3]],[t[2],t[1]]]),function(t,e){if(!e)return function(t){const e=new Float64Array(12);for(let n=0;n<t.length;n++)e[3*n+0]=t[n][0],e[3*n+1]=t[n][1],e[3*n+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:og,texCoords:sg}}(t);const n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),i=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),r=Math.ceil(n/e)+1,o=Math.ceil(i/e)+1,s=(r-1)*(o-1)*6,a=new Uint32Array(s),l=new Float32Array(r*o*2),c=new Float64Array(r*o*3);let u=0,h=0;for(let e=0;e<r;e++){const n=e/(r-1);for(let i=0;i<o;i++){const r=i/(o-1),s=ag(t,n,r);c[3*u+0]=s[0],c[3*u+1]=s[1],c[3*u+2]=s[2]||0,l[2*u+0]=n,l[2*u+1]=1-r,e>0&&i>0&&(a[h++]=u-o,a[h++]=u-o-1,a[h++]=u-1,a[h++]=u-o,a[h++]=u-1,a[h++]=u),u++}}return{vertexCount:s,positions:c,indices:a,texCoords:l}}(e,this.context.viewport.resolution)}_getModel(t){return t?new xu(t,{...this.getShaders(),id:this.props.id,geometry:new Sh({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(t){const{uniforms:e,moduleParameters:n}=t,{model:i,coordinateConversion:r,bounds:o,disablePicking:s}=this.state,{image:a,desaturate:l,transparentColor:c,tintColor:u}=this.props;n.pickingActive&&s||a&&i&&i.setUniforms(e).setUniforms({bitmapTexture:a,desaturate:l,transparentColor:c.map((t=>t/255)),tintColor:u.slice(0,3).map((t=>t/255)),coordinateConversion:r,bounds:o}).draw()}_getCoordinateUniforms(){const{LNGLAT:t,CARTESIAN:e,DEFAULT:n}=ri;let{_imageCoordinateSystem:i}=this.props;if(i!==n){const{bounds:n}=this.props;if(!hg(n))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const r=this.context.viewport.resolution?t:e;if(i=i===t?t:e,i===t&&r===e)return{coordinateConversion:-1,bounds:n};if(i===e&&r===t){const t=Xn([n[0],n[1]]),e=Xn([n[2],n[3]]);return{coordinateConversion:1,bounds:[t[0],t[1],e[0],e[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}function hg(t){return Number.isFinite(t[0])}i(ug,"layerName","BitmapLayer"),i(ug,"defaultProps",cg);var dg=n(772),fg=n.n(dg),pg={latitude:47.65,longitude:7,zoom:4.5,maxZoom:20,maxPitch:89,bearing:0},gg={position:"absolute",right:0,bottom:0,backgroundColor:"hsla(0,0%,100%,.5)",padding:"0 5px",font:"12px/20px Helvetica Neue,Arial,Helvetica,sans-serif"},mg={textDecoration:"none",color:"rgba(0,0,0,.75)",cursor:"grab"},vg="undefined"!=typeof window&&window.devicePixelRatio||1;function yg(t){var e=t.tile;if(e){var n=e.index,i=n.x,r=n.y,o=n.z;return"tile: x: ".concat(i,", y: ").concat(r,", z: ").concat(o)}return null}function _g(e){var n=e.showBorder,i=void 0!==n&&n,r=e.onTilesLoad,o=new rg({data:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png","https://c.tile.openstreetmap.org/{z}/{x}/{y}.png"],maxRequests:20,pickable:!0,onViewportLoad:void 0===r?null:r,autoHighlight:i,highlightColor:[60,60,60,40],minZoom:0,maxZoom:19,tileSize:256,zoomOffset:1===vg?-1:0,renderSubLayers:function(t){var e=t.tile.bbox,n=e.west,r=e.south,o=e.east,s=e.north;return[new ug(t,{data:null,image:t.data,bounds:[n,r,o,s]}),i&&new Od({id:"".concat(t.id,"-border"),data:[[[n,s],[n,r],[o,r],[o,s],[n,s]]],getPath:function(t){return t},getColor:[255,0,0],widthMinPixels:4})]}});return t.createElement(vh,{layers:[o],views:new Ca({repeat:!0}),initialViewState:pg,controller:!0,getTooltip:yg},t.createElement("div",{style:gg},"Â© ",t.createElement("a",{style:mg,href:"http://www.openstreetmap.org/copyright",target:"blank"},"OpenStreetMap contributors")))}fg().create(t.createElement(_g,null),"web-component-test")})()})();